[{"title":"anaconda","url":"/2022/04/23/anaconda/","content":"Anacondaone year ago, i heared anaconda when i learned python in oneline video tutorial. and how, what is anaconda, it is just a virtual environment of python. why i need it? i have python in my local machine! seems useless\ntoday, i finally realized that it is a amazing tool. since i wrote a python script with python3, it runs perfect locally. however in the real environment(remote machine), i cannot run it. because remote machine is python2.6 and also cannot install modules oneline. i tried several ways: such as packing modules, compiling python3 from source. all failed!\nfinally, i remember it, yeah, anaconda! and it is really so good, it can be installed in different os without dependent error and includes all modules which i need. amazing!\nfeatures\neasily in use\n\npurely installed without dependence error in whatever os\n\ninclude many modules what we used daily\n\nmulti different virtual environment, each of them without any relation\n\nwithout any affect to local environment\n\n\ninstalldownload from website, it has two choice:\n\nanaconda: include 1500+ modules, especially scientific packages and 3 GB storage disk needed \nminianaconda: without scientific packages, but enough for daily usage and 400Mib storage disk needed\n\ni download the minimal package\nthe installation in linux is easy\n\ndownload package\n\ngrant priviledge and execute\nchmod u+x Miniconda3-py39_4.9.2-Linux-x86_64.sh./Miniconda3-py39_4.9.2-Linux-x86_64.sh\nstep by step\n\nnote: \n   the place anaconda installed should be a folder that doesn’t exist\n\nDo you accept the license terms? [yes|no][no] &gt;&gt;&gt; yesMiniconda3 will now be installed into this location:/home/blueocean/miniconda3  - Press ENTER to confirm the location  - Press CTRL-C to abort the installation  - Or specify a different location below[/home/blueocean/miniconda3] &gt;&gt;&gt; /home/blueocean/.local/apps/minicandaDo you wish the installer to initialize Miniconda3by running conda init? [yes|no][no] &gt;&gt;&gt; yesmodified      `/home/blueocean/.zshrc`\nreopen terminal or source the environment variables where conda’s config stores, in my case it is in ~/.zshrc \n\ndisable auto enter conda base environment\nin default conda will auto active when we start up a terminal. that’s not i want, so change it.\nconda config --set auto_activate_base false# and checkconda config --show|grep base\n\nusagefull document follow this page\nlogin/logout environmentafter installation completes without error, we can reopen terminal or source the file where installation modified with source ~/.zshrc\n~ » source .zshrc                                                                         (base) ~ »         \n\nit is obviously that the promt changed, we can also modify prompt with --set env_prompt\nconda config --set env_prompt &#x27;(&#123;conda&#125;)&#x27;\n\nafter source file, we enter the default base environment which was created while installing. we can list the environment that we have created with conda env list\n(base) ~ » conda env list                                                                 # conda environments:#base                  *  /home/blueocean/.local/apps/minicanda\n\ncheck conda version\n(base) ~ » conda --version                                                               conda 4.9.2\n\n\nif versions prior to 4.6\n\nenter environment\nsource activate conda_env_name\nexit environment\nsource deactivate\n\n\nif versions higher than 4.6\n\nenter environment\nconda activate conda_env_name\nexit environment\nconda deactivate\n\n\n\ncreate new environmentbefore we install packages, we need config download mirrors, without configure will lead to installation failed for slowly download speed.\nconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/mainconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/freeconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/rconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/proconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2\n\nif the channel added is wrong, we can remove it by\nconda config --remove channels mirrors_url# such asconda config --remove channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r\n\ncheck channels config now\nconda config --show channels\n\ncreate environment \n# syntaxconda create --name conda_env_name install_module_name\n\nwhen we don’t specify python version, conda will install the newest python version. if we want to use a different versin of python, for example python 2.6, simply create a new environment and specify the version of Python that you want.\nconda create --name snowflakes python2.6\n\nif we have multi modules need to be installed, we should write in one line to avoid depences missing.\n# such as install pandas xlwt pathlib moduleconda create --name sky pandas xlwt pathlib\n\ncheck new environment\nconda env list\n\npack environmentwith conda-pack, we can pack environment to any other location and any other os.\n\nnote:\n   os means the same platform, such as cannot pack one linux environment to windows\n\ninstall conda-pack with conda\nit is recommended to install conda-pack into base environment, since it can be used in all other sub environment\nconda install conda-pack\n\npack environment\n# pack into ./env_name.tar.gzconda pack --name env_name# pack into /specified/location/path/env_name.tar.gzconda pack --prefix /store/location/path# change out nameconda pack --output my_env_name.tar.gz\n\nunpack environment\nthe condition we can use conda-pack is that there has a conda installed on the target machine.\n\nnote:\nthe place we unpack can be two parts:\n1. under base environment `envs` floder\n2. any other folder\n\n\n# create a folder named the same as packagemkdir /environment/stored/env_name# or store it in default base envsmkdir /path/to/base/envs# extract packagetar -xzf env_name.tar.gz -C /path/to/create/folder# if not in base envs, activate environment, this will add env_name/bin to your pathsource env_name/bin/activate# if in base envs, activate environment with conda directoryconda activate env_name# unpack conda-unpack# deactivate if not in default base envs, this will remove it from you pathsource env_name/bin/deactivate# if in base envs, activate environment with conda directoryconda deactivate\n","categories":["learn"],"tags":["anaconda"]},{"title":"anbox","url":"/2022/04/23/anbox/","content":"AnboxIn this article i will show you how to install anbox with snap and compare snap with flatpak.  anbox is a container-based software for running Android in linux. be different from virtual machine, anbox uses kernel module binder and ashmem to share and devide system source, thus it starts up very quickly.\nsnap vs flatpaksnap or flatpak is a cross platform package manager in different linux OS, which stores packages in a independent environment and improves security of system. whatever to say, both of them are not perfect as what i want. why i use it? i hope to install large size software in another disk partition but not the system tree in linux, if there is a need to reinstall the system, i don’t need to reinstall the software itself, one thing i need  is installing the snap package.\ndisadvantages:\n\nsnap doesn’t allow to specify package location, so we need to mount bind to that location.\nflatpak doesn’t have above disadvantages but the software size is too large and has less software than snap.\n\ni choose snap at last, the main reason in this case is that only snap has anbox package.\nchange kernelkernel module\ndefault linux kernel doesn’t has anbox needed modules, a simple way is installing a linux-zen kernel\npacman -S linux-zen\n\nthen we need edit /boot/grub/grub.cfg file, adding a sub entry with the new kernel. once we boot in grub, we can choose the  new kernel by hand.\nmenuentry &#x27;Arch Linux, with Linux-zen linux&#x27; --class arch --class gnu-linux --class gnu --class os $menuentry_id_option &#x27;gnulinux-linux-advanced-20f94885-274b-4a99-b067-a0adf09a1723&#x27; &#123;\t.\t.\t.\techo\t&#x27;Loading Linux-zen linux ...&#x27;\tlinux\t/boot/vmlinuz-linux-zen root=UUID=20f94885-274b-4a99-b067-a0adf09a1723 rw  loglevel=3 quiet\techo\t&#x27;Loading initial ramdisk ...&#x27;\tinitrd\t/boot/initramfs-linux-zen.img&#125;\n\n\n\nsnap installsnap package location change\nsnap has no method to specify package location, but we can use mount bind to mount other location to the package folder\n# snap package folder is  /var/lib/snapd# before install snap, mount folder to that foldermkdir /home/healer/Public/snapdsudo mkdir /var/lib/snapdsudo mount --bind /home/healer/Public/snapd /var/lib/snapd\n\nabove command will make effect until reboot, so we need write mount command to /etc/fstab in order to auto mount after system reboot.\nsudo vim /etc/fstab/home/healer/Public/snapd\t/var/lib/snapd\tnone\tbind\t0 0\n\ninstall snap\nparu -S snapd\n\nstart snap\nsudo systemctl enable --now snapd.socket\n\nadd hosts entry\nby default the speed snap downloads is slow, we need add dns to hosts file\necho &quot;151.101.62.217  fastly.cdn.snapcraft.io&quot; &gt;&gt; /etc/hosts\n\nsome snap commands\n# updatesnap refresh# searchsnap find package-name# installsnap install package-name# uninstallsnap uninstall package-name# list installed package snap list\n\n\n\n\n\nanbox installwe can find all snap packages in this website\nsnap install --devmode --beta anbox\n\nrun anbox first time\n/var/lib/snapd/snap/bin/anbox launch --package=org.anbox.appmgr --component=org.anbox.appmgr.AppViewActivity\n\nafter system reboot we can start anbox via system launch app or dmenu\ninstall apk in anboxby default, anbox has no app store in it, so we need install a app store to it. the method we use is adb\n# adb is part of android-tools packagesudo pacman -S android-tools\n\n# such as download a coolan apk from web browser and install it to anboxadb install Coolapk-11.4.2-2109281-coolapk-app-sign.apk\n\n\n\n\n\nflatpakinstall\nat last, i want to record the flatpak installation and usage. in a fact that flatpak is really easy to install or use.\n# installsudo pacman -S flatpak\n\nadd repo\nwe need to know that the package store location is defined by --user parameter. however the parameter takes effect only when we specify the user repo before. by default our repository is system, so we need add user repository manually.\n# systemflatpak remote-add --if-not-exists flathub https://dl.flathub.org/repo/flathub.flatpakrepo# userflatpak remote-add --user --if-not-exists flathub https://dl.flathub.org/repo/flathub.flatpakrepo# check repoflatpak remotes\n\nusage\nfind support packages and package install commands in this website\n# eg:# install firefox in user locationflatpak install --user flathub org.mozilla.firefox\n\nuser package location is ~/.local/share/flatpak\n# start with commandflatpak run org.mozilla.firefox# or directlyfirefox# or find it in package launch manager such as dmenu or rofi\n\nsome commands\n# updateflaptak update# search flatpak search package-name# installflatpak install package-name# uninstallflatpak uninstall package-name# list installed packageflatpak list\n\n\n\n","categories":["learn"],"tags":["anbox"]},{"title":"ansible","url":"/2022/04/23/ansible/","content":"Ansibleansible is a software without the concept of server or client, but it can do the job of cluster management. the magic is that it uses ssh to connect to other os, that’s it. it can do all of the thing what you do in hosts.\nfeatures\nno client\nvia ssh\nmoduled\nyaml file\nparallel\n\nfunction\nsoftware deployment, install software via ansible\nconfiguration management, configure system via ansible\nsoftware provisioning\n\ninstallin centos\nyum install epel-release -yyum install ansible -y\n\nin archlinux\npacman -S ansible\n\n\n\nsyntaxansible host_pattern action# oransible-playbook host_pattern\n\n\n\ninventory fileif only one ip address to connect, we can write it directly. if more than one ip address we can write it in a special file called inventory file.\ninventory file is a file that ansible store variable messages(such as ip, login user name, password etc). the default file is /etc/ansible/hosts. we can simplily put ip in the file, however the way much better is group hosts.\n[group_name]host_ip_1host_ip_2host_ip_3\n\neg:\n[testCentos]192.168.31.114\n\nthen we can list all host in this file by\n# ansible all --list-hosts  hosts (1):    192.168.31.114\n\nif we know group name, we can specify group to show\n# ansible testCentos --list-hosts  hosts (1):    192.168.31.114\n\n\n\nwe can also specify ourself inventory file. there are two methords.\n\nchange the default location in /etc/ansible/ansible.cfg\ninventory      = /any/other/file/location\nspecify by parameter\nmake personal inventory file\necho &quot;[testCentos]192.168.31.114&quot; &gt;&gt; ip_addr.txt\n\nuse --inventory to define.\nansible --inventory ./ip_addr.txt all --list-hosts\n\nmodulemodule in ansible is command collection. we can find module help by\nansible-doc module_name\n\nsuch as find shell module usage \nansible-doc shell\n\ncheck total module in local machine\nansible-doc --list | wc -l\n\nwe can use those modules by --module-name.\nAd-hocAd-hoc commands in ansible means those one-line commands run in hosts. it is easy, simple without multi tasks to run. so if we just wanna to do a simple task, we can write Ad-hoc. for example check connection with machine.\none ip can write directly\nansible 192.168.31.114 --module-name ping\n\n\n\n# ansible all --module-name pingThe authenticity of host &#x27;192.168.31.114 (192.168.31.114)&#x27; can&#x27;t be established.ECDSA key fingerprint is SHA256:LzEdo+P7rgs1gJgODVWJaPFgHKk+Zl8/9ULzGN6z/8Q.Are you sure you want to continue connecting (yes/no/[fingerprint])? no192.168.31.114 | UNREACHABLE! =&gt; &#123;    &quot;changed&quot;: false,    &quot;msg&quot;: &quot;Failed to connect to the host via ssh: Host key verification failed.&quot;,    &quot;unreachable&quot;: true&#125;\n\nif we have ever not connect to the hosts, it may get an error msg, at this time we need to type password by adding --ask-pass\n# ansible all --module-name ping --ask-passSSH password: 192.168.31.114 | FAILED! =&gt; &#123;    &quot;msg&quot;: &quot;Using a SSH password instead of a key is not possible because Host Key checking is enabled and sshpass does not support this.  Please add this host&#x27;s fingerprint to your known_hosts file to manage this host.&quot;&#125;\n\nokay, it says that the default config has enabled host key check, so we need disable it\nvim /etc/ansible/ansible.cfg# uncomment to disable host key checkhost_key_checking = False\n\nthen, run command again\n# ansible all --module-name ping --ask-passSSH password: 192.168.31.114 | SUCCESS =&gt; &#123;    &quot;ansible_facts&quot;: &#123;        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;    &#125;,    &quot;changed&quot;: false,    &quot;ping&quot;: &quot;pong&quot;&#125;\n\nyes, we get it. &quot;changed&quot;: false above means we don’t change anything in remote machine.\n\nNote:\n\ninstead of typing password every times, the recommand way is configuring ansible machine connects to remote machine without password (put ansible ssh public key to remote machine).\nif we don’t specify a login user, it will use ansible machine login user name, we can use --user user_name to specify other login user.\nwe can use --ask-pass to input login user password\n\n\n# ansible testCentos --ask-pass --user root --module-name shell --args &quot;ip -c -br a&quot;           SSH password: 192.168.31.114 | CHANGED | rc=0 &gt;&gt;lo               UNKNOWN        127.0.0.1/8 ::1/128 enp0s3           UP             192.168.31.114/24 fe80::cd8e:43e4:458d:9ab3/64\n\n\nNote:\ncommand module can only be used in one command with its parameter, one liner command(several commands connected with &amp;&amp;, ;, |, &gt;) need use shell module.\n\nsometimes, we cannot login directly with root user, but we need root priviledge. there are two ways:\n\n if the login user has sudo priviledge\n\n   ansible all --user login_user --ask-pass --become --become-user root --ask-become-pass --module-name shell --args &quot;systemctl restart network&quot;\n\n\nif the login user has no sudo priviledge, then we need to change to root user with su\nansible all --user login_user --ask-pass --become --become-user root --become-method su --ask-become-pass --module-name shell --args &quot;systemctl restart network&quot;\n\nvariable of user name and passwordokay, as we write above, if we want to execute some command in remote machine, a login user and password is needed. we can use --user and --ask-pass then typing in terminal, and there is another way without typing.\nansible has already defined this variables. the thing that we need to do is sign a value to it. there are four  ways.\n\nwrite in inventory file.\nif we only specify a group login info, we can use [group_name:vars]. if we define global login info, we can use [all:vars].\n[testCentos]192.168.31.114[testCentos:vars]ansible_ssh_user=testansible_ssh_pass=123ansible_become_pass=123456\n\nthen execute without password input\nansible --inventory ./hosts all --module-name shell --args &quot;ps -ef|grep sshd&quot; --become --become-user root --become-method su\nwrite in playbook file playbook.yml\ntouch playbook.yml\n\n---- hosts: testCentos  vars:    ansible_ssh_user: test    ansible_ssh_pass: 123    ansible_become_pass: 123456  gather_facts: no  tasks:    - name: copy file to remote      become: yes      become_user: root      become_method: su      copy:      \tsrc: /tmp/hosts   \tdest: /root\n\nthen execute\nansible --inventory ./hosts playbook.yml\nwrite in a seperate variable file\nin this way , we need to import the file in playbook\n# touch ansible_vars.yml---ansible_ssh_user=testansible_ssh_pass=123ansible_become_pass=123456\n\n# import variable file in playbook- hosts: testCentos  vars_files:    - ./ansible_vars.yml  gather_facts: no  tasks:    - name: check sshd status      become: yes      become_user: root      become_method: su      shell: ps -ef|grep sshd|grep -v grep\nwrite in specify floder group_vars\nin the way, we write a yaml variable’s file in group_vars and named with the same group name as inventory file.  and we don’t need to import the variable file by this way.\n# in ansible working folder make a folder named group_varsmkdir group_vars# in group_vars, make group name file and write variablestouch testCentosecho &quot;---ansible_ssh_user=testansible_ssh_pass=123ansible_become_pass=123456&quot; &gt;&gt; testCentos\n\nnote: if we wanna to define global variable, we need to make a file named all\n\n\n\nNote:\nbecome_method: su is very useful , default is use sudo method, however most of time we are not in sudo group. but with su method, we login with root then execute command.\n\n\nvars: collection of variables\nname: what kind of thing the task does\nansible_ssh_user: login user name\nansible_ssh_pass: login user password\nansible_become_pass: root user password\ngather_facts: whether will we collect remote machine info, don’t gather saves lot of time\nbecome: change user or not \nbecome_user:  default \nuse sudo to run the tasks\nbecome_method: su: don’t use sudo, login with root. it is very userful when we have no sudo priviledge \nshell: run linux shell command.\n\nplaybookwhat is playbook? playbook is a set of Ad-hoc tasks writing in a yaml file. the method to execute playbook different from Ad-hoc. use ansible-playbook instead of ansible\n# such as i make a playbook file named playbook.ymlansible-playbook playbook.yml\n\nfor example\n# hosts file[testCentos]192.168.31.114\n\n# playbook---- hosts: testCentos  gather_facts: no  become: yes  become_user: root  become_method: su  vars:    ansible_ssh_user: test    ansible_ssh_pass: 123    ansible_become_pass: 123456    pkgname: nginx  tasks:    - name: add nginx resource      shell: rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm    - name: install &#123;&#123;pkgname&#125;&#125;      yum: name=&#123;&#123;pkgname&#125;&#125; state=present      notify:        - restart &#123;&#123;pkgname&#125;&#125;    - name: start at boot      systemd: name=&#123;&#123;pkgname&#125;&#125; state=started enabled=yes    - name: open firewalld 80 port      shell: |        firewall-cmd --zone=public --permanent --add-port=80/tcp        firewall-cmd --reload  handlers:    - name: restart &#123;&#123;pkgname&#125;&#125;      systemd: name=&#123;&#123;pkgname&#125;&#125; state=restarted\n\nexecute\nansible-playbook --inventroy hosts playbook.yml\n\nthen we can visit nginx web page at http://192.168.31.114\nabove we used modules: \n​    shell to execute shell command \n​    yum to download nginx \n​    systemd to start and enable nginx auto start.\nwe also used notify: when task execute successfully, it will raise a notify.\nwe also used handlers: to receive notify and execute others\nwe also used vars: it anounced serveral variables, and we can call it with &#123;&#123;variable_name&#125;&#125;\n\nnote:\nwe may say we can use shell instead of yum or systemd module, yeah, you can do it like that, but the best way is using available modules.\nuse | to combine multi line into one line. it is useful to execute more than one command.\n\nconditionwe use when condition to do logical judge. register to store return value. failed_when:no to continue when return value isn’t true(in default task will stop when return value is false).\nas we write above, if we execute again, it may failed because we already have a nginx repo. so what should we do? we need to check whether exists nginx repo. if exists then jump\n...  tasks:    - name: check whether nginx repo added      shell: ls /etc/yum.repos.d/ | grep nginx      register: repo      failed_when: no    - name: add nginx resource      shell: rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm      when: repo.rc == 1...\n\n\n\nloopwe can use loop syntax in ansible playbook. use with_items to loop list. the variable default \n---- hosts: testCentos  gather_facts: no  become: yes  become_user: root  become_method: su  tasks:    - name: install software      yum: name=&#123;&#123; item &#125;&#125; state=present      with_items:        - curl        - wget\n\nansible » ansible-playbook --inventory hosts playbook.yml                                                                         PLAY [testCentos] **************************************************************************************************************************************************************************TASK [install software] ********************************************************************************************************************************************************************changed: [192.168.31.114] =&gt; (item=[&#x27;curl&#x27;, &#x27;wget&#x27;])PLAY RECAP *********************************************************************************************************************************************************************************192.168.31.114             : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n\n\n\ntagswith tags, we can specify which task to be execute in shell command\n\nwrite tag at the end of task\n---- hosts: testCentos  gather_facts: no  become: yes  become_user: root  become_method: su  tasks:    - name: install curl      yum: name=curl state=present      tags:        - curl    - name: install wget      yum: name=wget state=present      tags:        - wget\nspecify which task should be execute by using --tags tag_name\n\n\n  ansible » ansible-playbook --inventory hosts playbook.yml --tags wget                                                               PLAY [testCentos] **************************************************************************************************************************************************************************      TASK [install wget] ************************************************************************************************************************************************************************   ok: [192.168.31.114]      PLAY RECAP *********************************************************************************************************************************************************************************   192.168.31.114             : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n\nblockblock can help us execute multi task in one condition.\n---- hosts: testCentos  gather_facts: no  become: yes  become_user: root  become_method: su  tasks:    - name: check network      shell: ping www.baidu.com -c 3      register: connect    - name: install curl      block:        - yum: name=curl state=present        - yum: name=wget state=present      when: connect.rc == 0\n\n\n\n\n\nAnsible Toweransible tower is a paid software(not free) aiming provide an easy usage gui for ansible. before install, we need to know the minimal machine requirement\n\ncpu: 2 core\nmem: 4Gib\nsoftware size: almost 2 Gib\n\ninstalldownload tar.gz it from this website, then extract\ntar -xzf ansible-tower-setup-3.6.0-1.tar.gz -C /opt\n\nbefore installing, we need to add password to inventory configure file\ncd /opt/ansible-tower-setup-3.6.0-1# for example, not exactly the same as below. but need to fill all empty passwordadmin_password=&#x27;ansible&#x27;pg_password=&#x27;ansible&#x27;rabbitmq_password=&#x27;ansible&#x27;\n\nthen install with a shell script. may be a coffee time\n./setup.sh\n\nwhen all tasks execute successfully. we can visit the web page with https://ip\n\nthe default user name is admin, and the password is what you typed in inventory file.\nlicense hackas we mentioned before, ansible tower is a paid software, so we cannot login the main page. however there is a way to hack the license and making it valid forever.\n# add epel repoyum -y install epel-release# install pipyum -y install python-pip# download reverse compile modulepip install uncompyle6# change to license diretorycd /var/lib/awx/venv/awx/lib/python3.6/site-packages/tower_license# reverse compile init fileuncompyle6 __init__.pyc &gt; __init__.py# change reversed compile filevi __init__.py# at line 84, remove last character &quot;L&quot;# after line 89, add a new line with &quot;return True&quot;# compile itpython -m py_compile __init__.pypython -O -m py_compile __init__.py# restart ansible-tower-serviceansible-tower-service restart\n\nfile __init__.py changed like this:\n\nthen we can login the main page, and check it’s license.\n\nthe default main page of ansible tower looks like this\n\ntemplatea template to execute command in remote and check remote service status\nip_info\n[client1]192.168.31.197192.168.31.196[client2]192.168.31.182[client1:vars]ansible_ssh_user=ngusansible_ssh_pass=123ansible_become_pass=123456[client2:vars]ansible_ssh_user=dbaansible_ssh_pass=321ansible_become_pass=654321\n\nyaml file: playbook.yaml\n---- hosts: all  gather_facts: no  become: yes  become_user: root  become_method: su  tasks:      - name: install client        shell: &#123;&#123;command here&#125;&#125;        register: install_status        failed_when: no        tags:          - install      - name: check client status        shell: ps -ef |grep service_name        tags:           - check...\n\nrun with command\n## installansible-playbook --inventory ip_info playbook.yaml --tag install## checkansible-playbook --inventory ip_info playbook.yaml --tag check\n\n","categories":["learn"],"tags":["ansible"]},{"title":"20220612-善良是如何消失的","url":"/2022/06/12/20220612-%E5%96%84%E8%89%AF%E6%98%AF%E5%A6%82%E4%BD%95%E6%B6%88%E5%A4%B1%E7%9A%84/","content":"20220612yes, today is Sunday. what a pretty name: the day with sunshine in summer, i can even feel the hot and clean wind of outside which has a long way for me now. I am so sad that i live in such a society where forbid us to do almost everything such as ride road bike.\n忧伤像风一样拂过，在这美丽的季节，这遥远的星河。我从未觉得一个人是如此的渺小，我们属于历史，我们被命运束缚，生活在某个特定的时代，无论我们多么强大，也逃不过属于宇宙的一粒尘埃。所以是什么让生活绚烂？\n我相信所有的美好，是他们让生活绚烂。\n在大学的周末，我和芳哥一起去我哥的学校玩，回去的时候在一家饭店吃饭，虽然不记得是在哪里遇到的某个乞讨的人，但是我记得芳哥给了他十/二十块钱。我当时想得是我是不会给这些人钱的，他们明明可以自己去工作，为什么要乞讨？而且那个时候十块或者二十块钱对我来说真的很多，因为我总是要计算一天吃饭只要花十七八块钱。\n毕业整整三年时间里，我也遇到过乞讨的人，然而在我每次遇到的时候，我都感觉自己好慌乱，就像女生主动找我说话。来不及思考他们是骗人的还是真的需要帮助，来不及如何用对话分辨他们的真伪。去年遇到三个女生，在我下班的路上主动找到我，希望我给他们支付一个晚上酒店的钱，她们说身上没有钱了，但是我看他们的穿着打扮就是那种我高攀不起的人。而且在南山区住酒店实在是太贵了，所以我让他们去找社区寻求帮助（虽然我也不知道怎么才能找到社区服务人员，或者他们是否会搭理这几个人）。她们找了一些理由不去找社区，虽然主观上告诉我他们并不是缺钱，但是最后我还是请他们吃了一顿饭，仅仅是因为我实在找不到任何理由来推脱他们的哀求。事后我反思自己要如何在下一次遇到这种情况的时候要像福尔摩斯一样，不要像一个刷卡机器一样。\n前几天我有遇到了这样一种情况，一个打扮的像建筑工地的人，乞讨回家的火车费。那时候我要赶公交车，时间比较紧，所以我直接走过去没理会他，但是突然有一种同情的感觉。因为我想起我的老爸了，这个人也是某个孩子的父亲，没有足够的车票钱他一定很焦急。所以我跑回去把拿了50多块的现金（也是唯一的现金）给了他，我很欣慰有足够的现金，他可以买到票回家了。而且对于有工作的我，这个数量完全比不上大学的时候那个十块钱那么宝贵。然后那一个上午我都沉浸在自我满足的开心中。但是很快我就快乐不起来了，我开始担心这个人会不会也是骗子呢？当时完全是被同情蒙蔽了双眼，没有思考太多。我只能希望这次是真的帮助了对的人。\n然而，现实让一切都显得很苍白，很遗憾过了几天后我又看到他了，同样的穿着，只是稍微换了个地方。当时我觉得好悲伤，为什么我好不容易积攒的一点善良就要被如此的践踏。\n诚实的说，我并没有多么善良，如果需要我给的钱超过200块了，估计我就不会付出了。就像如此的我，也还是希望可以在自己的能力范围内帮助一些人，然而现实的社会显得更加可悲。\n我知道，社会上却是有那么有些人，他们真的需要帮助，然而更多的是骗子，正是这些骗子让人内心深处仅存的一点善良逐渐流失。我们没有精力、能力去分辨真伪。可是，在我们需要用思考来衡量他们是否是骗子的时候，我已经感受到这个社会的可悲了。因为你很难去想象一个gentleman，在英国的街头慷慨的给乞讨的人一些钱，他是需要去判断你是否是一个骗子的。善良本来就是一件不需要思考的事，它是人的天性，我很同情你，在我的能力范围内，我很乐意去帮助你，仅此而已。然而在我们国家呢？大多数人宁愿抚养一个流浪猫，也不会施舍一个乞讨的人。这就是一个社会的性格，我们被教育的不要轻易相信他人，而且被现实一遍一遍的验证这个说法的正确性，而这是一个名族的悲哀。\n很久没看王阳明的书了，但是依旧记得他无数次谈论起当时的社会，快要病入膏肓了。而现在的社会呢？还有好转的可能吗？\n最近很火的一个话题是唐山流氓欺负女生打人的事件，网上有很多人对那些坐在旁边无动于衷的人口诛笔伐。然而，我不会，如果我也在现场，那么我一定是哪个坐在角落默默干饭的人，我承认这种做法是多么的让人无耻。但是各位键盘侠总是站在上帝的角度，他们不会反思，为什么坐在那个角落的人就不能是你呢？那些冷漠的人也是和我们一样的人啊，we share the same blood. 键盘侠们只看到表面，无法深入思考，为什么我们是如此的冷漠？这就是一个社会的习性，这个社会告诉我们无法保护伸张正义的人，只要我们参与了这个事情，那么我们就会陷入危机。那么一个陌生人为什么要让我们陷入危机？我们就是如此自私的思考方式。我无法趾高气扬的指责这些人，我很同情他们，也很可悲。这就是我们生活的环境，一段让人失望的历史阶段。就像开头所说的那样，我们无法左右历史，如果无法磨练自己，那么只会被历史改变。\n最近，我真的很迷david goggins，他说的这句话我印象很深：life is not easy, we must stay hard. 我无法用中文翻译这句话，因为没有合适的语言可以描述他的内涵，就像我们的古诗一样，古诗就是古诗，没法翻译成白话文，如果翻译成了白话文，那就表达不出古诗的含义。是啊，纵观历史，很难说有一个好的时代，so life is not easy, from past to future. we must stay hard, train our mind, our body, make it strong, when the bad situation happened in our life, our group, our members, our family, there comes me who is strong enough to defend all of this. that’s it. stay hard is not to say we need to challenge a task which we don’t wanna to. in some of an aspect  it’s to say we get a plan, whatever something happens, i gonna not to change forever. in some of an aspect it’s to say we cannot make ourselves suitable too long, cause it will make us lazy, we need do something to remind ourselves we are so weakness in this, so never stop our steps.\n当我和同事说起生活不能太舒服要stay hard的时候，他说那么我为什么不跑回家，其实当时我就被他这种提问题的方式惊讶到了，事情并不是说只有正反两个方面，如果你不这样….那么就不怎么样。我只能说他没明白这句话的意义，而且他的这种思考方式也有点让我无法理解，stay hard并不是说马上就要做一个什么一般人无法做到的事情来证明，也不是说要让自己难受，而是一种思想，在心里我们要意识到stay hard，同样在我们做事的时候也要stay hard，不要让放弃这个词出现在脑海。如果某天我真的想从公司跑回家，那么stay hard就可以这么说了。\n","categories":["think"],"tags":["boring"]},{"title":"20220605","url":"/2022/06/05/20220605/","content":"2022-06-05\n现在已经是凌晨1点了，但是因为放假，所以就不管时间了，我发现晚上才适合学习，比较清醒和有灵感。\n之前每天早上都是8点左右到公司，有一个小时的时间拿来看王阳明的书。但是最近早上都在搞锻炼，所以没有时间去看书了。本来打算好好总结书中的道理的，但是我还没有开始：）\n因为搞锻炼，所以认识了两个非常有名的人：大卫・戈金斯；泰森。其实泰森我初中好像就听过了只是没留意。戈金斯是美国海豹突击队的成员，创造了许多的记录，用3个月的时间减重90多斤，我在bilibili上看他的视频，首先是被他那喜欢说脏话所吸引，然后随着看得视频越多越发现他说的话真的很有道理，他是一个真正的man。\n他说了一个观点我是深有体会：你可能是个强者，比如你可以跑马拉松拿第一，你可以做200个俯卧撑，你可以成为一个在普通人看来很有毅力的人。但你真的是强者吗？上面所说的这些并不是真正的强者的判断标准，跑马拉松或者做200个俯卧撑，你有一个确定的目标，虽然大多数人连这个也做不到，但是真正的考验在于这些目标都失去后，前路一片黑暗的时候你是否可以坚持下去。不把希望寄托在别人身上或者别人制定的规则身上，才是强者的第一步。你能做10个俯卧撑，那是你的极限，我能做80个，那是我的极限。但是并不能说我比你强，而是说到达极限之后谁能坚持的更久谁才是强者。只有锻炼到一定程度后才发现自己是有多么的weakness，才能更加清楚的认识到自己。\n从上面的观点延伸，如果总是需要将自己的行动力寄托在什么身上，那么是非常容易被打败的，比如你锻炼需要音乐来刺激你，那么如果没有音乐的环境你怎么办？你早上晨跑需要寄托在天气上，如果今天下暴雨呢？你就不锻炼不跑步了吗？他说世界是残酷的，大多数时候我们都会面对不可预料的问题，而真正的强者是不需要寄托与外界。只有这样我们才可能变强。\n他说的这两个观点真的是直击灵魂，而且我也深有感触。不要寄托与希望，不要依靠外界的环境，才能让我们成为一个强者。太多生活中的人当然也包括我，总是在说如果…那么我就…，我们总是需要某些条件ready我们才会do it。而这样真的是一个非常非常弱的人。\n戈金斯的观点太多了，先就说这么两个吧。然后说说泰森，叫他拳皇是真的一点都不为过，40战39胜1败。我主要是被他的力量和灵活的躲闪所吸引，看他的比赛，真的可以看到那种原始的狂野与力量，每一拳都感觉能把一个普通人打晕过去。他的光环与天赋与坚韧不是我想说的重点，我更想说的是他的那些缺点。没错他有很多缺点，如果用我们的观点来看的话，比如随意挥霍金钱，交往20多个女人，在比赛中咬对手的耳朵。很多人因为这些鄙视他，我们其实根本没有权利去指责，因为我们总是站在一个第三者的视角去看待问题。是想一下如果他的人生换成了我们，我们就不会那么去做吗？我想大多数人只会做的更离谱。相反我觉得这样的人生才算是真正的人生，起起伏伏，有辉煌有哀伤，这样才不枉来过这个宇宙一场。\n其实一个人的一生真的会犯很多的错误，那个人敢说自己真的就是正义的化身呢，我们不能总是拿完美无缺的标准去看待这些不平凡的人。说白了他们也是一个普通人，只不过他们更加有机会接近那些丑陋。对于他们自己来说关键在于他们是否会改正，能否摆脱困境。对于我们来说才是体现我们的包容，我想如果我们能够理解这点，那么就能明白仁慈代表的含义是什么了。仁慈不是我们友善，不是你有多么热爱小动物，不是你有多么爱戴老人，而是在动物咬了你一口后，老人碰磁你之后你的表现。他们伤害了我们，我们还能够用平常心对待，这才是仁慈才是包容。\n当然看视频的时候有很多人就如果和李小龙打谁会赢而争吵起来，对于这些观点在我看来有两个问题：\n\n这种假设不会发生，争论真的毫无意义，觉得谁赢这完全是主观判断\n说这种话的人既不了解泰森，也不了解李小龙\n\n我就简单说说我所认识的李小龙吧，从小学开始因为开了《李小龙传奇》就非常迷，希望自己也可以有他那样的功夫。一直到今年，直到我在youtube上开了李小龙的采访，我才明白李小龙并不是我想象中的那样，他更加的伟大。而电视剧真的是误解了李小龙，看了他的采访才知道他是一个多么和蔼的人并不是电视剧中表现的那种争强好胜，也并没有那种愤世嫉俗。虽然他的功夫很强，但真正让我觉得他的伟大无法被超越的却是他的思想。没错，和想象中的不一样李小龙读的是哲学系。他的功夫中无处不蕴含着哲学思想。并没有说因为别人叫他东亚病夫，他就多么仇恨外国人，那只是拍电影，虽然那时美国的思想对他确实有很多歧视，但他在看待国家名族的这些问题上，早已超越时代了。直到今天很多人的思想都赶不上李小龙，比如现在很多人都对日本，美国怀有仇恨。什么打砸日本汽车，抵制这个抵制那个。他们始终没有超越国家的观念，没有更高的眼界，没看到我们同是地球人。而李小龙则并没有给自己贴上一个国家的标签，他所看见的是we are human.\n","categories":["think"],"tags":["思绪"]},{"title":"convert-md-to-pdf","url":"/2022/11/13/convert-md-to-pdf/","content":"CONVERT MARKDOWN TO PDFToday, i want to upload a video to bilibili for recording a problem recently met: i cannot typing Chinese in terminal, but browser is fine.\nSo i need a PPT to show some information, but how to do that? I remember vim can do the thing, but for a long time searching, i find no way to realize that.\nThen i remember Luke used pandoc to convert markdown file to pdf, and it is perfect. So i tried to use pandoc to convert, but it shows an error: lack of pdflatex engine.\nI use pacman -Si pandoc to find the missing software: texlive-core. After installing, use the command to convert.\npandoc myfile.md -t beamer -o myfile.pdf\n\nBut it shows cannot display Chinese……\nFine, i give up. But i tried some other English markdown file, it works perfect.\n\nThe way i use vim to display information\nFinally i choose using vim directly to show text, after zooming text size, i find the status bar in the bottom looks awful, i wonder whether there is a way to hide the status line. And there really is a command to hide it\n:set laststatus=0\n\nTo turn it back with\n:set laststatus=2\n\nAwesome!\n","categories":["linux"],"tags":["convert"]},{"title":"clean-html-tag-in-csv-with-vim","url":"/2022/11/22/clean-html-tag-in-csv-with-vim/","content":"CLEAN HTML TAG IN CSV WITH VIMToday, one people ask me whether azure devops platform can export csv file with clean plain text. Because one column in csv fulls of html tags. However there is no such a function.\nI know there are some other methods, such as write a python script. But it is not easy to build a python environment especially in company. And it is really too complicated, if we use vim to clean those tags, that’s really simple.\nThere are some tags we need to clean:\n\nclean end of tag such as &lt;/div&gt;\nclean all info in &lt;&gt;, such as &lt;span ...&gt; &lt;a herf=&quot;...&quot;&gt;\n\n:%s/&lt;\\/\\a*&gt;//g:%s/&lt;\\a.\\&#123;-&#125;&gt;//g\n\n\nTips:There is a little trick, when we match any content in &lt;&gt;, we need to use none greedyregex, we know in standard regex, we can use ? to specify. But in vim, we need touse \\&#123;-&#125;, which means match previous atom 0 or more times as less as can.\n\nAnd there is another needs: if the content in one cell can be in multi lines, that will much better. And in origin html, a &lt;br&gt; tag means line break. So the problem becomes how to replace &lt;br&gt; tag to a new line symbol in vim.\nAfter searching, i find the way to type line break symbol in vim, that is typing ctrl+v ctrl+m in insert mode, then it will display a line break symbol, when we open the csv file in other excel programs, it will shows multi lines in one cell.\nBut, it is really hard for other people to type those commands, so i figure out the way, using vim’s autocmd. The user only needs to use vim to open the file, then type :wq, everything will be done.\nSo in ~/.vimrc or other place of vim configuration, write those:\naugroup formatcsv\tautocmd !\tautocmd BufRead *.csv :%s/&lt;br&gt;/(press ctrl+v ctrl+m)/g\tautocmd BufRead *.csv :%s/&lt;\\/\\a*&gt;//g\tautocmd BufRead *.csv :%s/&lt;\\a.\\&#123;-&#125;&gt;//gaugroup end\n\n\nNotices: (press ctrl+v ctrl+m) means the really key pressing, because markdown cannot shows the line break symbol, so i use this method to explain.\n\n","categories":["vim"],"tags":["autocmd"]},{"title":"archlinux","url":"/2022/04/23/archlinux/","content":"archlinuxThis document includes all the knowledges of using archlinux, from basic installing to daily using, all in one.\n[TOC]\nbase system installfirst of all, we need to install the system. take it ease, step by  step, and you can own it.\nadjust console fontmay be the default console font is too small, we can change it temporarily and make it much bigger.\ncd /usr/share/kbd/consolefontssetfont iso01-12x22.psfu.gz\n\nconnect network\nif plug in the cabel, use dhcpcd to get a ip address.\n\nif use wireless, use iwctl to config the netwrok\n# the iwd.server is running by defaultiwctl# list network interfacedevice list# start scaning networkstation device scan# show scan resultstation device get-networks# connect to one wifistation device connect ssid# get dynamic ip addressdhcpcd\n\nchange mirror listmodify /etc/pacman.d/mirrorlist file, move China mirror list to the head.\n\nnote: this configure will sync to new installed system.\n\nhead /etc/pacman.d/mirrorlist## ChinaServer = http://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$archServer = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$archServer = http://mirrors.ustc.edu.cn/archlinux/$repo/os/$archServer = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$archServer = http://mirrors.163.com/archlinux/$repo/os/$archServer = http://mirrors.bfsu.edu.cn/archlinux/$repo/os/$archServer = https://mirrors.bfsu.edu.cn/archlinux/$repo/os/$arch\n\nupdate system clockenable ntp to ensure the system clock is accurate.\ntimedatectl set-ntp true\n\npartition diskwe can use tools like cfdisk ,parted to parted disk. whatever tool we choose, there are some things need to be done the same.\n\nformat entire disk with gpt table\none efi partition to install grub\n\n\nnote: efi partition cannot used as lvm part, lvm can only be recognized after grub loading.\n\nlvm example: \n\nesp: 100M\nroot(lvm): 30G\nhome(lvm):  last space\n\nparted /dev/nvme0n1 mktable gptparted /dev/nvme0n1 mkpart fat 0% 100Mibparted /dev/nvme0n1 mkpart ext4 100Mib 100%pvcreate /dev/nvme0n1p2vgcreate linux /dev/nvme0n1p2lvcreate -L 30G linux -n root lvcreate -l +100%FREE linux -n homemkfs.fat -F 32 /dev/nvme0n1p1mkfs.ext4 /dev/linux/rootmkfs.ext4 /dev/linux/home\n\nmount partition and install system# mount root and home partitionmount /dev/linux/root /mntmkdir /mnt/home &amp;&amp; mount /dev/linux/home /mnt/home# chroot mnt and install base systempacstrap /mnt base linux linux-firmware lvm2 vim\n\ngenerate mount configure\nnote: efi partition not need to be mount.\n\ngenfstab -U /mnt &gt;&gt; /mnt/etc/fstab\n\nchroot new systemarch-chroot /mnt\n\ntimezoneln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtimehwclock --systohc\n\nsystem languageuncomment /etc/locale.gen  with en_us.UTF-8 and zh_CN.UTF-8 then run\nlocale-gen# set default system languageecho &quot;LANG=en_US.UTF-8&quot; &gt; /etc/locale.conf\n\nnetwork# add hostnameecho &quot;notebook&quot; &gt; /etc/hostname# add hostsecho &quot;127.0.0.1    localhost::1        localhost127.0.1.1    hostname.localdomain    hostname&quot; &gt;&gt; /etc/hosts\n\ninitramfs\nnote: if we don’t use lvm, this step can be ignored.\n\nedit /etc/mkinitcpio.conf, add lvm2 between block and filesystems\nmkinitcpio -P\n\ninstall netwrok toolwe can choose iwd or netctl to configure network\n\niwd\n\npacman -S iwd dhcpcdsystemctl enable iwd\n\n\nnetctl\n\npacman -S netctl wpa_supplicant dialog  dhcpcd\n\ninstall grubfirst mount efi partition to /boot/efi\nmkdir /boot/efimount /dev/nvme0n1p1 /boot/efipacman -S grub efibootmgrgrub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=GRUB --removablegrub-mkconfig -o /boot/grub/grub.cfg\n\nset root passwdpasswd root\n\numount and rebootexit and umount -R /mntreboot\n\ngeneral configurethe step below is general configure, that is to say it’s basic and cannot be ignored.\nconnect network\nwe can use iwd to set wifi connection, only need using dhcpcd to get a dynamic ip address\nstatic ip\ncreate a config file  /etc/iwd/main.conf to enable static network config by adding\ncat /etc/iwd/main.conf[General]EnableNetworkConfiguration=true\n\nadd static ip address config to wifi_name.psk file under /var/lib/iwd\ncat &gt;&gt; /var/lib/iwd/qiyue.psk[IPv4]Address=192.168.31.31Netmask=255.255.255.0Gateway=192.168.31.1\nif we use netctl(wifi/ethernet), we can use a gui tool named wifi-menu to connect network\nsudo wifi-menu\n\nwhen we connect correct there will be a configure file in /etc/netctl, in order to auto connect network, we need enable it.\ncd /etc/netctl# it must be file name not localtion path and without super priviledgenetctl enable confirure_file_name\n\nstatic ip\nsudo cp /etc/netctl/examples/wireless-wpa-static /etc/netctlDescription=&#x27;A simple WPA encrypted wireless connection using a static IP&#x27;Interface=wlo1Connection=wirelessSecurity=wpaESSID=&#x27;wifi-essid&#x27; # modifyKey=&#x27;password&#x27; # modifyIP=staticAddress=&#x27;192.168.0.104/24&#x27; # modifyGateway=&#x27;192.168.0.1&#x27;    # modifyDNS=(&#x27;114.114.114.114&#x27;) # modify\n\nsome command of netctl\nnetctl disable wireless-wpa-static-oldnetctl enable wireless-wpa-staticnetctl restart wireless-wpa-static\n\ninstall some softwareif there comes some error message shows cannot find package, we need to config China repository first.\n\nman page\npacman -S man-db man-pages texinfo\nbase-devel\nit includes sudo, gcc, make, sed, grep, which and etc usual command\npacman -S base-devel\ninstall doas or sudo\npacman -S sudopacman -S doas\n\nthen create a file /etc/doas.conf and write something to it\necho &quot;permit nopass :wheel&quot; &gt; /etc/doas.conf\nxmonad window manager\nxmonad window manager uses xterm by default.\npacman -S xmonad xmonad-contrib xmobar xterm\npoybar\ni use it with xmonad as default status bar\npacman -S polybar\ninput method\ninstall all of packages of fcitx5-im, fcitx5-material-color is the skin which really likes windows 10\npacman -S fcitx5-im fcitx5-material-color fcitx5-rime\ntransparent tools\ntransset-df can transparent the xterm\nyay -S transset-df\nanimate action\npicom has some good effect like fade in fade out and etc. and aur’s picom-jonaburg-git has motion effect\nyay -S picom-jonaburg-git\n\n\n\npackage search tool\nwe can use dmenu or rofi, i use dmenu much more, but rofi can help me to find how many applications i have ever installed and which one should i launch once a time forgot its name with some keywords.\npacman -S dmenu rofi\nfont\nproper font will make some software works well like xterm and polybar\n# the font can show icons in terminal, and font for vscode# Cascadia and Firacode become my favorite fonts now, even use it as system application fontpacman -S nerd-fonts-iosevka nerd-fonts-fira-code nerd-fonts-cascadia-code# the two fonts can show chinese and korean proper in polybarpacman -S adobe-source-han-sans-cn-fonts adobe-source-han-sans-kr-fonts \nnotify tool\nit can show notify message in desktop with highly configurable.\npacman -S dunst\nclip tool\nit is a clip tool with great useage, such as clip standard output, one file even though an image\npacman -S xclip\nyoudao dictionary\ni have wrote a shell translate copy sentense which depends on this\npacman -S ydcv-rs-git\nscreenshot\nuseful screenshot tool\npacman -S flameshot\nfile manager\nw3m is a plug in to show photo\npacman -S ranger w3m\ndownload tool\npacman -S wget curl\naudio and video player\npacman -S mpg123 mplayer\nperformance monitor\npacman -S glances htop neofetch# htim is a replace of htop with vim typle keybing, after install it, type htop as usualyay -S htim\nbrowser\npacman -S firefox\nwriter\n# use marktext-git instead of typora, since typora is not open sourcepacman -S marktext-git\ncode\npacman -S visual-studio-code-bin\nscreen capture\npacman -S obs-studio\nsql client tool\npacman -S dbeaver\nstickypad\npacman -S xpad\nchat\npacman -S skypeforlinux-stable-bin\ngui dialog tool\npacman -S yad\nsimulate\npacman -S xdotool\ncli music player \npacman -S cmus\nchinese date\npacman -S cdate\ncpu information\npacman -S cpufetch\nimage viewer\npacman -S gthumb\nwire sniff tool\npacman -S wireshark\nfake like hackers tool\ncmatrix no-more-secrets-git\nanalysis disk usage\npacman -S ncdu\n\nadd userinstall zsh shell first\nsudo pacman -S zsh oh-my-zsh-git\n\nadd user with wheel group and zsh as default shell\nuseradd -m -G wheel -s /bin/zsh username\n\nset passwd\npasswd username\n\nthen adjust priviledges, such as sudo priviledge, run command without password\n# uncomment below in /etc/sudoers%wheel ALL=(ALL) ALL%wheel ALL=(ALL) NOPASSWD: ALL\n\ninstall xorgpacman -S xorg\n\nin order to use startx to login to gui, we need to install xorg-xinit\npacman -S xorg-xinit\n\nvideothere comes three choice: \n\nintel with video card integrated\nnvidia indepedent\namd video driver\n\nif we use intel video card, we need to install intel drive\npacman -S xf86-video-intel# install package to adjust screen backlight, only intel workspacman -S xorg-xbacklight# we can also adjust screen backlight by hand, only intel worksvim /sys/class/backlight/intel_backlight\n\nif we use nvidia video card, we need to install nvidia drive\npacman -S nvidia\n\namd gpu\npacman -S xf86-video-amdgpu\n\naudiosudo pacman -S pulseaudio pulseaudio-alsa pamixer\n\nwhen we installed those software, we can also not get voice, because it is mute by default. so we need enable it\npamixer --unmute\n\npersonal configurewhy it is personal? because there are too many choice for user to choose, and i myself use the system serveral years and have wrote a shell script to copy the old configure file to the system without configure it step by step. so i will describe it in two part.\n\none is auto config\nanother is step by step\n\nauto config all my backup file locate in ~/Data/linux, so i need to copy old data to new machine. there are several ways to do the thing, such as a usb drive, use scp, startup a ftp in old machine…\nand find a script named filesync in linux/.local/bin which we copied from old machine. and run:\n./filesync install\n\n most of things will be done automaticly.\nstep by stepthe section below will show you how to config system step by step.\ninstall AUR package installerusing yay or paru we can download software in AUR. and suggest use paru, because it can search both pacman and aur at the same time.\npacman -S paru# pacman -S yay\n\nadd China repositorypacman repository\nwrite info to /etc/pacman.conf\n[archlinuxcn]Server = https://mirrors.aliyun.com/archlinuxcn/$arch\n\nthen refresh the database\npacman -Sy\n\nwe don’t need to install chinese keyring right now, just install it while there is a message shows we need to import some keyring.\npacman -S archlinuxcn-keyring\n\naur repository\n# if use yay to download aur packageyay --aururl &quot;https://aur.tuna.tsinghua.edu.cn&quot; --save\n\nthis will create yay config in ~/.config/yay/config.json\n# can check config with commandsyay -P -g\n\ndefault location configwhen we use xorg, there is a way to config where the data to be stored. even though not all the software follow the rules, but it is much better than no.\nadded to ~/.pam_environment\n# environment variable to set xdg base directoryXDG_CONFIG_HOME=/home/blueocean/.configXDG_CACHE_HOME=/home/blueocean/.cacheXDG_DATA_HOME=/home/blueocean/.local/shareXDG_DATA_DIRS=/usr/local/share:/usr/shareXDG_CONFIG_DIRS=/etc/xdg\n\nfcitx5 configurein order to make fcitx5 works well, there are several variable to be configed in ~/.pam_environment\n# environment variable for fcitx5INPUT_METHOD  DEFAULT=fcitx5GTK_IM_MODULE DEFAULT=fcitx5QT_IM_MODULE  DEFAULT=fcitx5XMODIFIERS    DEFAULT=\\@im=fcitx5\n\nadd startup command to ~/.xinitrc file :fcitx5 &amp; \nshort keys: ctrl +alt +h  :enable/disable completion\nif not simple chinese, use “ctrl+`” to change\nxmonad configcopy configure file xmonad.hs  to ~/.xmonad/\nthen compile it:\nxmonad --recompile\n\nwrite start xmonad command to ~/.xinitrc\n# if home directory has no .xinitrc then copy [ ! -f ~/.xinitrc ] &amp;&amp; cp /etc/X11/xinit/xinitrc ~/.xinitrc# write to the end of the fileexec xmonad    \n\npolybar configif there has no configure file, we can download configure from website\n[ ! -f ~/.config/polybar/config ] &amp;&amp; touch ~/.config/polybar/config\n\nadd start command in ~/.xinitrc\nsh ~/.config/polybar/launch.sh\n\ndisable touchpadif we have a touchpad and don’t wanna use, we can disable it\nfirst of all, install the command:\npacman -S xorg-xinput\n\nadd below to ~/.xinitrc to disable it\nxinput | grep Touchpad | grep -E &#x27;=[0-9]&#123;2&#125;&#x27; -o | grep -E &#x27;[0-9]&#123;2&#125;&#x27; -o | xargs xinput disable\n\ncursor stylemake sure xsetroot tools has been installed\npacman -S xorg-xsetroot\n\nwrite below to ~/.xinitrc\nxsetroot -cursor_name left_ptr\n\nwindow effectmake sure picom has been installed, then write below to ~/.xinitrc\npicom  --experimental-backends --config .config/picom/picom.conf -b\n\nxterm transparentmake sure transset-df has been installed, then write below to ~/.zshrc. we can change transparent with -m parameter.\n[ -n &quot;$XTERM_VERSION&quot; ] &amp;&amp; transset-df -m 0.95 --id &quot;$WINDOWID&quot; --dec 0.1 &gt;/dev/null\n\nntfs file system recognizein order to recognize windows file system, the tool need to be installed. and without it we cannot modify windows file by normal user.\npacman -S ntfs-3g# mount examplemount -t ntfs-3g /dev/sdaX /mnt\n\nhome directorywith xdg-user-dirs add “well known” user directories in /home/user\npacman -S xdg-user-dirs\n\nthen run xdg-user-dirs-update to product\nxdg-user-dirs-update\n\nfat partition recognizein order to mount fat partition or use mkfs.fat format a disk, we need to install dosfstools first.\npacman -S dosfstools\n\nother settingssome configure which seems not very important.\ngrub theme\ngnome look or pacman\n   download from the web site or install by pacman and mv to /boot/grub/theme directory\nunzip arch-silence-master.zip                    mv arch-silence-master /boot/grub/theme/    \n\n   now tell grub use the new theme, modify /etc/default/grub    \nGRUB_THEME=&quot;/boot/grub/themes/arch-silence-master/theme/theme.txt&quot;\n\n   rebuild grub.cfg\ngrub-mkcofig -o /boot/grub/grub.cfg\ngit hub\n   download from website, unzip and change directory to it and run\nsudo ./install.sh -b -t tela\n\n   \n   uninstall run sudo ./install.sh -r -t tela\n\n\nshow boot messagein default the boot message is hidden, we can make it showing again.modify /etc/default/grub, remove quiet flag\nGRUB_CMDLINE_LINUX_DEFAULT=&quot;loglevel=3&quot;\n\nrebuild grub.cfg\ngrub-mkconfig -o /boot/grub/grub.cfg\n\ncoloize pacmanin default the search result of pacman has no colors, we can change it. modify /etc/pacman.conf, uncomment color\ncolorlsit is a colorized ls command which can show icons (make sure u have patched font with graph support. such as nerd-fonts-iosevka)\n# it is writed in rubepacman -S ruby# then use gem which ruby package manager install colorlsgem install colorls# follow install output config environment. such as add to .zshrcsource $(dirname $(gem which colorls))/tab_complete.sh# add path to /etc/profileappend_path &#x27;/home/blueocean/.local/share/gem/ruby/2.7.0/bin&#x27;\n\nalias ls to colorls\n# in .zshrcalias ls=&quot;colorls&quot;# make effectsource /etc/profilesource ~/.zshrc\n\n\nif ruby upgrades, run gem install colorls to upgrade colorls also.\nbluetoothinstall base package\nuse bluetooth to connect device. intall package first\npacman -S bluez\n\nprovide cli tool\npacman -S bluez-utils\n\nprovide sounds for bluetooth\npacman -S pulseaudio-bluetooth\n\nadd user to lp group\nit is needed to add user to lp group\nusermod -a -G lp `whoami`\n\nstart bluetooth\ncheck whether or not driver has been launched\nlsmod | grep btusb\n\nif not launched by hand\nmodprobe btusb\n\nlaunch service, a reboot needed\nsystemctl enable bluetooth.servicesystemctl start bluetooth.service\n\n\nnote: we need enable bluetooth to start up automaticly, otherwise there will be a error msg of failed\n\nconnect devices the first time\nbluetoothctlagent KeyboardOnlydefault-agentpower onscan onpair xxxxconnect xxxx\n\na paired device can be connect directory\n# show paired devicesdevices# then connectconnect xxxx\n\nadjust video fan speedmake sure nvidia-settings has been installed already.\n# enable fan speed adjustnvidia-xconfig --cool-bits=4# then add below to ~/.xinitrc, replace n with the fan speed percentage. such as 10nvidia-settings -a &quot;[gpu:0]/GPUFanControlState=1&quot; -a &quot;[fan:0]/GPUTargetFanSpeed=n&quot;\n\ncursor themefull document can visit arch wiki page.\nthe default cursor theme is bad, i need to change it. before start up, i need to make it clearly there are 3 part should be changed\n\nxdg settting for X11\ngtk theme setting\nterminal setting\n\nfirst download cursor theme you liked in this website\nxdg setting\n# create ~/.icons foldermkdir ~/.icons# extract theme folder to ~/.iconstar -xzf theme.tar.gz -C ~/.icons# create theme configure filemkdir ~/.icons/defaulttouch ~/.icons/default/index.themeecho &quot;[icon theme]Inherits=oreo_spark_blue_cursors&quot; &gt; ~/.icons/default/index.theme\n\ngtk setting\n# create theme config filetouch ~/.config/gtk-3.0/settings.iniecho &quot;[Settings]gtk-cursor-theme-name=oreo_spark_blue_cursors&quot; &gt; ~/.config/gtk-3.0/settings.ini# polybar use gtk-2.0, so we need copy above setting to gtk2 foldercp ~/.config/gtk-3.0/settings.ini ~/.config/gtk-2.0/settings.ini\n\nterminal setting\n# write this in ~/.XresourcesXcursor.theme: oreo_spark_blue_cursorsXcursor.size: 16\n\nmake it effect\nxrdb ~/.Xresources\n\nthen relogin desktop\ngtk application theme and icon themeit is a long time for google, and cannot find how to set system application theme and icon theme. finally i get it.\nFirst, we need to know there are two different frames in our application:\n\nGTK style\nQT style\n\nit depends on what kind of language the application to be wrote. not depends on our theme chooseing.\nSecond, we need to know there are there kind of themes we can download:\n\napplication theme. the frame of application which stores in ~/.themes or /usr/share/themes\nicon theme, the icon of application which stores in ~/.icons or /usr/share/icons\ncursor theme, cursor style which stores in ~/.icons or /usr/share/icons\n\nI follow wiki page to configure themes:\n\ndownload theme from this website\n\nthen extract gtk theme in~/.themes. \nextract icon theme in ~/.icons\ntar -xJf Downloads/WhiteSur-light.tar.xz -C ~/.themes\n\ntar -xJf 01-WhiteSur.tar.xz -C ~/.icons\nedit two files\n\nNote:\ni find a more beautiful font rather than Cantarell\nuse CaskaydiaCove Nerd Font 10 instead of Cantarell 11\n\ngtk2 application need to edit file /usr/share/gtk-2.0/gtkrc or .config/gtk-2.0/gtkrc\ncat /usr/share/gtk-2.0/gtkrc gtk-icon-theme-name = &quot;WhiteSur-light&quot;gtk-theme-name = &quot;WhiteSur-light&quot;gtk-font-name = &quot;Cantarell 11&quot;\n\ngtk3 application can edit /usr/share/gtk-3.0/settings.ini or .config/gtk-3.0/settings.ini\ncat ~/.config/gtk-3.0/settings.ini [Settings]gtk-cursor-theme-name = oreo_spark_blue_cursorsgtk-icon-theme-name = WhiteSur-lightgtk-theme-name = WhiteSur-lightgtk-font-name = Cantarell 11\n\nthen relogin desktop, most of applications will show specified theme correctly. however some of applications such as vbox still the same as before shows like this:\n\nand at last i find that it is because the application writes by QT, so we cannot apply GTK theme to it. and i find the fixed method: make QT application use GTK theme in this page\n# write this to ~/.xinitrc if i use window managerexport DESKTOP_SESSION=gnome\n\nrelogin desktop, and then the virtualbox shows correct themes, it is really amazing!\n\nonly for one specified app\nabove setting will change all app theme, however we can define some app with specified theme.\n# go to this foldercd /usr/share/applications# find which app should be changevim leafpad.desktop# find Exec lineExec=leafpad %F# change it to specified themeExec=env GTK_THEME=WhiteSur-light:light leafpad %F\n\nrestart app, theme will make effect. but it seems that it’s only make effect if we have no theme setting by default.\nfont settingat first, we need to know the category of fonts.\n\nbitmap: often used in system console\nlatin script:\nserif: shows great in large font, no good in small font. often used in title and printing.\nsans-serif: shows great in small font and web page.\nmonospace: often used in coding.\nfamily: include above there fonts.\n\n\nnon-latin script: chinese/japanese and others\nemoji and symbols\nmath\nother operating system fonts\n\nso in a GUI operation system, we often use latin for english and non-latin for chinese. emoji and math is optional. notice that console can use bitmap only.\n\nuser font can be set in ~/.local/share/fonts\nthen use fc-cache to build font cache.\n\nin order to configure font manually, we need two step:\n\n make effect of user setting\n\n   mkdir ~/.config/fontconfig/conf.dln -s /usr/share/fontconfig/conf.avail/50-user.conf ~/.config/fontconfig/conf.d\n\n\nmanually font setting\ntouch ~/.config/fontconfig/fonts.conf\n\n&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE fontconfig SYSTEM &quot;fonts.dtd&quot;&gt;&lt;fontconfig&gt;    &lt;match target=&quot;font&quot;&gt;        &lt;edit name=&quot;autohint&quot; mode=&quot;assign&quot;&gt; &lt;bool&gt;false&lt;/bool&gt; &lt;/edit&gt;        &lt;edit name=&quot;antialias&quot; mode=&quot;assign&quot;&gt; &lt;bool&gt;true&lt;/bool&gt; &lt;/edit&gt;        &lt;edit name=&quot;hinting&quot; mode=&quot;assign&quot;&gt; &lt;bool&gt;true&lt;/bool&gt; &lt;/edit&gt;        &lt;edit name=&quot;hintstyle&quot; mode=&quot;assign&quot;&gt; &lt;const&gt;hintslight&lt;/const&gt; &lt;/edit&gt;        &lt;edit name=&quot;rgba&quot; mode=&quot;assign&quot;&gt; &lt;const&gt;rgb&lt;/const&gt; &lt;/edit&gt;        &lt;edit name=&quot;lcdfilter&quot; mode=&quot;assign&quot;&gt; &lt;const&gt;lcddefault&lt;/const&gt; &lt;/edit&gt;        &lt;edit name=&quot;embeddedbitmap&quot; mode=&quot;assign&quot;&gt; &lt;bool&gt;false&lt;/bool&gt; &lt;/edit&gt;    &lt;/match&gt;    &lt;!--fallback font order--&gt;    &lt;alias&gt;        &lt;family&gt;serif&lt;/family&gt;        &lt;prefer&gt;            &lt;family&gt;DejaVu Serif&lt;/family&gt;            &lt;family&gt;Source Han Sans CN&lt;/family&gt;        &lt;/prefer&gt;    &lt;/alias&gt;    &lt;alias&gt;        &lt;family&gt;sans-serif&lt;/family&gt;        &lt;prefer&gt;            &lt;family&gt;Inter&lt;/family&gt;            &lt;family&gt;Source Han Sans CN&lt;/family&gt;        &lt;/prefer&gt;    &lt;/alias&gt;    &lt;alias&gt;        &lt;family&gt;monospace&lt;/family&gt;        &lt;prefer&gt;            &lt;family&gt;Ubuntu&lt;/family&gt;            &lt;family&gt;Source Han Sans CN&lt;/family&gt;        &lt;/prefer&gt;    &lt;/alias&gt;&lt;/fontconfig&gt;\n\ni use DejaVu Serif for serif, Inter for sans-serif, Ubuntu for monospace. the same setting for firefox and it shows great.\nvirtual machinevirtualboxload kernel module\nbefore we can run virtual machine, we need load vboxdrv kernel module before\nmodprobe vboxdrv\n\nwhen we launch a virtualbox os with desktop environment, the most import thing is the size of window, for what the default size is to small.\nif we use windows we can directily click the top bar menu and choose install third extension, after finish, we can login windows and click install extension.\nscreen size with command\nhowever in linux, it is much complex, one method i find good enough is use command to specify to size without install extension and working fine.\n# first use cvt to product the screen size infocvt length width# second install xorg-xrandr and use it to set sizepacman -S xorg-xrandr# add the standout of cvt xrandr --newmode # add a new modexrandr --addmode Virtual-1 lengthxwidth_refreshrate# change screen sizexrandr --output Virtual-1 --mode lengthxwidth_refreshrate# for examplecvt 2550 1406xrandr --newmode &quot;2552x1406_60.00&quot;  302.75  2552 2736 3008 3464  1406 1409 1419 1458 -hsync +vsyncxrandr --addmode Virtual-1 2552x1406_60.00xrandr --output Virtual-1 --mode 2552x1406_60.00\n\nscreen size with iso file\nyeah, there comes another method which work most of the time i find in the website.The most important thing, do not use THE “GUEST  ADDITIONS CD” come along with the Oracle VirtualBox, which you usually  find in the menu “Devices” - “Insert Guest Additions CD Image”. But download the latest VBoxAdditions iso file from the official webpage, mount the image file in your virtual machine and then run the shell file “VBoxLinuxAdditions.run”:\nsudo sh  VBoxLinuxAdditions.run\n\nType in the password when prompted. Restart your virtual machine, then everything should work now.\nkvmI have used virtualbox so many years when i first heard of it, it is quiet simple, free and i like it very much. However today when i see DT’s video, he introduces virt-manager to manager virtual machine, i think i need try it. Because kvm is the kernel based virtual machine, its performance may improved a lot then virtualbox. At first we need to know some concept:\n\nkvm: kernel based virtual machine,  provide the ability to start virtual machine.\n\nqemu: machine emulator which can use kvm hypervisor or others. \n\nlibvirt: libs(network, storage and etc), daemon, command utility(virsh)\n\nvirt-manager: gui tool for easily build/manage virtual machine.\n\n\nat first, check whether support kvm\nLC_ALL=C lscpu | grep Virtualization\n\nif the output not empty, then we can install the needed tools\n# virt-manager includes libvirtpacman -S qemu virt-manager# other tool that libvirtd needpacman -S ebtables dnsmasq dmidecode\n\n\nNote: \n\nebtables and dnsmasq is very important for virt-manager to manage/build host network bridge and dnsmasq in iptables, without them the network in virtual machine may be faild to connect.\n\ndmidecode used for showing host information in virt-manager.\n\nso,  in host machine iptables must be enabled and started for virt-manager to manage virtual machine network.\n\n\n\nthen enable and start libvirtd daemon\nsystemctl enable --now libvirtd\n\nafter start up, we need add our user to libvirt group. \n\n Note: without this step, there may be some auth errors.\n\nusermod -a -G libvirt [user_name]\n\nfinally, we can launch virt-manager to build/manage virtual machine.\nadd new image location\nthe default image location is /var/lib/libvirt/images, we can add a new storage location via virt-manager\n\nconvert virtualbox images to kvm images\n# for example convert archlinux.vdi to archlinux# er, i convert serveral images from vdi to qcow2 and all of them faild in find disk with UUIDqemu-img convert -f vdi -O qcow2 archlinux.vdi ~/Public/kvm/images/archlinux\n\nadd uefi support\ninstall edk2-ovmf to support uefi\npacman -S edk2-ovmf# then restart libvertdsystemctl restart libvertd\n\nget mouse back from virt-manager\nuse left ctrl + left alt to release focus in virt-manager. or left ctrl + left alt + g when use GTK fronted of qemu.\nsome important virsh command\nvirsh is libvirt’s command line tool, include commands which can operate the virtual machine instead of virt-manager, however it is much complex.\nvirtual machine is called domain in libvirt\n# list all running machines/domains (include id/domain-name)sudo virsh list# list all machines/domainssudo virsh list --all# list all networkssudo virsh net-list# list all pools/images storage positionsudo virsh pool-list# list all volumes/imagessudo virsh vol-list [pool-name]# list domain/machine infosudo virsh dominfo [domain-name/id]# list domain/machine ipaddresssudo virsh domifaddr [domain-name/id]# start/shutdown/suspend domain/machinesudo virsh start/shutdown/suspend [domain-name/id]# start networksudo virsh net-start [network-name]\n\nuser comand line to start up a virtual machine\n# start up networksudo virsh net-listsudo virsh net-start [network-name]# start virtual machinesudo virsh list --allsudo virsh start [domain-name/id]# get virtual machine&#x27;s ip addresssudo virsh domifaddr [domain-name/id]# then use ssh to connect remote linux or rdesktop to connect windows\n\n\n\nfix cannot adjust resolution\nmost of time we start up a new virtual machine in virt-manager, the resolution cannot adjust correctly, the way to fix it is change virt-manager video model.\nwe can change QXL to Virtio or VGA\nshare folder\nfor example make host’s Desktop folder as a share folder, we need to change Desktop folder’s permistion to 777\nchmod 777 ~/Desktop\n\nin virt-manager create a new file filesystem and mount to /mnt for example\nin virtual machine use command to mount the new share folder\n# for example mount share folder to Desktopmount -t 9p -o trans=virtio /mnt Desktop\n\nuse qemu command to create/start virtual machine with GUI\nshortcut:\n\nfullscreen: ctrl+alt+f\nmenu: ctrl+alt+m\ngrab mouse: ctrl+alt+g (effect only when menu bar shows)\n\n# create a file block to install virtual machineqemu-img create -f qcow2 [virtual-name] [disk-size]# eg:qemu-img create -f qcow2 android.img 10G# install OS to file blockqemu-system-x86_64 -enable-kvm -cdrom android.iso -drive file=./android.img # start virtual machine# cpu: host has the best performance# smp: cpu thread# m: memory# vga: video method# soundhw: sound device# eg:qemu-system-x86_64 -enable-kvm -drive file=./android.img -cpu host -smp 4 -m 4G -vga virtio -display sdl,ql=on -soundhw=hdaqemu-system-x86_64 -enable-kvm -drive file=win11.qcow2 -cpu host -smp 4 -m 4G -vga virtio -display gtk,gl=on,full-screen=on -soundhw hda\n\n\n\n\n\nconnect remote windowswindows remote desktop via udp/3389, so if i wanna to connect to windows in linux machine, i need to install a client with the ability to connect windows supported protocol. there are a lot of tools, but i choose the rdesktop, since it is a simple command line tool.\npacman -S rdesktop\n\n# better randerrdesktop -g 100% -r sound:local -x l -M -K  -P -z 192.168.122.157:3389\n\n\n-g 100%: automatically scale the geometry to fit screen.\n\n-r sound:local: redirect remote machine sound to local.\n\n-M: use linux system’s mouse instead of remote machine’s mouse.\n\n-K: use linux window manager instead of remote machine’s window manager.\n\n-x l: rander remote desktop’s wallpaper, window motion. \n\n-P: enable bitmap cache to disk to improve performance.\n\n-z: enable compress rdp datastream.\n\n192.168.122.157:3389: remote mahine’s ip and port.\n\n\n# low level randerrdesktop -g 100% -r sound:local -x m -M -K -P -z -b 192.168.122.157:3389\n\n\nNote: when use -P option, will create a directory  ~/.rdesktop/cache, in order to speed up the access time, we can mount this directory to memory.\n\n# nvim /etc/fstabtmpfs    /home/healer/.rdesktop/cache    tmpfs   rw,nodev,nosuid    0 0\n\nauto loginarchlinux use agetty to manage virtual console, we can use it to automatic login system without password. \nmkdir /etc/systemd/system/getty@tty1.service.dtouch /etc/systemd/system/getty@tty1.service.d/override.conf# change username with login user nameecho &quot;[Service]ExecStart=ExecStart=-/usr/bin/agetty --autologin username --noclear %I $TERM&quot; &gt; /etc/systemd/system/getty@tty1.service.d/override.conf\n\nrelogin system will make effect.\nif we also want to login desktop environment, we can do it like this.\necho &quot;if [[ ! $DISPLAY &amp;&amp; $XDG_VTNR -eq 1 ]]; then    exec startx &amp;&gt;/dev/nullfi&quot; &gt; ~/.zprofile\n\nconnect remote linuxin linux, there is no default remote service installed by default, so if we wanna to connect to remote linux with GUI interface, we need install a VNC server in remote linux and then install a VNC client in local machine to connect to remote.\nin remote\nthe easiest way is to install x11vnc\npacman -S x11vnc\n\nthen create a connection passwd\nx11vnc -storepasswd\n\nthe command above will create a passwd file in ~/.vnc/passwd by default.\nthen start vnc server\nx11vnc -display :0\n\nin local\nremmina is a common GUI tool that support lots of protocol\npacman -S remminapacman -S libvncserver\n\nauto suspendin order to save power while we don’t use computer with a specified time. we can use slock and xautolock\nsuspend with shortcut\n# write this in xmonad.hs and triger with shortcut((0 , xK_l), spawn &quot;slock &amp; systemctl suspend&quot;)\n\nauto suspend with specified time\nrun xautolock while system startup and auto sleep with specified time\n# write this in xmonad.hs which will run while login desktop (30 minites)spawnOnce &quot;xautolock -time 30 -locker &#x27;systemctl suspend&#x27; -detectsleep&quot;# or write this in .xinitrcxautolock -time 30 -locker &#x27;systemctl suspend&#x27; -detectsleep\n\ncache browser data to memoryinstall\n# install psdpacman -S  profile-sync-daemon# first run create configure file~ » psd                                                                                                                                                                                               ~   First time running psd so please edit /home/healer/.config/psd/psd.conf to your liking and run again.\n\nconfigure\n# enablesystemctl --user enable psd# configure overlay and browservim ~/.config/psd/psd.confUSE_OVERLAYFS=&quot;yes&quot;BROWSERS=(firefox)\n\ncache anything to RAMthe benefit of asd is that it can speed the access of some folder (not file) and makes the file to store in physical possible.\nsudo pacman -S anything-sync-daemon\n\nedit /etc/asd.conf\n# put the folder which i want to load to memoryWHATTOSYNC=(&#x27;/home/healer/.oh-my-zsh/his&#x27;)\n\n\nNote:\nby default .zsh_history stores in $HOME, but asd can only sync folders. And there is a way to set history to another folder: define HISTFILE variable before oh-my-zsh in ~/.zshrc\nHISTFILE=~/.oh-my-zsh/his/.zsh_historysource $ZSH/oh-my-zsh.sh\n\nat last enable asd service at boot time and start asd\nsudo systemctl enable --now asd\n\nscreen rotationuse xrandr described in wiki page\n# add a key binding in xmonad# output name can be find with xrandrxrandr --output HDMI-A-0 --rotate leftxrandr --output HDMI-A-0 --rotate normal\n\nfirefox adds-onsome useful adds-on\n\nburn dvdI have to say that the idea why i want to use dvd is because of one youtuber called DT, he has a video told why he uses dvd still today, and i thought it is a perfect idea.\nThe main reason i use dvd is that can store long times without information lose, and has a feeling of old life in such a fast society.\nthere are two things need to be noticed:\n\nnew blank DVD-R cannot be mounted, it needs to burn data first.\na toolset dvd+rw-tools contains the tool growisofs which can burn data to DVD-R.\n\n# install toolsetpacman -S dvd+rw-tools# insert new DVD-R to DVD burn machine# burn data to new DVD-Rgrowisofs -Z /dev/sr0 -R -J /some/files# append data to DVD-Rgrowisofs -M /dev/dvd -R -J /more/files\n\nafter burning data to DVD-R we can mount it\nmount /dev/sr0 /mnt\n\nemail receivingmutt is a linux CLI application of email client. although GUI mail applications such as MailSpring, BlueMail are very friendly use, but the size of GUI packages are much bigger than CLI applications.\nsudo pacman -S mutt\n\nmutt’s default configure can be set in ~/.config/mutt/muttrc\n# create local mail store loction and mutt configuration filemkdir ~/.local/share/Mail ~/.config/mutttouch ~/.config/mutt/muttrc\n\nmuttrc configuration \n# RECEIVING EMAIL SETTING (IMAP)# user and passwordset imap_user       = 1025096440@qq.comset imap_pass       = lcfqrejgdeggbcic# address of colud mailboxset folder          = imaps://1025096440@imap.qq.com/set spoolfile       = +INBOX# architure of cloud mailbox checkingmailboxes           = +INBOX +SENT# receiving of sending file local store positionset folder          = &quot;$HOME/.local/share/Mail&quot;; set record=&quot;+sent&quot;set imap_keepalive  = 300set mail_check      = 5set sort            = reverse-date# SENDING EMAIL SETTING (SMAP)# user name of sending fromset realname        = shutterbug# address and password of sending fromset from            = $imap_userset smtp_pass       = $imap_pass # cloud SMAP server addressset smtp_url        = smtps://1025096440@qq.com@smtp.qq.com# use ssl enforceset ssl_force_tls   = yes# style and editor defineset arrow_cursor#set folder_format=&quot;%2C %t %N %8s %d %f&quot;set sidebar_short_path  = yesset sidebar_width       = 22set sidebar_visible     = yesset sidebar_format      = &quot;%B%* %N/%S &quot;set index_format=&quot;%3C %-5Z %&#123;%b %d      &#125; %-25.20L (%?l?%4l&amp;%4c?) %s&quot;set editor          = vim# html render with w3mset mailcap_path    = $HOME/.config/mutt/mailcapauto_view text/htmlalternative_order text/plain text/html# key bindingbind pager j next-linebind pager k previous-linebind attach,index,pager \\CD next-pagebind attach,index,pager \\CU previous-pagebind pager g topbind pager G bottombind attach,index g first-entrybind attach,index G last-entrybind index,pager B sidebar-toggle-visible # color schemecolor hdrdefault blue blackcolor quoted blue blackcolor signature blue blackcolor attachment red blackcolor prompt brightmagenta blackcolor message brightred blackcolor error brightred blackcolor indicator red black color status brightgreen bluecolor tree blue blackcolor normal white blackcolor markers red blackcolor search white blackcolor tilde brightmagenta blackcolor index blue black ~Fcolor index red black &quot;~N|~O&quot;\n\nby default mutt cannot render html page, however we can use w3m to resolve it with the configuration file $HOME/.config/mutt/mailcap\ntext/html; w3m -I %&#123;charset&#125; -T text/html; copiousoutput;\n\nwe can type mutt to launch the email client use space key to open the content of email\nsending email is little difference\n# launch text editor to edit messagemutt -s &#x27;tile&#x27; user@email.com# or message from file contentmutt -s &quot;Subject&quot; somejoeorjane@someserver.com &lt; /var/log/somelog# or append some filemutt -s &quot;Subject&quot; somejoeorjane@someserver.com -a somefile &lt; /tmp/sometext.txt\n\n\nNote:\nchange sidebar folder press c, then press tab twice\n\nexternal monitor brightnesswhen i use a monitor display, i cannot adjust the brightness with xbacklight tool. today, i find the reason why i cannot adjust it in this website. simple to say, external monitor needs other tools to change brightness.\n# it need a kernel module to be loadedsudo modprobe i2c-dev# install a tool called ddcutilsudo pacman -S ddcutil# then find which feature can adjust the brightnesssudo ddcutil capabilities |grep -i brightness➜  acpi_video0 sudo ddcutil capabilities |grep -i brightness   Feature: 10 (Brightness)# i find it is 10, then i can adjust it# 10 is the feature numbersudo ddcutil setvcp 10 30# increase/decreasesudo ddcutil setvcp 10 + 5sudo ddcutil setvcp 10 - 5# and check itsudo ddcutil getvcp 10\n\nfinally i need the module to be loaded at boot time, we can add this feature as describe in this website. \nsudo touch /etc/modules-load.d/i2c-dev.confsudo echo i2c_dev &gt; /etc/modules-load.d/i2c-dev.conf\n\nchange ddcutil permission to let normal user can execute it\n# setuid can make normal user execute some file with the file&#x27;s owner permissionsudo chmod u+s /usr/bin/ddcutil\n\nthen add shortcut to xmonad\n((mod1Mask, xK_F6), spawn &quot;ddcutil setvcp 10 - 5&quot;)((mod1Mask, xK_F8), spawn &quot;ddcutil setvcp 10 + 5&quot;)\n\ncommand/software usagecommon command and software usage.\njournaljournal is the logging system of systemd. default log location in /var/log/journal. in default setting the size of log will increate until 10% of total disk.\n# we can change the default setting, unit Mibvim /etc/systemd/journald.confSystemMaxFiles=10\n\nwe can clean by hand\n# show disk usagejournalctl --disk-usage# clean # vacuum cannot remove active or unarchived file. and rotate can archive active file.journalctl --rotate --vacuum-size=1journalctl --rotate --vacuum-time=1\n\nformat convert\nnote:\n   utf-8 and gbk are both character encoding, and they are differect, we need to know utf-8 is much better than gbk, for utf-8 support more.\n\nif software cannot show text normally, we have two method to repair it.\n\nchange software setting to display normally if software has the ability\nchange file encoding to which software use with tools\n\nfor example:\nas we know windows file encode with gbk, and it cannot display normally in linux vim editor in default, we can add vim setting to support it\nvim ~/.vimrcset fileencodings=utf-8,gb18030,gbk\n\nanother method is change file encoding\niconv -f gbk -t utf-8 1.txt -o 2.txt\n\n\n-f from\n-t to\n-o output file\n\nqv2ray &amp; v2ray-core\nNote:\n\nbuy proxy, i buy though iGG. with iGG i can get scribe url\ninstall software to config scribe url\n\n\nbecause yay cannot download software from github, most time will failed to install some software. so need to install a software to proxy.\nQv2ray is a v2ray client gui tool for configing v2ray. and v2ray-core is the core of v2ray.\n\ndownload\ndownload qv2ray , i choose appimage, it can be run directory without install\ndownload v2ray-core, a 64bit zip file\n\nconfigure qv2ray\nfollow this website\n# create a app foldermkdir .local/apps/qv2ray# move appimage to qv2raymv Downloads/Qv2ray.v2.6.3.linux-x64.AppImage .local/apps/qv2ray# then run this appchmod u+x ./Qv2ray.v2.6.3.linux-x64.AppImage./Qv2ray.v2.6.3.linux-x64.AppImage# create v2ray-core foldermkdir .local/apps/qv2ray/vcore# unzip v2ray-core to new folderunzip Download/v2ray-linux-64.zip -d .local/apps/qv2ray/vcore# then configure in gui app\n\nchange file location and click “ok”\n\n\nand follow website to add scribe address, then we can use proxy to visit website\n\nthe way to allow yay(git) to proxy follow this website\n-- git# http httpsgit config --global http.proxy http://127.0.0.1:8889git config --global https.proxy https://127.0.0.1:8889# socks5git config --global http.proxy socks5://127.0.0.1:1089git config --global https.proxy socks5://127.0.0.1:1089\n\n– speed github\n\n\nconfigure http https proxy  git config –global http.https://github.com.proxy https://127.0.0.1:8889  git config –global https.https://github.com.proxy https://127.0.0.1:8889\nconfigure socks5 proxy, this is what yay used  git config –global http.https://github.com.proxy socks5://127.0.0.1:1089  git config –global https.https://github.com.proxy socks5://127.0.0.1:1089\nthe port we can find in gui configure![image-20210505014434826](.images/image-20210505014434826.png)- after configure, if i need to use yay, first choose a proxy and enable it, then use yay to download software, speed fast.![image-20210505015404595](.images/image-20210505015404595.png)- at last create a soft link to appimage```shellcd .local/binln -sf ~/.local/apps/qv2ray/Qv2ray.v2.7.0-pre2.linux-x64.AppImage v2ray\n\n# usage: such as reconnect last connectv2ray --reconnect\n\nterminal proxyabove v2ray setting can allow git / github /browser proxy, but terminal cannot. below will show how to proxy terminal.\nthe setting can work correctly depend on above v2ray work fine\nsudo pacman -S proxychains-ng \n\nmodify configure file\n# add this to file end#socks4         127.0.0.1 9050http    127.0.0.1 8889socks5  127.0.0.1 1089\n\nproxy terminal\nproxychains bash\n\n\n\ncronie notifyi use cronie to edit time task\npacman -S cronie\n\nin default, cronie use vi to edit task. we can change it vim\nEDITOR=vim crontab -e\n\nthere are some principles we need to follow:\n\nmessage cannot send to dbus directorily\ncrontab don’t know system variables, we need to announce it\nstdout not support pipline\ncannot recognize local command such as ~/.local/bin\n\nin order to use notify and sound we need announce variables either in script or crontab command\n## sound variable# check variable&#x27;s valueecho $XDG_RUNTIME_DIR# 1. write in scriptexport XDG_RUNTIME_DIR=/run/user/1000# 2. or announce in crontabenv XDG_RUNTIME_DIR=/run/user/1000## nofify# check variable&#x27;s valueecho $DBUS_SESSION_BUS_ADDRESS# 1. write in scriptexport DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus# 2. or announce in crontabenv DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus\n\nwe can write crontab like this:\n* * * * * env DBUS_SESSION_BUS_ADDRESS=unix:path=&quot;/run/user/1000/bus&quot; XDG_RUNTIME_DIR=&quot;/run/user/1000&quot; dunstify &quot;`~/.local/bin/filesync`&quot;\n\nhowever, there is a problem. if we send nothing, the dunst will also show a none notify. we can fix it by writing command in script, and then execute script\nfunction log()&#123;    exec 1&gt;&amp;4    if [ $# -gt 0 ];then        info=$@        echo &quot;[$(date &#x27;+%F %H:%M&#x27;)] :: $info&quot;        # send notify in script        dunstify &quot;[$(date &#x27;+%F %H:%M&#x27;)] :: $info&quot;    fi    exec 1&gt;/dev/null    unset info&#125;\n\nthen execute script with crontab\n* * * * * env DBUS_SESSION_BUS_ADDRESS=unix:path=&quot;/run/user/1000/bus&quot; XDG_RUNTIME_DIR=&quot;/run/user/1000&quot; ~/.local/bin/filesync\n\nonekooneko is a application that displays a cute cat chases cursor.\n# AUR installparu -S oneko# add to xmonad startup appspawnOnce &quot;oneko &amp;&quot;\n\ndowngrade applicationsometimes we want to use an old version application, we can use downgrade command to downgrade.\npacman -S downgrade# downgrade a softwaredowngrade app_name# then choose a number to downgrade\n\n使用shoadowsocks上google安装shadowsocks代理以及proxychains协议转换\nsudo pacman -S proxychains-ng shadowsocks\n\n修改proxychains配置文件\nsudo vim /etc/proxychains.conf#socks4         127.0.0.1 9050        #注释socks5  127.0.0.1 1080                #添加\n\n添加本地域名解析\nsudo vim /etc/hosts#添加104.31.74.55  youneed.win104.31.74.54  www.youneed.win\n\n添加脚本变量路径\nvim .xinitrcexport PATH=$PATH:~/.local/bin\n\n在~/.local/bin下建立软链接，指向脚本\ncd ~/.local/binln -s ~/Documents/script/shell/shadowshocks.sh sslink\n\n运行脚本启动代理\nproxychains firefox        #浏览器代理proxychains bash        #终端代理\n\n安装virtualbox#由于使用的是linux内核，所以选择virtualbox-host-modules-arch sudo pacman -S virtualbox virtualbox-host-modules-arch \n\n在启动虚拟机之前，需要加载模块\nmodprobe vboxdrv\n\n启动virtualbox的几种方式：\n1.GUI图形界面的启动，这也是大部分时候都在使用的方式，即运行virtualbox软件\n2.命令启动，即使用命令无界面启动。后来发现这种方式启动和xmonad很搭，因为不会存在热键冲突的问题，那么xmonad中的所有窗口操作的快捷键依然有效。\nvboxsdl --startvm &#x27;kali linux&#x27;        #由于系统名字中有空格，所以要使用引号\n\n3.同样是命令启动，但这种大多数时候是作为服务器使用的方式，即没有任何界面，只能通过ssh去连接主机（就像在windows中使用xshell一个意思）\nvboxheadless -s &#x27;kali linux&#x27;\n\n解决xorg问题自从安装系统之后就发现一个问题，那就是xorg每次启动都要花个20多秒。所以首先是查看日志\n#xorg的日志在家目录下vim .local/share/xorg/Xorg.0.log#然后查看EE报错的地方，发现每次都是在启动nouveau驱动的时候卡了20多秒，然后启动失败了#原因是我没有安装nouveau驱动，没有安装的原因就是安装之后启动倒是挺迅速的，但是退出xorg之后，或者想要关机的时候就会卡住。#我想为什么就不能让它不去检测这个驱动呢？终于google到了答案：就是强制让xorg使用intel显卡，而忽略n卡cd /etc/X11/xorg.conf.d/touch nonvidia.conf#添加如下代码：Section &quot;Device&quot;    Identifier  &quot;Intel Card&quot;    Driver      &quot;intel&quot;EndSectionSection &quot;Device&quot;    Identifier  &quot;Nvidia Card&quot;    Driver      &quot;nouveau&quot;EndSectionSection &quot;Screen&quot;    Identifier  &quot;My Screen&quot;    Device      &quot;Intel Card&quot;EndSection\n\n然后reboot，startx，果然一下子就打开了图形界面，虽然查看了一下日志，依然有报错，但是它直接跳过之后的等待以及检测了。以上介绍在wiki上也有讲，只是我不知道咋写啊。这也算是基本完成了系统安装以及之后的错误修复了吧！\n安装系统之后博客迁移安装必要软件\n#这些都要安装sudo pacman -S git nodejs npmsudo npm install -g hexo-clinpm install --save hexo-deployer-gitnpm audit fixnpm audit fix --forcenpm install hexo-generator-searchdb --save\n\n当然我又安装了这个加密插件，结果我错了\nnpm install --save hexo-blog-encrypt    #然后我哭了\n\n搞了半天老是报错，什么tostring不能为空，我的密码明明有啊，查看了一下js配置文件，发现确实有password.tostring()这个\n然后我用数字做密码试了一下不报错，但是我之前加密的文章全部没加密了？我觉得这是一个bug，至少前面应该做一下判断。所以去你的加密，索性不用了，然后一切都好了。\nssh-keygencat ~/.ssh/id_rsa.pub\n\n然后在github设置中将sshkey添加进去\n当然这后面还有两步，如果没有这两步，推送的时候会提示的\ngit config --global user.email &quot;2935549510@qq.com&quot;git config --global user.name &quot;narcissus&quot;\n\n再编译，推送\nhexo ghexo d\n\n与Android手机连接这里是使用了USB与手机连接\nsudo pacman -S android-file-transfer    #安装软件\n\n手机通过USB与电脑连接，同时开启MTP传输。\nsudo aft-mtp-mount /mnt                    #挂载\n\n然后就可以直接进入/mnt目录查看手机中的文件了\n\n更新key失败加入archlinuxcn源后，下载archlinuxcn-keyring时失败。\n# 删除gpg数据库rm -rf /etc/pacman.d/gunpg# 重新获取pacman-key --initpacman-key --populatepacman-key --refresh-keyspacman -Syu\n\n另外一个解决方法是通过调整时间，出问题的根本原因在于时间不一致，但是这次时间看似都正常，因此用第一种方法解决了\n# 查看系统时间date# 查看硬件时钟hwclock --show# 修改硬件时钟timedatectl set-time &quot;2019-11-24 09:56:00&quot;# 重新更新pacman -Syu\n\ndiscusssome problems i meet while installing the system.\ncannot find the grub info in biosthis time i installed system in msi, grub installation and configuration were right, but cannot find the grub in bios. \ni know the boot info was stored in NVRAM, so i find wheather it has the boot info with my archlinux.\nefibootmgr -v\n\n there has nothing info of my archlinux, so i added it by myself.\n# the efi partition is /dev/sda1 and efi installed in /boot/efi with directory /boot/efi/EFI/GRUB/grubx64.efiefibootmgr --create --disk /dev/sda --part 1 --loader /EFI/GRUB/grubx64.efi --label &quot;archlinux bootloader&quot; --verbose\n\nthen i checked weather it has the archlinux boot info, and got correct info\nefibootmgr -vBoot0006* archlinux bootloader  PciRoot(0x0)/Pci(0x17,0x0)/Sata(2,65535,0)/HD(1,GPT,fd816945-085d-4dca-aabc-734244e1ff5f,0x800,0x31800)/File(\\EFI\\BOOT\\BOOTX64.EFI)\n\nhowever when i reboot the system, there has nothing what i added before.\nat last i find the problem:\n\nthat’s why the info i added disappeard. so while installing the grub, i need add a removable parameter. and then the grub configure will rename to BOOTX and store in another directory where the UEFI firmware can recognize.\n# correctly commandgrub-install --efi-directory=/boot/efi --bootloader-id=GRUB --removable\n\n now the directory likes this:\n/boot/efi└── EFI    └── BOOT        └── BOOTX64.EFI\n\nthe grub configure  producted before can be removed or leave it alone since it will not be used.\nxterm or ranger cannot show iconssometimes while installing nerd-font and ranger plug-icons we may find terminal cannot show icons, and the problem was leaded by error system font  setting. we need to change whether the configure properly\n~ » cat /etc/locale.conf                                                                                                                                                                              ~  LANG=en_US.UTF-8\n\nxterm cannot show Chineseat first, checking whether we have setted the correct locale\n# make sure exist &quot;en_US.UTF-8&quot;locale -a# make sure have &quot;LANG=en_US.UTF-8&quot;cat /etc/locale.conf# if not run thisecho &quot;LANG=en_US.UTF-8&quot; &gt; /etc/locale.conf# or use localectllocalectl set-locale LANG=en_US.UTF-8\n\nif locale setting makes no effect, we need force xterm use utf8\n# add this to .XresourceXTerm*locale: falseXTerm*utf8: true\n\nrun xrdb .Xresource to make effect of changes \nAMD virtualize failedwhen use virtualbox to launch a virtual machine, there comes a error, it is leaded by disabled cpu virtual in bios which is in default.\nERROR MSG: AMD-V is disabled in the BIOS (or by the host OS) (VERR_SVM_DISABLED).\nFIX: enable svm mode\n\nyay install failed with strip binaryERROR: Cannot find the strip binary required for object file stripping.\nWHY: miss some application\nFIX: install base-devel\nmirror version errorERROR:  error while loading shared libraries: libicui18n.so.69\nWHY: version problem\nFIX: uncomment community mirror and run system update: pacman -Syu\npycharm error in xmonadif in windows environment, it works fine. but in xmonad, there comes a error: WARN - s.impl.EditorColorsManagerImpl - Cannot find scheme: Vibrant Ink from plugin: com.intellij.database.\nfixed by exporting a environment variable\nexport _JAVA_AWT_WM_NONREPARENTING=1\n\nin order to simply usage, write it with alias\nalias pycharm=&#x27;export _JAVA_AWT_WM_NONREPARENTING=1 &amp;&amp; ~/pycharm-2019.3.3/bin/pycharm.sh &amp;&gt;/dev/null &amp;&#x27;\n\nobs cannot record microphone soundthe default setting after installing obs-studio cannot record microphone. In a fact that it’s not the problem of obs, it is the error of system sound setting. The default system setting mutes the sound of microphone, we need install a software called pavucontrol to configure it.\ngui tool\n\npacman -S pavucontrol\n\nclick the icon to disable muting, then every thing works fine.\n\n\ncli tool\nanother method is install a cli tool, much light than gui tool.\n# installpacman -S pulsemixer# list all audio devicepulsemixer --list# find the mute one and unmute itpulsemixer --id &lt;source-2&gt; --unmute\n\ninvalid or corrupted package(pgp signature)after adding china mirror to pacman.conf and running update, package install will meet this problem\nerror: jansson: signature from &quot;Eli Schwartz &lt;eschwartz@archlinux.org&gt;&quot; is marginal trust:: File /var/cache/pacman/pkg/jansson-2.10-3-x86_64.pkg.tar.xz is corrupted (invalid or corrupted package (PGP signature)).\n\nmethod to resolve the problem\n# eg:pacman-key --list-sigs |rg &#x27;Eli&#x27;pacman-key --delete 91FFE0700E80619CEB73235CA88E23E377514E00pacman-key --populate archlinux\n","categories":["learn"],"tags":["archlinux"]},{"title":"cleanup-home-dir","url":"/2022/11/20/cleanup-home-dir/","content":"CLEANUP MY HOME DIRECTORYA long time ago, i realized my home directory has so many files and folders, and i want to cleanup them. But it will causes lots of problems, so i just let it go. Till i see luke talked about his home directory, i think i should do it this time.\nOne thing i should mention is that luke’s home directory even don’t have a standard Downloads Music Desktop, at first i think it is not good enough, cause without this, it is may hard for us to store and access such files. But later, my though changed, because i really don’t use this folder often and all those standard folders are capitalized, it just makes typing hard. So this time i will remove useless folder and lowercase them.\nFrom this page we can find the way to change some directories to other place. In a word, there are there ways:\n\nexport an environment variable then move file/directory to those location\nalias command which supports defining location via command line\nedit command’s configuration file which supports self defining location\n\nFor easily use, i combine those export variables in a file and source it in /etc/profile\n#add this command in the end of /etc/profilesource $HOME/.config/env\n\nthis is my env file content\n# environment variable for xdg base directoryexport XDG_CONFIG_HOME=$HOME/.configexport XDG_CACHE_HOME=$HOME/.cacheexport XDG_DATA_HOME=$HOME/.local/shareexport XDG_STATE_HOME=$HOME/.local/stateexport XDG_DATA_DIRS=/usr/local/share:/usr/shareexport XDG_CONFIG_DIRS=/etc/xdg# environment variable for fcitxexport GTK_IM_MODULE=fcitxexport QT_IM_MODULE=fcitxexport XMODIFIERS=@im=fcitx# xauthorityexport XAUTHORITY=&quot;$XDG_CONFIG_HOME&quot;/Xauthority# nugetexport NUGET_PACKAGES=&quot;$XDG_CACHE_HOME&quot;/NuGetPackages# bash_historyexport HISTFILE=&quot;$XDG_STATE_HOME&quot;/bash/history# rustexport RUSTUP_HOME=&quot;$XDG_DATA_HOME&quot;/rustup# stack#export STACK_ROOT=&quot;$XDG_DATA_HOME&quot;/stack# wgetexport WGETRC=&quot;$XDG_CONFIG_HOME/wgetrc&quot;# zshexport ZDOTDIR=&quot;$HOME&quot;/.config/zsh# default editorexport EDITOR=nvim# gnupgexport GNUPGHOME=&quot;$XDG_DATA_HOME&quot;/gnupg# make QT application(such as vbox) use GTK theme. Very useful!export DESKTOP_SESSION=gnome# set ghcup environmentexport GHCUP_USE_XDG_DIRS=&quot;$HOME&quot;/.local/share# openjdk JAVA_HOME=$HOME/.local/apps/jdk-15.0.1CLASSPATH=.:$JAVA_HOME/libGOLANG=&quot;$HOME/.local/apps/go/bin&quot;ROFI=&quot;$HOME/.config/rofi/scripts&quot;export PATH=$PATH:$JAVA_HOME/bin:$CLASSPATH:$GOLANG:$ROFI# rustexport RUSTUP_HOME=$HOME/.local/apps/rust/rustupexport CARGO_HOME=$HOME/.local/apps/rust/cargosource $HOME/.local/apps/rust/cargo/env\n\nSome alias\nalias vscodium=&quot;vscodium --extensions-dir $XDG_DATA_HOME/vscode/.vscode-oss/extensions&quot;alias wget=&quot;wget --hsts-file=$XDG_CACHE_HOME/wget-hsts&quot;alias yarn=&#x27;yarn --use-yarnrc &quot;$XDG_CONFIG_HOME/yarn/config&quot;&#x27;\n\n\ncause vscodium can startup with rofi, so we need to edit its mime file: /usr/share/applications/codium.desktop.change exec to Exec=/opt/vscodium-bin/bin/codium --no-sandbox --unity-launch --extensions-dir .local/share/vscode/.vscode-oss/extensions %F\n\nNow, my home directory likes this:\nPermissions Size User   Date Modified Namedrwx--x--x     - healer 20 Nov 14:12   .cachedrwx--x--x     - healer 20 Nov 20:30   .config.rw-r--r--    64 healer 20 Nov 10:50   .gitconfigdrwxr-xr-x     - healer 21 Jun 23:55   .iconsdrwxr-xr-x     - healer 23 Oct 11:01   .localdrwx--x--x     - healer  8 May 00:55   .mozilladrwx--x--x     - healer 23 Apr 23:38   .sshdrwxr-xr-x     - healer 18 Nov 22:52   .stackdrwxr-xr-x     - healer 19 Mar 12:00   .themes.rwxr-xr-x   685 healer 19 Nov 21:48   .xinitrc.rwxr-xr-x   146 healer 19 Nov 10:06   .zprofiledrwxrwxrwx     - healer 20 Nov 19:49   desktopdrwxr-xr-x     - healer 19 Nov 21:42   downloaddrwxr-xr-x     - healer 19 Nov 10:01   publicdrwxr-xr-x     - healer 20 Nov 19:45   video\n\n","categories":["linux"],"tags":["home dir"]},{"title":"create-cursor","url":"/2022/06/24/create-cursor/","content":"Self Define Cursor ThemeBecause i use a pen tablet rather than a regular mouse, so i wanna to find a cursor theme suit for my need which has a circle rather than pointer, however i find no, then i decide to create myself cursor theme.\nFinally i find the method, with the command xcursorgen we can easily create a cursor from a png image or a series of png images to create a animated cursor.\nMain Steps\nuse image editor to create square png image, i choose gimp.\nusually use 32x32 pixels, i just choose 12x12 pixels for a little circle. save with background transparency circle.png.\n\nfind the pointer’s tip with x,y coordinate(gimp will show the x,y when hover image position).\ni choose 6 6 which the center of circle\n\n create a configure file circle.cursor\n\n\n   image-size x y image-name# eg:12 6 6 circle.png\n\n\nproduct the final cursor file\nxcursorgen configure-file final-cursor-name# eg:xcursorgen circle.cursor circle\nput final cursor file to personal cursor folder\nmkdir ~/.icons/my-cursorcp circle ~/.icons/my-cursor/circle\nlink to new created cursor\nthe cursor pointer is called left_ptr under ~/.icons/Layan-cursors/cursors (the folder name maybe different, it is depend on your cursor theme), which is linked to default by default.\nwe need relink to our new cursor\nln -sf ~/.icons/my-cursor/circle left_ptr\nmake it effect\nxsetroot -cursor_name left_ptr\n\nAnimate Cursoranimate cursor is also simple to create, the only difference is we need create more than one png images and give them a showing time in configure file.\nsuch as i create two png images:\ncircle.pngcircle-light.png\n\nand then in configure file\n12 6 6 circle.png 500012 6 6 circle-light.png 100\n\nnote that the showing time unit is microseconds\nabove means showing circle.png 5 seconds and then circle-light.png 0.1 seconds, and then repeat.\n","categories":["linux"],"tags":["cursor theme"]},{"title":"Bad Guy","url":"/2022/05/14/bad-guy/","content":"今天听了《美丽的神话》这首歌，又回想起来大学看过的《神话》这个电视剧。时光匆匆，这么多年又过去了，然而看电视剧的感受还是那么 清晰。全剧最让我感动的就是赵高说他要一步一步往上爬，成为一人之下万人之上的存在。这里也是他和主角正式分道扬镳的地方，如果让我选择一个支持的人，我可能并不会那么高尚的选择主角。\n赵高原本是一个现代的厨师，有一些小偷小摸的习惯，但却是为了是给妹妹更好的生活。他从小把妹妹带大，相依为命，可以说妹妹就是他唯一生活的阳光。因为小川，他被无缘无故的被带入到了古代，与妹妹时空相隔，同时迎接他的命运也是极端的残酷，被拉去修长城，进宫成为了太监，这一系列的遭遇，如果唤作是我，恐怕活着的勇气都没了。然而他还是坚持了下来，因为他始终相信他还可以回去，回到现代。\n而小川的命运完全不一样，一帆风顺的不可想象，结识了刘邦项羽，有吕素为救自己而牺牲，后来还遇到了他的所爱，像天使一样美丽的少数名族的公主玉树，并且相恋。所以小川坚持他的人间值得，正道光明没有什么错。但是我认为他却不能将这样的要求强加给赵高。\n后来小川将虞姬引荐给赵高，我还记得赵高第一次遇见虞姬的那种开心，那种话都说不明白的心情，因为虞姬和他妹妹长的一模一样，他以为他又见到了自己的妹妹。那一瞬间仿佛穿越了时空，仿佛停止了时间，感动的让人落泪。我想这是那苦难的社会能唯一给他带来快乐的事情了吧。\n所以他说他要一步一步往上爬，即便是成为历史书中那个奸臣赵高也无妨。我可以体会到那种心情，也足够同情他，他每爬一步背后所承受的那种心酸，悲伤，无助，失望谁又能懂呢？他不是不知道他会堕落成魔，但是社会已经无可救药，为了可以见到亲妹妹，为了保护这个世界的虞姬，他必须这么做。没有多么高尚的目标，没有社会责任，没有英雄主义，却让我敬佩。这才是真正的人生，这才是勇敢的人。\n设想一下一个社会的小小角色，无权捍卫自己的人生安全，无法受到公平对待，没有任何自由的权利，那么我为什么还要遵守这癫狂的社会规则，遵守那些贪官污吏、昏庸无能的君主所定下的规则呢？如果成魔可以保护自己所爱的人，那么就让我成魔吧。\n我并不认为历史和当下有多遥远的距离，因为此刻也即是历史，那些曾经做过的错的对的事也会随风流逝，重要的是我们为自己所做的决定后悔吗？赵高不会为自己所做的事后悔，他就是一个小老百姓，不必肩负历史的命运，而能够尽自己所能保护所爱的人已足矣，心安。\n对与错是很难分辨的，也不应该用一个固定标准去衡量它，因为在不同的人眼中是不同的，不同的地域，不同的时空都是不同的。一千个读者就有一千个哈姆雷特；在美国拥有枪支是合法的，而在中国却是非法的；杜甫那个时代指责政府的诗可以流传千古，而八股文，文字狱却是一言足以入狱。\n那么如何去分辨是非曲直呢？我只能说我也不清楚，因为我自己都无法正确判断，我也在学习的路上。而行之有效的一个方式就是走进历史，走进历史所在的那个环境，用心去体会，用理智去判断。这个判断的依据从来都不是政府，因为皇权百年更迭，而人心亘古不变，人心也即是普世价值。\n","categories":["think"],"tags":["神话"]},{"title":"dunst-status-bar","url":"/2022/11/28/dunst-status-bar/","content":"DUNST STATUS BARRecently, i changed my xmonad configuration with removing xmobar. My mind just changed, i think a status bar is not necessary in most of time, since i find i nearly don’t see the information in status bar, only the workspace info.\nAnd i remember xmonad itself can provide a workspace tree for me to display choose the workspace, that’s enough. But some information such as brightness and volume should be display when i change them. So i try to use dunst to show this, and i have ever saw that dunst can configured to display a nice bar.\nThis is my script:\n#!/bin/dash#  _          _       _     _                       # | |__  _ __(_) __ _| |__ | |_ _ __   ___  ___ ___ # | &#x27;_ \\| &#x27;__| |/ _` | &#x27;_ \\| __| &#x27;_ \\ / _ \\/ __/ __|# | |_) | |  | | (_| | | | | |_| | | |  __/\\__ \\__ \\# |_.__/|_|  |_|\\__, |_| |_|\\__|_| |_|\\___||___/___/#               |___/                               # define variables, $0 stands for current filename which will be used# by sed.OPERATE=$1VOLUME=$2FILENAME=$0# use sed change and store current brightness value instead# of each time to query current brightness with `sudo ddcutil getvcp 10`# the benefit of doing this is that query brightness needs lots of time# which will leads to the notify shows delayed.current=5brightness=$(expr $current $OPERATE $VOLUME)[ $brightness -ge 0 ] &amp;&amp; sed -i &quot;/^current/c current=$&#123;brightness&#125;&quot; $FILENAME# use dunst to show a status bar of brightness.notify-send &quot;brightness : $&#123;brightness&#125;%&quot; \\\t-h string:frcolor:#000000 \\\t-h int:value:$&#123;brightness&#125; \\\t-h string:x-dunst-stack-tag:brightness \\\t-t 800# change brightnesssudo ddcutil setvcp 10 $OPERATE $VOLUME\n\nIt is normal, but have something need to be marked.\n\n-h int:value:... used to show a status bar.\n-t string:frcolor:... used to show the status bar’s frame color.\n-h string:x-dunst-stack-tag:... use a tag to mark notification is the same, can help notify to show info with replacement instead of a list of notifications.\nuse sed to directly change and store current brightness can help to speed up showing, shrink the time of querying.\n\n","categories":["linux"],"tags":["dunst"]},{"title":"ed","url":"/2022/04/23/ed/","content":"EDed是一个unix默认的编辑器，是操作系统自带的编辑器，如果在某些场景下没有vim编辑器，那么ed就可以派上用场的\n大多数ed的命令和vim一致\nsimple open / quit file\n# ed without parameter open a text buffered# ed with a filename open a file and make changes to the copy of file buffered file.txt# exit ed with warnq# exit without warnQ# write changes to filew# open content to filef filename# open content file and write to filef filenamew# orw filename\n\n\n\nprompt/command mode and input mode\nwhile opening file, will locate in the last line of file with prompt mode\n# default will enter prompt mode, in this mode we can execute command# `P` toggles prompt on or off P# trun display error message onH# !command allow us to execute shell command!command# read output of command and write to bufferr !command# enter input mode: `a` append; `i` insert; `c` changeaic# `.` exit input mode.\n\n\n\n, usage\n# `,` means all lines# print last line, in default, will show the last linep# print all lines,p# delete one lined# delete all lines,d\n\n\n\n\n\n# usage\n# `#` in prompt mode means ignore# this line will be ignored# `#` in input mode means nothing but a character\n\n\n\nnum to locate\n# in default, will locate the last line, num will locate other line# 1 locate line 11# enter will locate to end line one by one# move option after num2s/hell/hello# move current line to line 1m0# move line 10 to line 1 and print10m0p\n\n\n\nline address\n.    #The current line (address) in the buffer.$    #The last line in the buffer.n    #The nth line in the buffer, where n is a number in the range &#x27;0,$&#x27;.+n   #The nth next line, where n is a non-negative number.-n   #The nth previous line, where n is a non-negative number.+    #The next line. This is equivalent to &#x27;+1&#x27; and may be repeated with cumulative effect.-    #The previous line. This is equivalent to &#x27;-1&#x27; and may be repeated with cumulative effect.,    #The first through last lines in the buffer. This is equivalent to the address range &#x27;1,$&#x27;.;    #The current through last lines in the buffer. This is equivalent to the address range &#x27;.;$&#x27;./re/ #The next line containing the regular expression re. The search wraps to the beginning of the \t\t\t  buffer and continues down to the current line, if necessary.?re? #The previous line containing the regular expression re. The search wraps to the end of the buffer \t and continues up to the current line, if necessary.&#x27;x   #The apostrophe-x character pair addresses the line previously marked by a &#x27;k&#x27; (mark) command,  \t\t where &#x27;x&#x27; is a lower case letter from the portable character set &#x27;[a-z]&#x27;.\n\n\n\nother important command\n# print line with line number,n# undo changesu# copy current line to specified linet2# show content with keyword position. eg:display content from starting with `#` to now.?^#?,.p# global search1,$g/&lt;pattern&gt;/p# or,g/&lt;pattern&gt;/p\n\n","categories":["learn"],"tags":["ed"]},{"title":"bing壁纸设置","url":"/2022/05/29/bing%E5%A3%81%E7%BA%B8%E8%AE%BE%E7%BD%AE/","content":"The way to set wallpaper with bing daily img之前写过一个shell脚本，用来设置bing的每日壁纸作为桌面壁纸，但是发现失效了，只能下载当天的，没法选择以前的。所以今天重新写一遍\n之前使用的是api链接后面添加数字来表示天数，但是现在不是这样的方式了。而是用一个api获取所有数据。\n\n\n所以重新写了一遍（发现很长时间不用就有很多不熟悉的知识）\n#!/bin/bash#               _ _                             #__      ____ _| | |_ __   __ _ _ __   ___ _ __ #\\ \\ /\\ / / _` | | | &#x27;_ \\ / _` | &#x27;_ \\ / _ \\ &#x27;__|# \\ V  V / (_| | | | |_) | (_| | |_) |  __/ |   #  \\_/\\_/ \\__,_|_|_| .__/ \\__,_| .__/ \\___|_|   #                  |_|         |_|              # specify download tmp locationtmp_dir=&quot;/tmp&quot;# sepcify store locationdefault_dir=&quot;$&#123;HOME&#125;/Pictures/background&quot;# specify default picture local dirdefault_pic=&quot;$&#123;HOME&#125;/Pictures/background/splash.png&quot;# specify bing image gallery apiapi=&quot;https://cn.bing.com/hp/api/v1/imagegallery?format=json&quot;# specify dynamic change timedynamic_time=&quot;600&quot;# save argsmethod=$&#123;1:-&quot;&quot;&#125;location=$&#123;2:-&quot;&quot;&#125;download_or_not=$&#123;3:-&quot;&quot;&#125;# function for sure no backend existsfunction no_backend()&#123;    [[ `ps -ef | grep wallpaper | grep -v grep | wc -l` -gt 2 ]] &amp;&amp; &#123;        kill `ps -ef | grep wallpaper | head -1 | awk &#x27;&#123;print $2&#125;&#x27;`    &#125; &#125;# function for notifyfunction notify()&#123;    info=$@    notify-send &quot;$&#123;info&#125;&quot;&#125;# function for setting static wallpaperfunction static_bg()&#123;    [[ -f $&#123;location&#125; ]] &amp;&amp; feh --bg-scale $&#123;location&#125; || &#123;        feh --bg-scale $&#123;default_pic&#125;        notify &quot;wrong picture path!&quot;     &#125;&#125;# function for setting dynamic wallpaperfunction dynamic_bg()&#123;    &#123;        while :        do            [[ -d $&#123;location&#125; ]] &amp;&amp; feh -D 1 -z --bg-scale $&#123;location&#125; || &#123;                static_bg $&#123;default_pic&#125;                notify &quot;no specify directory or wrong path!&quot;            &#125;            sleep $&#123;dynamic_time&#125;        done    &#125; &amp; &#125;# function for setting bing wallpaperfunction bing_bg()&#123;    day=$1    download_or_not=$2    timeout 1 ping -c 1 -q www.bing.com &amp;&gt;/dev/null &amp;&amp; &#123;        urls=`curl -s &quot;$&#123;api&#125;&quot; |jq &#x27;[.data.images[] | .imageUrls | .landscape | .wallpaper]&#x27;`        url=`echo $urls |jq &quot;.[$&#123;day&#125;]&quot; |tr -d &#x27;&quot;&#x27;`        link=&quot;https://www.bing.com$&#123;url&#125;&quot;        wallpaper_name=`echo $&#123;link&#125; |cut -d. -f4 |cut -d_ -f1`        [[ $&#123;download_or_not&#125; == &quot;download&quot; ]] &amp;&amp; &#123;            &#123;                wget $&#123;link&#125; -P $&#123;tmp_dir&#125; &amp;&gt;/dev/null &amp;&amp; &#123;                    mv /tmp/*$&#123;wallpaper_name&#125;* /tmp/$&#123;wallpaper_name&#125;.jpg                    mv /tmp/$&#123;wallpaper_name&#125;.jpg $&#123;default_dir&#125;                    notify &quot;download $&#123;wallpaper_name&#125; to $&#123;default_dir&#125;&quot;                &#125;            &#125; || notify &quot;download error!&quot;        &#125;    &#125;     feh --bg-scale $&#123;link&#125;&#125;# function for help messagefunction exit_with_help()&#123;    echo &quot;parameter error! try:    wallpaper static /file/location    wallpaper dynamic /folder/location    wallpaper bing    wallpaper bing 0~6    wallpaper bing 0~6 download&quot;    exit 1&#125;# choose which methods to use[[ $&#123;method&#125; != &quot;&quot; ]] &amp;&amp; &#123;    [[ $&#123;location&#125; != &quot;&quot; ]] &amp;&amp; &#123;        if [ $&#123;method&#125; == &quot;static&quot; ];then            no_backend            static_bg $&#123;location&#125;        elif [ $&#123;method&#125; == &quot;dynamic&quot; ];then            no_backend            dynamic_bg $&#123;location&#125;        elif [ $&#123;method&#125; == &quot;bing&quot; ];then            no_backend            bing_bg $&#123;location&#125; $&#123;download_or_not&#125;        fi    &#125; || exit_with_help&#125; || exit_with_help\n\n","categories":["learn"],"tags":["shell"]},{"title":"gentoo","url":"/2023/02/02/gentoo/","content":"MY GENTOO HANDBOOKAfter 6 years of archlinux usage, i finally move to gentoo and give it a try. After several weeks, i still miss archlinux, since installing something is really cheap in arch, but often take minutes in gentoo. However, i learned more in gentoo and get used to compiling kernel. So, it is really worth to try gentoo.\nINSTALLKERNELconfigure sound cardIf we don’t configure sound card, then with the default configuration we never gonna have sound. So we need to follow the alsa page and choose some of the card driver.\nIn fact i also don’t know which one should i choose, i just picked Realtic and then compiled and reboot, and i get the sound.\nconfigure frame bufferThere are several times when i compiled a kernel, and reboot to a black screen, it only shows “loading kernel…”, and this is something that configured in grub. So in a word, system cannot boot the kernel. And i am glad to say, i finally know the reason, that is caused by error configuration of frame buffer.\nI miss one step in kernel configuration with Xorg ability. I didn’t specify the firmware file(under /lib/firmware) which frame buffer depends on(compile gpu drive to kernel directly). \nWe should follow the firmware page to configure.\n\nWe can write like this: amdgpu/xxx.bin amdgpu/xxx.bin, separated by space. However which one should i write? We need boot to a normal system, and run this command to find.Or we can find in the page.\n--- › » dmesg -t | grep amdgpu | grep firmwareLoading firmware: amdgpu/beige_goby_sos.binLoading firmware: amdgpu/beige_goby_ta.binLoading firmware: amdgpu/beige_goby_smc.binLoading firmware: amdgpu/beige_goby_pfp.binLoading firmware: amdgpu/beige_goby_me.binLoading firmware: amdgpu/beige_goby_ce.binLoading firmware: amdgpu/beige_goby_rlc.binLoading firmware: amdgpu/beige_goby_mec.binLoading firmware: amdgpu/beige_goby_mec2.binLoading firmware: amdgpu/beige_goby_sdma.binLoading firmware: amdgpu/beige_goby_dmcub.binLoading firmware: amdgpu/beige_goby_vcn.binamdgpu 0000:03:00.0: amdgpu: Will use PSP to load VCN firmware\n\n\nconfigure default gpu driverUsually we can successfully login window manager without problem, but once we check the xorg log file ~/.local/share/xorg/Xorg.0.log, we will find some error messages show cannot load ati/mesa gpu driver, although it is harmless(it will finally load the gpu we have), but this comes because we have not configured it yet.\nWe should specify the correct gpu driver we use in /etc/X11/xorg.conf.\nSection &quot;Device&quot;   Identifier   &quot;My Graphics Card&quot;   Driver       &quot;amdgpu&quot;EndSection\n\n\nconfigure console frontWhile using framebuffer, the console font size becomes too small, so there is a need to change the font size. I find the way.\n\nFind console font name in /usr/share/consolefonts.\n\nConfigure font in /etc/conf.d/consolefont.\nconsolefont=&quot;sun12x22&quot;\n\n\nNote: remove .psfu.gz of the font name.\n\n\nAdd consolefont service to boot level.\nrc-update add consolefont boot\nAfter reboot, the font size will be the right one.\n\n\nadd guru repositoryThere are so many third part repository with gentoo. And i will try guru this time.\nGuru is a gentoo repository just like arch’s aur. I tried to install with eselect-repository but failed, so i will configure it manually.\n\nCreate a repo file\ntouch /etc/portage/repos.conf/guru.conf [guru]location = /var/db/repos/gurusync-type = gitsync-uri = https://github.com/gentoo-mirror/guru.git\nsyncing\nemerge --sync guru\n\n\nNote: now we cannot find any difference with emerge search which not like arch’s aur. But we can find the difference in installation\n\nUSAGEcompile kernel with correct fileSince i decide to use gentoo, how to configure a minimalist kernel is always a challenge for me. Last failed time i compile kernel, i got confused a lot, because the first time compiled failed, i want to recompile the kernel, but when i run make menuconfig, i got the configuration the same as i changed before, even when i removed .config file. What i really want is a clean origin setting. And i finally find there are ways to realized that\nConfiguration targets:                    config              - Update current config utilising a line-oriented program  nconfig             - Update current config utilising a ncurses menu based program         menuconfig          - Update current config utilising a menu based program                 xconfig             - Update current config utilising a QT based front-end  gconfig             - Update current config utilising a GTK based front-end  oldconfig           - Update current config utilising a provided .config as base           localmodconfig      - Update current config disabling modules not loaded                   localyesconfig      - Update current config converting local mods to core                  silentoldconfig     - Same as oldconfig, but quietly, additionally update deps             defconfig           - New config with default from ARCH supplied defconfig                 savedefconfig       - Save current config as ./defconfig (minimal config)                  allnoconfig         - New config where all options are answered with no                    allyesconfig        - New config where all options are accepted with yes                   allmodconfig        - New config selecting modules when possible                           alldefconfig        - New config with all symbols set to default                           randconfig          - New config with random answer to all options                         listnewconfig       - List new options                                                     olddefconfig        - Same as silentoldconfig but sets new symbols to their default value  kvmconfig           - Enable additional options for guest kernel support                   tinyconfig          - Configure the tiniest possible kernel                              \n\nI finally know that there are so many options for make to choose, and the one i need is make defconfig. It will produce an origin .config file. After that run make menuconfig to use gui interface to choose the items.\nunmask a package || get the latest versionSometimes, when we prepare to install a package with emerge, and we find we cannot install it, because it shows the package is masked. We can allow that by editing a configuration file /etc/portage/package.accept_keywords\n# for example unmask ddcutil package# put the line in package.accept_keywordsapp-misc/ddcutil ~amd64\n\nThen we will be allowed to install. If we want to install the latest version of package, we can configure it the same way.\n# for example without any configure, allowed firefox version is 102.# with configuration, we can install the newest verion 108www-client/firefox ~amd64\n\n\nupdate configuration fileWhen i update my system, there comes a message tells me to update my zprofile. I don’t understand it at first, and after reading the man page, i finally realize how great gentoo is. In a fact, it is a protection mechanism to prevent programs auto rewrite our exist configuration file.\nIt will create a file named ._cfgxxx under /etc/zsh/ which is the new configuration zprofile file. We should merge it to exist one.\n* GNU info directory index is up-to-date.* IMPORTANT: config file &#x27;/etc/zsh/zprofile&#x27; needs updating.* See the CONFIGURATION FILES and CONFIGURATION FILES UPDATE TOOLS* sections of the emerge man page to learn how to update config files.\n\nWe can use one of these tools: dispatch-conf,  cfg-update, and etc-update to update the configuration\netc-update /etc/zsh\n\nchoose other repositoryGentoo has more than one repository, we can add it by hand or use an old too called layman. But a modern way is using eselect repository.\n\nFirst we need to install it.\n$user: doas emerge --ask app-eselect/eselect-repository\nMake sure there already has a /etc/portage/repo.conf directory.\n\nMake sure there already has a wget config file wgetrc in ~/.config.\n$user: cp /etc/wgetrc ~/.config/\nRun the command show all repositories.\n$user: eselect repository list# or only show currently configured repository$user: eselect repository list -i\n\n\nNote:\n\nInstalled, enabled repositories are suffixed with a * character.\nRepositories suffixed with #, need their sync information updated (via disable/enable) or were customized by the user.\nRepositories suffixed with @ are not listed by name in the official, published list.\n\n\n\nAdd an new ebuild repository\n# for example add guru$user: doas eselect repository enable guru\nSync new repository\n$user: doas emaint sync -r guru\n\nuse gentooltoGentoolto is a overlay instruction help us to optimize packages, shrink compile and launch time but get bigger package size.\n\nAdd repository\n$user: doas eselect repository enable mv lto-overlay\nSync repository\n$user: doas emaint sync -r mv$user: doas emaint sync -r lto-overlay\nInstall ltoize\nUnmask ltoize first\n# add this to /etc/portage/package.accept_keywordssys-config/ltoize ~amd64\n\n$user: doas emerge --ask sys-config/ltoize\nConfigure make.conf.lto\nJust uncomment the one github page shows, but CPU_FLAGS_X86 need ourselves to add\n# run cpuid2cpuflags to show all matched flag $user: cpuid2cpuflags# then add this flag to config file with same format, for my cpu it isCPU_FLAGS_X86=&quot;aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt rdrand sha sse sse2 sse3 sse4_1 sse4_2 sse4a ssse3&quot;\nRebuild system with lto\n$user: doas emerge -e --keep-going @world\n\nISSUEStartx cannot open /dev/tty0In gentoo, after we installed, and we try to login window manager with startx command as a none root user, we will got this error message:\nuser$ startxparse_vt_settings: Cannot open /dev/tty0 (permission denied)\n\nThe solution is enabling elogind service at boot time.\nuser$ doas rc-update add elogind bootuser$ /etc/init.d/elogind start\n\n/etc/profile doesn’t take effectCannot auto source /etc/profile when changing default shell from bash to zsh.\nIn archlinux, once i change default shell to zsh, everything works fine. But in gentoo, i got some problems, i find everything in /etc/profile doesn’t take effect.\nAfter searching, i finally find the reason, zsh shell doesn’t read /etc/profile but /etc/zsh/zprofile.\nSo the solution is writing everything we need to /etc/zsh/zprofile for system wide, or ~/.config/zsh/zprofile for user wide.\nno sound by defaultAlsa stands for advanced linux sound architecture which obtains the sound ability of kernel. In fact, we don’t need other tools to gain the sound, but the sound system is muted by default, so we need install media-sound/alsa-utils which contains some useful tools help us to unmute sound and adjust it.\n\nUnmute sound system\nWe can use command alsamixer a ncurse tool to unmute sound first. But the system will still have no sound until we configured.\n\nFind sound device\nFind the sound devices\nuser$ aplay -L ...front:CARD=Generic_1,DEV=0HD-Audio Generic, ALCS1200A AnalogFront output / input...\n\nFind the part of front, that is the information we need.\n\nConfigure sound\nThere are there places we can put our configuration:\n\n/etc/asound.conf\n~/.asoundrc\n~/.config/alsa/asoundrc\n\nAs my case, i need this configuration to be put.\ndefaults.pcm.!card Generic_1defaults.pcm.!device 0defaults.ctl.!card Generic_1\n\ncannot find libnss.soWhen i start clash with ./cfw, it shows some error messages: “libnss.so library missing”. If use emerge to search libnss, we cannot find the correct one. In a fact, the correct one is called nss.\nemerge --ask dev-libs/nss\n\nAfter installing, i can successfully launch the clash application.\nupdate system error$user: emerge --syncgpg: refreshing 4 keys ...gpg: keyserver refresh failed...\n\nThis problem maybe remote server problem, and a way to fix is use other sync method.\n$user: doas emaint --auto sync\n\nCOMPILED FROM SOURCEddcutilIf we get a external monitor, we cannot adjust brightness with xbrightness command, so we need a tool called ddcutil, however in gentoo it is masked, so the best way is downloading the source code and compile it manually.\n\nDownload ddcuitl source file from github\n\nFollow this page to compile ddcutil\n#cd to unpacking directoryuser$ ./autogen.sh user$ ./configureuser$ make user$ doas make install\n\nThen ddcutil will be installed in /usr/local/bin/ddcutil.\n\nLoad i2c-dev module\nBy default, we cannot run ddcutil command, cause i2c-dev device missing.\nuser$ doas ddcutil detect                                       1 ↵No /dev/i2c devices exist.ddcutil requires module i2c-dev.\n\nLoad missing module\nuser$ doas modprobe i2c-dev#check whether loadeduser$ lsmod |rg -i i2ci2c_dev                28672  0\n\n\nNote: we need to make sure i2c-dev already compiled in kernel.\n\n\nDetect display device\nMost of the time it show device 10\nuser$ doas ddcutil getvcp ALL |rg -i brightnessVCP code 0x10 (Brightness                    ): current value =    25, max value =   100\nSet/get brightness with ddcutil\nuser$ doas ddcutil setvcp 10 + 5user$ doas ddcutil getvcp 10VCP code 0x10 (Brightness                    ): current value =    25, max value =   100\n\npicomYeah, i love picom, but in gentoo repo i cannot find [pijulius/picom] but the original one, so i need to compile it from source.\n\nDownload source code\n\nDownload needed dependcies\nOne trick is that we don’t need to install all the dependcies from what github page says. We can only install the dependcies from what gentoo repo’s picom needs.\n#find the needed dependciesuser$ emerge --ask --pretend x11-misc/picom#install the need dependciesuser$ doas emerge --ask uthash libev libconfig\nCompile source file\nuser$ cd picom-implement-window-animationsuser$ git submodule update --init --recursiveuser$ meson --buildtype=release . build user$ ninja -C build\n\nThen the binary file will be installed in ~/.local/bin/picom.\n\nRun picom\nMake sure the configuration file is placed in proper location.\nuser$ picom --experimental-backends --config ~/.config/picom/picom.conf -b\n\nxcolorIn gentoo, i cannot find xcolor package, the great tool, so i have to install it from source.\n\nDownload the source code.\n\nExtra package and compile.\ntar -xf Soft-xcolor-0.5.1-2-g969d652.tar.gz -C ~/.local/apps cd ~/.local/apps cargo install xcolor\nIt’s binary file located in ~/.local/share/cargo/bin, the better way add this path to environment variable.\n\n\ndbus errorI use stack to install xmonad and xmobar since long time ago, cause it is a great way without system to install plenty of haskell modules preventing starting xmonad failure each time even one haskell module has been updated.\nBut this time in gentoo linux, maybe xmobar version has been updated, i can install xmobar, but failed to start it, and shows:\n--- ~ » xmobar xmobar: SocketError &#123;socketErrorMessage = &quot;Network.Socket.connect: &lt;socket: 16&gt;: does not exist (No such file or directory)&quot;, socketErrorFatal = True, socketErrorAddress = Just (Address &quot;unix:path=/run/user/1000/bus&quot;)&#125;\n\nAfter searching, i tried this method(which turns to be a horrible mistake):\n# add this two lines in /etc/environmentDBUS_SYSTEM_BUS_ADDRESS=unix:path=/run/dbus/system_bus_socketDBUS_SESSION_BUS_ADDRESS=unix:path=/run/dbus/system_bus_socket\n\nYes, it really fixed the problem of xmobar, it can be launched successfully, but causes problems more than that. When i try to send a notification or create a new tab in firefox by scripts, all fail.\n--- ~ » notify-send &quot;hello&quot;                                           1 ↵GDBus.Error:org.freedesktop.DBus.Error.ServiceUnknown: The name org.freedesktop.Notifications was not provided by any .service files--- ~ » firefox-bin --search --new-tab &quot;ls&quot;                           1 ↵[Parent 5156, Main Thread] WARNING: g_dbus_proxy_new: assertion &#x27;G_IS_DBUS_CONNECTION (connection)&#x27; failed: &#x27;glib warning&#x27;, file /builds/worker/checkouts/gecko/toolkit/xre/nsSigHandlers.cpp:167(firefox:5156): GLib-GIO-CRITICAL **: 04:00:23.853: g_dbus_proxy_new: assertion &#x27;G_IS_DBUS_CONNECTION (connection)&#x27; failed[Parent 5156, Main Thread] WARNING: g_dbus_proxy_new: assertion &#x27;G_IS_DBUS_CONNECTION (connection)&#x27; failed: &#x27;glib warning&#x27;, file /builds/worker/checkouts/gecko/toolkit/xre/nsSigHandlers.cpp:167(firefox:5156): GLib-GIO-CRITICAL **: 04:00:23.853: g_dbus_proxy_new: assertion &#x27;G_IS_DBUS_CONNECTION (connection)&#x27; failed\n\n\nAt first, i thought it was the problem of dbus software itself, there must be some problems of communication of process. Yeah, there really are problems of communication of process, but it caused by myself. Because i add that two dbus environment variables in /etc/environment.\nSolution:\n\nsolve the problem of dbus communication by removing dbus variable in /etc/environment.\n\nsolve the problem of xmobar by adding a softlink in ~/.xinitrc\n#fix xmobar cannot find /run/user/1000/busln -sf /run/dbus/system_bus_socket /run/user/1000/bus\n\nIt is a happy ending again, i am so happy to see that, cause i weak up in 3:00 AM(weak up by something of a mouse noise, i finally know this rent house has some mouses) and find the solution(i don’t know why i just realized where the problem is at this time, but it happened)!\nlinks","categories":["linux"],"tags":["gentoo"]},{"title":"firefox-extension","url":"/2022/05/24/firefox-extension/","content":"firefox extension\nI may never wondering there comes a day that i will learn to write a firefox extension, because all most the time i need is to download some one for adds on. But when i get a job, and need to view one web page ten to hundred times, then i really want to do some optimize with the page just wish to improve the usability. And when i write this note, i only learned a little, however i think it is better to do rather than not.\n\nThe main goals that i want to achieve are:\n\nedit the color style of a page\nautomatically choose/click button\nintelligent filling/adjust what i typed in\n\nthe way to realize\ninject css file to web page when we open one url, to customize page style \ninject js file to web page(we all know how powerful the js is) to do everything else\n\nmy first extension with temporary loadingat first we need a folder to store all files\ntouch chcolor\n\nthen create folder and file like this\n── chcolor   ├── icons   │  ├── 32.png   │  ├── 48.png   ├── manifest.json   └── scripts      ├── modify.js      └── theme.css\n\n\nmanifest.json is the main file to describe everything else\nicons folder includes all the icons used in adds on\nscripts folder store our main js and css file\n\nmainfest.jsondescribe which icon the extension use and which url will be match, which js and css file we use.\n&#123;    &quot;manifest_version&quot;: 2,    &quot;name&quot;: &quot;chcolor&quot;,    &quot;version&quot;: &quot;1.0&quot;,    &quot;description&quot;: &quot;testing and learning&quot;,    &quot;icons&quot;: &#123;        &quot;48&quot;: &quot;icons/48.png&quot;    &#125;,    &quot;content_scripts&quot;:[        &#123;            &quot;matches&quot;:[&quot;*://*.baidu.com/*&quot;],            &quot;js&quot;:[&quot;scripts/modify.js&quot;],            &quot;css&quot;:[&quot;scripts/theme.css&quot;]        &#125;    ]&#125;\n\n\n\ninject css file to web pageif we want to customized the style of web page, at first we need to find the css in web page and then change to what we want in our local css file. note that we only need copy the one we need, not all of them.\n\ntheme.css\n.s-top-left-new &#123;    display: none;&#125; .s-hotsearch-wrapper &#123;    display: none;&#125;#head_wrapper #kw &#123;    border: 2px solid #a65d31;    background: #c0b29c52;&#125;#head_wrapper .s_btn &#123;    background-color: #a65d31;    border-radius: 0 20px 20px 0;&#125;\n\n\n\ninject js to web pageanother way hiding some elements of page is to use js’s  function removeChild()\nnote that the parent element must be the direct father element of child, otherwise it will make no sense.\nmodify.js\n// change whole webpage background colordocument.body.style.backgroundColor = &quot;#eef2e8&quot;;// use console.log to debugconsole.log(&quot;start&quot;);menu_father = document.getElementById(&quot;head&quot;);menu = document.getElementById(&quot;s-top-left&quot;);menu_father.removeChild(menu);hot_search = document.getElementById(&quot;s-hotsearch-wrapper&quot;);hot_search_father = document.getElementsByClassName(&quot;s_form_wrapper soutu-env-nomac soutu-env-index&quot;)[0];hot_father.removeChild(hot_search);console.log(&quot;done&quot;);\n\nif we cannot find an element by id, we can find it by classname, and remember that we need to use index figuring out it.\nin console, we can find whether it is done.\n\ntemporary load our extension to firefoxin about:debugging of firefox, click This Firefox to load our extension, then reload the web page, we will find it makes effect.\nnow it will look like this:\n\npack file to an shared extensionwith the above method, we can only make it effect when the browser opens, once it reopens then it will not work until we add it by hand.\nso we need to pack it up to an .xpi file, one important thing is we need compress our file to a zip file first and then send it to AMO to sign. Once it be signed, we can install it like other online adds on.\nbefore compress file, we need add some info to manifest.json\n&quot;browser_specific_settings&quot;: &#123;  &quot;gecko&quot;: &#123;    &quot;id&quot;: &quot;ssfwshutterbug@gmail.com&quot;  &#125;&#125;\n\ncompress file\n# compress file without unnecessary file such as .git folderzip -r -FS ../my-extension.zip * --exclude &#x27;*.git*&#x27;\n\nopen AMO web page, login our account, then click developer hub, upload our zip file. once it done, we can download it from this page.\n","categories":["learn"],"tags":["inject js/css"]},{"title":"git","url":"/2022/04/23/git/","content":"gitI learned git long time ago, but don’t use it very often, recently i write a script to sync my task todo list with github, need some git skills, so i tried to cleanup my note and learn again.\nBASIC CONFIGURATIONThere are three kind of configuration files:\n\nsystem：write file: /etc/gitconfig\nglobal：write file: ~/.gitconfig\nlocal：write file: .git/config\n\nPersonally, i will use local configuration file, because it will not create file in home directory which makes home a less  mess folder.\n#user name and email only used for identity.git config --local user.name &quot;your_user_name&quot;git config --local user.email &quot;your_email_addr&quot;#change default branch name from master to main.git config --local init.defaultBranch main#use nvim as commit editor.git config --local core.editor nvimgit config --local merge.tool nvim -d#enable color.git config --local color.ui truegit config --local color.status autogit config --local color.branch auto\n\n\nTip:\nchange an exist repo default name: git branch -m main\n\nShow all configuration:\n#show all configuration(global + local)git config --list#show only localgit config --local --list#show only the one i wanna to seegit config user.name#or we can directly cat the configuration filecat ~/.gitconfig\n\n\n\n\nCOMMON COMMAND QUICK LOOK\n\n\ncommand\nusage\n\n\n\ngit init\ninitialize a new repo git status\n\n\ngit checkout [file]\nreverse modified\n\n\ngit add\nadd changes to stage area\n\n\ngit reset HEAD [file]\nreverse changes out of stage area\n\n\ngit commit\ncommit as a check point\n\n\ngit log\ncheck commit info\n\n\ngit reset\nreverse to a specified commit(check point)\n\n\ngit branch –list\nshow all branchs\n\n\ngit branch [branchname]\ncreate new branch\n\n\ngit checkout [branchname]\nchange to new branch\n\n\ngit checkout -b [branchname]\neasily create new branch and change to it\n\n\ngit merge [branchname]\nmerge from branch\n\n\ngit branch -d [branchname]\ndelete a branch\n\n\ngit tag\nshow tag\n\n\ngit tag [tagname]\ncreate tag\n\n\ngit tag -d [tagname]\ndelete tag\n\n\ncommand\nusage\n\n\nUSE GIT TO MANAGE REPONo matter what the directory is empty or full of folders or files, we can change directory to it and initialize it to a git repo.\ngit init\n\nAfter run this command, there comes a .git directory in current folder, nothing else. Yeah, git don’t track any file or fold, we need to specify which to track.\ngit add [file name or folder]#or track allgit add .\n\nOnce we run this command, git will track them the one we specified. What if some files or folders that we don’t track? We can create a file named .gitignore to note. Each line allows one file or folder.\ntouch .gitignore#we can track this filegit add .gitignore\n\nEvery file we added will store in a stage area. When we finish a big change or feature, we can take a snapshot with git commit.\n#before commit, we can check the difference with last time commitgit diff#commitgit commit -m &quot;some commit message&quot;#we can write a simple commit msg like above, but a better way is #write more info about this commit for us or other to understand.git commit#without any command will raise a text editor for us to write commit#message, the recommand form is:summary infotitle of this change- why change- other affect or notice\n\n\nNotice:\nWe can escape add step, combine add and commit with one command: git commit -a -m &quot;commit msg&quot;\n\nSPECIFY WHICH SSH KEY PAIR SHOULD BE USEDwhen already have a local git repoIf we have more than one repo in github and need to sync to local, we will get a problem: each repo needs different ssh keys, but usually we run ssh-keygen only create one key. So how can we produce different keys and let local git repo knows which key should be used?\nThe method is specify the key should be used in git config\n# generate ssh key pair in different namessh-keygen # in our git repo run this commandgit config --local core.sshCommand &quot;ssh -i /path/to/private_key&quot;# or edit git configure file in git reponvim .git/configsshCommand = &quot;ssh -i /path/to/private_key\n\n\nTip: in this way, we can put ssh key pair in local git directory .ssh instead of home directory ~/.ssh. If we do it like this, we need add .ssh directory in .gitignore file, otherwise our key pair will shows in public, and it is a risk.\n\nspecify with each host/domainnameIf we have different host, this method is fine, but not suitable for github since all repo own one domainname.\n# create ssh key pair$user: ssh-keygen -f ~/.ssh/id_rsa_hexo# configure $user: nvim ~/.ssh/configHost github.com\tIdentityFile ~/.ssh/id_rsa_hexo\n\n\nspecify in command directlyIt is convenient for clone a new remote repo, without configuration file.\n$user: GIT_SSH_COMMAND=&quot;ssh -i ~/.ssh/id_rsa_example&quot; git clone example# or $user: GIT_SSH_COMMAND=&quot;ssh -i ~/.ssh/mysubdir/id_rsa -o &#x27;IdentitiesOnly yes&#x27;&quot; git push# if existed configuration file override this command, then give ssh an empty config file.$user: GIT_SSH_COMMAND=&quot;ssh -i ~/.ssh/id_rsa_example -F /dev/null&quot; git clone git@github.com:example/example.git\n\nROLLBACK CHANGESThere is always a way for us to rollback once we use git to track files.\n#rollback modified but not added to stage areagit restore [filename]#rollback file in stage areagit restore --staged [filename]#rollback stage area and modified at once to commitgit reset --hard#rollback last commit but keep all changesgit reset --soft HEAD^#rollback one version beforegit reset --hard HEAD^#rollback to sepecified commitgit reset --hard [hash id]#what if we did a wrong rollback, we just want recover to the newest commit?#we can also use hash id to recover if we remember, because git doesn&#x27;t delete it yetgit reset --hard [hash id]\n\n\n\nNotice:\nWe can get hash id with git log\n\nGET INFORMATION# show all the message we commitgit log# or only show simple nice onelinegit log --pretty=oneline\n\n\n\nuse github as remote repo本地使用git可以满足一个人的需求，如果在多个终端/多个人协作就需要一个公共访问的远端仓库，github就满足这个要求\n# at first create a empty repository in github , such as named test# second make sure locally has created a local repo and commited all the changes# checkout whether exists remote configuregit remote --verbose# then config remote repo&#x27;s info，where the url link finds will be described below# now we can use origin instead of the long url linkgit remote add origin &lt;https://github.com/your_github_username/test.git&gt;# push local to remote repo&#x27;s(origin) main branchgit push -u origin main\n\ngithub仓库的链接地址可以通过点击code找到\n\n或者直接在web的url后面添加.git即可\n\n通常会需要输入github的username，password。当然可以在github上进行配置省去输入:\n\n本地生成id_rsa.pub公钥并上传到github指定repo的配置中或者github的配置（适用于所有的repo）\n修改git remove中origin的url链接方式为ssh\n\n# first, create a ssh public key locally in ~/.ssh/id_rsa.pubssh-keygen# then add the content of ~/.ssh/id_rsa.pub to github config\n\n\n选择ssh方式\n\n修改本地remote link配置\n# first remove exist configgit remote remove origin# add ssh link to configurationgit remote add origin &lt;git@github.com:ssfwshutterbug/note.git&gt;\n\n然后就不需要输入username和password了\nclone from github existing repo前面是本地仓库同步到github，如果github仓库已有内容，那么只需要clone下来即可\n# the github repo link described above, use httpsgit clone &lt;https://github.com/your_github_username/test.git&gt;# use ssh link without username and password neededgit clone &lt;git@github.com:ssfwshutterbug/note.git&gt;# clone a specified branchgit clone --single-branch --branch &lt;main&gt; &lt;git@github.com:ssfwshutterbug/note.git&gt;\n\n\n\ncreate/delete branch分支通常作为beta测试，稳定后会融入stable版本main\n# create branchgit branch &lt;branch_name&gt;# display all the branchgit branch --list# change to specified branchgit checkout &lt;branch_name&gt;# delete a specified branchgit branch --delete &lt;branch_name&gt;\n\n删除github上的分支\n# locally delete github branchgit push origin --delete &lt;branch_name&gt;\n\n\n\nmerge branch切换到分支对其它的分支进行合并：只需记住从别的分支融合到当前分支（merge from）\n# merge to main and auto create a commit, has the ability to reversegit merge --no-ff -m &quot;your comments&quot;# simple merge without commit, cannot reverse, not suggestgit merge &lt;branch_name&gt;\n\n\n\nshow difference我们可以通过对比两个分支，两个commit，当前修改与最后一次修改的不同……\n# shou difference between now with last commitgit diff# or specified a file to comparegit diff &lt;file_name&gt;# show difference between two commitsgit diff &lt;uuid1&gt; &lt;uuid2&gt;# show difference between two branchsgit diff &lt;branch1&gt; &lt;branch2&gt;\n\n\n\n\n\ndiscusswhile pull main branch to local, show this error message:\ngit pull origin main    From github.com:ssfwshutterbug/note * branch            main       -&gt; FETCH_HEADfatal: refusing to merge unrelated histories\n\nfixed with below\ngit pull origin main --allow-unrelated-histories\n\n\n\ncredentialI am in a work with azure devops platform. And sometimes some users ask for my help of git authorized issues.\nThere are two ways that a user can be used to authorize:\n\nssh\nhttp\n\nwith ssh method, i clearly know that we need produce a pub key in local machine, and store the pub key to azure devops platform. After that we can download repository without username and password typing.\nhowever, i really don’t know how the way of http works. I searched online and get nothing. Until one day i see my teamwork to modify the username and password in control pannel, and i finally know that.\nThere are two ways of http authorization works:\n\nwith no configure, then we need to type username and password each time we download\nwith a credential helper, and this can be split with three methods:\ncache: store username and password in memory, with a timeout.\nstore: store username and password in a file, permanently.\nother softwares: in win10, is called manager. in win11, called manger-core\n\n\n\ncache and store methods will use the OS’s own ability to encrypt username and password\nwith configure, there are three kinds of level:\n\nsystem: write in /etc/gitconfig\nglobal: write in ~/.gitconfig\nlocal: write in repo’s .git/config\n\nthe low level can override the above level, for example: if we write a configre in local repo, then user local configure instead of system’s.\nand if no low level setting, the above level can be used by whole system.\n# list all system configgit config --system --list# list all global configgit config --global --list# list all local configgit config --local --listgit config --list# set win10 credential helper to managergit config --system credential.helper manager# set win11 credential helper to manager-coregit config --system credential.helper manager-core# and then we can find stored info in contrl pannel&#x27;s windows credental# set local credential helper to cache(default 900 seconds)git config credential.helper &quot;cache --timeout 900&quot;# clean cached username and passwordgit config --unset credential.helper# then reset to cachegit config credential.helper cache# or kill the processpkill git-credential-helper# if we set several method credential helper and want to cleangit config --unset-all credential.helper\n\n\nwhy we use git bash without configure and it used windows credential in default?\nbecause when we install git bash, there comes a config setting in default\n\n➜  task git:(main) ✗ git push -u origin mainTo github.com:ssfwshutterbug/task.git ! [rejected]        main -&gt; main (non-fast-forward)error: failed to push some refs to &#x27;github.com:ssfwshutterbug/task.git&#x27;hint: Updates were rejected because the tip of your current branch is behindhint: its remote counterpart. Integrate the remote changes (e.g.hint: &#x27;git pull ...&#x27;) before pushing again.hint: See the &#x27;Note about fast-forwards&#x27; in &#x27;git push --help&#x27; for details.\n\n➜  task git:(main) ✗ git push --prune --force -u origin mainEnumerating objects: 71, done.Counting objects: 100% (71/71), done.Delta compression using up to 4 threadsCompressing objects: 100% (66/66), done.Writing objects: 100% (66/66), 7.14 KiB | 1.78 MiB/s, done.Total 66 (delta 43), reused 0 (delta 0), pack-reused 0remote: Resolving deltas: 100% (43/43), completed with 4 local objects.To github.com:ssfwshutterbug/task.git + 8650aae...a134be4 main -&gt; main (forced update)\n\n\n\n\n","categories":["learn"],"tags":["git"]},{"title":"even-firefox-vim-extension","url":"/2022/11/01/even-firefox-vim-extension/","content":"EVEN THE FIREFOX VIM EXTENSIONYeah, this topic may seems a little weird, it is just a simple firefox extension called Vimium C, and i have to talk about it. Okay, i want to say it is not my problem, it is the extension itself makes thing awful, it has nearly zero key binding example, how do i know how to configure it? In that way i have to record some important things before i can get used to it.\nBy default K moves to next tab and J moves to previous tab, the logic makes me uncomfortable, it is different from VIM. Another is no or i don’t know the key of scroll page down/up.\nSo in its configuration page, i need rewrite this kind of key bindings.\nmap J nextTabmap K previousTabmap &lt;c-f&gt; scrollPageDownmap &lt;c-b&gt; scrollPageUpmap I focusInputmap c enterVisualMode mode=&quot;caret&quot;\n\ncaret mode is something we can show mouse position and scroll in lines, with v key pressing, can select words or lines.\n","categories":["uncle talk"],"tags":["firefox"]},{"title":"ip_route","url":"/2022/04/23/ip-route/","content":"IP addr and routeip address settingMost of time we login a new system, there has no ip address and we cannot connect to the web and also cannot download packages with package manager. At this time, we have so many methods to configure a system with ip address.\nif we have dhcpcd client or have network/NetworkManager installed\n\nthe easily way is using dhcpcd or dhcpcd network_interface command to get a dynamic ip address. for instance:\ndhcpcd # ordhcpcd wlan0\nif the system use network or NetworkManager to manage network, we can configure static or dynamic ip address. for instance:\ncat /etc/sysconfig/network-scripts/ifcfg-enp0s3TYPE=EthernetPROXY_METHOD=noneBROWSER_ONLY=noBOOTPROTO=static\t\t# static mathodDEFROUTE=yesIPV4_FAILURE_FATAL=noNAME=enp0s3UUID=9362a50a-b4fc-4943-ab54-a865b328ef0fDEVICE=enp0s3ONBOOT=yes\t\t\t\t# auto startIPADDR=10.10.10.10\t\t# ipPREFIX=24\t\t\t\t# netmaskGATEWAY=10.10.10.1\t\t# gateway\n\nor simple dynamic ip\ncat /etc/sysconfig/network-scripts/ifcfg-enp0s3TYPE=EthernetPROXY_METHOD=noneBROWSER_ONLY=noBOOTPROTO=dhcp\t\t\t# dhcp mathodDEFROUTE=yesIPV4_FAILURE_FATAL=noNAME=enp0s3UUID=9362a50a-b4fc-4943-ab54-a865b328ef0fDEVICE=enp0s3ONBOOT=yes\t\t\t\t# auto start\n\n\nNote: if we have a requirement of visiting website, we need set local DNS in /etc/resolv.conf \n​          eg: echo nameserver 192.168.31.1 &gt; /etc/resolv.conf\n\n\n\nif there has no dhcpcd and network/NetworkManager\n\nadd a ip address and route by hand\nip address add 192.168.31.33 dev enp0s3\n\nthen add route\nip route add 192.168.31.0/24 dev enp0s3\n\nadd nameserver\necho nameserver 192.168.31.1 &gt; /etc/resolv.conf\n\n\nNote: the configuration above we write is temporary, when we reboot the computer or restart network service the configuration will lost. \n\nIf we use network/NetworkManager, the way to store route configuration is writing command to /etc/sysconfig/network-scripts/route-*, store ip configuration is writing command to /etc/sysconfig/network-scripts/ifcfg-eth*.\nif we don’t use network service, the easiest way is writing commands to a start script such as .xinitrc or  setting a service with scripts to execute those commands.\n\n\nFor Example:\n# add ip addressip address add 192.168.31.31 dev enp0s3ip address add 10.10.10.10 dev enp0s3# add routeip route add 10.10.10.0/24 dev enp0s3ip route add 192.168.31.0/24 dev enp0s3ip route add default via 192.168.31.1 dev enp0s3# store route configurecat /etc/sysconfig/network-scripts/route-enp0s310.10.10.0/24 dev enp0s3192.168.31.0/24 dev enp0s3default via 192.168.31.1 dev enp0s3# store ip addresscat /etc/sysconfig/network-scripts/ifcfg-enp0s3IPADDR1=192.168.31.31PREFIX1=24GATEWAY1=192.168.31.1IPADDR2=10.10.10.10PREFIX2=24GATEWAY2=10.10.10.1\n\nTipsif there has more than one network device and we need to configure it by hand where can we  find network interface and mac address?\n if ip link show cannot find, we can find it in /sys/class/net.\nwhere to find network interface mac address?\nwe can find it in /sys/class/net/network_interface/address.\nip address aliaswe can add more then one ip address to a network interface using\nip address add 10.10.10.1 dev enp0s3\n\nit may look like this\n2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000    link/ether 08:00:27:a9:ce:40 brd ff:ff:ff:ff:ff:ff    inet 10.10.10.10/24 brd 10.10.10.255 scope global enp0s3       valid_lft forever preferred_lft forever    inet 192.168.31.33/32 scope global enp0s3       valid_lft forever preferred_lft forever    inet6 fe80::a00:27ff:fea9:ce40/64 scope link        valid_lft forever preferred_lft forever\n\n\n\nor we can use ip alias by using\nip address add 12.12.12.12/24 dev enp0s3 label enp0s3:1\n\nit may look like this\n2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000    link/ether 08:00:27:a9:ce:40 brd ff:ff:ff:ff:ff:ff    inet 10.10.10.10/24 brd 10.10.10.255 scope global enp0s3       valid_lft forever preferred_lft forever    inet 192.168.31.33/32 scope global enp0s3       valid_lft forever preferred_lft forever    inet 12.12.12.12/24 scope global enp0s3:1\t# alias       valid_lft forever preferred_lft forever    inet6 fe80::a00:27ff:fea9:ce40/64 scope link        valid_lft forever preferred_lft forever\n\nthe way to save ip alias configure is\ncd /etc/sysconfig/network-scripts/cp ifcfg-enp0s3 ifcfg-enp0s3:1cat ifcfg-enp0s3:1IPADDR=12.12.12.12PREFIX=24GATEWAY=12.12.12.1\n\n\n\n\n\nnat 路由转发可以连接外网的网段是192.168.31.0/24，自己组建局域网的网段是10.10.10.0/24，要用一个linux主机做路由转发，让10.10.10.0/24网段的主机可以连接外网。\n设备\n一台做路由的linux主机，有两张网卡，分别为192网段和10网段ip\n其它10.10.10.0/24网段的主机\n\n步骤用virtualbox启动两个centos7的系统：centos-nat分配两张网卡，centos7.1分配一张网卡。\ncentos-nat需要关闭默认的防火墙firewalld，然后才能使用iptables\ncentos-nat\n# centos-nat步骤## 设置ipip address add 192.168.31.33/24 dev enp0s3ip address add 10.10.10.10/24 dev enp0s8## 设置路由ip route add 192.168.31.0/24 dev enp0s3ip route add 10.10.10.0/24 dev enp0s8ip route add default via 192.168.31.33 dev enp0s3## 关闭防火墙systemctl stop firewalld## 开启路由echo 1 &gt; /proc/sys/net/ipv4/ip_forward## 设置iptables nat转发策略iptables -t nat -A POSTROUTING -o enp0s3 -j MASQUERADE\n\ncentos7.1\n# centos7.1步骤## 设置ipip address add 10.10.10.11/24 dev enp0s3## 设置默认路由ip address add default via 10.10.10.10 dev enp0s3## 设置DNS解析echo nameserver 192.168.31.1 &gt; /etc/resolv.conf\n\n然后centos7.1（10.10.10.0/24的主机）就可以连接外网了,done.\n","categories":["learn"],"tags":["route"]},{"title":"iptables","url":"/2022/04/23/iptables/","content":"IPTABLESiptables is a powerful tool(front of kernel netfilter module) to manually change the way that network connection of our computer. we can do everything with the network connection such as port forward, nat network transfer, load balancer and etc.\ntablesas first we need to know that there are 5 tables for us to store our ip table rules:\n\n\n\ntable\naims\n\n\n\nraw\nexempt from connection tracking\n\n\nfilter\ncommon to adjust input and output policy\n\n\nnat\ncommon to do network address translation\n\n\nmangle\nspecialized packet alterations\n\n\nsecurity\nsecurity access\n\n\nthe most important thing is that the life of packet working though isn’t from one table to another table, so, table is just a group of rules that have the same effective function. in order to make the configuration much easier, there comes chain concept. each table has different chains.\nstartup and savein my archlinux, it isn’t enabled by default.\n# enable iptables and startsudo systemctl enable --now iptables\n\nterminal setting of iptables will not store in disk, in order to make it effect after reboot we need to save it.\nsudo iptables-save -f /etc/iptables/iptables.rules\n\nin general, we don’t modify this file directly. however if we do that a reload is needed.\nsudo iptables-restart /etc/iptables/iptables.rules\n\n\n\nlist rules--list: list all rules with DNS resolve, don’t use this along since it will display for a long time.\n--numeric: don’t resolve DNS, display ip directly.\n--list-rules: list all origin commands.\n--line-number: list rules with line number.\n--verbose: show packet account.\nsudo iptables --table filter --list --numericsudo iptables --table nat --list --numeric --line-numbersudo iptables --table mangle --list-rules\n\n\nNote:\nuse list with numeric together, or it will spend lots of time to reverse ip address to DNS/hostname\n\nimport modulesIn iptables, there are lots of modules we can use. For example --protocol tcp will import a module named tcp in backend. If we want to use other modules, we can use --module module_name to import.\nModule comment is very useful for us to add a comment to a rule in case of forgotten.\nsudo iptables --table filter --append FORWARD --jump DROP --module comment --comment &quot;disable all forward traffice by default&quot;\n\n\n\n\n\ndisable input requestin order to enhance personal PC security, i want to disable all request to my PC but only allow local area ssh connect.\nif i disable all input traffic, though all output traffic is allowed i cannot access any web site via browser. The reason is that when i send a request to remote web server, the remote server need reply the information that i need, but i already disabled all input traffic, so i cannot visit any web site. Since all connection have a state, if the connection is established, the state will be changed. So i can use this feature.\n# disable all input traffic by defaultsudo iptables --table filter --policy INPUT DROP# allow established connectionsudo iptables --table filter --append INPUT --module state --state ESTABLISHED --jump ACCEPT --module comment --comment &quot;allow established connection&quot;# allow local area network ssh connectinsudo iptables --table filter --append INPUT --protocol tcp --dport 22 --jump ACCEPT --module comment --comment &quot;allow local area network ssh connection&quot;\n\n\n\n\n\nflush old rule and modify default chain policywe can choose which one to flush, all table/ one table/ a chain?\n# flush all tablesudo iptables --flush# flush specified tablesudo iptables --table [table_name] --flush# flush specified table&#x27;s chainsudo iptables --table [table_name] --flush [chain_name]\n\nthere are two ways to change the default chain policy:\n\ndirectly change chain policy\nadd a global policy at the end of one chain\n\n# eg: change default ACCEPT to DROP of filter table INPUT chainsudo iptables --table filter --policy INPUT DROPsudo iptables --table filter --append INPUT --jump DROP\n\n\n\nNAT tablelearn from youtube video. net table is used to forward packet, much powerful in port forward, ip forward, even load balance.\nport forwardall traffic coming to local network will work though nat’s PREROUTING chain. in this chain, we can modify access port to other port realizing port forward.\nfor example i want other people access my PC’s 8080 port to really visit 80  port.\nsudo iptables --table nat --append PREROUTING --protocol tcp --dport 8080 --jump REDIRECT --to 80 --module comment --comment &quot;redirect 8080 to 80 port&quot;\n\nnow other people visit my PC’s 8080 port will redirect to 80 port.\nit is very useful, yeah? one hand, we can enhance security, on the other hand, we can start several same applications with different ports in one machine.\nip forward\n环境：192.168.31.235主机安装了nginx服务，可以进行web页面80端口访问。现在需要在192.168.31.31（本机）访问192.168.31.114的80端口来间接访问192.168.31.235的nginx服务\n所有iptables策略在转发192.168.31.114主机上进行配置\n# 将来自114：80端口的请求转发到235:80端口iptables --table nat \\--append PREROUTING \\--protocol tcp \\--dport 80 \\--destination 192.168.31.114 \\--jump DNAT \\--to-destination 192.168.31.235:80# 将转发到235:80端口的数据源地址31（本机）地址修改为114iptables --table nat \\--append POSTROUTING \\--protocol tcp \\--dport 80 \\--destination 192.168.31.235 \\--jump SNAT \\--to-source 192.168.31.114\n\n\nNote: \n默认主机的ip转发是关闭的，需要手动开启。如果需要永久开启需要在/etc/sysctl.conf中添加\nnet.ipv4.ip_forward=1\n\necho 1 &gt; /proc/sys/net/ipv4/ip_forward\n\n\n\n","categories":["learn"],"tags":["iptables"]},{"title":"haskell","url":"/2022/04/23/haskell/","content":"HASKELLwhat is haskell?Haskell is a purely functional programming language. don’t tell the computer what to do as such but rather you tell it what stuff is\nfeature\nunchangeable variable \nno side-effects\npure function\nfunction must return value\ntype static\ncompile language\nlazy calculate\nelegant and concise\n\nenvironmenthaskell的环境搭建包含了三个部分：\n\n编译器\n\n编译器使用ghc或者hugs（在使用包管理器或安装脚本时会自动安装）\n\n\n模块\n模块安装有多种方法：\n\n如果是使用debian，ubuntu等操作系统，包管理器提供的有完整安装包，这种安装方式会自动安装后面代码提示所需要的后台服务\n\n如果所使用的系统不在列表中，可使用官方提供的一键安装脚本，安装所有组件，包含了ghc以及包管理cabal/stack（安装完有2Gib多的空间占用）\n\n如果觉得上面安装的文件太大，可使用系统提供的包管理器安装选择性的安装，例如archlinux可以直接使用pacman安装。我使用的就是这种方式，比较轻量，需要什么就安装什么。\n\n\n\n编辑器的代码提示\n包含两个部分：\n\n后台服务：模块安装后在vscode中编辑是没有代码提示的，因为还缺少一个haskell-language-server，这个软件会在后台提供自动补全等功能\npacman -S haskell-language-server\nIDE插件：vscode中安装对应的扩展插件：\n\n\n\n\n\nrun虽然haskell是编译型语言，但编译器提供了直接运行的方式。虽然速度比编译后的慢\nrunhaskell file.hs\n\n\n\n编译后运行\nhaskell的编译器有很多，但是这里使用ghc，archlinux下安装很简单:\npacman -S ghc\n\n\nNote: \n由于xmonad是使用haskell语言写的，所以安装xmonad时，已经安装了ghc，所以不需要再次下载了\n\n交互命令行\n输入ghci进入交互式界面，输入:quit进行退出\n➜  ~  ghciGHCi, version 8.10.4: https://www.haskell.org/ghc/  :? for helpPrelude&gt; :quitLeaving GHCi.Prelude&gt; :set prompt &quot;ghci &gt; &quot;ghci &gt;\n\nhaskell的脚本后缀为.hs，ghci中加载脚本文件为：:l file.hs. :r重新加载文件\narithmetic+\t--add-\t--subtract*\t--multiply/\t--dividemod\t--remainderrem\t--remainder\n\n\n\n\n\nboolean algebra与：&amp;&amp;\n或：||\n非：not\n等：==\n不等：/=\nghci &gt;&gt; False &amp;&amp; TrueFalseghci &gt;&gt; False || TrueTrueghci &gt;&gt; not FalseTrueghci &gt;&gt; 1 == 0Falseghci &gt;&gt; &quot;a&quot; == &quot;b&quot;Falseghci &gt;&gt; &quot;a&quot; == &quot;a&quot;True\n\n\n\n\n\nlist\nlist use []\nvalue in list must be the same type\nString is a syntactic sugar of list\nuse ++ put lists together\n++ method will work though the first list. however : cons will not\nlist can be compared if the stuff they contain can be compared\nuse !! to get element out of a list by index. the begin index is 0\nenumerated value can use .. to expand needed value\ndon’t use .. operation with float value\n[1..] explains all the values of nature\n_ will ignore one value (means drop)\n\nsome built in function:\nPrelude&gt; list = [1..10]Prelude&gt; head list1Prelude&gt; tail list[2,3,4,5,6,7,8,9,10]Prelude&gt; init list[1,2,3,4,5,6,7,8,9]Prelude&gt; last list10Prelude&gt; list !! 45Prelude&gt; length list10Prelude&gt; null listFalsePrelude&gt; reverse list[10,9,8,7,6,5,4,3,2,1]Prelude&gt; take 4 list[1,2,3,4]Prelude&gt; drop 4 list[5,6,7,8,9,10]Prelude&gt; maximum list10Prelude&gt; minimum list1Prelude&gt; sum list55Prelude&gt; product list3628800Prelude&gt; elem 5 listTruePrelude&gt; 5 `elem` listTrue\n\n\nNote:\nsome function be write in the middle of two value, such as `5 elem [1..10]`\n\n\n-- expand valuePrelude&gt; [1..10][1,2,3,4,5,6,7,8,9,10]Prelude&gt; [&#x27;a&#x27;..&#x27;z&#x27;]&quot;abcdefghijklmnopqrstuvwxyz&quot;Prelude&gt; [&#x27;A&#x27;..&#x27;Z&#x27;]&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;-- define stepsPrelude&gt; [1,3..20][1,3,5,7,9,11,13,15,17,19]Prelude&gt; [&#x27;A&#x27;,&#x27;D&#x27;..&#x27;Z&#x27;]&quot;ADGJMPSVY&quot;\n\n\nNote:\nreverse order list must define step\n\n\nPrelude&gt; [10..1][]Prelude&gt; [10,9..1][10,9,8,7,6,5,4,3,2,1]\n\n\nNote:\n`take` function is very important, it works well with haskell&#39;s lazy feather\n                                \n`take 5 [1,5..]`\n\n\nPrelude&gt; take 20 $ cycle [1..5][1,2,3,4,5,1,2,3,4,5,1,2,3,4,5,1,2,3,4,5]Prelude&gt; take 4 $ repeat [1..5][[1,2,3,4,5],[1,2,3,4,5],[1,2,3,4,5],[1,2,3,4,5]]Prelude&gt; replicate 20 1[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]\n\n\n\nlist comprehension\nlist comprehension allows us do more operations with each element or filter them and return a new list.\n\nNote:\n`[ return expression | variable &lt;- list, filter1, filter2]`\n                                \n`&lt;-` means bind each element to variable\n\n\nPrelude&gt; [ x^2 | x &lt;- [1..10]][1,4,9,16,25,36,49,64,81,100]Prelude&gt; [ x^2 | x &lt;- [1..10], x `mod` 3 /= 0][1,4,16,25,49,64,100]Prelude&gt; [ x^2 | x &lt;- [1..10], x `mod` 3 /= 0, x `mod` 2 == 0][4,16,64,100]Prelude&gt; [ x+y | x &lt;- [1..3], y &lt;- [(-1),(-2)..(-3)]][0,-1,-2,1,0,-1,2,1,0]\n\n\nNote:\nwe can use function to deliver list with parameter\n\n\nPrelude&gt; plus2 xs = [ x*2 | x &lt;- xs]Prelude&gt; plus2 [1..5][2,4,6,8,10]\n\n\nNote:\nwe can not only operator list itself, but also use list as a condition\n\n\nPrelude&gt; color xs = [ if x==0 then &quot;red&quot; else if x==1 then &quot;yellow&quot; else &quot;blue&quot; | x &lt;- xs, x==0 || x==1 || x==2]Prelude&gt; color [1,4,0,3,2,10][&quot;yellow&quot;,&quot;red&quot;,&quot;blue&quot;]\n\n\nNote:\nwe can use `_` to ignore some value\n\n\nPrelude&gt; length&#x27; xs = sum [ 1 | _ &lt;- xs]Prelude&gt; length&#x27; [1..10]10\n\n\nNote:\ndeal with list of lists\n\n\nPrelude&gt; lists = [[2,3,4],[3,4,5],[4,5,6]]Prelude&gt; [[x+1 | x&lt;-xs] | xs &lt;- lists][[3,4,5],[4,5,6],[5,6,7]]\n\n\n\ntuple\ntuple use ()\ncan contain different type values\ntuple’s type depend on the length of tuple (means different length of tuple stands of different type) and the type of tuple’s value\n\n\nNote:\n\ni still not find a good way to index the tuple, one way to index tuple is use _ to filter no needed data. one little complex way is using pattern match\n\nbut if the tuple only has two value, we can use two function get the value\n\n\n\nyohe = (20,170,&quot;12312823@gmail.com&quot;)-- define function with pattern matchgetAge xs =    let (age,_,_) = xs    in  print age-- haskell will return last value be default, so `print` is optionalgetScho0l xs = let (_,school,_) = xs in school-- a more convient way is getEmail (_,_,email) = email-- we can write above in a file, then we can call it by functiongetAge yohegetSchool yohegetEmail yohe\n\n\n\nPrelude&gt; yohe = (20, &quot;2398422@gmail.com&quot;)Prelude&gt; fst yohe20Prelude&gt; snd yohe&quot;2398422@gmail.com&quot;\n\n\nNote:\n`zip` to combine two list into one tuple\n                                \n`unzip` can abstract tuple into two list\n\n\nPrelude&gt; zip [1..10] [&#x27;a&#x27;..&#x27;z&#x27;][(1,&#x27;a&#x27;),(2,&#x27;b&#x27;),(3,&#x27;c&#x27;),(4,&#x27;d&#x27;),(5,&#x27;e&#x27;),(6,&#x27;f&#x27;),(7,&#x27;g&#x27;),(8,&#x27;h&#x27;),(9,&#x27;i&#x27;),(10,&#x27;j&#x27;)]Prelude&gt; a = zip [1..10] [&#x27;a&#x27;..&#x27;z&#x27;]Prelude&gt; unzip a([1,2,3,4,5,6,7,8,9,10],&quot;abcdefghij&quot;)\n\n\n\n\n\ntype and typeclassin other languages such as python, data also has type, if we write 1 - True in file will lead a error in compile time. so how about haskell? okay, we need to say in haskell everything has a type, data, function, expression (in fact, data is included in expression)\nPrelude&gt; :t 33 :: Num p =&gt; pPrelude&gt; :t sumsum :: (Foldable t, Num a) =&gt; t a -&gt; aPrelude&gt; :t (1+1)(1+1) :: Num a =&gt; a\n\nbenefit of type\n\ntype told the expression or function what data type it needs\nmake it much easier to know what the function/expression means while reading type define\ncheck syntax in compile time\n\n\nNote:\n\ntype is capital case in start : Int, Integer, Float, Double, Bool, Char, String\nuse :: to announce type definition\nuse -&gt; to separate parameters\nthere are two ways:\nwith function, function_name :: parameter1_type -&gt; parameter2_type -&gt; return_type\nwith data, data :: data_type\n\n\n\n\ngetEmail :: String -&gt; StringgetEmail xs = let (_,_,email) = xs in  emailPrelude&gt; 3 + 47Prelude&gt; 3 + 4 :: Float7.0\n\n\n\ntype variable\nsome functions not only allow one unchanged data type, this kind of function called polymorphic function. we need to use type variable, often use single lower case character (a~z). it stands for all kinds of types\n-- head allow String and Int type and others...Prelude&gt; :t headhead :: [a] -&gt; aPrelude&gt; head &quot;string&quot;&#x27;s&#x27;Prelude&gt; head [1..10]1Prelude&gt; head [1.0..10.0]1.0\n\n\n\ntypeclass\nA typeclass is a sort of interface that defines some behavior. If a type is a part of a typeclass, that means that it supports and implements the behavior the typeclass describes.\nPrelude&gt; :t (==)(==) :: Eq a =&gt; a -&gt; a -&gt; Bool\n\nEverything before the =&gt; symbol is called a class constraint. We can read the previous type declaration like this: the equality function takes any two values that are of the same type and returns a Bool. The type of those two values must be a member of the Eq class (this was the class constraint)\n\nwe use =&gt; to announce typeclass\n\nbasic typeclass:\nEq\t \t\tused for comparing:it&#x27;s implement has method of `==` `/=`Ord\t \t\tordering: `&gt;` `&lt;` `&gt;=` `&lt;=`Show\t\tpresent as string\t`show`Read\t\tread string and return a type of Read\t`read`Enum\t\tsequentially ordered types\t`succ` `pred`Bounded\t\thave an upper and a lower boundNum\t\t\tnumeric typeclassIntegral\tonly integral (whole) numbers\t`fromIntegral`Floating\tincludes only floating point numbers\nif one type belongs to one typeclass, then this type can act like other type the typeclass defined.\n-- 5 belongs to Num typeclass, so it can be Int or Float or DoublePrelude&gt; :t 55 :: Num p =&gt; pPrelude&gt; 5 :: Int5Prelude&gt; 5 :: Float5.0Prelude&gt; 5 :: Double5.0\n\n\nNote:\n\nlength function will return a Int value, which may lead many inconvenient\nPrelude&gt; :t lengthlength :: Foldable t =&gt; t a -&gt; Int                                Prelude&gt; length &quot;hello&quot; + 4.5                                &lt;interactive&gt;:235:18: error:    • No instance for (Fractional Int) arising from the literal ‘4.5’    • In the second argument of ‘(+)’, namely ‘4.5’      In the expression: length &quot;hello&quot; + 4.5      In an equation for ‘it’: it = length &quot;hello&quot; + 4.5\n\nso why fromIntegral comes up\nPrelude&gt; :t fromIntegralfromIntegral :: (Integral a, Num b) =&gt; a -&gt; bPrelude&gt; fromIntegral (length &quot;hello&quot;) + 4.59.5\n\n\ntype annotations\nsome functions don’t know what kind of type it will return, so we need to tell it, that’s type annotations\nuse :: data_type after data\nPrelude&gt; :t readread :: Read a =&gt; String -&gt; aPrelude&gt; read &quot;3&quot; :: Int3\n\n\n\nfunction\nfunction will return last calculate value by default, so  return keyword is optiona\nreturn keyword only told function return a value rather than pause, so the code below return will run continue\nfunction name starts with lower case\nargs split with blank space\n\npattern matching\nmuch more different than any other languages, this feature in my opinion is really cool for it can do some match with parameters.\n-- how sum comes-- for list end with [], this may lead function runs error, with pattern match, we can avoid itsum&#x27; [] = 0-- with pattern match, we can sperate list into two parts: head value and the rest of valuesum&#x27; (x:xs) = x + sum&#x27; xs\n\n-- without pattern match, function like thisyeho = (20，170，“293848389@gmail.com”)getEmail xs = let (_,_,email) = xs in email-- however we can directly match with parameter,cool?yeho = (20，170，“293848389@gmail.com”)getEmail (_,_,email) = email-- without pattern match, head like thishead&#x27; [] = error &quot;empty list&quot;head&#x27; x = x !! 0-- with parameter match, head like this, cool?head&#x27; [] = error &quot;empty list&quot;head&#x27; (x:_) = x\n\npattern matching also can act like if statement\ncolor 0 = &quot;red&quot;color 1 = &quot;yellow&quot;color 2 = &quot;blue&quot;color _ =  &quot;not origion triple color&quot;\n\n\n\nguard\nguards are a way of testing whether some property of a value (or several of them) are true or false. much more like if statement.\n\nno = sign after parameter\nuse | to sign begin\n\nadjudge :: (Ord a, Num a) =&gt; a -&gt; [Char]adjudge score    | score &gt;= 90 = &quot;perfect&quot;    | score &gt;= 80 = &quot;good&quot;    | score &gt;= 60 = &quot;not bad&quot;    | score &gt;= 0 = &quot;not pass&quot;    | otherwise = &quot;error score&quot;\n\notherwise is optional, but it is often useful for catching everything\nwith where we can also use local variables in guard\ntotal :: (Ord a, Num a) =&gt; a -&gt; a -&gt; a -&gt; [Char]total math english history    | score &gt; lineup = &quot;perfect&quot;    | score &gt; passline = &quot;good&quot;    | otherwise = &quot;hurry up&quot;    where score = math + english + history          lineup = 400          passline = 200 \n\n\nNote:\n\nthe indent below where is hard to specify, for it is not 2 tab but 6 blank space (1tab + 2black space)\nin where binding, we can define variable\nin where binding, we can use pattern match\nin where binging, we can use function\n\n\ntotal :: (Ord a, Num a) =&gt; a -&gt; a -&gt; a -&gt; [Char]total math english history    | score &gt; lineup = &quot;perfect&quot;    | score &gt; passline = &quot;good&quot;    | otherwise = &quot;hurry up&quot;    where score = math + english + history          (lineup,passline) = (400,200)\n\nimport Data.List.Splitemail :: [Char] -&gt; [Char]email addr    | end == &quot;gmail.com&quot; = &quot;gmail&quot;    | end == &quot;qq.com&quot; = &quot;qq&quot;    | end == &quot;163.com&quot; = &quot;163&quot;    | otherwise = &quot;error email address&quot;    where [_,end] = splitOn &quot;@&quot; addr -- run result*Main&gt; email &quot;20398442@qq.com&quot;&quot;qq&quot;\n\nzip&#x27; xs ys = [f x y | x &lt;- xs, y &lt;- ys]    where f x y = (x, y)\n\n\n\nlet works similar like where, but it can write in anywhere in function not only in the end\nsyntax: let binding in expression\nthe difference between let and where is that let binding itself is expression\n(let (a,b,c) = (1,2,3) in a+b+c) * 100\n\nif else statement is an expression and we can cram it in almost anywhere, so do let binding. and i wanna to say let binding is so flexible and cool\n-- simple calculate expression3 + (let a=2 in a^2) + 1-- list expression[ m | x &lt;- [1..10], let m = x * 2 + 1, m &gt; 8]-- function expressionlet add1 x = x + 1 in (add1 1, add1 2, add1 3)-- pattern matchlet (a,b,c) = (1,2,3) in a^2 + b^2 + c^2\n\n\n\ncase expressioncase is expression,so what about it? that means we can use pattern matching with case value\n-- syntaxcase expression of pattern -&gt; result\t\t\t\t   pattern -&gt; result\t\t\t\t   pattern -&gt; result\t\t\t\t   ...\n\nhead&#x27; :: [a] -&gt; ahead&#x27; xs = case xs of [] -&gt; error &quot;empty list&quot;                      (x:xs) -&gt; x\n\n\n\nrecursionfor haskell is a language that higher than any other languages, and it ignores how to do it but tells what it is, so the implementation of loop will be instead of recursion. that is why recursion so important in haskell.\nmax&#x27; :: Ord a =&gt; [a] -&gt; a -- edge condition with pattern matchmax&#x27; [] = error &quot;empty list&quot;max&#x27; [x] = xmax&#x27; (x:xs)-- don&#x27;t need to do loop condition, but to say head number greater than -- tail numbers (rest of the list number)    | x &gt; restList = x    | otherwise = restList    where restList = max&#x27; xs\n\ntake&#x27; :: Int -&gt; [a] -&gt; [a]take&#x27; _ [] = []take&#x27; n (x:xs)    | n &lt;= 0 = []    | otherwise = x : take&#x27; (n-1) xs\n\nreverse&#x27; :: [a] -&gt; [a]reverse&#x27; [] = []reverse&#x27; (x:xs) = reverse&#x27; xs ++ [x]\n\nrepeat&#x27; :: a -&gt; [a]repeat&#x27; x = x:repeat&#x27; x\n\n-- notice the type definezip&#x27; :: [a] -&gt; [b] -&gt; [(a,b)]zip&#x27; [] _ = []zip&#x27; _ [] = []zip&#x27; (x:xs) (y:ys) = (x,y) : zip&#x27; xs ys\n\nelem&#x27; :: Eq a =&gt; a -&gt; [a] -&gt; Bool elem&#x27; m [] = Falseelem&#x27; m (x:xs)     | m == x = True     | otherwise = elem&#x27; m xs\n\ndropBlank&#x27; :: String -&gt; StringdropBlank&#x27; [] = []dropBlank&#x27; (x:xs)    | x == &#x27; &#x27; = &quot;&quot; ++ dropBlank&#x27; xs    | otherwise = x:dropBlank&#x27; xs\n\n\n\nquick sort\nquicksort :: Ord a =&gt; [a] -&gt; [a]quicksort [] = []quicksort (x:xs) =    let smallsort = quicksort [m | m &lt;- xs, m &lt;= x]        bigsort = quicksort [m | m &lt;- xs, m &gt; x]    in smallsort ++ [x] ++ bigsort\n\n\n\n\n\nmodules importsyntax for importing modules\n-- in haskell file-- in this way, we can call the module&#x27;s function name directlyimport module_name-- in ghci:m + module_name-- import some of function in moduleimport module_name (func1,func2)-- import all function in module expect someoneimport module_name hiding (func)-- in some case, two or more modules contains the function with the same name-- in order to distinguish the function, we can use qualified keyword-- if the module imported with qualified, the way to call function need to -- be prefixed with module nameimport qualified module_name-- call functionmodule_name.func-- in order to simplify above calling style, we can use alias to instead the -- long syntax of calling functionimport qualified module_name as alias_name-- call functionalias_name.func-- eg:import qualified Data.Map as MM.filter\n\n\n\n\n\nhigher order functioncurried function\nanother part that function program is different with other language is curried function (one function takes more than one parameters). it is a concept  which helps us to think functions in another way. in order to understand the concept, we need to know the following point:\n\nputting a space between two things is simply function application\nevery function in haskell officially only takes one parameter\nif a function need more than one parameters, the one we write that function with too few parameters is called function on the fly (or called partial application) . we can pass it to another function as parameter\n\nso, we may though, okay, i know that’s it, and what does it helpful for my coding? let’s see this function and you will understand how powerful this concept\n-- * is also a function which need two parameters-- (*2) is a function on the flyplus2 xs = map (*2) xs-- / is a function which need two parameters-- (/10) is a function on the flydivideByTen x = (/10) x\n\nif without curried function, above may need to be write as this\nsum&#x27; (x:xs) = x + sum&#x27; xsplus2 xs = map (\\x -&gt; x*2) xs\n\nwith this concept we can though a function with many parameters is a function take one parameter then return a new function, the new function takes another parameter and then return a new function and so on…\nmultithree :: Num a =&gt; a -&gt; a -&gt; a -&gt; amultithree x y z = x * y * z-- with curried function concept, we can write type as thismultithree :: Num a =&gt; a -&gt; (a -&gt; (a -&gt; a))multithree x y z = x * y * z\n\n\nNote:\nfunction on the fly don’t means a function only takes one parameter,  it can take more than one parameter. both of them can be called function on the fly.\neg: multithree x is a function on the fly, multithree x y is also a function on the fly\n\nvariable name of function on the fly\nhave we notice that a function takes one (or more) parameter returns a new function, how great this means? now we can write above function like this:\nplus2 = map (*2)divideByTen = (/10)\n\n\nNote:\nit is not means we ignore function parameters, left side is just a new function name (yeah a variable)\nin this way, function can be greatly simplified.\n\nfunction as a parameter\nwe know that function can take function as parameter and also return functions\napplyTwice :: (a -&gt; a) -&gt; a -&gt; a  applyTwice f x = f (f x)  -- then we can pass function to itapplyTwice (3:) 1\n\nnotice that the function we pass to it is a function on the fly. in this way we abstract function as a variable or called parameter, so we can pass different function to it.\nzipWith&#x27; :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]zipWith&#x27; _ [] _ = []zipWith&#x27; _ _ [] = []zipWith&#x27; f (x:xs) (y:ys) = f x y : zipWith&#x27; f xs ys\n\n\n\nhigher order function\n-- combine two list into one list with specified functionzipWith f x yzipWith&#x27; :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]zipWith&#x27; _ [] _ = []zipWith&#x27; _ _ [] = []zipWith&#x27; f (x:xs) (y:ys) = f x y : zipWith&#x27; f xs ys-- apply specified function to all elements of listmap f xmap&#x27; :: (a -&gt; b) -&gt; [a] -&gt; [b]map&#x27; _ [] = []map&#x27; f (x:xs) = f x : map&#x27; f xs-- filter all list elements to specified functionfilter f xfilter&#x27; :: (a -&gt; Bool) -&gt; [a] -&gt; [a]filter&#x27; _ [] = []filter&#x27; f (x:xs)    | f x = x : filter&#x27; f xs    | otherwise = filter&#x27; f xs\n\n\n\nlambda\nwe know higher order function need a parameter of function, normally, we pass a lambda to it.\n-- syntax(\\parameter1 parameter2 -&gt; function body)\n\n\nNote\npartial application can do the same thing as lambda when the function is simple. so consider use partial application first if it can\n\n-- we can do simple pattern match in lambdamap (\\(a,b) -&gt; a + b) [(1,2),(3,4),(4,5),(5,6)]\n\n\n\nfold\nsome functions encapsulate common pattern (x:xs) with edge condition (such as map) and return one value are called fold.\n-- fold function need a start value and a accumulator-- eg : start value &quot;False&quot; accumulator &quot;acc&quot;elem&#x27; :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool elem&#x27; m xs = foldl (\\acc x -&gt; if m == x then True else acc) False xs-- this function can be simplified to elem&#x27; :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool elem&#x27; m = foldl (\\acc x -&gt;  m == x || acc) False\n\nfoldl work though list from left, foldr work though list from right. \nsum&#x27; xs = foldl (\\acc x -&gt; acc + x) 0 xssum&#x27; xs = foldr (\\x acc -&gt; x + acc) 0 xs\n\nacc‘s position is very important.\n-- foldr will take start value as the second parametermap&#x27; f xs = foldr (\\x acc -&gt; f x : acc) [] xs-- foldl will take start value as the first parametermap&#x27; f xs = foldl (\\acc x -&gt; acc ++ [f x]) [] xs\n\nfoldl1 foldr1 almost the same as foldl foldr. only foldl1 and foldr1 take list’s first/last value as the starting value, so we don’t need to write. with this, we need to confirm the list is not empty, or it may crash\nsum&#x27; xs = foldl1 (\\acc x -&gt; acc + x) xssum&#x27; xs = foldr1 (\\x acc -&gt; x + acc) xs\n\n\n\nfunction application with $\nfunction application with $ is right-associative, which act as ()\nsum ([1..10] ++ [2..20])-- with $sum $ [1..10] ++ [2..20]\n\nfunction composition with .\nfunction composition with . compose two functions into one, and it is also right-associative\nf . g = \\x f (g x)\n\nmap (\\x -&gt; (+1) (x/10)) [1..10]map ((+1) . (/10)) [1..10]\n\n\nNote:\n\nthe principle that we can write compose function is the right function return value’s type is the same as left function parameter\n\nif the right function takes more than one value, we need pass other parameters to the function\n\n\n\nshow . replicate 3 . max 6 $ 8\n\n\n\n\n\n\n\n\n\ntype and typeclassso, what the data type can help me?\n\nwith value constructor, help me to store data with associate relationship and with default method to get them out\nwithout value constructor, help me to store data with the value name\n\ndata typehaskell has already provided us basic data type like Int, Float, Bool, String. we can also define ourself data type\n-- syntax: -- type_name should be capital casedata type_name = value_constructor\n\n\n\nvalue parameterafter value constructor, we can add some data types define the value it will contain\n-- Circle , Rectangle are value constructordata Shape = Circle Float Float Float | Rectangle Float Float Float Float \n\n\nNote:\n\nwe can thought value constructor as function, it returns a data type\n\nhowever we can not directly call value constructor, because it has no method to display our data.\n\nwe can apply deriving (basic typeclass) to data type, then the data type will has the properity of basic typeclass\n\nwe can use pattern match with value constructor\n\n\n\ndata Shape = Circle Float Float Float | Rectangle Float Float Float Float deriving (Show)surface :: Shape -&gt; Floatsurface (Circle _ _ r) = pi * r ^ 2surface (Rectangle x1 y1 x2 y2) = (abs $ x1 -x2) * (abs $ y1 -y2)\n\n*Main&gt; surface $ Circle 3 4 578.53982*Main&gt; Circle 3 4 5Circle 3.0 4.0 5.0\n\nfor value constructor can act as function, we can use partial application with it\n*Main&gt; map (Circle 3 4) [1..5][Circle 3.0 4.0 1.0,Circle 3.0 4.0 2.0,Circle 3.0 4.0 3.0,Circle 3.0 4.0 4.0,Circle 3.0 4.0 5.0]\n\n\nNote:\noften we write data type name  the same as value constructor name if there is only one value constructor\n\ndata Point = Point Float Float deriving (Show)\n\nwe can use the data type in other data type define\ndata Shape = Circle Point Float | Rectangle Point Point deriving (Show)\n\nin this way, we can make Shape data type more readable\nsurface :: Shape -&gt; Floatsurface (Circle _ r) = pi * r ^ 2surface (Rectangle (Point x1 y1) (Point x2 y2)) = (abs $ x1 -x2) * (abs $ y1 -y2)\n\n\n\nrecord syntaxthe way above data type define is not bad, but there are some inconvenient : \nsuch as :\n\nhow to get the value of a data type?  \n\nhow to easily distinguish each value?\n\n\n-- sign each type a variable name, seperate with commadata Person = Person &#123; age :: Int                       , height :: Float                       , phoneNumber :: String                       &#125; deriving (Show)   \n\nBy using record syntax to create this data type, Haskell automatically make these functions with the name of type name: age height phoneNumber\n\nNote:\nwith the default method, we can get specified value we need out of the data type\n\njohn = Person &#123;age=20, height=170, phoneNumber=&quot;2837109292&quot;&#125;*Main&gt; age john20*Main&gt; phoneNumber john&quot;2837109292&quot;class = map (Person 20 170) [&quot;4532232&quot;, &quot;9023482&quot;, &quot;0923842&quot;]*Main&gt; map phoneNumber classes[&quot;4532232&quot;,&quot;9023482&quot;,&quot;0923842&quot;]*Main&gt; phoneNumber $ classes !! 0&quot;4532232&quot;\n\n\n\n\n\ntype parameterthe same as value parameter,  type constructors can take types as parameters to produce new types\n-- eg: a after Maybe is a type parameterdata Maybe a = Nothing | Just a  \n\nwith a parameter, we call data type as data constructor\nthe benefit of type parameter is that the data type depends on what we pass to it.\ndata Person a b c = Person &#123; age :: a                               , height :: b                               , phoneNumber :: c                               &#125; deriving (Show) \n\nwithout value constructor store data with value name\ndata Day = Monday | Tuesday | Wednesday | Thursday | Friday | Saturday | Sunday   \tderiving (Eq, Ord, Show, Read, Bounded, Enum)  \n\nMonday --with Show, call directlyMonday == Monday --with Eq, compare directlyread &quot;Monday&quot; :: Day --with Read, convert value from StringMinBound --with Bounded, get min/max value[Monday..Sunday] --with Enum, list range with value\n\n\n\ntype synonymsdata type’s alias, with it we can make our type declaration more clearly\n-- String is alias of [Char]type String = [Char]\n\n-- can have parameterstype AssocList k v = [(k,v)]  -- can partically apply type parameterstype IntMap v = Map Int v  -- or ignoretype IntMap = Map Int  \n\n\n\n\n\n\n\nthird modulehaskell官方提供了丰富的模块，可以根据需要选择对应的模块进行下载。\nShell Scripthaskell的turtle模块嵌入了shell脚本，实现了很多的unix命令，方便我们使用haskell写shell脚本。同时还支持直接调用系统的命令\n# install turtle in archlinuxpacman -S haskell-turtle\n\nprint text to screen\n-- 不使用turtle模块,使用内置的System.IOmain = do\tputStrLn &quot;hello world!&quot;\tprint &quot;hello world!&quot;\t-- 使用turtle模块的echo命令import Turtuleimport qualified Data.Text as Timport Data.Maybemain = do\t-- echo 需要Line数据类型,使用repr可获得Line\techo $ repr &quot;hello world!&quot;\t-- 或者使用Data.Text来获取Text，使用textToLine获取Maybe Line,使用fromJust 获取Line\t-- 需要导入Data.Maybe Data.Text\techo $ fromJust $ textToLine $ T.pack &quot;hello world!&quot;\n\n上面这种方式太麻烦，实际上是在文件开头添加&#123;-# LANGUAGE OverloadedStrings #-&#125;，这样String会成为Text类型\n&#123;-# LANGUAGE OverloadedStrings #-&#125;import Turtlemain = do    shell &quot;ls -alh /home&quot; empty\n\n\n\n\n\nget command output\nimport Turtlemain = do    dir &lt;- pwd     echo $ repr dir    time &lt;- date     echo $ repr time\n\n\n\nexecute system command\nimport Turtleimport qualified Data.Text as Tmain = do\t-- 打开浏览器\t-- shell需要接受一个Text数据类型\tlet cmd = T.pack &quot;firefox&quot;\tshell cmd empty\t\t-- ps查看进程\tshell (T.pack &quot;ps -ef |grep firefox&quot;)  empty\t\t-- 调用ls命令，内置的ls命令无法添加参数，使用这种方式可以加参数\tshell (T.pack &quot;ls -alh $HOME&quot; |grep rc)  empty\n\n\n\n\n\nErrorproblem of dynamic linkErr：vscode中运行正常，但是编译报错无法找到Prelude\n\nCause: ghc 8.0.2-1版本只支持动态链接库，而编译默认使用的是静态链接。\nFix:\n\n编译的时候添加动态链接参数\nghc --dynamic file_name.hs\n\n为了方便，可以用alias重写ghc\n# add to ~/.zshrcalias ghc=&quot;ghc -dynamic&quot;\n\n\n\n\n配置cabal/stack使用动态库，配置方法参考arch wiki\n\n\n\ncannot find module which has been installedErr: 使用cabal安装模块后，依然无法导入，报错无法找到模块\nCause: 在安装cabal之前系统已经存在ghc，导致安装cabal时编译的是系统的ghc\nFix：解决方法很简单，使用系统的ghc就可以了（注释掉安装时配置的环境变量）\n","categories":["learn"],"tags":["haskell"]},{"title":"go","url":"/2022/04/23/go/","content":"GOinstallfollow this document, download compressed file and extract to the place where application stores.\n# i install go in .local/apps.tar -xzf Downloads/go1.16.3.linux-amd64.tar.gz -C .local/apps\n\nconfigure go env\n# add to /etc/profile or ~/.zshrc. i put it in .xinitrcexport PATH=$PATH:/home/blueocean/.local/apps/go/bin\n\nafter source configure file we can check whether it makes effect\ngo env\n\nconfig workspaceGOPATH is the place of our workspace which can be find by running go env, we can change it by running\ngo env -w GOPATH=&quot;$HOME/Public/code/go&quot;\n\nthe command will write go environment variable to ~/.config/go/env file.\nbelow is the standard workspace structure\nPublic/code/go├── bin├── pkg└── src    └── github.com        └── blueocean            └── go_project_1                └── helloworld                    └── main.go\n\n\nbin: compiled file stores, when we run go install xx.go will create binary file to the folder\npkg: other people package, the package/module we download will store in the folder\nsrc: source code file, the place we write go code\n\nwhy there are github.com/username? it is useful when we work in a team. the folder name is the same as github.\nvscode go plugini will write code with vscode editor, first install go extension. then when we write go code, there will be a prompt suggests us to install other extensions. and just click install all. however it may failed because we can not access github file in our country.\nbut there comes a method can resolve this problem with proxy. goproxy.io is a proxy of go\ngo env -w GO111MODULE=ongo env -w GOPROXY=https://goproxy.io,direct\n\nthen reinstall all will be fine\n\nNote:\nwhile install go plugin, there comes a error message: Writing login information to the keychain failed with error ‘The name org.freedesktop.secrets was not provided by any .service files’.\nresolve method:\nsudo pacman -S gnome-keyring libsecret\n\nrun or compile filethough go is a compile language, go tools allow us to run code without compile. we can just type\ngo run go_file.go\n\nif we wanna to compile it to binary file\n# this will product a binary file in current locationgo build go_file.go\n\nwe can also compile file with go install, and it will put binary file to bin directory\ngo install go_file.go\n\nhello worldpackage mainimport &quot;fmt&quot;func main() &#123;    fmt.Println(&quot;hello world!&quot;)&#125;\n\nwe need to know that in an application there are many go files and each of them need to belong to a package. the name of package can be customized, however there must to be a package name main for progarm will start running with this file. and there must be a function named main for program will start running with main function.\nwe can import other packages by keyword import. neither build in packages or download from internet with go get\nimport &quot;fmt&quot;import &quot;math&quot;// or use parenthenseimport (    &quot;fmt&quot;    &quot;math&quot;)\n\nnaming rulein Go, a name is exported if it begins with a capital letter.\n\nfunction name and variable always begins with lowercase。\nexcept the package need to be imported by other packages as a module, then function name begin with capital letter\n\nconstanthe value that can not be changed is called constan. we can define it by const\nconst name = &quot;john&quot;\n\nvariablesas we know go is a compile language, we need to define a variable before we use it.\nthere are two principles we need follow:\n\ndefine a variable before we use it.\nevery defined variable need to be used\n\nthere are three ways to define a variable:\n\nuse var keyword\nvar variable_name type\n\neg:\nvar name stringvar age intvar high float32var ptr *int\ninitialize without type\nvar variable_name = value\n\neg:\nvar name = &quot;Azon&quot;var age = 12var ptr = &amp;age\ninside function use short sign\n\nNote:\nthis method can only used inside function\n\nvariable_name := value\n\neg:\nname := &quot;Azon&quot;age := 12ptr = &amp;age\n\ndefine same type variables in one line\nvar name, age int\n\ndefine serveral variables with parentheses\nvar (    name string    age int    ptr *int)// or sign valuevar (    name = &quot;Azon&quot;    age = 12    ptr = &amp;age)\n\n\nnote:\n​    second and third used often. and third can only be used in function\n\nbasic typeboolstringint  int8  int16  int32  int64uint uint8 uint16 uint32 uint64 uintptrbyte // alias for uint8rune // alias for int32     // represents a Unicode code pointfloat32 float64complex64 complex128\n\narraythe length of array is part of array’s type. and the size can not be changed\ndefine array with fixed size\nvar array_name [length]type\n\ndefine array with values\nvar array_name = [length]type &#123;value1, value2...&#125;// or use `...`, in this way the length of array is the initial length of value elements. it may common to usevar array_name = [...]type&#123;v1,v2,v3,v4&#125;\n\nuse short syntax\narray_name := [length]type &#123;value1, value2...&#125;\n\nchange array value\nnums := [2]int&#123;1, 2&#125;nums[0] = 2\n\narray index\narr[0] //firstarr[len(arr)-1] //last\n\ntwo ways to loop array value\npackage mainimport (    &quot;fmt&quot;)func main() &#123;    dataJson := [...]string&#123;&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;&#125;    // range    for _, v := range dataJson &#123;        fmt.Println(v)    &#125;    // index    for i := 0; i &lt; len(dataJson); i++ &#123;        fmt.Println(dataJson[i])    &#125;&#125;\n\ncompare two arrays\nif the element type of the array is comparable, then the array type is also compartable\npackage mainimport &quot;fmt&quot;func main() &#123;    arr1 := [...]int&#123;1, 2, 3&#125;    arr2 := [3]int&#123;1, 2, 3&#125;    fmt.Println(arr1 == arr2)&#125;\n\nsliceslice is the reference of array, it doesn’t store any data but the describe of data. \n\nno specified size\nchange slice will change array which slice describes\n\ndefine array with changeable length\nslice []type&#123;v1,v2,v3&#125; truely creates an array [3]type&#123;v1,v2,v3&#125; and then builds a slice that references it\nvar slice_name = []type&#123;value1, value2...&#125;// orslice_name := []type&#123;value1, value2...&#125;// use pointerslice_name := &amp;[]type&#123;&#125;// specified with exist arrayvar array_name = [3]int&#123;v1,v2,v3&#125;slice_name1 := array_name[0:2]slice_name2 := array_name[:]slice_name3 := array_name[0:]slice_name4 := array_name[:2]// use make to create sliceslice_name := make([]type, len_of_array, cap_of_array)// eg:num := make([]int, 0, 5)\n\npackage mainimport &quot;fmt&quot;func main() &#123;    var num = [4]int&#123;1, 2, 3, 4&#125;    a := num[0:4]    a[0] = 8    fmt.Println(num)&#125;//[8 2 3 4]\n\nadd value to changeable length array\nnums := []int&#123;1, 2&#125;nums = append(nums, 3)\n\nslice has length and capacity\n\nThe length of a slice is the number of elements it contains.  \n\nThe capacity of a slice is the number of elements in the underlying array,     counting from the first element in the slice.  \n\n\nvar sum = []int&#123;1, 2, 3, 4, 5&#125;num := sum[:0]fmt.Println(len(num), cap(num))\n\nslice of slice\npackage mainimport &quot;fmt&quot;func main() &#123;    nums := [][]int&#123;        []int&#123;&#125;,        []int&#123;&#125;,        []int&#123;&#125;,    &#125;    fmt.Println(nums)&#125;// [[] [] []]\n\nnilThe zero value of a slice is nil.  \nA nil slice has a length and capacity of 0  and has no underlying array.  \npackage mainimport &quot;fmt&quot;func main() &#123;    var num []int    if num == nil &#123;        fmt.Println(num, len(num), cap(num))    &#125;&#125;\n\nrange_ used to ignore some value\npackage mainimport &quot;fmt&quot;func main() &#123;    nums := [][]int&#123;        []int&#123;1, 2, 3&#125;,        []int&#123;4, 5, 6&#125;,        []int&#123;7, 8, 9&#125;,    &#125;    fmt.Println(nums)    for _, v := range nums &#123;        fmt.Println(v)    &#125;&#125;\n\nmap// define syntaxvar map_name = make(map[key_type]value_type)\n\nvar student = make(map[string]int)student[&quot;xiaozhan&quot;] = 23student[&quot;xiaoli&quot;] = 22fmt.Println(student, student[&quot;xiaozhan&quot;])// without definevar student = map[string]int&#123;    &quot;xiaozhan&quot;: 23,    &quot;xiaoli&quot;:   22,&#125;fmt.Println(student, student[&quot;xiaozhan&quot;])\n\nhowever the way map most useful is combining with struct\nimport &quot;fmt&quot;type People struct &#123;    name      string    age       int    graduate  bool    email     string    address   string    telephone string&#125;func main() &#123;    var student = map[int]People&#123;        1: &#123;&quot;xiaozhan&quot;, 12, true, &quot;129381@qq.com&quot;, &quot;China&quot;, &quot;1337649393&quot;&#125;,        2: &#123;&quot;johnsemi&quot;, 23, false, &quot;johnsemi@gmail.com&quot;, &quot;American&quot;, &quot;98234222&quot;&#125;,    &#125;    // update value    student[1] = People&#123;&quot;xiaozhan&quot;, 18, true, &quot;129381@qq.com&quot;, &quot;China&quot;, &quot;1337649393&quot;&#125;    fmt.Println(student[1].age)    // delete element    delete(student,2)    // check whether key exist    _, exist := student[2]    fmt.Println(exist)&#125;\n\n\nNote: \ncan’t change values associated with keys in a map, only if we use pointer\n\npackage mainimport &quot;fmt&quot;type People struct &#123;    name      string    age       int    graduate  bool    email     string    address   string    telephone string&#125;func main() &#123;    var student = map[int]*People&#123;        1: &#123;&quot;xiaozhan&quot;, 12, true, &quot;129381@qq.com&quot;, &quot;China&quot;, &quot;1337649393&quot;&#125;,        2: &#123;&quot;johnsemi&quot;, 23, false, &quot;johnsemi@gmail.com&quot;, &quot;American&quot;, &quot;98234222&quot;&#125;,    &#125;    student[1] = &amp;People&#123;&quot;xiaozhan&quot;, 18, true, &quot;129381@qq.com&quot;, &quot;China&quot;, &quot;1337649393&quot;&#125;    student[1].age = 22    fmt.Println(student[1].age)&#125;\n\nstructA struct is a collection of fields.  \n\nStruct fields are accessed using a dot.\nStruct fields can be accessed through a struct pointer.  and has a short write (*p).x with p.x\nStruct literal  used to make new data field\n\npackage mainimport &quot;fmt&quot;type People struct &#123;    name  string    age   int    email string&#125;func main() &#123;    no1 := People&#123;&quot;xiaoming&quot;, 12, &quot;823739@qq.com&quot;&#125;    no2 := People&#123;name: &quot;xiaozhan&quot;, age: 13&#125;    no3 := &amp;People&#123;age: 12&#125;    fmt.Println(no1, no1.age+no2.age, no3.age)&#125;\n\nfor loopin golang, there is no while loop, however for loop can do the same thing as while.\n// infinite loopfor &#123;&#125;// for eachfor i,v := range xxx &#123;&#125;// break or continuefor &#123;    if ...... &#123;        break    &#125; else &#123;        continue    &#125;&#125;\n\nbasic functionthe way to define function with keyword func\nfunc func_name(arg type) return_type &#123;    //function content&#125;// more than one return value use `()`func func_name(arg1 type, arg2 type) (return_type, return_type) &#123;    //function content&#125;// named return// combine same typefunc func_name(arg1, arg2 type) (x,y return_type) &#123;    x = xxx    y = xxx    return&#125;\n\neg:\npackage mainimport (    &quot;fmt&quot;)func sum(a, b int) int &#123;    return a + b&#125;func reverse(a, b string) (string, string) &#123;    return b, a&#125;func minormax(a, b int) (max1, min1 int) &#123;    var max, min int    if a &gt; 0 &amp;&amp; b &gt; 0 &#123;        if a &gt; b &#123;            max = a            min = b        &#125; else &#123;            max = b            min = a        &#125;        for i := min; i &gt; 1; i-- &#123;            if max%i == 0 &amp;&amp; min%i == 0 &#123;                max1 = i            &#125;        &#125;        for i := max; i &gt; 0; i++ &#123;            if i%max == 0 &amp;&amp; i%min == 0 &#123;                min1 = i                // add break here or it cannot stop                break            &#125;        &#125;    &#125;    return&#125;func main() &#123;    a := sum(1, 2)    b, c := reverse(&quot;hello&quot;, &quot;world&quot;)    d, e := minormax(8, 10)    fmt.Println(a, &quot;\\t&quot;, b, c, &quot;\\t&quot;, d, e)&#125;\n\n... usagetwo ways:\n\npass ... before function input type: this way can let function accept values which the number we are not sure\npass ... after array/slice: this way can parse them out of array/slice without for loop\n\n// pass ... to function typepackage mainimport &quot;fmt&quot;func Sum(a ...float32) float32 &#123;    var sum float32 = 0    for _, v := range a &#123;        sum = sum + v    &#125;    return sum&#125;func main() &#123;    fmt.Println(Sum(56, 78, 60.5, 89.5, 93, 76))    // or     // fmt.Println(Sum(score...))&#125;\n\n// pass ... to array/slicepackage mainimport &quot;fmt&quot;func main() &#123;    score := []float32&#123;56, 78, 60.5, 89.5, 93, 76&#125;    var array = []float32&#123;&#125;    array = append(array, score...)    fmt.Println(array)&#125;\n\nfunction value\nFunctions are values too. They can be passed around just like other values.  \nFunction values may be used as function arguments and return values.  \n\npackage mainimport &quot;fmt&quot;func plu(fn1 func(float32, float32) float32, fn2 func(float32, float32) float32) float32 &#123;    return fn1(2, 3) * fn2(2, 3)&#125;func main() &#123;    a := func(x, y float32) float32 &#123;        return x + y    &#125;    b := func(x, y float32) float32 &#123;        return x - y    &#125;    c := plu(a, b)    fmt.Println(c)&#125;\n\nexampleinitialize struct data with functions and return a struct data type.package mainimport &quot;fmt&quot;// define a struct typetype people struct &#123;    name string    age  int&#125;// initialize struct with function and return a structfunc who(name string, age int) *people &#123;    people := &amp;people&#123;        name: name,        age:  age,    &#125;    return people&#125;// function to get struct datafunc (p people) getName() string &#123;    return p.name&#125;func main() &#123;    // used like this: method().method()    res := who(&quot;libai&quot;, 12).getName()    fmt.Println(res)&#125;\n\nread from file and write filepackage mainimport (    &quot;log&quot;    &quot;os&quot;)func main() &#123;    // read content form ori and write to filePath file    var filePath string = &quot;/mnt/c/Users/qiyue/Desktop/test.txt&quot;    var ori string = &quot;/mnt/c/Users/qiyue/Desktop/go.md&quot;    // open write file    new_file, err := os.OpenFile(filePath, os.O_WRONLY|os.O_TRUNC, 0777)    defer new_file.Close()    if err != nil &#123;        log.Fatal(err)    &#125;    // open content file    ori_file, err := os.ReadFile(ori)    if err != nil &#123;        log.Fatal(err)    &#125;    // write content    if _, err := new_file.Write(ori_file); err != nil &#123;        log.Fatal(err)    &#125;&#125;\n\nmethodsGo does not have classes. However, you can define methods on types.  \n\nA method is a function with a special receiver argument.  \nThe receiver appears in its own argument list between the func keyword and  the method name.\n\n// method with structtype type_name struct &#123;&#125;func (v type_name) func_name() return_type &#123;&#125;// use methodv := type_name&#123;&#125;v.func_name()\n\n// method with none-struct typetype type_name value_typefunc (v type_name) func_name() return_type&#123;&#125;// use methodv := type_name()v.func_name()\n\npointer receiver\n// with pointer receiver, we can change struct data selftype type_name struct &#123;&#125;func (v *type_name) func_name() return_type&#123;&#125;// change struct data with functionv := type_name&#123;&#125;v.func_name()\n\nmethod with pointer receiver can be called either a value or a pointer\n// method with pointer receivertype type_name struct &#123;&#125;func (v *type_name) func_name() return_type&#123;&#125;// called by valuev := type_name&#123;&#125;v.func_name()// callled by pointerv := &amp;type_name&#123;&#125;v.func_name()\n\nmethod with value receiver can be called either a value or a pointer\n// normal value receivertype type_name struct &#123;&#125;func (v type_name) func_name() return_type &#123;&#125;// can be call with value or pointerv1 := type_name&#123;&#125;v1.func_name()v2 := &amp;type_name&#123;&#125;v2.func_name()\n\n\nNote:\n1. even though both can work fine, however only pointer receiver has the capacity to change struct data itself\n2. pointer receiver don&#39;t copy data struct, which can minimize memory usage\n\n\ninterfacesAn interface type is defined as a set of method signatures.  \n\nA value of interface type can hold any value that implements those methods.  \n\npackage mainimport &quot;fmt&quot;type Cal interface &#123;    Abs() float32&#125;type Sum struct &#123;    a, b float32&#125;// function of sum implement Cal interfacefunc (s *Sum) Abs() float32 &#123;    return float32(s.a + s.b)&#125;type Div struct &#123;    a, b float32&#125;// function of div implement Cal interfacefunc (d *Div) Abs() float32 &#123;    return float32(d.a / d.b)&#125;func main() &#123;    // apply any value to interface variable which has implemented interface methods    var a Cal    a = &amp;Sum&#123;2, 3&#125;    fmt.Println(a.Abs())    a = &amp;Div&#123;2, 3&#125;    fmt.Println(a.Abs())&#125;//5//0.6666667\n\nThe interface type that specifies zero methods is known as the empty interface\ninterface&#123;&#125;\n\n\nAn empty interface may hold values of any type.     (Every type implements at least zero methods.)  \n\nEmpty interfaces are used by code that handles values of unknown type.     For example, fmt.Print takes any number of arguments of type interface&#123;&#125;.  \n\n\npackage mainimport &quot;fmt&quot;func main() &#123;    // empty interface `interface&#123;&#125;` as a value type    var num interface&#123;&#125;    num = 5    fmt.Println(num)    num = &quot;justin&quot;    fmt.Println(num)&#125;\n\ntype assertions\n// define a variable of empty interfacevar i interface&#123;&#125;i = &quot;hello&quot;// use i.(type) to check the type of i is true. ok&#x27;s value is true || false_,ok := i.(type)// eg :package mainimport &quot;fmt&quot;func main() &#123;    var i interface&#123;&#125;    i = &quot;hello&quot;    _, ok := i.(int)    fmt.Println(ok)&#125;//false\n\ntype switch\nuse type assertions with switch case to ignore value’s type or deal value with different types.\npackage mainimport &quot;fmt&quot;func do(i interface&#123;&#125;) &#123;    switch t := i.(type) &#123;    case int:        fmt.Println(t * 2)    case string:        fmt.Println(&quot;words:&quot;, t)    default:        fmt.Println(&quot;noknown type !&quot;)    &#125;&#125;func main() &#123;    do(20)    do(&quot;hello world&quot;)    do(12.232)&#125;\n\n\nNote:\ntype Stringer interface &#123;    String() string&#125;\n\nfmt package will look for Stringer interface to print values by default. it is be defined in fmt package\n\n// Exercise: Stringer// Make the IPAddr type implement fmt.Stringer to print the address as a dotted quad.// For instance, IPAddr&#123;1, 2, 3, 4&#125; should print as &quot;1.2.3.4&quot;. package mainimport &quot;fmt&quot;type IPAddr [4]bytevar hosts = map[string]IPAddr&#123;    &quot;loopback&quot;:  &#123;127, 0, 0, 1&#125;,    &quot;googledns&quot;: &#123;8, 8, 8, 8&#125;,&#125;func (ip IPAddr) String() string &#123;    return fmt.Sprintf(&quot;%v.%v.%v.%v&quot;, ip[0], ip[1], ip[2], ip[3])&#125;func main() &#123;    for name, ip := range hosts &#123;        fmt.Printf(&quot;%v:\\t%v\\n&quot;, name, ip)    &#125;&#125;\n\ngoroutinesA goroutine is a lightweight thread managed by the Go runtime.  \npackage mainimport &quot;fmt&quot;var num = [10]int&#123;1, 2, 3, 4, 5, 6, 7, 8, 9, 10&#125;func main() &#123;    for _, j := range num &#123;        go fmt.Println(j)        fmt.Println(j)        fmt.Println(&quot;ordered&quot;)    &#125;&#125;\n\nchannelChannels are a typed conduit through which you can send and receive values with the channel operator, &lt;-.  \n// create channelch := make(chan int)// send v to channel chch &lt;- v// receive from ch, and assign value to vv := &lt;- ch\n\nbuffered channels\nChannels can be buffered.  Provide the buffer length as the second argument to make to initialize a buffered channel:  \nch := make(chan int, 100)\n\nSends to a buffered channel block only when the buffer is full. Receives block when the buffer is empty.  \nexecute shell commandgo has a built in module os/exec, which can execute shell command in the system.\n\nOutput(): run command and show stdout, exit code\nRun(): run command and wait it to finish, only show stderr\nStart(): run command in background, only show stderr\n\n// 1. use log.Printf() to pretty output with date showing// 2. check command exists in system first// 3. output isn&#x27;t string, use string() converts// 4. exec.Command() can not use `|` and multi commands, so // we need use `bash -c` to wrap multi commands and pipeline// 5. use `return` to exit program while error appearspackage mainimport (    &quot;fmt&quot;    &quot;log&quot; // output with date    &quot;os/exec&quot;)var commands = [3]string&#123;&quot;/bin/bash&quot;, &quot;ps&quot;, &quot;wc&quot;&#125;func main() &#123;    // LookPath to check whether the system contains this commands    for _, c := range commands &#123;        _, err := exec.LookPath(c)        if err != nil &#123;            log.Printf(&quot;%v: not find in path&quot;, c)            return        &#125;    &#125;    // Command execute, output is stream    cmd := exec.Command(&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;ps -ef |wc -l&quot;)    stream, err := cmd.Output()    if err != nil &#123;        log.Println(err)        return    &#125;    // convert to character with string function    fmt.Println(string(stream))    // Run() don&#x27;t show a stdout value    error := exec.Command(&quot;ls&quot;, &quot;-l&quot;).Run()    if error != nil &#123;        log.Println(error)    &#125;&#125;\n\nfind the type of variable3 ways to check\n\nUsing reflect.TypeOf Function\nUsing reflect.ValueOf.Kind() Function\nUsing %T with Printf\n\npackage mainimport (    &quot;fmt&quot;    &quot;log&quot;    &quot;os&quot;    &quot;reflect&quot;)func main() &#123;    file, err := os.Open(&quot;./test/examples/README.md&quot;)    defer file.Close()    if err != nil &#123;        log.Println(err)    &#125;    // first    fmt.Printf(&quot;%T\\n&quot;, file)    // second    tp := reflect.TypeOf(file)    fmt.Println(tp)    // third    tp = reflect.ValueOf(file).Type()    fmt.Println(tp)&#125;\n\ndeal with fileread fileread file include two parts:\n\nopen a file handler\nget the content with handler\n\nhowever some function combine the two parts into one, and that’s fine\n\nNote:\nwhile opening a file, need to colse it\n\nsimple open a file, leave a file handler, without dealing with it.\npackage mainimport (    &quot;log&quot;    &quot;os&quot;)func main() &#123;    file, err := os.Open(&quot;./test/examples/README.md&quot;)    defer file.Close()    if err != nil &#123;        log.Println(err)    &#125;    // show file state    fmt.Println(file.Stat())&#125;\n\nread whole file content with one function at once, don’t use it with large file\npackage mainimport (    &quot;fmt&quot;    &quot;os&quot;)func main() &#123;    // don&#x27;t need to colse file manually    content, err := os.ReadFile(&quot;./test/examples/README.md&quot;)    if err != nil &#123;        fmt.Println(err)    &#125;    fmt.Println(string(content))&#125;\n\nread file by chunks\nwe don’t take it all completely in memory but instead we load it by  chunking. It’s very important to read large files in chunk to avoid out  of memory errors.\npackage mainimport (    &quot;fmt&quot;    &quot;io&quot;    &quot;log&quot;    &quot;os&quot;)func main() &#123;    file, err := os.Open(&quot;./test/examples/README.md&quot;)    defer file.Close()    if err != nil &#123;        log.Print(err)    &#125;    // create slice    chunk := make([]byte, 8)    // for loop    for &#123;        // read content to chunk and return a chunk size        size, err := file.Read(chunk)        if err != nil &#123;            if err != io.EOF &#123;                log.Print(err)            &#125;            return        &#125;        fmt.Printf(string(chunk[:size]))    &#125;&#125;\n\nuse bufio\nline by line\npackage mainimport (    &quot;bufio&quot;    &quot;fmt&quot;    &quot;log&quot;    &quot;os&quot;)func main() &#123;    file, err := os.Open(&quot;./test/examples/README.md&quot;)    defer file.Close()    if err != nil &#123;        log.Print(err)    &#125;    scanner := bufio.NewScanner(file)    for scanner.Scan() &#123;        fmt.Println(scanner.Text())    &#125;&#125;\n\nread file word by word\npackage mainimport (    &quot;bufio&quot;    &quot;fmt&quot;    &quot;log&quot;    &quot;os&quot;)func main() &#123;    file, err := os.Open(&quot;./test/examples/README.md&quot;)    defer file.Close()    if err != nil &#123;        log.Print(err)    &#125;    scanner := bufio.NewScanner(file)    scanner.Split(bufio.ScanWords) // add one line to split line into word    for scanner.Scan() &#123;        fmt.Println(scanner.Text())    &#125;&#125;\n\nwrite filesimplest way, easy for writing small size file\npackage mainimport (    &quot;fmt&quot;    &quot;os&quot;)func main() &#123;    loc := &quot;./data.txt&quot;    file, err := os.OpenFile(loc, os.O_CREATE|os.O_APPEND|os.O_RDWR, 0755)    if err != nil &#123;        fmt.Println(err)    &#125;    defer file.Close()    // write to file directorily    file.WriteString(&quot;hello world!&quot;)    // read file    content, err := os.ReadFile(loc)    fmt.Println(string(content))&#125;\n\nwe can use bufio to write content to file, more useful for large file to write\n\nuse os.OpenFile() for more control\nit does a write when writer.Fulsh() is called\n\npackage mainimport (    &quot;bufio&quot;    &quot;fmt&quot;    &quot;os&quot;)func main() &#123;    // create file if none with permistion of 0755, or append to a exist file     loc := &quot;./data.txt&quot;    file, err := os.OpenFile(loc, os.O_CREATE|os.O_APPEND|os.O_RDWR, 0755)    if err != nil &#123;        fmt.Println(err)    &#125;    defer file.Close()    // store string to buffer    writer := bufio.NewWriter(file)    writer.WriteString(&quot;hello world!&quot;)    if err != nil &#123;        fmt.Println(err)    &#125;    // write buffer all at once to file when we use flush function    writer.Flush()    // reopen file to show content    file, _ = os.Open(loc)    scanner := bufio.NewScanner(file)    for scanner.Scan() &#123;        fmt.Println(&quot;text:&quot;, scanner.Text())    &#125;    file.Close()&#125;\n\nget request and json convertpackage mainimport (    &quot;crypto/tls&quot;    &quot;encoding/json&quot;    &quot;fmt&quot;    &quot;io/ioutil&quot;    &quot;net/http&quot;)var URL string = &quot;https://192.168.31.214:8080&quot;var USER string = &quot;admin&quot;var PASSWD string = &quot;xFkwBNzwtA6ufGGLwSXzCwU8k9VGX4hcbhxemEUhBxyUkesSupynBBemEX8CK3Do&quot;// join stringfunc url(api string) string &#123;    return URL + api&#125;func get(url string) []byte &#123;    http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config&#123;InsecureSkipVerify: true&#125;    r, err := http.NewRequest(&quot;GET&quot;, url, nil)    r.SetBasicAuth(USER, PASSWD)    c := &amp;http.Client&#123;&#125;    resp, err := c.Do(r)    if err != nil &#123;        fmt.Println(err)    &#125;    defer resp.Body.Close()    // return resp.Body, remove `[]`    content, _ := ioutil.ReadAll(resp.Body)    return content[1 : len(content)-2]&#125;// create struct to parse json, notice captial casetype Data struct &#123;    Code             string `json:&quot;code&quot;`    virtual          string    state            string    agentsetgroup    string    labelgroup       string    agentsetrole     string    agentsetfwstate  string    microfwstate     string    usernumber       int    expiredtimestamp int    blocklog         string    updateduser      string    updatedtimestamp int&#125;func main() &#123;    content := get(url(&quot;/default/activationcode&quot;))    fmt.Println(string(content))    var md Data    // convert to json    json.Unmarshal(content, &amp;md)    fmt.Println(md.Code)&#125;\n\npracticepackage mainimport (    &quot;crypto/tls&quot;    &quot;encoding/json&quot;    &quot;flag&quot;    &quot;fmt&quot;    &quot;io&quot;    &quot;net/http&quot;    &quot;time&quot;)// define some variablesvar NEW Datavar OLD Data// create data struct of service request [&#123;k:v,k:[&#123;k:v&#125;,&#123;k:v&#125;...]&#125;,k:v]type Data []struct &#123;    Uuid             string  `json:&quot;uuid&quot;`    Service          Service `json:&quot;service&quot;`    Updatedtimestamp int     `json:&quot;updatedtimestamp&quot;`&#125;type Service []struct &#123;    Protocol string `json:&quot;protocol&quot;`    Port     string `json:&quot;port&quot;`    Listen   string `json:&quot;listen&quot;`    Name     string `json:&quot;name&quot;`    Exe      string `json:&quot;exe&quot;`&#125;// commind line parsefunc parseCmd() (string, uint, string, string) &#123;    url := flag.String(&quot;url&quot;, &quot;192.168.31.53&quot;, &quot;QCC url&quot;)    interval := flag.Uint(&quot;time&quot;, 300, &quot;interval time(seconds)&quot;)    api := flag.String(&quot;api&quot;, &quot;rh8FeGiGZhGBFWawrCvFYLaMHHQBVr9ZEmKmLAJAiCfqkB5kRkGs4cwgToELFV5L&quot;, &quot;qcc api&quot;)    user := flag.String(&quot;user&quot;, &quot;admin&quot;, &quot;api user name&quot;)    flag.Parse()    return *url, *interval, *api, *user&#125;// function of api urlfunc apiUrl(url, api string) string &#123;    return &quot;https://&quot; + url + &quot;:8080&quot; + api&#125;// get http request raw datafunc rawData(url, user, api string) []byte &#123;    http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config&#123;InsecureSkipVerify: true&#125;    r, err := http.NewRequest(&quot;GET&quot;, url, nil)    r.SetBasicAuth(user, api)    c := &amp;http.Client&#123;&#125;    resp, err := c.Do(r)    if err != nil &#123;        fmt.Println(err)    &#125;    defer resp.Body.Close()    // return resp.Body    content, _ := io.ReadAll(resp.Body)    return content&#125;// compare data with x minutes intervalfunc compareData(data Data, tsleep uint) string &#123;    NEW = data    for &#123;        if OLD == nil &#123;            OLD = NEW            continue        &#125;        // condition        time.Sleep(time.Duration(tsleep) * time.Second)        return &quot;one&quot;    &#125;&#125;// main functionfunc main() &#123;    url, interval, api, user := parseCmd()    fmt.Println(url, interval, api, user, apiUrl(url, &quot;/default/workloadservice&quot;))    content := rawData(apiUrl(url, &quot;/default/workloadservice&quot;), user, api)    // fmt.Println(apiUrl(&quot;/default/workloadservice&quot;))    // fmt.Printf(&quot;%T\\n&quot;,content)    // fmt.Printf(&quot;%s\\n&quot;,content)    var data Data    err := json.Unmarshal(content, &amp;data)    if err != nil &#123;        fmt.Println(err)    &#125;    result := compareData(data, interval)    fmt.Println(result)    // fmt.Printf(&quot;%T\\n&quot;,data)    // fmt.Println(data[0].Service)&#125;\n","categories":["learn"],"tags":["go"]},{"title":"k8s","url":"/2022/04/23/k8s/","content":"kubernetescore component\netcd：分布式存储，保存集群状态\napiserver：api操作接口\ncontroller manager：维护集群状态\nscheduler：资源调度\nkubelet：容器生命周期，volume和网络管理\ncontainer runtime：镜像管理，pod和容器管理\nkube-proxy：内部服务发现和负载均衡\n\nbasic conceptcontainer: k8s构建在容器之上，容器被k8s所管理，容器间采用namespace进行隔离\npod: k8s使用pod来管理容器，一个pod中一般运行相同的程序，因为pod内的容器共享网络（处于同网段）和文件系统，可进行进程间通信和文件共享\nnode: node是部署pod的地方，所以node的大小决定能够部署虚拟机的多少\nservice: 服务可以跨越pod，每个服务会分配一个内部的cluster ip和dns，供其它容器访问\nlabel &amp; annotation: label用来标识对象，annatation用来做注释\nvolume: 为了pod的启停不对数据造成损坏，volume可实现数据持久化\n确保pod数量的方式\nrc (replication controller): 保证pod的高可用，申明确定的pod数量，并维持pod数量不变\nrs (replica set): 新一代的rc，支持更多种类的匹配模式\ndeployment：比rs应用更广，用于创建、更新、滚动升级服务\n服务发现和负载均衡\nservice提供了pod对外服务的确定ip和端口，不需要考虑pod新建和销毁所引起的ip地址变化\njob:用来控制批处理型任务，执行一次完成后自动退出\ncommandskubectl get\t\t\t\t# list podskubectl describe \t\t# detail infokubectl logs\t\t\t# logskubectl exec\t\t\t# execute command in containerkubectl run\t\t\t\t# run a simple containerkubectl create -f xx.yaml # run container commonly\n\n\n\n\n\n\n\ninstall成功安装kubernetes的前提条件：\n\n安装k8s的机器保证cpu个数大于等于2\n内存不使用swap分区\n多节点的时候需要有主机名与对应ip的映射关系\n关闭防火墙setenforce firewalld\n对应版本的docker和k8s\n\n\n这里使用的版本为：\ndocker:\n​    docker-ce-19.03.0-3.el7 \n​    docker-ce-cli-19.03.0-3.el7 \n​    containerd.io-1.4.4-3.1.el7\nk8s:\n​    kubelet-1.20.0-0 \n​    kubeadm-1.20.0-0 \n​    kubectl-1.20.0-0 \n\ninstall修改主机名# leaderhostnamectl set-hostname k8l# nodehostnamectl set-hostname k8n1\n\n\n\n设置主机与ip的映射关系\nNote:\n\nk8s的节点主机最好设置为静态ip，因为ip变化之后node节点也会消失\n一般多节点最好是奇数个，但这里采用2个\n\n\n# 建立映射关系cat &gt;&gt; /etc/hosts &lt;&lt; EOF192.168.31.11 k8l192.168.31.12 k8n1EOFecho nameserver 114.114.114.114 &gt; /etc/resolv.conf\n\n\n\n关闭防火墙&amp;swap分区# 关闭firewalldsystemctl stop firewalldsystemctl disable firewalld# 关闭selinuxsetenforce 0sed -i &#x27;s/=enforcing/=permissive/&#x27; /etc/sysconfig/selinux# 关闭swap分区swapoff -ased -i &#x27;/swap/s/^/#/&#x27; /etc/fstab\n\n\n\ndocker安装&amp;配置# 配置docker源yum install -y yum-utilsyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo# 安装dockeryum install docker-ce-19.03.0-3.el7 docker-ce-cli-19.03.0-3.el7 containerd.io-1.4.4-3.1.el7 -y\n\n\nNote:\n查看版本：yum list containerd.io –showduplicates | sort -r\n\n修改dockercgroupdriver为systemd (默认为cgroupfs)\nmkdir /etc/dockercat &gt; /etc/docker/daemon.json &lt;&lt; EOF&#123;  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]&#125;EOF\n\n启动docker，配置自启动\nsystemctl enable dockersystemctl start docker\n\n\n\nk8s安装&amp;配置# 允许k8s进行流量代理cat &gt; /etc/sysctl.d/k8s.conf &lt;&lt; EOFnet.bridge.bridge-nf-call-ip6tables = 1net.bridge.bridge-nf-call-iptables = 1EOF# 添加国内k8s镜像源cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt; EOF[kubernetes]name=Kubernetes Repobaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/gpgcheck=0enabled=1EOF# 安装k8syum install -y kubelet-1.20.0-0 kubeadm-1.20.0-0 kubectl-1.20.0-0 \n\n允许k8s自启动\nsystemctl enable kubelet\n\n\nNote:\n这里不需要启动k8s，现在启动会报错\n\n主节点配置主节点初始化\n# 修改apiserver-advertise-address为master的ipkubeadm init --kubernetes-version=1.20.0  \\--apiserver-advertise-address=192.168.31.11   \\--image-repository registry.aliyuncs.com/google_containers  \\--service-cidr=10.10.0.0/16 --pod-network-cidr=10.122.0.0/16\n\n\nNote:\n主节点初始化失败后可以重新初始化，不过需要先清空之前初始化的配置\nkubeadm resetrm -rf /etc/cnirm -rf $HOME/.kube/config\n\n初始化完成后会在终端打印一些重要信息，需要记录下来。比如node接入的命令\nmkdir -p $HOME/.kubesudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/configsudo chown $(id -u):$(id -g) $HOME/.kube/configexport KUBECONFIG=/etc/kubernetes/admin.conf\n\n修改端口\nsed -i &#x27;s/insecure-port=0/insecure-port=8080/&#x27; /etc/kubernetes/manifests/kube-apiserver.yaml\n\n启动kubelet\nsystemctl start kubelet\n\n安装网络管理插件\nkubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml\n\n\nNote:The connection to the server 192.168.31.11:6443 was refused - did you specify the right host or port?\n遇到以上报错时，需要重新初始化，一般是某些k8s的docker启动失败。\nsystemctl stop kubeletsystemctl stop dockerkubeadm resetrm -rf /etc/cnirm -rf $HOME/.kube/configsystemctl start dockersystemctl start kubeletkubeadm init --kubernetes-version=1.20.0  \\--apiserver-advertise-address=192.168.31.11   \\--image-repository registry.aliyuncs.com/google_containers  \\--service-cidr=10.10.0.0/16 --pod-network-cidr=10.122.0.0/16\n\nnode接入主节点# node上运行kubeadm join 192.168.31.11:6443 --token nfb8gw.46gfska1dhfevlg9 --discovery-token-ca-cert-hash sha256:5ca678d7bcda290d7a692474711cbf1e5d5a11bc51969cbd453561e1f3186476\n\n如果忘记了以上命令，那么需要重新获取\n# 查看token的值kubeadm token list# 如果过期了重新生成kubeadm token create# 获取ca证书的sha256编码hash值openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | openssdgst -sha256 -hex | sed &#x27;s/^.* //&#x27;# 组装kubeadm join 192.168.31.11:6443 --token &#123;&#123;token&#125;&#125; --discovery-token-ca-cert-hash sha256:&#123;&#123;hash&#125;&#125;\n\n\n\n\n\n查看状态kubectl get nodeskubectl get pods -n kube-systemkubectl get namespacekubectl get pods\n\n需要等待一会才是ready状态\n[root@k8l ~]# kubectl get nodesNAME   STATUS   ROLES                  AGE     VERSIONk8l    Ready    control-plane,master   25m     v1.20.0k8n1   Ready    &lt;none&gt;                 8m33s   v1.20.0\n\n\n\n\n\n创建nginxkubectl create deployment nginx --image=nginxkubectl expose deployment nginx --port=80 --type=NodePortkubectl get pod,svc# 查看80映射端口[root@k8s-master ~]# kubectl get pod,svcNAME                         READY   STATUS              RESTARTS   AGEpod/nginx-6799fc88d8-7rgq6   0/1     ContainerCreating   0          16sNAME                 TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)        AGEservice/kubernetes   ClusterIP   10.10.0.1      &lt;none&gt;        443/TCP        34mservice/nginx        NodePort    10.10.78.172   &lt;none&gt;        80:31613/TCP   7s# web界面访问http://192.168.31.111:31613\n\n\n\n\n\n\n\ndaskboardinstall\nfollow this website) to install dashboard\n# run this command kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.2.0/aio/deploy/recommended.yaml\n\n# 如果上面下载不下来也可以用我的gitee文件。内容和上面一样kubectl apply -f https://gitee.com/ulomo/some-config-file/raw/master/recommended.yaml\n\n\n\nedit settting\nin default we cannot access dashboard outsite the host machine where k8s installed. with [this method](How To Access Kubernetes Dashboard Externally – The Geek Diary) we can access dashboard with host ip address \n# change service “type” from ClusterIP to NodePortkubectl -n kubernetes-dashboard edit service kubernetes-dashboard\n\nthen find port to visit. it is 31235\n[root@k8m ~]# kubectl get services --all-namespacesNAMESPACE              NAME                        TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                  AGEdefault                kubernetes                  ClusterIP   10.10.0.1      &lt;none&gt;        443/TCP                  74mkube-system            kube-dns                    ClusterIP   10.10.0.10     &lt;none&gt;        53/UDP,53/TCP,9153/TCP   74mkubernetes-dashboard   dashboard-metrics-scraper   ClusterIP   10.10.27.176   &lt;none&gt;        8000/TCP                 59mkubernetes-dashboard   kubernetes-dashboard        NodePort    10.10.222.86   &lt;none&gt;        443:31235/TCP            59m\n\ncreate user\n[follow this website](dashboard/creating-sample-user.md at master · kubernetes/dashboard · GitHub) to create user\ncat &lt;&lt;EOF | kubectl apply -f -apiVersion: v1kind: ServiceAccountmetadata:  name: admin-user  namespace: kubernetes-dashboardEOFcat &lt;&lt;EOF | kubectl apply -f -apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata:  name: admin-userroleRef:  apiGroup: rbac.authorization.k8s.io  kind: ClusterRole  name: cluster-adminsubjects:- kind: ServiceAccount  name: admin-user  namespace: kubernetes-dashboardEOF\n\n\n\nget tocken\nget tocken login needed\nkubectl -n kubernetes-dashboard get secret $(kubectl -n kubernetes-dashboard get sa/admin-user -o jsonpath=&quot;&#123;.secrets[0].name&#125;&quot;) -o go-template=&quot;&#123;&#123;.data.token | base64decode&#125;&#125;&quot; |less\n\nat last, we can visit dashboard with k8s master ip address: https://192.168.31.11:31235/\n","categories":["learn"],"tags":["k8s"]},{"title":"kubernetes","url":"/2022/04/23/kubernetes/","content":"kubernetesfeature\nhigh availablity or no downtime\nscalability or high performance\ndisaster recovery (backup and restore)\n\nprocess of worker nodesthere are three processes in worker loads\n\nkubectl: operate on pods, with the ability of resource devision\nkube proxy: communicate with nodes, with the ability of load balance\ncontainer runtime: run container\n\nprocess of main nodesthere are four processes in master nodes\n\napi server: access all web ui or ctl operation commands\nscheduler: calculate worker nodes resource and decide which worker node the pod will start up\ncontroller manager: monitor pods’s availability and restart/rebuild the broken pods\netcd: the database of master nodes, stores all collected information from worker  nodes\n\nmain kubernetes components\n\n\ncomponents\nfeature\n\n\n\npod\nthe smallest unit in k8s\n\n\nservice\nadd permanent ip address for deployment\n\n\ningress\nmap url with service\n\n\nconfigmap\n\n\n\nsecret\nstore secret user name/password (encoded with base64)\n\n\nvolume\nadd persistence data storage\n\n\ndeployment\nthe method(blueprint) deploy pod\n\n\nstatefulset\nthe method(blueprint) deploy pod, with the ability of data sync\n\n\ninstall minikubeminikube has kubernetes’s all availability but tool installed in one machine.\n# install in centos with new docker version# don&#x27;t install docker with yum default repo, for the version is too old# follow this link :https://docs.docker.com/engine/install/centos/sudo yum install -y yum-utilssudo yum-config-manager \\    --add-repo \\    https://download.docker.com/linux/centos/docker-ce.repo    sudo yum install docker-ce docker-ce-cli containerd.io -ysudo systemctl enable --now docker  # install minikubecurl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-latest.x86_64.rpmsudo rpm -Uvh minikube-latest.x86_64.rpm# start minikube with none root priviledge useruseradd -G docker kube &amp;&amp; newgrp docker &amp;&amp; su - kubeminikube start\n\n\n\ncreate podsthere are two ways to create pods:\n\ncommand line: simple usage  \nconfigure file: full feature\n\nvia command lineget information of default configuration\nalias kubectl=&quot;minikube kubectl --&quot;kubectl get nodes/deployment/pods/configmap/services/replicaset/all [-o wide] [--watch]\n\ncreate new pod\nkubectl create deployment nginx --image=nginx\n\n\nNote:\nkubernetes doesn’t create pod directly, but the layer: deployment\n\nthe command above creates a blueprint of nginx automatically, we can edit it\nkubectl edit deployment nginx\n\ncheck pod’s detail information\n# deploy infokubectl describe pod [pod-name]# running logkubectl logs [pod-name]\n\nlogin container\nkubectl exec -it [pod-name] -- /bin/bash\n\ndelete deployment\nkubectl get deploymentkubectl delete [deployment-name]\n\n\nNote:\nwe can only delete pod at the deployment layer, for deployment will restart new pod if we delete the pod with kubectl delete pod [pod-name]\n\nvia configure fileconfigure file include three parts\n\nmetadata\nspecification\nstatus(kubernetes auto generate)\n\nif we create pod via command line deployment, we can export the configuration file created by kubernetes.\nkubectl get deployment [deploy-name] -o yaml &gt; [deploy-name].yaml\n\ncreate or delete deployment\nkubectl create -f [deploy-name].yamlkubectl delete -f [deploy-name].yaml\n\nmongodb.yaml\napiVersion: apps/v1kind: Deploymentmetadata:  name: mongodb-deployment  labels:    app: mongodbspec:  replicas: 1  selector:    matchLabels:      app: mongodb  template:    metadata:      labels:        app: mongodb    spec:      containers:      - name: mongodb        image: mongo        ports:          - containerPort: 27017        env:        - name: MONGO_INITDB_ROOT_USERNAME          valueFrom:            secretKeyRef:              name: mongodb-secret              key: root-username        - name: MONGO_INITDB_ROOT_PASSWORD          valueFrom:            secretKeyRef:              name: mongodb-secret              key: root-password---apiVersion: v1kind: Servicemetadata:  name: mongodb-servicespec:  selector:    app: mongodb  ports:    - protocol: TCP      port: 3306      targetPort: 27017\n\nmongo-express.yaml\napiVersion: apps/v1kind: Deploymentmetadata:  name: mongo-express  labels:    app: mongo-expressspec:  replicas: 1  selector:    matchLabels:      app: mongo-express  template:    metadata:      labels:        app: mongo-express    spec:      containers:      - name: mongo-express        image: mongo-express        ports:          - containerPort: 8081        env:          - name: ME_CONFIG_MONGODB_ADMINUSERNAME            valueFrom:              secretKeyRef:                 name: mongodb-secret                key: root-username          - name: ME_CONFIG_MONGODB_ADMINPASSWORD            valueFrom:              secretKeyRef:                 name: mongodb-secret                key: root-username          - name: ME_CONFIG_MONGODB_SERVER              valueFrom:              configMapKeyRef:                name: mongodb-configmap                key: database_url---apiVersion: v1kind: Servicemetadata:  name: mongo-express-servicespec:  selector:    app: mongo-express  type: LoadBalancer  ports:    - protocol: TCP      port: 8081      targetPort: 8081      nodePort: 30000\n\nmongodb-configmap.yaml\napiVersion: v1kind: ConfigMapmetadata:  name: mongodb-configmapdata:  database_url: mongodb-service\n\nmongodb-secret.yaml\napiVersion: v1kind: Secretmetadata:  name: mongodb-secrettype: Opaquedata:  root-username: bW9uZ28=  root-password: bW9uZ28=\n\n\n\n\n\nnetwork realizationresource link:\nhttps://github.com/kristenjacobs/container-networking\nhttps://static.sched.com/hosted_files/kccna18/c1/slides.pdf\nhttps://www.youtube.com/watch?v=6v_BDHIgOY8\ncommunication between network namespaceseach network namespace has its own network stack, they cannot communicate with each other directly\n\npod is the group of containers, all the containers in a pod share the same network  stack, owns one ip and localhost address\nso, how can we resolve the problem that host machine(root  namespace) communicates with container /pod (another new created namespace)?\nand the answer is veth pair(virtual network device), with veth pair two network namespaces can be connected together. packet can flow between the two ethernet interfaces. \nin this example, i will use one network namespace instaead of a pod’s or containers’ network stack.\n\nNote:\n\nvia virtual network technology, eth1-1 is the same as veth1\n\nhost(eth0) can ping each container network, but reverse cannot. because all namespace transparency to host \n\n\n\n\npod_namespace=cont1pod_interface=eth1-1pod_ip=10.10.0.11vpair=veth1# create network namespacesudo ip netns add $&#123;pod_namespace&#125;# create veth pairs in host root namespacesudo ip link add $&#123;vpair&#125; type veth peer name $&#123;pod_interface&#125;# add interface to new network namespacesudo ip link set $&#123;pod_interface&#125; netns $&#123;pod_namespace&#125;# add ip address for new interfacesudo ip netns exec $&#123;pod_namespace&#125; ip addr add $&#123;pod_ip&#125;/24 dev $&#123;pod_interface&#125;# start new namespace loopback upsudo ip netns exec $&#123;pod_namespace&#125; ip link set lo up# start new namespace ethernet upsudo ip netns exec $&#123;pod_namespace&#125; ip link set dev $&#123;pod_interface&#125; up# start root namespace vpair interface upsudo ip link set dev $&#123;vpair&#125; up# add default route for new namespace via ethernet interfacesudo ip netns exec $&#123;pod_namespace&#125; ip route add default via $&#123;pod_ip&#125; dev $&#123;pod_interface&#125;# add route for root namespace vpair interfacesudo ip route add $&#123;pod_ip&#125; dev $&#123;vpair&#125;# ping new namespace ethernet ip address in hostping -c 2 $&#123;pod_ip&#125;\n\n\n\ncommunication between podsabove veth pair can resolve the problem of two network namespaces communication, but not two pods, for there are lots of pods in kubernetes node, we cannot establish veth pairs for each two pods. \nand the bridge network device can resolve this problem, a bridge has its own ip address and route table, so pod can communication with each other once they connect to the bridge, it acts just like a router(switch). another benefit of bridge is that bridge device and the host net device are in the same root namespace, both have ip address, so they can communicate directly.\n\nNote:\n\nvia bridge network technology, eth1-1 and eth2-2 can ping each other\neth1-1 can ping host eth0, because br0 and eth0 both in the same root namespace\n\n\n\npod1_namespace=cont1pod1_interface=eth1-1pod1_ip=10.10.0.11vpair1=veth1bridge_interface=br0bridge_ip=10.10.0.1pod2_namespace=cont2pod2_interface=eth2-2pod2_ip=10.10.0.22vpair2=veth2# create network namespacesudo ip netns add $&#123;pod1_namespace&#125;sudo ip netns add $&#123;pod2_namespace&#125;# create veth pairs in host root namespacesudo ip link add $&#123;vpair1&#125; type veth peer name $&#123;pod1_interface&#125;sudo ip link add $&#123;vpair2&#125; type veth peer name $&#123;pod2_interface&#125;# add interface to new network namespacesudo ip link set $&#123;pod1_interface&#125; netns $&#123;pod1_namespace&#125;sudo ip link set $&#123;pod2_interface&#125; netns $&#123;pod2_namespace&#125;# add ip address for new interfacesudo ip netns exec $&#123;pod1_namespace&#125; ip addr add $&#123;pod1_ip&#125;/24 dev $&#123;pod1_interface&#125;sudo ip netns exec $&#123;pod2_namespace&#125; ip addr add $&#123;pod2_ip&#125;/24 dev $&#123;pod2_interface&#125;# start new namespace loopback upsudo ip netns exec $&#123;pod1_namespace&#125; ip link set lo upsudo ip netns exec $&#123;pod2_namespace&#125; ip link set lo up# start new namespace ethernet upsudo ip netns exec $&#123;pod1_namespace&#125; ip link set dev $&#123;pod1_interface&#125; upsudo ip netns exec $&#123;pod2_namespace&#125; ip link set dev $&#123;pod2_interface&#125; up# start root namespace vpair interface upsudo ip link set dev $&#123;vpair1&#125; upsudo ip link set dev $&#123;vpair2&#125; up# create a bridgesudo ip link add name $&#123;bridge_interface&#125; type bridge# assign a IP address to the bridgesudo ip addr add $&#123;bridge_ip&#125;/24 dev $&#123;bridge_interface&#125;# add two veth pair interface to bridgesudo ip link set dev $&#123;vpair1&#125; master $&#123;bridge_interface&#125;sudo ip link set dev $&#123;vpair2&#125; master $&#123;bridge_interface&#125;# start the bridge upsudo ip link set dev $&#123;bridge_interface&#125; up# add the default route in two network namespacessudo ip netns exec $&#123;pod1_namespace&#125; ip route add default via $&#123;bridge_ip&#125; dev $&#123;pod1_interface&#125;sudo ip netns exec $&#123;pod2_namespace&#125; ip route add default via $&#123;bridge_ip&#125; dev $&#123;pod2_interface&#125;# two containers ping each otherip netns exec $&#123;pod1_namespace&#125; ping -c 3 $&#123;pod2_ip&#125;ip netns exec $&#123;pod2_namespace&#125; ping -c 3 $&#123;pod1_ip&#125;\n\n\n\ncommunication between nodes with different subnetwith veth pair and bridge network technology, the container can reach host network and other pod’s network in one node. so communication in two nodes, the only thing we need to do is assigning a route table.\nrun script in one node. node ip is 192.168.31.100/24 and ether interface is eth0\n\nNote:\n\ncontainer network can reach the host point already, we only need to specify each node to other node’s route table\n\n\n\npod1_namespace=cont1pod1_interface=eth1-1pod1_ip=10.10.0.11vpair1=veth1bridge_interface=br0bridge_ip=10.10.0.1pod2_namespace=cont2pod2_interface=eth2-2pod2_ip=10.10.0.22vpair2=veth2# create network namespacesudo ip netns add $&#123;pod1_namespace&#125;sudo ip netns add $&#123;pod2_namespace&#125;# create veth pairs in host root namespacesudo ip link add $&#123;vpair1&#125; type veth peer name $&#123;pod1_interface&#125;sudo ip link add $&#123;vpair2&#125; type veth peer name $&#123;pod2_interface&#125;# add interface to new network namespacesudo ip link set $&#123;pod1_interface&#125; netns $&#123;pod1_namespace&#125;sudo ip link set $&#123;pod2_interface&#125; netns $&#123;pod2_namespace&#125;# add ip address for new interfacesudo ip netns exec $&#123;pod1_namespace&#125; ip addr add $&#123;pod1_ip&#125;/24 dev $&#123;pod1_interface&#125;sudo ip netns exec $&#123;pod2_namespace&#125; ip addr add $&#123;pod2_ip&#125;/24 dev $&#123;pod2_interface&#125;# start new namespace loopback upsudo ip netns exec $&#123;pod1_namespace&#125; ip link set lo upsudo ip netns exec $&#123;pod2_namespace&#125; ip link set lo up# start new namespace ethernet upsudo ip netns exec $&#123;pod1_namespace&#125; ip link set dev $&#123;pod1_interface&#125; upsudo ip netns exec $&#123;pod2_namespace&#125; ip link set dev $&#123;pod2_interface&#125; up# start root namespace vpair interface upsudo ip link set dev $&#123;vpair1&#125; upsudo ip link set dev $&#123;vpair2&#125; up# create a bridgesudo ip link add name $&#123;bridge_interface&#125; type bridge# assign a IP address to the bridgesudo ip addr add $&#123;bridge_ip&#125;/24 dev $&#123;bridge_interface&#125;# add two veth pair interface to bridgesudo ip link set dev $&#123;vpair1&#125; master $&#123;bridge_interface&#125;sudo ip link set dev $&#123;vpair2&#125; master $&#123;bridge_interface&#125;# start the bridge upsudo ip link set dev $&#123;bridge_interface&#125; up# add the default route in two network namespacessudo ip netns exec $&#123;pod1_namespace&#125; ip route add default via $&#123;bridge_ip&#125; dev $&#123;pod1_interface&#125;sudo ip netns exec $&#123;pod2_namespace&#125; ip route add default via $&#123;bridge_ip&#125; dev $&#123;pod2_interface&#125;# two containers ping each otherip netns exec $&#123;pod1_namespace&#125; ping -c 3 $&#123;pod2_ip&#125;ip netns exec $&#123;pod2_namespace&#125; ping -c 3 $&#123;pod1_ip&#125;######################################## above almost the same ############################################################# add route to another node&#x27;s bridgesudo ip route add 10.10.1.0/24 via 192.168.31.200 dev eth0sudo sysctl -w net.ipv4.ip_forward=1# test ip netns exec $&#123;pod1_namespace&#125; ping -c 3 10.10.1.11\n\nrun script in another node, node ip is 192.168.31.200/24 and ether interface is eth0\npod1_namespace=cont1pod1_interface=eth1-1pod1_ip=10.10.1.11vpair1=veth1bridge_interface=br0bridge_ip=10.10.1.1pod2_namespace=cont2pod2_interface=eth2-2pod2_ip=10.10.1.22vpair2=veth2# create network namespacesudo ip netns add $&#123;pod1_namespace&#125;sudo ip netns add $&#123;pod2_namespace&#125;# create veth pairs in host root namespacesudo ip link add $&#123;vpair1&#125; type veth peer name $&#123;pod1_interface&#125;sudo ip link add $&#123;vpair2&#125; type veth peer name $&#123;pod2_interface&#125;# add interface to new network namespacesudo ip link set $&#123;pod1_interface&#125; netns $&#123;pod1_namespace&#125;sudo ip link set $&#123;pod2_interface&#125; netns $&#123;pod2_namespace&#125;# add ip address for new interfacesudo ip netns exec $&#123;pod1_namespace&#125; ip addr add $&#123;pod1_ip&#125;/24 dev $&#123;pod1_interface&#125;sudo ip netns exec $&#123;pod2_namespace&#125; ip addr add $&#123;pod2_ip&#125;/24 dev $&#123;pod2_interface&#125;# start new namespace loopback upsudo ip netns exec $&#123;pod1_namespace&#125; ip link set lo upsudo ip netns exec $&#123;pod2_namespace&#125; ip link set lo up# start new namespace ethernet upsudo ip netns exec $&#123;pod1_namespace&#125; ip link set dev $&#123;pod1_interface&#125; upsudo ip netns exec $&#123;pod2_namespace&#125; ip link set dev $&#123;pod2_interface&#125; up# start root namespace vpair interface upsudo ip link set dev $&#123;vpair1&#125; upsudo ip link set dev $&#123;vpair2&#125; up# create a bridgesudo ip link add name $&#123;bridge_interface&#125; type bridge# assign a IP address to the bridgesudo ip addr add $&#123;bridge_ip&#125;/24 dev $&#123;bridge_interface&#125;# add two veth pair interface to bridgesudo ip link set dev $&#123;vpair1&#125; master $&#123;bridge_interface&#125;sudo ip link set dev $&#123;vpair2&#125; master $&#123;bridge_interface&#125;# start the bridge upsudo ip link set dev $&#123;bridge_interface&#125; up# add the default route in two network namespacessudo ip netns exec $&#123;pod1_namespace&#125; ip route add default via $&#123;bridge_ip&#125; dev $&#123;pod1_interface&#125;sudo ip netns exec $&#123;pod2_namespace&#125; ip route add default via $&#123;bridge_ip&#125; dev $&#123;pod2_interface&#125;# two containers ping each otherip netns exec $&#123;pod1_namespace&#125; ping -c 3 $&#123;pod2_ip&#125;ip netns exec $&#123;pod2_namespace&#125; ping -c 3 $&#123;pod1_ip&#125;######################################## above almost the same ############################################################# add route to another node&#x27;s bridgesudo ip route add 10.10.0.0/24 via 192.168.31.100 dev eth0sudo sysctl -w net.ipv4.ip_forward=1# testip netns exec $&#123;pod1_namespace&#125; ping -c 3 10.10.0.11\n\n\n\n\nNote:\n\nit is a huge work if there are hundreds of nodes, so instead of manually configure, there are lots of CNI plugin for us to choose. such as flannel, calico…\n\n\n\n","categories":["learn"],"tags":["k8s"]},{"title":"learn_from_shield","url":"/2022/04/23/learn-from-shield/","content":"I watched “agents of SHIELD”, and learned a lot from it. Especially Skye’s response when Coulson told her the truth of her past life.\nCoulson said: “what i told her shattered her world,her lifelong search led to stories of murder and now it’s too difficult to continue. her search is over, her story ends here. but you know what she said? she said no, her story started here. her whole life, she though she wasn’t wanted, that she didn’t belong, that every family that took her in, didn’t want her to stay, didn’t care. but all that time, it was shield protecting her, looking after her, that’s what she took away from the story, not the family she’ll never have but the one she’s always had. here i am telling her something that could destroy her faith in humanity. and somehow, she manages to repair a little piece of mine. “\nthe world is full of evil and lies and pain and death, and you can’t hide from it, you can only face it. the question is, when you do, how do you respond? who do you become? \nI have a great inspiration of that. There has a long time i just feel so disappointed and can not  find any happiness of life, because i realize that the government i live is full of lies, they don’t treat people as human, there is on faith, no fair, on freedom and so on.\nHowever when i see the story of Skye, i realize that i need to change my mind. I know the country is so bad, it is truth. And i cannot change any thing, i can’t hide from it, can only face it. And the question is how i respond.  If i feel sad every day then my life is broke, whatever to say, it is not the worst  situation. I can alive, can do almost the thing which i wanna to dive in, there is no war, no death of threat. And that’s enough. \nEach day on earth is the day need to be treasured, since it can never come back. The really bad is not the environment but the heart of failure. \n","categories":["think"],"tags":["shield"]},{"title":"magic-of-xmonad","url":"/2022/06/25/magic-of-xmonad/","content":"magic of xmonad\nXmonad似乎永远都能带来意想不到的惊喜，只要你不断的探索\n\ntypora从1.0版本开始后就不再是免费软件了，所以曾经我卸载了他。每次打开它的时候就有一个窗口需要点击，有点烦。不过还是比其它收费软件好一些，毕竟这个也只是提示你，并没有强制不升级正版就不能用。\n然而我昨天发现xmonad居然可以轻松的帮我去掉点击弹框的这一步，太神奇，太惊讶了。而且非常简单。\n\n正常打开typora，并且打开终端，在终端输入xprop，然后点击这个弹框获取到它的WM_NAME\n\n在xmonad的manageHook中添加条件，将匹配到这个名字的窗口隐藏\nmyManageHook = composeOne             [ title     =? &quot;License Info&quot;               -?&gt; doHideIgnore            ]\n重新编译xmonad，启动就可以了，只能说xmonad太强了\n\n\n","categories":["linux"],"tags":["xmonad"]},{"title":"markdown-syntax","url":"/2022/10/30/markdown-syntax/","content":"MARKDOWN SYNTAX\nThere is no rules about how many lines we should put between paragraph, but basically we need 1, if we put more than 1, it is just for good view.\n\n\nsyntax character has a space with normal document.\n  ## HEAD1- list\nuse one or more lines create paragraphs.\n  paragraph1paragraph2\nuse 2 or more spaces break a line\n  line1  line2  \nuse 1 * to italicize text\n  *this is some italic text*\nuse 2 * to bold text\n  **this is some bold text**\nuse &gt; to create blockquotes\n  &gt; this is a blockquote&gt;&gt; this is another blockquote paragraph\nuse number followd by period to create orderd list\n  1. list12. list2\nuse - to create unorderd list\n  - unorder list1- unorder list2\nadd elements in lists with 4 or a tab space in the beginning of line\n  1. list1    - unsorted list1    - unsorted list22. list2\nuse ` to denote a word\n  this is a `denote` word\nuse 4 spaces or a tab to create code blocks\n  &lt;html&gt;    some kind of words&lt;/html&gt;\nuse 3 or more - create a line\n  ---\nuse  to create a link\n  [this is a bing site link](https://bing.com)\nuse  to create a image\n  ![image-name](image-link)\nreference-style links\n  [this is a bing site][1][this is a google site][2][1]: https://www.bing.com[2]: &lt;https://www.google.com&gt; &quot;google site&quot;\n\n","categories":["learn"],"tags":["markdown"]},{"title":"noResponseGrub","url":"/2022/04/23/noResponseGrub/","content":"issue在grub双启动界面无法用键盘进行上下移动选择需要的启动项，并且也无法用del键进入bios\nanalysize无论是方向键还是del键都不起作用，推测是grub启动的时候未识别到键盘，或者配置了什么参数导致grub freeze。google搜索了一下，发现有人遇到过这个问题，是因为在bios中设置了快速启动，所以我需要进bios中将快速启动关掉试试。然而现在的问题是无法进入bios\nresolve那么现在需要解决如何进入bios的问题，键盘没有反应肯定是不行了。之前设置过usb始终作为第一个启动项，所以将usb插上后可能就会进入usb的启动界面，或许键盘可以用。然而usb似乎是没有识别出来，所以还是只能在之前的grub上面进行修改。幸好grub是可以自定义启动顺序的，所以将进入bios的启动项配置为第一个就可以了。\nif [ $&#123;grub_platform&#125; == &quot;efi&quot; ]; then        menuentry &quot;Firmware setup&quot; &#123;                fwsetup        &#125;fi\n\n将以上代码写入/boot/grub/grub.cfg中，放到第一个启动位置。然后重启，顺利进入bios。最终找到了问题所在\n\nMSI的fast boot会导致在bios加载过程中不进行usb，硬盘识别，由于键盘/启动盘是用usb连接的，所以识别不到。将MSI快速关机禁止掉之后就解决了问题。\n所以如果是台式机，这个选项一定不能开启，否则bios都进入不了。笔记本电脑才能开启这个选项。不管怎么说，这个功能确实很不错，开启这个选项后进入系统的时间确实会减少很多。\n","categories":["learn"],"tags":["grub"]},{"title":"not-simple-is-the-best","url":"/2022/11/08/not-simple-is-the-best/","content":"Simple is the best, really?I get to say most of time it is true. Simple is best, it stands a life style. We hope things goes straightly, without some big boy’s game.\nHowever, not everything goes like this. And we’d better not get used to it. Since it will comes to a mindset. We need think things in different ways.\nSometimes, making things complicated is not totally a bad idea. For example, recently i write a shell script to access all history data, i need all history command only show once, including duplicate commands.\nWe know uniq -u command can help us to show the command which only used once, that fits our needs. uniq -d command can merge duplicate commands into one, it also fits our needs.\nsig=$(cat .zsh_history |uniq -u)dup=$(cat .zsh_histroy |uniq -d)commands=$(echo $sig $dup)\n\nHowever i need to combine the two results into one to get my final result, and use above method cannot realize it in a single line. All my mind is thinking how to minus the duplicate commands into one without filter out the one only used once.\nI cannot find a prefect solution. Today, when i take a bus to my working place, i suddenly realized the problem that i got. Why all my thought is how to minus? Why not plus.\nYes, that’s the trick, if i duplicate the history file, then use uniq -d to merge all the commands, the result is what i want. Since all command that only used once now become twice.\ncat .zsh_histroy .zsh_history |uniq -d\n\nThat’s the simplest answer but build behind the reverse thought. Expand data first then shrink it. And that’s inspires me a lot. We need to think in multiple ways.\nThis is the real script:\n#!/usr/bin/dash#                                                                   _ #  _ __ _   _ _ __     ___ ___  _ __ ___  _ __ ___   __ _ _ __   __| |# | &#x27;__| | | | &#x27;_ \\   / __/ _ \\| &#x27;_ ` _ \\| &#x27;_ ` _ \\ / _` | &#x27;_ \\ / _` |# | |  | |_| | | | | | (_| (_) | | | | | | | | | | | (_| | | | | (_| |# |_|   \\__,_|_| |_|  \\___\\___/|_| |_| |_|_| |_| |_|\\__,_|_| |_|\\__,_|# # this script uses dmenu to show history commands# pick one or new command to executeZSH_HISTORY=&quot;$HOME/.config/zsh/.zsh_history&quot;FONT=&quot;CaskaydiaCove Nerd FONT Mono:pixelsize=22&quot;PROMPT=&quot;execute:&quot;LINE=&quot;15&quot;command=$(cut -d&#x27;;&#x27; -f2- $ZSH_HISTORY $ZSH_HISTORY \\    | sort -r \\    | uniq -d \\    | dmenu -i -l &quot;$LINE&quot; -fn &quot;$FONT&quot; -p &quot;$PROMPT&quot;    )[ -z $command ] &amp;&amp; exit 0cd $HOME &amp;&amp; echo $command |sh\n","categories":["think"],"tags":["mindset"]},{"title":"openssh","url":"/2022/04/23/openssh/","content":"opensshinstallin archlinux, openssh is a ssh toolkit, includes client ssh and server sshd. \npacman -S openssh\n\nclientusage examples.\nremote connectconnect to remote pc with default port 22.\nssh user@ip\n\nconnect to remote pc with specified port.\nssh -p port user@ip\n\nfile copywe can download file from server and upload file to server in client.\n\nNote:\nwhatever we download or upload, we only need a ssh client tool called scp  in local machine, needless server in local. and server runs in remote machine\n\ndownload file from server\nscp server_user@server_ip:/file/directory /local/file/directory\n\nupload file to server\nscp /local/file/directory server_user@server_ip:/file/directory\n\nroot loginadd following to allow root user login\nPermitRootLogin yes\n\nchange default portchange default port 22 to other ports\nnvim /etc/ssh/sshd_configPort 40000\n\nnow, connect to the machine need specify port\nssh -p 40000 user@ip\n\nlogin without password\nmachine A: who want to connect to B\n\nmachine B: with ssh service running\n\n\nif we use ssh command often, we can configure it without password to login(A=&gt;B). there are two things we need to do:\n\nin machine A: need to product a public key\nssh-keygen# or Specifies the type of key to create.  The possible values are “dsa”, “ecdsa”, “ecdsa-sk”, “ed25519”, “ed25519-sk”, or “rsa”.ssh-keygen -t rsa# this step will create a public key (id_rsa.pub) in ~/.sshls ~/.ssh  id_rsa       id_rsa.pub       known_hosts\nin machine A: copy public key id_rsa.pub  to B’s ~/.ssh/authorized_keys\n# in machine A we can use a command to do it, this will copy content to B automaticlyssh-copy-id user_B@ip_B# or we can login machine B, and copy content of id_rsa.pub to ~/.ssh/authorized_keysscp .ssh/id_rsa.pub user_B@ip_B:/tmpssh user_B@ip_Bmkdir ~/.sshtouch ~/.ssh/authorized_keyscat /tmp/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys\n\nafter the two steps, A can connect to B without password.\nissuesconnect to an old version ssh serverUnable to negotiate with x.x.x.x port 22: no matching host key type found. Their offer: ssh-rsa fatal: Could not read from remote repository.\nthis problem comes when the remote ssh encryption method is too old/weak such as isa1. since isa1 method  will be regarded unsafe.\nin order to resolve this problem, there comes two methods:\n\nupgrade remote ssh version and then use the new encryption method such as isa2\n\nwrite a config in ~/.ssh/config, allow the connection specified\n\n\nHost 192.168.1.80    User root    PubkeyAcceptedAlgorithms +ssh-rsa    HostkeyAlgorithms +ssh-rsa\n\nssh tunnelthere are two parts.\n\nlocal port forwarding\nremote port forwarding\n\n\n\nlocal port forwarding\n\naccess local ip with port 8888 with redirect to remote server 192.168.1.3 with port 8080 though ssh server 44.11.22.33\nssh -L local_port:remote_ip:remote_port ssh_user@ssh_ip\n\neg:\nssh -L 10000:192.168.31.84:8080 root@192.168.31.116\n\nabove means i can visit http://localhost:10000 in my pc to visit remote http://192.168.31.84:8080 though ssh server 192.168.31.116. it builds a ssh tunnel between local and ssh server.\nremote port forwarding\nif any outside machine wanna to access local network service, we can create a ssh tunnel between local network machine with a outside ssh server, then any request to ssh server will redirect to local network service.\nany request to ssh server 44.11.22.33 with port 8888 will redirect to 10.0.0.3 with port 8080.\nssh -R remote_port:local_ip:local_port user@remote_ssh_ip\n\nmuch more important for remote port forwarding\n# 192.168.31.214 has a website# my machine and 192.168.31.214 are the same network, my machine and 192.168.31.221 are the other same network# execute this command in my machine will create a ssh tunnel between my machine and 221# then we can visit the website though https://192.168.31.221:4444ssh -R 4444:192.168.31.214:443 healer@192.168.31.221 -N -f# -N : don&#x27;t allow to execute command in remote machine# -f : run in background\n\n\nNote:\nwhen the ssh tunnel created successfully, we can only access  website in 214 with localhost(described in this article), becase ssh disabled gatewayport by default and it only listen on 127.0.0.1:port [::1]:port. such as:\n\n\nin order to access remote machine with ip address, we need enable gatewayport\nvim /etc/ssh/sshd_configGatewayPorts yes\n\nthen recreate ssh tunnel in my machine and  restart sshd of 214\n\nthen all will be okay\n","categories":["learn"],"tags":["ssh"]},{"title":"our-body-may-cheat-ourselves.md","url":"/2022/10/23/our-body-may-cheat-ourselves-md/","content":"Our body may cheat ourselves好几个月没有写笔记了，事实上看了很多电视剧或者电影之后都有很多感想需要去写，但是总有一种想法在脑海里，觉得花这个时间好浪费，或者是我已经很久没有calm down了。\n今天主要是想写看《the adam project》亚当计划之后的感想和之前听goggins说的一句话的理解。\ngoggins之前说过一句话：我们的身体会欺骗我们，给我们发送一些虚假的信息，并且他说可以通过大脑控制身体，当身体告诉他已经很累了，但是他可以用大脑告诉身体分泌更多的肾上腺素让自己充满力量。这是需要一个艰苦的训练过程，这也是为什么他说我们其实有能力开发更多的大脑的能力。\n我相信他的观点，我意识到了身体和意识是分离的，当我和别人发生冲突的时候，脚会不自主的抖，也就是胆怯所体现出来的，但是我的意识并没有任何胆怯，身体发送了错误的信息，而且我无法用意识来控制身体平静下来。那么在锻炼的时候身体也会欺骗我们也就不难理解了，他告诉我们很累了，但是其实并没有我们想象中的那么累。这也让我明白the true weak is not our body, but our mind.\nadam project，未来的自己回到2022年，告诉2022年的他，他人生中最美好的时光就是现在。让我有些感触，我想未来的我看到如今的我是怎么样的呢？事实上我们现在的想法和做法决定了未来的自己，而我不想未来的自己回忆起来全是遗憾叹息，我希望未来的自己会为今天所做的决定感到骄傲。这也是为什么我周末还会早起去跑步的原因，我不想和大多数人一样，被慵懒和惬意围绕，在未来回忆起现在的时候会觉得后悔。我不会让whatif发生，因为我要决定未来的样子。\na man is about his memory, 对于这句话有了更多的理解，honor or shame defines a man who we are, but not the future. if we want our future have more worth memory, we need do something now.\n","categories":["think"],"tags":["mind"]},{"title":"operate-sepcified-column-in-vim","url":"/2022/11/23/operate-sepcified-column-in-vim/","content":"OPERATE SPECIFIED COLUMN IN VIMI got a task which one person asks my help to clean up some text in a csv file. But it seems not an easy work, i mean in vim. Because vim doesn’t has the ability to operate on some specified columns, which awk or python with pandas can do it better.\nExample: the column separates by &quot;,&quot;, i need to clear column two’s text between [].\nThe options are           &quot;,&quot; [set] like with :setlocal The new value .&quot;,&quot;buffer [and] window       &quot;,&quot; [that] contain file.  [Although]&quot;,&quot; it&#x27;s possible .&quot;,&quot;[options] from a modeline &quot;,&quot; this is[ unusual]  If you have&quot;.&quot;,&quot;the files                 &quot; ,&quot; in [it] set [the] same global option &quot;,&quot;depends on which          &quot;,&quot; one was [opened] .&quot;,&quot;\n\n\nTRY SHELL SCRIPT FAILEDI tried to use awk(select each column) and sed(regex match and replace) and paste(join each column). However i failed in none greedy match, cause i only need to clean text in [], but Sed’s \\[.*\\] will match the beginning of [ till the latest ].\nTRY VIM AGAINIf i can use vim to do the stuff, i need to match separator &quot;,&quot;, and use normal command moving(n) and visual selecting(v) those text, then use ex command :s/xx/xx/g to replace it.\nCOMBINE EX WITH NORM OR NORM WITH EXIs there a way to combine: normal command + ex command or ex command + normal command?\nThe answer is “Yes”, we can do that.\n\nway to combine ex command with normal command:\n:ex normal ...&quot;Example:g/&quot;,&quot;/ normal I--\n\n\nNotice:global match :g should be used carefully, it means match something in the current buffer and do something to all lines that matched.\n\n\nway to combine normal + ex command or normal + normal:\n:exe &#x27;normal ...&#x27; | ex:exe &#x27;normal ...&#x27; | normal ...&quot;Example:exe &#x27;normal /&quot;,&quot;/(prsses ctrl+v+enter)vn(press ctrl+v+esc)&#x27; | s/\\%V\\[.\\&#123;-&#125;\\]//g :exe &quot;normal /\\&quot;,\\&quot;\\&lt;CR&gt;vn\\&lt;Esc&gt;&quot; | s/\\%V\\[.\\&#123;-&#125;\\]//g\n\n\nNotice:\nexecute should be followed by a string type of normal command, so in the string of normal command we need type the return or esc and other control character.\nthere are two ways to fill in those none visible control characters:\n\nSurrounds normal command with &#39; &#39; and press ctrl+v+control character.\nSurrounds normal command with &quot; &quot; and type control characters but begin with a \\. If there are &quot; &quot; in command, we also need to \\ to convert. \n\n\n\n\nREPLACE ONLY VISUAL SELECTED AREAThe command above, i use \\%V to reselect the selected area, the meaning of use this is if we don’t use that, we change the whole line instead of some visual selected area.\nFor example:\nI like apple and orange.&quot;i want to change apple&#x27;s a to A, and i visual select &quot;apple&quot;&quot;if i just type :s/a/A/g&quot;all a in the line will be uppercased&quot;only when i specify the visual select area with \\%V, i can realized the effect:s/\\%Va/A/g\n\n\n\nPOWERFUL MACRO RECORDThe method above seems very well, but only good for a single line, if i want to do this action to whole file, i will get a failure. Because i need to write this command tens/hundreds times to make sure it execute in every line, or write a loop condition.\nThat’s kind of weird and difficult. I only want to write a autocmd and itself will do this action to each and every line automatically.\nSo, with this mind set, i remembered macro record. Yes, one of the most powerful tool.\nThe problem is can i report those macro record? How can i call it in autocmd?\nAnd the answer “Yes” again, i can export and call it in autocmd.\nLess needs to say how to record a macro(q register ...some action...q to quik), but export is the thing i don’t remember. After search, i get it.\n&quot;if we have a macro record to register f, we can print it with&quot;fp\n\nThen we can save the output to our vim configuration for example ~/.vimrc.\nlet @f = &#x27;macro record content&#x27;&quot;orlet @f = &quot;macro record content&quot;&quot;Examplelet @f = &quot;I[\\&lt;Esc&gt;lx$pa(\\&lt;Esc&gt;j&quot;\n\n\nNotice:The choose of &#39; &#39; or &quot; &quot; is if we use &#39;&#39;: the none visible control character should be type with ctrl+v.if we use &quot;&quot;, we can use \\+&lt;Esc&gt; or any control characters, and i find this way much more useful if we want to copy the macro record to other people, since it will not expand a new line if there is a return control character.if there are some Chinese characters in macro record, we need to configure our vim with utf-8 capability, otherwise vim will convert those character to some none recognized or none matched characters. set fileencoding=utf-8\n\nAt last, we can recall it with autocmd.\naugroup macro\tautocmd!\tautocmd BufRead *.txt normal 100@faugroup end\n\n\nNotice:\nmacro record should be execute in normal mode, but autocmd execute ex command, so we need to write normal command....\n\nJust imagine how powerful it is to combine macro record with autocmd. It can do anything.\nOh, one last thing, because i actually use those methods to help one person formatting a mess csv file, the only thing she needs to do is open a csv file and save it. But she knows nothing about vim, even open and close vim as she thinks is a bit of confusion, so there comes a way to execute vim command without opening.\nvim -c :wq some.csv#and also i can write a alias to .bashrc or .zshrcalias fmt=&quot;vim -c :wq&quot;#she only needs is typingfmt some.csv\n\n\n","categories":["vim"],"tags":["macro and ex"]},{"title":"podman","url":"/2022/04/23/podman/","content":"podman# create a containerpodman run -it -d --name ubuntu ubuntu# find container pidcontainer_pid=`podman inspect -f &#123;&#123;.State.Pid&#125;&#125; container_name`# execute host command in container(only used for network command)# useful for the container have no ip commandsudo nsenter -t $container_pid -n command\n\n\n\n","categories":["learn"],"tags":["container"]},{"title":"pdnsd","url":"/2022/06/05/pdnsd/","content":"PdnsdToday, i find something new, a tool called pdnsd. It stands for persistent dns daemon. With the tool, we can cache normally visit domain (dns) information in our local computer to reduce the time resolving domain name from remote server.\ninstallpacman -S pdnsd\n\n\n\nconfigurecp /usr/share/doc/pdnsd/pdnsd.conf /etc/pdnsd.conf\n\nAt first we need to know something about the format of configuration file.\n\n # and /* */ means comment.\nin &#123;&#125; block, we write our configuration.\nthere are several block of server, and we only need one, we need comment others.\nthe rest of the configuration file we don’t need modify and it can work perfect.\n\nwe need to modify server block of dial-up\n\nchange label to resolvconf\nadd ip with our dns\nchange file to our /etc/resolv.conf\n\nat last it looks like this:\nglobal &#123;\tperm_cache=1024;\tcache_dir=&quot;/var/cache/pdnsd&quot;;#\tpid_file = /var/run/pdnsd.pid;\trun_as=&quot;pdnsd&quot;;\tserver_ip = 127.0.0.1;  # Use eth0 here if you want to allow other\t\t\t\t# machines on your network to query pdnsd.\tstatus_ctl = on;#\tparanoid=on;       # This option reduces the chance of cache poisoning\t                   # but may make pdnsd less efficient, unfortunately.\tquery_method=udp_tcp;\tmin_ttl=15m;       # Retain cached entries at least 15 minutes.\tmax_ttl=1w;        # One week.\ttimeout=10;        # Global timeout option (10 seconds).\tneg_domain_pol=on;\tudpbufsize=1024;   # Upper limit on the size of UDP messages.&#125;# The following section is more appropriate for dial-up connections.# Read about how to use pdnsd-ctl for dynamic configuration in the documentation.server &#123;\tlabel= resolvconf;\tip = 114.114.114.114;\tfile = &quot;/etc/resolv.conf&quot;;  # Preferably do not use /etc/resolv.conf\tproxy_only=on;\ttimeout=4;\tuptest=if;\tinterface = enp37s0;\tinterval=10;       # Check the interface every 10 seconds.\tpurge_cache=off;\tpreset=off;&#125;source &#123;\towner=localhost;#\tserve_aliases=on;\tfile=&quot;/etc/hosts&quot;;&#125;/*include &#123;file=&quot;/etc/pdnsd.include&quot;;&#125;\t# Read additional definitions from /etc/pdnsd.include.*/rr &#123;\tname=localhost;\treverse=on;\ta=127.0.0.1;\towner=localhost;\tsoa=localhost,root.localhost,42,86400,900,86400,86400;&#125;/*neg &#123;\tname=doubleclick.net;\ttypes=domain;   # This will also block xxx.doubleclick.net, etc.&#125;*//*neg &#123;\tname=bad.server.com;   # Badly behaved server you don&#x27;t want to connect to.\ttypes=A,AAAA;&#125;*/\n\n\n\nAnd we also need to change our /etc/resolv.conf‘s  nameserver to 127.0.0.1.\n# cat /etc/resolv.confnameserver 127.0.0.1\n\nenable and start servicesudo systemctl enable pdnsdsudo systemctl start pdnsd\n\n\n\ncheck whether it workswe need a command called nslookup which belongs to a toolset bind.\nsudo pacman -S bind\n\nnow check whether it works\n# nslookup bing.comServer:         127.0.0.1Address:        127.0.0.1#53Non-authoritative answer:Name:   bing.comAddress: 13.107.21.200Name:   bing.comAddress: 204.79.197.200Name:   bing.comAddress: 2620:1ec:c11::200# nslookup google.comServer:         127.0.0.1Address:        127.0.0.1#53Non-authoritative answer:Name:   google.comAddress: 59.24.3.174\n\nwhen the server shows 127.0.0.1 that means it works.\nnow when we visit some websites, our computer can directly go to the stored ip address without resolve it from remote dns server. cheers!\n","categories":["learn"],"tags":["optimized"]},{"title":"pandas","url":"/2022/04/23/pandas/","content":"pandaspandas是python中一个数据处理和科学分析的工具，最为强大的就是数据处理。由于它可以很轻松的处理excel数据，所以也是自动化办公的一个神器。\ninstall使用pip来安装pandas，pip需要先配置国内源，不然下载速度很慢\npip install pandas\n\n处理excel数据，还需要一个插件（openpyxl）来读取/写入excel\n# openpyxl (3.0.3)    - A Python library to read/write Excel 2010 xlsx/xlsm filespip install openpyxl\n\n\n\nthree data type\n\n\n数据结构\n维度\n特点\n\n\n\nSeries\n一维\n同构（数据类型相同），表示一列column\n\n\nDataFrame\n二维\n异构，表示一个表格table\n\n\nPanel\n三维\n异构，使用的少\n\n\n由于具有DataFrame这种二维数据结构，所以可以处理很多类似数据结构的文件，比如：excel，sql，json等\nsimple read write读取数据的时候可以直接指定index列index_col=\n数据如果太长显示不了，可以设置显示宽度pandas.options.display.max_columns=num\nexcelimport pandas as pd# 写入数据到exceldata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,22,24], &quot;score&quot;:[80,90,100]&#125;df = pd.DataFrame(data)df.to_excel(&#x27;/home/narcissus/Desktop/1.xlsx&#x27;)# 从excel读取数据pe = pd.read_excel(&quot;/home/narcissus/Desktop/1.xlsx&quot;, index_col=&#x27;name&#x27;)print(pe)\n\nmysql需要安装数据库连接驱动\npip install pymysql\n\nimport pandasimport pymysqlhost = &#x27;192.168.0.105&#x27;user = &#x27;pi&#x27;password = input(&quot;password for mysql connection: &quot;)database = &#x27;mytestdb&#x27;con = pymysql.connect(host,user,password,database)# 读取数据df = pd.read_sql_query(&#x27;select * from ssacount limit 0,10&#x27;,con)print(df)# 可以将数据库中读取到的数据直接写入excel中df.to_excel(&#x27;~/Desktop/1.xlsx&#x27;)\n\nsqliteimport sqlite3con = sqlite3.connect(&quot;testdatabase.db&quot;)df = pd.read_sql_query(&quot;SELECT * FROM ssacount&quot;, con)print(df)\n\njsondf = pd.read_json(&#x27;test.json&#x27;)\n\ncsv/tsv/txtpandas只有一个read_csv()函数，但是却可以读取这三种文件（文本文件都可以），默认读取csv文件，其分隔符为逗号，所以在读取tsv和txt的时候，要手动设置分隔符sep=&#39;&#39;\ndf = pd.read_csv(&#x27;1.csv&#x27;)df = pd.read_csv(&#x27;1.tsv&#x27;, sep=&#x27;\\t&#x27;)df = pd.read_csv(&#x27;1.txt&#x27;, sep=&#x27;文件中的特殊分隔符号&#x27;)\n\n\n\n写入值得注意的是在写入文件之前要确保去掉默认的index，需要设置成自己指定的index，否则再读取文件时，会有一个unamed的列（之前的index列）。其实可以用后面学习的skiprows在读取时指定跳过多少行，以及usecols来跳过指定列\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,None,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,None,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)# 写入文件之前需要去掉默认的indexdf.set_index(&#x27;name&#x27;, inplace=True)df.to_excel(&#x27;~/Desktop/1.xlsx&#x27;)# 读取数据时指定indexdf = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, index_col=&#x27;name&#x27;)print(df)\n\n\n\ndf.to_excel(&#x27;~/Desktop/1.xlsx&#x27;)df.to_json(&#x27;~/Desktop/test.json&#x27;)df.to_sql(&#x27;ssacount&#x27;, con)\n\n\n\nPS: 按照目前我的理解，pandas可以完美的完成这些数据文件之间的转换。可以将json，数据库中的数据导入到excel中进行可视化操作。\nDataFrame作为最重要的一个部分，DataFrame包含了几百种方法和操作，可以对数据进行任何的分析与处理。\n创建创建的方式比较多，但通常都是使用dict来创建。\nimport pandas as pddata = &#123;    \t&quot;name&quot;:[&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;],         &quot;age&quot;:[21,22,24],         &quot;score&quot;:[80,90,100]       &#125;df = pd.DataFrame(data)print(df)\n\n每一对key-value作为一个Series(column)，key作为表头，value作为数据\n自己指定index默认会自动创建一个index列，为从0开始的连续数据。可以自己指定某列为索引列\n# 使用set_index()方法df = df.set_index(&quot;name&quot;)# 或者在DataFrame中指定indexdf = pd.DataFrame(data, index=[&#x27;一班&#x27;,&#x27;二班&#x27;,&#x27;二班&#x27;])\n\n需要注意的是这个index的数据是可以重复的，并不需要唯一性\n通过index找出对应数据可以通过loc找出来的条件是设置了index，否则无法找到\nsear = df.loc[&#x27;一班&#x27;]print(sear)name     韩信age      21score    80Name: 一班, dtype: object\n\n可以看出index与其对应数据也是一个dict数据类型\n即使设置了index，也可以通过默认的index来查找iloc\nsear = df.iloc[1]\n\n\n\n指定header默认header=0,会使用第0行（index为空）/excel中的第一行作为header，即columns\ndf = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, header=1)\n\n重新自定义header，能够自定义成功的前提是这个文件本身就没有header，否则原来的header会作为一个数据行成为index=0的那一行\ndf = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, header=None)# 取指定列df = df[[1,3]]# 设置headerdf.columns = [1,2]\n\n查看开头和结尾# 默认为5行df.head()df.tail()# 可以自己指定显示多少行df.head(20)df.tail(20)\n\n\n\n查看数据信息.info()提供了很重要的一些信息，包括行，列，数据是否为空，数据类型，内存占用等\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,22,24], &quot;score&quot;:[80,80,100]&#125;df = pd.DataFrame(data)info = df.info()print(info)&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;RangeIndex: 3 entries, 0 to 2Data columns (total 3 columns): #   Column  Non-Null Count  Dtype ---  ------  --------------  -----  0   name    3 non-null      object 1   age     3 non-null      int64  2   score   3 non-null      int64 dtypes: int64(2), object(1)memory usage: 200.0+ bytesNone\n\n\n\n查看行列数.shape提供了一个简单快速查看总行数，列数的信息(rows,columns)\ninfo = df.shapeprint(info)(3,3)\n\n\n\n添加与去重添加DataFrame\ndf.append()\npandas.concat([])\n\n.append()可以将已有的DataFrame追加。但是index不会自动变化，要是index自动变化，需要调用reset_index(drop=True)\nappend如果需要将Series追加到行后面，必须加一个参数ignore_index=True\nimport pandas as pdimport pymysqldata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)tmp_df = df.append(df)print(tmp_df)    name  age  score0   韩信   21     801   韩信   21     802   李白   22     803   杜甫   24    1000   韩信   21     801   韩信   21     802   李白   22     803   杜甫   24    100\n\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)tmp_df = df.append(df).reset_index(drop=True)print(tmp_df)\tname  age  score0   韩信   21     801   韩信   21     802   李白   22     803   杜甫   24    1004   韩信   21     805   韩信   21     806   李白   22     807   杜甫   24    100\n\n使用concat默认y轴添加，使用axis=1则x轴添加\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)tmp_df = pd.concat([df,df], axis=0).reset_index(drop=True)print(tmp_df)\n\n\n\n\n\n添加Seriesimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)add = pd.Series(&#123;&#x27;name&#x27;:&#x27;筱倩&#x27;, &#x27;age&#x27;:30, &#x27;score&#x27;:88&#125;)df = df.append(add, ignore_index=True)print(df)\tname  age  score0   韩信   21     801   韩信   21     802   李白   22     803   杜甫   24    1004   筱倩   30     88\n\n\n\n添加列df[&#x27;column_name&#x27;] = []tmp_df[&#x27;add&#x27;] = [i for i in range(max(tmp_df.index)+1)]\n\n\n\n找到重复数据df.dumpllicateed(subset=&#39;column_name&#39;)可以找出指定列的重复index，和True/False的Series。那么如何通过index来找到真正的重复数据？可以通过循环，其实更加简单的方式是使用df.iloc[index]定位\nimport pandas as pdimport pymysqldata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)dum = df.duplicated(subset=&#x27;name&#x27;)# 查看是否存在重复数据print(dum.any())dum = dum[dum == True] #可以简化为dum = dum[dum]info = df.iloc[dum.index]print(info)True\tname  age  score1   韩信   21     80\n\n\n\n去重.drop_duplicates()可以将追加的重复数据清除，需要加上inplace=True这个参数，否则不会生效。\n\n默认会对整个表的数据进行去重，如果需要对指定列，那么添加参数subset=&#39;column_name&#39;\n\ntmp_df.drop_duplicates(subset=&#x27;score&#x27;, inplace=True)    name  age  score0   韩信   21     802   李白   22     803   杜甫   24    100\n\n.drop_duplicates()的keep参数：\n\nfirst，保留第一次出现的，默认\nlast，保留最后一次出现的\nFalse，去除所有重复数据\n\ntmp_df.drop_duplicates(inplace=True, keep=&#x27;first&#x27;)    name  age  score0   韩信   21     802   李白   22     803   杜甫   24    100\n\ntmp_df.drop_duplicates(inplace=True, keep=&#x27;last&#x27;)    name  age  score1   韩信   21     802   李白   22     803   杜甫   24    100\n\ntmp_df.drop_duplicates(inplace=True, keep=False)Empty DataFrameColumns: [name, age, score]Index: []\n\n\n\n修改通过df[‘column_name’]/df.column_name可以获取Series，通过Series[index]可以获取到指定的值\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)df.name[1] = &#x27;筱倩&#x27;df.age[1] = 99print(df)\tname  age  score0   韩信   21     801   筱倩   99     802   李白   22     803   杜甫   24    100\n\n\n\n替换使用到了df.iloc[index]定位，并用Series进行替换\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)alert = pd.Series(&#123;&#x27;name&#x27;:&#x27;筱倩&#x27;, &#x27;age&#x27;:30, &#x27;score&#x27;:88&#125;)df.iloc[1] = alertprint(df)\n\n插入行使用到了df[]切片以及追加操作。值得注意的是：在python中可以对list进行切片，但是在pandas中还可以对DataFrame这种二维数据进行切片\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)insert = pd.Series(&#123;&#x27;name&#x27;:&#x27;筱倩&#x27;, &#x27;age&#x27;:30, &#x27;score&#x27;:88&#125;)part1 = df[:2]part2 = df[2:]df = part1.append(insert, ignore_index=True).append(part2).reset_index(drop=True)print(df)\tname  age  score0   韩信   21     801   韩信   21     802   筱倩   30     883   李白   22     804   杜甫   24    100\n\n列# num为想插入到第几列前面df.insert(num, column=&#x27;column_name&#x27;, value=[])\n\n\n\n删除行两种方法：\n\n使用到了df.drop(index=[], inplace=True)\n可以使用切片，将需要的数据切出来然后append组合\n\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)insert = pd.Series(&#123;&#x27;name&#x27;:&#x27;筱倩&#x27;, &#x27;age&#x27;:30, &#x27;score&#x27;:88&#125;)part1 = df[:1]part2 = df[2:]# index后面可以跟一个list集合，也可以是一个range()函数df.drop(index=2, inplace=True)# 使用切片然后组合# df = part1.append(part2).reset_index(drop=True)print(df)\n\n列df.drop(columns=[],inplace=True)\n\n\n\ncolumns.columns可获取所有列名，返回的是一个列表\nprint(df.columns)Index([&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;], dtype=&#x27;object&#x27;)\n\n.rename()可修改列名\ndf.rename(columns=&#123;&#x27;name&#x27;:&#x27;Name&#x27;, &#x27;age&#x27;:&#x27;AGE&#x27;&#125;, inplace=True)\n\ncol.lower()搭配列表生成式可以转换小写\ndf.columns = [col.lower() for col in df.columns]\n\n\n\nNull数据行清除.isnull()找出null数据，null数据显示True，非空数据显示False\nprint(df.isnull())\n\n.sum()计算总的null数据\nprint(df.isnull().sum())\n\n.dropna()删除有null数据的行，只要有一个null数据就会清除\ndf.dropna(inplace=True)\n\n可以看到这种清除数据的缺点，无法对指定列的Null数据进行清除，所以需要使用到过滤\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,None,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,None,24], &quot;score&quot;:[80,80,80,100]&#125;# 为了能够找到手动输入的None数据列，对其进行了转换df = pd.DataFrame(data).fillna(0)miss = df.loc[df.name == 0 ].indexdf.drop(index=miss, inplace=True)print(df)\tname   age  score0   韩信  21.0     802   李白   0.0     803   杜甫  24.0    100\n\n\n\nNull数据列的清除.dropna(axis=1)使用了一个参数axis\ndf.dropna(inplace=True, axis=1)\n\n为什么是1？在我们使用df.shape的时候返回一个tuple，(rows,columns)，可以看出columns的索引为1\n使用mean来填充null数据列.fillna(column_name, inplace=True)如果将有null的数据列都删除的话， 那么数据的缺失会比较大，可以用平均值来填充\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,None,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,None,22,24], &quot;score&quot;:[80,80,80,100]&#125;df = pd.DataFrame(data)# 取出age列age = df[&#x27;age&#x27;]# 取平均值age_mean = age.mean()# 将age列中的null用平均值填充age.fillna(age_mean, inplace=True)print(df)\n\n\n\n获取数据描述前面用.info()获取了对DataFrame的描述，但是.describe()可以获取关于数据的描述：包括最大值，最小值，平均值，列数，行数等。既可以是整个DataFrame，也可以是某一列。\n# 整个表print(df.describe())# age列print(df[&#x27;age&#x27;].describe())\n\n\n\n查看某列数据相同数据的个数.value_counts()指定列的数据出现个数\nprint(df[&#x27;score&#x27;].value_counts())\n\n\n\n重组DataFrametype(df[&#39;age&#39;])的类型是一个serise，而type(df[[&#39;age&#39;]])的类型是一个DataFrame，所以可以使用这种方式来重新选取需要的列构成新的DataFrame\nnew_df = df[[&#x27;name&#x27;, &#x27;age&#x27;]]print(new_df)\n\n\n\n数据的过滤在Series的基础上过滤用条件判断来过滤数据：&gt; &lt; == !=等\ninfo = (df[&#x27;score&#x27;] == 80)print(info)# 可以得到true of false的返回值0     True1     True2     True3    False\n\n如果想要直接得到过滤后的数据\ninfo = df[df[&#x27;score&#x27;] == 80]print(info)   name   age  score0    韩信  21.0     801   None   NaN     802    李白  22.0     80\n\n还可以使用逻辑判断\ninfo = df[(df[&#x27;score&#x27;] &gt; 80) | (df[&#x27;age&#x27;] == 22)]\n\n使用isin()更加简洁\ninfo = df[df[&#x27;age&#x27;].isin([21,22])]\n\n上面的所有方法都很简洁，但是数据量比较大的时候，效率就比较低\n所以我们需要使用函数来进行过滤，使用.apply()将column传递给函数\ndef filter_score(x):    if x == 100:        return True    else:        return Falseinfo = df.loc[df[&#x27;score&#x27;].apply(filter_score)]# 简化info = df[df[&#x27;score&#x27;].apply(filter_score)]# 简化，其实我不理解为什么可以这么写info = df[df.score.apply(filter_score)]\n\n可以使用匿名函数简化\ninfo = df[df[&#x27;score&#x27;].apply(lambda x : x == 100)]# 再简化info = df[df.score.apply(lambda x : x == 100)]\n\n\n\n在DataFrame基础上过滤axis=1表示每一行（x轴），axis=0表示每一列（y轴）\ndef filter_score(x):    if x.score == 100:        return True    else:        return Falseinfo = df.apply(filter_score， axis=1)print(info)\n\n\n\n从指定行或列开始读取可能表格并不是从第一行第一列开始写的，所以需要指定从哪里开始读取，否则会出现许多的unamed row和Nan值\nimport pandas as pd df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;)print(df)# 这里包含了一个空行，和一个index列，读取的时候会出现这些问题Unnamed: 0 Unnamed: 1 Unnamed: 2 Unnamed: 30         NaN       name        age      score1         0.0         韩信         21         802         1.0         韩信         22         803         2.0         李白         22         804         3.0         杜甫         24        100\n\n使用skiprows(num)和usecols=[]来选取需要的数据\nimport pandas as pd df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, skiprows=1, usecols=[1,2,3])# 或者使用列名指定df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, skiprows=1, usecols=[&#x27;name&#x27;,&#x27;age&#x27;,&#x27;score&#x27;])print(df)# 这样就能读取需要的数据了\tname  age  score0   韩信   21     801   韩信   22     802   李白   22     803   杜甫   24    100\n\n自动填充功能用python来实现excel中拖拽自动填充的功能，生成序列数据进行填充，比较复杂的是日期的处理\n\n连续数据：list赋值\n交叉数据：三目运算\n日期数据：自定义函数\n\nimport pandas as pdfrom datetime import date,timedeltadata = &#123;&#x27;name&#x27;:[&#x27;李白&#x27;,&#x27;杜甫&#x27;,&#x27;白居易&#x27;,&#x27;王维&#x27;], &#x27;age&#x27;:[None,None,None,None], &#x27;birthday&#x27;:[None,None,None,None], &#x27;drink&#x27;:[None,None,None,None]&#125;df = pd.DataFrame(data)print(df)=======================================================================================\tname   age birthday drink0   李白  None     None  None1   杜甫  None     None  None2  白居易  None     None  None3   王维  None     None  None=======================================================================================# 初始化日期start = date(1600,1,31)# 定义日期处理函数，传一个开始日期以及添加的月份def add_month(start_date, add_month):    tmonth = start_date.month + add_month    cyear = start_date.year + tmonth // 12     cmonth = 12 if tmonth % 12  == 0 else tmonth % 12    cday = start_date.day\t# 由于不同月份的天数不同，所以需要考虑    if cday &gt; 28:        if cmonth == 2:            cday = 29 if cyear % 4 == 0 and cyear % 100 != 0 or cyear % 400 == 0 else 28        elif cday == 31 and cmonth in [1,3,5,7,8,10,12]:            cday = 31        elif cday == 31 and cmonth in [2,4,6,9,11]:            cday = 30    return date(cyear,cmonth,cday)# 对age进行填充，使用到了list的赋值df[&#x27;age&#x27;] = [i+20 for i in range(df.shape[1])]# 使用循环index，来对每一项进行赋值for i in df.index:    # 用到了三目运算，实现交叉数据填充    df[&#x27;drink&#x27;][i] = &#x27;like&#x27; if i % 2 == 0 else &#x27;hate&#x27;        # day递增的情况：day的相加有对应的函数    df[&#x27;birthday&#x27;][i] = start + timedelta(days=i)\t# year递增的情况：year的相加可以在year上直接添加    df[&#x27;birthday&#x27;][i] = date(start.year+i, start.month, start.day)\t# month递增的情况：比较复杂，涉及到year与month进位的问题，调用自定义函数实现    df[&#x27;birthday&#x27;][i] = add_month(start,i+10)print(df)=======================================================================================\tname  age    birthday drink0   李白   20  1600-11-30  like1   杜甫   21  1601-12-31  hate2  白居易   22  1601-01-31  like3   王维   23  1601-02-28  hate=======================================================================================\n\n\n\n计算功能x轴向乘法使用到了pandas特有的list相乘，以及list展开相乘（这在python语法中是没有的，乘也是list的复制）\nsr1 = pd.Series([21,18,22,24])sr2 = pd.Series([80,80,80,100])df = pd.DataFrame(&#123;&#x27;A&#x27;:sr1, &#x27;B&#x27;:sr2&#125;)print(df)# pandas的list乘df[&#x27;C&#x27;] = df[&#x27;A&#x27;] * df[&#x27;B&#x27;]df[&#x27;D&#x27;] = df[&#x27;C&#x27;] * 100# 可以使用apply()df[&#x27;E&#x27;] = df[&#x27;B&#x27;].apply(lambda x:x+2)print(df)A    B0  21   801  18   802  22   803  24  100    A    B     C       D    E0  21   80  1680  168000   821  18   80  1440  144000   822  22   80  1760  176000   823  24  100  2400  240000  102\n\nx轴向求和/平均前面都是使用的Series来进行计算的，如果需要的不止一列的数据呢？比如说需要每一行的和和平均值，当然也可以将所有列写出来计算，但是有点麻烦，其实可以指定轴。它会自动过滤掉文字列，只计算数字列。(索引不会计算)\naxis=1指定x轴，按行计算，从上到下\nimport pandas as pddf1 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet1&#x27;)df2 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet2&#x27;)table = df1.join(df2, how=&#x27;left&#x27;).fillna(0)table[&#x27;qq&#x27;] = table[&#x27;qq&#x27;].astype(int)table[&#x27;sum&#x27;] = table.sum(axis=1)table[&#x27;mean&#x27;] = table.mean(axis=1).astype(int)print(table)\tname  age  score student          qq         sum        mean0   韩信   21     80      韩信   124242423   124242524    621212621   赵云   22     10      赵云    12342356    12342388     61711942   李白   22     30      李白   574534563   574534615   2872673073   杜甫   24    100      杜甫     6785842     6785966     33929834   曹操   18     75      曹操    34563342    34563435    172817175   姜尚   45     75      姜尚    57845262    57845382    289226916   阿狗   23     11      阿狗    45645834    45645868    228229347   筱倩    3     99      筱倩    58364743    58364845    291824228   夫子  123    107      夫子  4824854834  4824855064  24124275329   葛聂   33     90       0           0         123          61\n\ny轴向求和/平均并添加到DataFrame\n必须设置ignore_index=True，否则无法添加\n\nimport pandas as pddf1 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet1&#x27;)df2 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet2&#x27;)table = df1.join(df2, how=&#x27;left&#x27;).fillna(0)table[&#x27;qq&#x27;] = table[&#x27;qq&#x27;].astype(int)# 这里省略了axis=0,因为这是默认值total = table.mean()sum = table.sum()# total为一个Series，可以设置name值total[&#x27;name&#x27;] = &#x27;平均值&#x27;sum[&#x27;name&#x27;] = &#x27;总和&#x27;# 将Nan转为空table = table.append([total,sum], ignore_index=True).fillna(&#x27;&#x27;)print(table)name    age  score student            qq0    韩信   21.0   80.0      韩信  1.242424e+081    赵云   22.0   10.0      赵云  1.234236e+072    李白   22.0   30.0      李白  5.745346e+083    杜甫   24.0  100.0      杜甫  6.785842e+064    曹操   18.0   75.0      曹操  3.456334e+075    姜尚   45.0   75.0      姜尚  5.784526e+076    阿狗   23.0   11.0      阿狗  4.564583e+077    筱倩    3.0   99.0      筱倩  5.836474e+078    夫子  123.0  107.0      夫子  4.824855e+099    葛聂   33.0   90.0       0  0.000000e+0010  平均值   33.4   67.7          5.739179e+0811   总和  334.0  677.0          5.739179e+09\n\n\n\n排序.sort_values(by=[],inplace=True,ascending=[False])\n默认生成一个新的DataFrame，使用inplace=True在原DataFrame上修改\n默认使用升序排列，用ascending=False来降序排列\n\n对一列数据进行排序\n\nimport pandas as pdsr2 = pd.Series([21,18,22,22,24])sr3 = pd.Series([80,80,60,80,100])df = pd.DataFrame(&#123;&#x27;A&#x27;:sr2, &#x27;B&#x27;:sr3&#125;)df.set_index(&#x27;A&#x27;, inplace=True)df.sort_values(by=&#x27;A&#x27;, inplace=True, ascending=False)print(df)\n\n\n对多列数据进行排序，而且第一列倒序，第二列升序\n\nimport pandas as pdsr2 = pd.Series([21,18,22,22,24])sr3 = pd.Series([80,80,60,80,100])df = pd.DataFrame(&#123;&#x27;A&#x27;:sr2, &#x27;B&#x27;:sr3&#125;)df.set_index(&#x27;A&#x27;, inplace=True)df.sort_values(by=[&#x27;A&#x27;,&#x27;B&#x27;], inplace=True, ascending=[False,True])print(df)\n\n\n\n数据相关性之前在一篇文章中看到df.corr()时，没看懂它到底什么意思，有什么作用。今天看了老师讲的视频，才发现这个东西超级无敌厉害。它就是分析一个表中每两列数据之间的相关性的。\n\n1.0代表完全相关\n比例越大，相关性越大\n\nimport pandas as pdsr2 = pd.Series([21,18,22,22,24])sr3 = pd.Series([80,80,60,80,100])df = pd.DataFrame(&#123;&#x27;age&#x27;:sr2, &#x27;score&#x27;:sr3&#125;)df.corr()# 可以看出score与age之间的相关性比较小，仅有0.3\t\t\tage\tscoreage\t\t1.000000\t0.322749score\t0.322749\t1.000000\n\n\n\n从不同sheet页读取import pandas as pddf1 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet1&#x27;)df2 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet2&#x27;)print(df1)print(df2)# table = df1.merge(df2, on=&#x27;name&#x27;)# print(table)\tname  age  score0   韩信   21     801   赵云   22     102   李白   22     303   杜甫   24    1004   曹操   18     755   姜尚   45     756   阿狗   23     117   筱倩    3     998   夫子  123    1079   葛聂   33     90  name          qq0   韩信   1242424231   赵云    123423562   李白   5745345633   杜甫     67858424   曹操    345633425   姜尚    578452626   阿狗    456458347   筱倩    583647438   夫子  4824854834\n\n\n\n多表联合查询用到了与数据库类似的操作，merge两个DataFrame，默认为inner join,可以设置left/right join\n\ndf.merge()需要指定关联的列，具有内连接，左/右连接\ndf.join()默认使用index作为关联的列，不具有内连接，左/右连接\npandas.concat([],axis=num)\n\nimport pandas as pddf1 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet1&#x27;)df2 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet2&#x27;)table = df1.merge(df2, on=&#x27;name&#x27;)print(table)\tname  age  score          qq0   韩信   21     80   1242424231   赵云   22     10    123423562   李白   22     30   5745345633   杜甫   24    100     67858424   曹操   18     75    345633425   姜尚   45     75    578452626   阿狗   23     11    456458347   筱倩    3     99    583647438   夫子  123    107  4824854834\n\n可以发现默认是使用的inner join，要df1的数据全部显示出来，使用left join方式\ntable = df1.merge(df2, how=&#x27;left&#x27;, on=&#x27;name&#x27;)\n\n如果要关联的两张表的columns名字不同，那么不能使用on，而需要使用left_on=&#39;&#39;,right_on=&#39;&#39;来连接\n\tname  age  score0   韩信   21     801   赵云   22     102   李白   22     303   杜甫   24    1004   曹操   18     755   姜尚   45     756   阿狗   23     117   筱倩    3     998   夫子  123    1079   葛聂   33     90  student          qq0      韩信   1242424231      赵云    123423562      李白   5745345633      杜甫     67858424      曹操    345633425      姜尚    578452626      阿狗    456458347      筱倩    583647438      夫子  4824854834\n\n关联之后数据会出现Nan值，使用fillna()函数来填充null\n如果显示的是小数或者科学计数，可以使用astype()设置为数据类型\nimport pandas as pddf1 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet1&#x27;)df2 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet2&#x27;)table = df1.merge(df2, how=&#x27;left&#x27;, left_on=&#x27;name&#x27;, right_on=&#x27;student&#x27;).fillna(0)table[&#x27;qq&#x27;] = table[&#x27;qq&#x27;].astype(int)print(table)\tname  age  score student          qq0   韩信   21     80      韩信   1242424231   赵云   22     10      赵云    123423562   李白   22     30      李白   5745345633   杜甫   24    100      杜甫     67858424   曹操   18     75      曹操    345633425   姜尚   45     75      姜尚    578452626   阿狗   23     11      阿狗    456458347   筱倩    3     99      筱倩    583647438   夫子  123    107      夫子  48248548349   葛聂   33     90       0           0\n\n使用join()函数\nimport pandas as pddf1 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet1&#x27;)df2 = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, sheet_name=&#x27;Sheet2&#x27;)table = df1.join(df2, how=&#x27;left&#x27;).fillna(0)table[&#x27;qq&#x27;] = table[&#x27;qq&#x27;].astype(int)print(table)\tname  age  score student          qq0   韩信   21     80      韩信   1242424231   赵云   22     10      赵云    123423562   李白   22     30      李白   5745345633   杜甫   24    100      杜甫     67858424   曹操   18     75      曹操    345633425   姜尚   45     75      姜尚    578452626   阿狗   23     11      阿狗    456458347   筱倩    3     99      筱倩    583647438   夫子  123    107      夫子  48248548349   葛聂   33     90       0           0\n\n\n\n数据列分割使用到了Series.str.split()方法，另外Series.str有很多方法可以用，可以对字符串进行各种操作。\nimport pandas as pd data = &#123;&#x27;A&#x27;:[&quot;hello joyce&quot; for i in range(1,8)]&#125;df = pd.DataFrame(data)# 不使用expand，那么数据会作为一个listinfo = df.A.str.split(expand=True)df[&#x27;first&#x27;] = info[0]df[&#x27;last&#x27;] = info[1]print(df)\n\n\n\n行列转换df.transpose()即可，为了避免旋转后第一行为index，所以在读取的时候需要指定index\nimport pandas as pddf = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, index_col=&#x27;name&#x27;)df = df.transpose()print(df)\n\n\n\n提取日期pandas.DatetimeIndex(df[&#x27;column_name&#x27;]).yearpandas.DatetimeIndex(df[&#x27;column_name&#x27;]).monthpandas.DatetimeIndex(df[&#x27;column_name&#x27;]).day\n\n\n\n分组，聚合模拟透视表功能\nimport pandas as pdimport numpy as npdf.pivot_table(index=&#x27;column_name&#x27;, columns=&#x27;column_name&#x27;, value=&#x27;column_name&#x27;, aggfunc=np.sum)\n\n分组\ngroups = df.groupby(&#x27;column_name&#x27;)\n\n聚合\nS = groups[&#x27;column_name&#x27;].sum()\n\n\n\n条件颜色import pandas as pd def colorlize(x):    colors = &#x27;orange&#x27; if x &lt; 60 else &#x27;lime&#x27;    # 这里返回的格式必须要是这样    return f&#x27;color:&#123;colors&#125;&#x27;def another(x):    # 这里需要返回一个list    return [&#x27;color:red&#x27; if v &gt; 90 else &#x27;background-color:black&#x27; for v in x]     df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;)# 可直接添加在后面# df.style.apply(another, subset=[&#x27;age&#x27;,&#x27;score&#x27;])df.style.applymap(colorlize, subset=[&#x27;age&#x27;,&#x27;score&#x27;]).apply(another, subset=[&#x27;age&#x27;,&#x27;score&#x27;])\n\n\n需要注意的：\n\ndf.style.applymap()获取到的是每一个值\ndf.style.apply()获取到的是一个Series，但是需要用for循环读取每一个值，这和之前用的df.apply()自动循环每一个值不同\n\n颜色条import pandas as pd df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;)df.style.bar(color=&#x27;pink&#x27;, subset=[&#x27;age&#x27;,&#x27;score&#x27;])\n\n\n渐变颜色需要下载seaborn模块\npip install seaborn\n\nimport pandas as pd import seaborn as sndf = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;)color_map = sn.light_palette(&#x27;pink&#x27;, as_cmap=True)df.style.background_gradient(color_map, subset=[&#x27;age&#x27;, &#x27;score&#x27;])\n\n\n\nSeriesSeries序列用来生成一维数据。类似list数据类型\nimport pandas as pddata = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;貂蝉&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,18,22,24], &quot;score&quot;:[80,80,80,100]&#125;sr = pd.Series(data)print(sr)name      [韩信, 貂蝉, 李白, 杜甫]age       [21, 18, 22, 24]score    [80, 80, 80, 100]\n\nSeries组装DataFrame\n使用dict组装。不指定index时，使用默认的index\n\nimport pandas as pdsr1 = pd.Series([&quot;韩信&quot;,&quot;貂蝉&quot;,&quot;李白&quot;,&quot;杜甫&quot;])sr2 = pd.Series([21,18,22,24])sr3 = pd.Series([80,80,80,100])df = pd.DataFrame(&#123;&#x27;name&#x27;:sr1, &#x27;age&#x27;:sr2, &#x27;score&#x27;:sr3&#125;)print(df)  name  age  score0   韩信   21     801   貂蝉   18     802   李白   22     803   杜甫   24    100\n\n\n还可以手动指定index\n\nimport pandas as pdsr1 = pd.Series([&quot;韩信&quot;,&quot;貂蝉&quot;,&quot;李白&quot;,&quot;杜甫&quot;], index=(1,2,3,4), name=&#x27;name&#x27;)sr2 = pd.Series([21,18,22,24], index=(1,2,3,4), name=&#x27;age&#x27;)sr3 = pd.Series([80,80,80,100], index=(1,2,3,4))df = pd.DataFrame(&#123;sr1.name:sr1, sr2.name:sr2, sr3.name:sr3&#125;)print(df)  name  age  NaN1   韩信   21   802   貂蝉   18   803   李白   22   804   杜甫   24  100\n\n\n使用list组装。如果不指定index和name，那么会用默认的index来填充columns和index\n\nimport pandas as pdsr1 = pd.Series([&quot;韩信&quot;,&quot;貂蝉&quot;,&quot;李白&quot;,&quot;杜甫&quot;],  index=(1,2,3,4), name=&#x27;name&#x27;)sr2 = pd.Series([21,18,22,24], index=(1,2,3,4), name=&#x27;age&#x27;)sr3 = pd.Series([80,80,80,100], index=(1,2,3,4), name=&#x27;score&#x27;)df = pd.DataFrame([sr1, sr2, sr3])print(df)        1   2   3    4name   韩信  貂蝉  李白   杜甫age    21  18  22   24score  80  80  80  100\n\n可以发现，使用list来组装DataFrame时，会将Series以行的形式展示。如果用dict来组装，那么会将Series以列的形式组装。\nDataFrame取出Series两种方式：\n\n这种就是python自身的语法，DataFrame由字典组成，所以使用df[&#39;column_name&#39;]即可\n使用pandas DataFrame数据结构的语法，df.column_name也可以\n\n\n制图pandas是构建于matplotlib之上，所以需要先下载\n# matplotlib (3.2.1)                 - Python plotting packagepip install matplotlib\n\n使用到的数据：\n\n柱状图第一个例子：\nimport pandas as pd import matplotlib.pyplot as pltdf = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, skiprows=1, usecols=[1,2,3,4])# 先排score，再排age，从大到小df.sort_values(by=[&#x27;score&#x27;,&#x27;age&#x27;], inplace=True, ascending=False)# pandas支持制图df.plot.bar(x=&#x27;name&#x27;, y=[&#x27;score&#x27;,&#x27;age&#x27;], color=[&#x27;lightblue&#x27;,&#x27;orange&#x27;])# 紧凑显示plt.tight_layout()# 使用matplotlib来渲染plt.show()\n\n\n中文支持默认matplotlib无法显示中文，需要从matplotlib导入font_manager\nfrom matplotlib import font_manager\n\n查看有那些中文字体\nfc-list :lang=zh/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc: WenQuanYi Micro Hei,文泉驛微米黑,文泉驿微米黑:style=Regular/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc: WenQuanYi Micro Hei Mono,文泉驛等寬微米黑,文泉驿等宽微米黑:style=Regular\n\n设置font变量\nfont = font_manager.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)\n\n在需要显示中文的地方加上fontproperties属性。需要注意只有matplotlib才能加这个属性，所以在需要加这个属性的时候，要用matplotlib来设置\nplt.xticks(rotation=40, fontproperties=font)\n\n\n\n使用matplotlib修饰matpllotlib比pandas自带的制图功能要多，可定制性更强。导入matplotlib的作用呢就是来补充pandas自身制图功能的一些不足，以及渲染图片。\n由于pandas基于matplotlib，所以这两个可完美的搭配使用。在pandas搞不定的地方就用matplotlib来补充\n分组柱状图import pandas as pd import matplotlib.pyplot as pltfrom matplotlib import font_managerfont = font_manager.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)# 读取df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, skiprows=1, usecols=[1,2,3,4])# 排序df.sort_values(by=[&#x27;score&#x27;,&#x27;age&#x27;], inplace=True, ascending=False)# 用pandas自身绘制分组柱状图df.plot.bar(x=&#x27;name&#x27;, y=[&#x27;score&#x27;,&#x27;age&#x27;], color=[&#x27;lightblue&#x27;,&#x27;orange&#x27;])# pandas自身绘图的标签不支持中文，那么用matplotlib来让标签显示中文，以及设置一定旋转角度# plt.xticks(rotation=20, fontproperties=font, fontsize=14)# 上面这个无法设置旋转中心，所以使用下面的# gca获取x轴，ha=&#x27;right&#x27;设置右端对齐px = plt.gca()px.set_xticklabels(df[&#x27;name&#x27;], rotation=20, ha=&#x27;right&#x27;, fontproperties=font, fontsize=14)# gcf获取图形的布局pf = plt.gcf()pf.subplots_adjust(left=0.1)# 用matplotlib来设置x轴名称plt.xlabel(&#x27;name&#x27;, fontsize=20)# 用matplotlib来设置y轴名称plt.ylabel(&#x27;score&#x27;, fontsize=20)# 用matplotlib来设置titleplt.title(&#x27;学习情况统计表&#x27;, fontproperties=font, fontsize=24, color=&#x27;lightpink&#x27;)plt.tight_layout()plt.show()\n\n\n\n\n叠加柱状图\n需要自己新计算一个新的列，这个列的值为需要叠加的数据之和\n使用这个新的列作为排序的标准\ny轴仍然为之前的列\n只不过在df.plot.bar显示的时候加了一个参数stacked=True，声明使用叠加的方式\n\nimport pandas as pd import matplotlib.pyplot  as plt from matplotlib import font_managerfont = font_manager.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, usecols=[1,2,3,4,5], skiprows=1)df[&#x27;total&#x27;] = df[&#x27;age&#x27;] + df[&#x27;score&#x27;]df.sort_values(by=&#x27;total&#x27;, inplace=True, ascending=False)df.plot.bar(x=&#x27;name&#x27;, y=[&#x27;score&#x27;, &#x27;age&#x27;], color=[&#x27;brown&#x27;,&#x27;pink&#x27;], stacked=True)px = plt.gca()px.set_xticklabels(df[&#x27;name&#x27;], rotation=10, ha=&#x27;right&#x27;, fontproperties=font)plt.xlabel(&#x27;name&#x27;)plt.ylabel(&#x27;count&#x27;)plt.title(&#x27;学习情况统计&#x27;, fontproperties=font, fontsize=22, fontweight=&#x27;bold&#x27;)plt.show()\n\n\n水平叠加柱状图其实只需要改一个参数就可以了，将df.plot.bar改为df.plot.barh就代表水平展示了。\n\n这个时候的排序可能需要调整一下\n如果自定义了x轴，y轴的话，需要交换一下\n\nimport pandas as pd import matplotlib.pyplot  as plt from matplotlib import font_managerfont = font_manager.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, usecols=[1,2,3,4,5], skiprows=1)df[&#x27;total&#x27;] = df[&#x27;age&#x27;] + df[&#x27;score&#x27;]df.sort_values(by=&#x27;total&#x27;, inplace=True)df.plot.barh(x=&#x27;name&#x27;, y=[&#x27;score&#x27;, &#x27;age&#x27;], color=[&#x27;brown&#x27;,&#x27;pink&#x27;], stacked=True)px = plt.gca()px.set_yticklabels(df[&#x27;name&#x27;], rotation=10, ha=&#x27;right&#x27;, fontproperties=font)plt.xlabel(&#x27;count&#x27;)plt.ylabel(&#x27;name&#x27;)plt.title(&#x27;学习情况统计&#x27;, fontproperties=font, fontsize=22, fontweight=&#x27;bold&#x27;)plt.show()\n\n\n饼图绘制饼图的优点是可以清晰的看出各部分所占的比例\n与柱状图不同，饼图需要的数据为一个Series，同时在读取数据的时候指定的index会成为饼图显示的信息\n\n饼图注意点还挺多的，最为重要的就是使用pandas来绘制，无法显示中文，所以采用了plt来绘制\n采用matplotlib时，也无法直接设置字体，需要用循环给具体的对象赋值\n对序列排序，并通过绘制时的顺时针来设置旋转方向\n通过startangle来设置最大值从12点方向开始\n\nimport pandas as pd from matplotlib import font_manager as fm from matplotlib import pyplot as plt font = fm.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, skiprows=1, usecols=[1,2,3,4])# 为了顺序显示，进行排序。这里没有从大到小排是因为后面绘制的时候可以使用counterclock来设置顺时针排序df.sort_values(by=&#x27;score&#x27;, inplace=True)# 使用pandas自身的绘图，无法显示中文，所以不采用# df[&#x27;score&#x27;].plot.pie(labels=df[&#x27;name&#x27;])# 使用matplotlib来绘制图形，label为标签名paint = plt.pie(df[&#x27;score&#x27;], labels=df[&#x27;name&#x27;], counterclock=True, startangle=-270)# 即便是通过matplotlib来绘制，中文也不好显示，只能通过返回值来找到text所在位置，并循环设置中文字体for i in df.index:    paint[1][i].set_fontproperties(font)plt.title(&#x27;学习情况统计&#x27;, fontproperties=font, fontsize=22, fontweight=&#x27;bold&#x27;)# ylabel来设置左边显示文字plt.ylabel(&#x27;score&#x27;, fontsize=16)plt.show()\n\n对数据进行排序之后会出现，比例较小的部分字重叠，这也是一个问题。\n\n所以不对其进行排序显示的效果可能会更好。\n\n折线图\n折线图在绘制的时候，只要直接使用.plot就可以了。需要指定y轴的数据\nx轴的数据可以通过指定index来设置\n\nimport pandas as pd from matplotlib import pyplot as plt from matplotlib import font_manager as fm font = fm.FontProperties(fname=&#x27;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&#x27;)data = &#123;&#x27;score&#x27;:[45,76,56,100,93], &#x27;age&#x27;:[16,18,24,29,35]&#125;df = pd.DataFrame(data)df.plot(y=[&#x27;score&#x27;,&#x27;age&#x27;])plt.title(&#x27;年龄与分数走势图&#x27;,fontproperties=font, fontsize=22)plt.xlabel(&#x27;time&#x27;)plt.xticks(df.index)plt.ylabel(&#x27;count&#x27;)plt.show()\n\n\n叠加区域图只需要在折线图的基础上将.plot改为.plot.area即可\ndf.plot.area(y=[&#x27;score&#x27;,&#x27;age&#x27;])\n\n\n散点图散点图就可以看出pandas的处理速度完胜excel，同时交换x，y轴数据，pandas可以轻松搞定，而excel在数据量多的时候无法操作。\n\n使用到了df.plot.scatter()来画散点图\n\nimport pandas as pdfrom matplotlib import pyplot as pltfrom matplotlib import font_manager as fm font = fm.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, skiprows=1, usecols=[1,2,3,4])df.plot.scatter(x=&#x27;score&#x27;, y=&#x27;age&#x27;, color=&#x27;brown&#x27;)plt.title(&#x27;学习与年龄散点图&#x27;, fontproperties=font, fontsize=22)plt.show()\n\n\n分布图可以清晰的看出指定数据的分布情况。分布图只需要Series就可以\n\n使用了Series.plot.hist(bins=num)\n参数bins设置划分区间，越多图越精细\nplt.xticks()设置x轴的分段，默认Series分段少，使用range()函数，来设置步长\n\nimport pandas as pdfrom matplotlib import pyplot as pltfrom matplotlib import font_manager as fm font = fm.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, skiprows=1, usecols=[1,2,3,4])df[&#x27;score&#x27;].plot.hist(bins=10)plt.xticks(range(0,max(df[&#x27;score&#x27;]),4), rotation=90)plt.xlabel(&#x27;score&#x27;)plt.title(&#x27;分数分布图&#x27;, fontproperties=font, fontsize=20)plt.show()\n\n\n密度图直接使用会报错，提示缺少一个scipy的科学库\n# scipy (1.4.1)                   - SciPy: Scientific Library for Pythonpip install scipy\n\n\n\n密度图同样使用Series\n\n使用Series.plot.kde(),其它与分布图类似\n\nimport pandas as pdfrom matplotlib import pyplot as pltfrom matplotlib import font_manager as fm font = fm.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)df = pd.read_excel(&#x27;~/Desktop/1.xlsx&#x27;, skiprows=1, usecols=[1,2,3,4])df[&#x27;score&#x27;].plot.kde()plt.xlabel(&#x27;score&#x27;)plt.title(&#x27;密度分布图&#x27;, fontproperties=font, fontsize=20)plt.show()\n\n\n\n终于一口气学完了这个模块，感觉功能确实很多，而且没学到的功能还有很多。但是就目前掌握的这些来说，写个自动化办公的脚本来说已经够了。数据的读取，增删查改，制图等等功能都很好用。虽然是一边看视频，一边敲代码，但是熟悉程度还不够，还的在日常的生活中多用才会熟练。学完一个东西觉得很开心，但是又觉得有点失落，因为我接下来要学什么呢？是个很大的问题。要不学学powershell吧！\n","categories":["learn"],"tags":["python"]},{"title":"run_in_backend","url":"/2022/04/23/run-in-backend/","content":"run in backendokay, let’s check whether there is a program running in backend.\njobs\n\nif it shows like this then it has a program running in backend, if nothing, no program running in backend (always we can say like this).\n➜  ~  jobs[1]  + suspended  xterm\n\n[1] is job number, suspended is program status, xterm is program name. if we wanna to see program pid, just type jobs -l.\n5 ways running in backend\nwhen a terminal program runs, press ctrl+z, then program will stop and send to backend. after that type bg %jobs_number  will make background jobs running in backend.\nbg %job_number\nadd &amp; at the end of command running program.\ncommand &amp;\nadd nohup at the start of command and add &amp; at the end of command. it is much useful if we need logout of the system such as in a remote environment.\nnohup command &amp;\nuse setsid\nsetsid command_to_execute\nuse (&amp;)\n() will expand command in a subshell, put &amp; after command in () will run in backend\n(command &amp;)\n\n\nNote:\nmethods of 3,4,5 can resolve the problem when we logout the terminal but leaving the program execute continue.\nif we use methods 1,2. we can also make it execute continue as 3,4,5 with disown\n# change all jobs running in backend belongs to pid 1disown -a# change a specified job belongs to pid 1disown %job_number\n\nkill program in backendfirst find job number\njobskill %job_number\n\nor find program pid\njobs -lkill $pid\n\n\n\nstart program in backendwith this command, we can make program in the backend with stop status running.\nbg %job_number\n\nanother way is using kill command\nkill -cont $pid\n\n\n\npause program in backendwith this command, we can pause program running in backend.\nkill -stop $pid\n\n\n\nput backend in frontwith this command, we can put backend program in front.\nfg %job_number\n\n\n\n\n\n","categories":["learn"],"tags":["linux"]},{"title":"python","url":"/2022/04/23/python/","content":"PYTHONpython is a dynamic language, very powerful, useful and simple to use.\npython interpreterbecause python is a dynamic language, a interpreter is needed for using. there are two ways to install python interpreter:\n\ninstall from  source code, this way need compiling,  and it is complex, download in official website, uncompress then compile\n./configuremakemake testsudo make install\nif we use linux distribution, it is easy to download with package manager.\n# such as in archlinuxpacman -S python\n\nafter installing, check it’s version\npython --version\n\n\n\npipwhat is pip? it is a package manager of python module. let’s install it.\ninstall\nnote that there are two pip package available,\n\npip2: this is used for python2\npip3:  this is used for python3\n\nso, which one should we choose depend on which python version we use.\npython --version\n\nin centos:\n# epel repo neededyum install epel-releaseyum install python2-pip\n\nin archlinux:\npacman -S python-pip\n\nrepo config\nin defalut, download speed is very slow. we need to modify mirror configuration\npip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple\n\nthe command will change mirror to tnua, and we can find the config in ~/.config/pip/pip.conf\nmodule location\ncommand to find the default position\npython -m site\n\nbe careful the USER_SITE value, it stores the package location pip installed\nnow let us to see where is the config file\npython -m site --help\n\nthe config file is /usr/lib/python3.8/site.py\nthen we can change the default value to any other site you want, such as\nUSER_SITE = &quot;/home/narcissus/Software/python_lib&quot;\n\nfrom now on, we use pip command install packages, they will be stored in customized position\nexample:\npip install pandas --user\n\n\n\n\n\n\n代码风格\npython代码的一个很明显的特点就是缩进。代码块是通过缩进来组织的，代码块使用冒号:来标识\n\n单行注释使用#\n# 单行注释\n多行注释使用&quot;&quot;&quot; &quot;&quot;&quot;\n&quot;&quot;&quot;多行注释&quot;&quot;&quot;\n一行代码拆分多行使用\\\nuser = &#123;&quot;name&quot;:&quot;snippet&quot;,\\        &quot;age&quot;:&quot;12&quot;,\\        &quot;gender&quot;:&quot;male&quot;        &#125;print(user[&quot;age&quot;])\n命名规范\n\n类命名：使用大驼峰的规范，即每个单词都以大写字母开头\nclass UserInfo():    name = &quot;python&quot;\n变量命名：\n\n第一种：小驼峰，即第一个单词小写开头，其余字母大写开头baiduUrl = &quot;https://www.baidu.com&quot;\n第二种：所有字母全部小写，并用_连接，我比较喜欢这个baidu_url = &quot;https://www.baidu.com&quot;\n\n\n\n\n\n变量作用：\n变量是一个字符串，用来保存数据的内存地址，指向内存中数据Data的位置。\n变量所保存的内存地址可以被改变，所以变量可变\n如果在程序中多处都要使用到这个数据，那么使用变量则可以只修改一个地方就行\n\n赋值：\n由于python是解释型语言，所以在声明变量时，不需要指定变量的类型\nname = &quot;xiaotianquan&quot;\n还可以一次性赋值多个\nname,age,like = &quot;gou&quot;,2,&quot;food&quot;print(name,age,like)\n\n引用直接写变量名即可\n数据类型标准数据类型：\n数字\n 直接写数字，不加引号，加了引号作为字符串\n age = 3\n字符串 str\n 用引号括起来的作为字符串，可以使用单引号和双引号 这两种没有区别，因为没有变量置换（shell和perl中）这种操作，它使用的是拼接\n\n布尔 True/False\n 在python中，布尔值也可以作为数字使用 True = 1, False = 0\n age = 3print(age+True)\n列表 list\n 用[]表示，可以存储不同类型的数据\n data = [1,2,3,4,5,6,7,&quot;a&quot;,&quot;b&quot;]print(data)\n\n 切片操作\n\n使用:，取出指定范围的数据，可以使用函数id()查看取出数据的内存地址list[start_index:end_index:step]\ndata1 = [1,2,3,4]# 作用为复制列表，使用频率高，有效的避免对原数组数据造成破坏data2 = data1[:]# 内存地址不同print(id(data1),id(data2))# 与data[:]作用相同，-1为最后一个元素的索引data3 = data1[0:-1]# 指定位置,前闭后开[)data4 = data1[0:2]# 指定步幅data4 = data1[::2]# 逆序data8 = data1[-1::-1]# 负数索引data5 = data1[-3:-1]\n\n 其它\n # 删除指定元素data6 = data1.remove(2)# 从后往前取出数据（删除）data7 = data1.pop()# 乘data9 = data1 * 2# 列表生成式data10 = [ i for i in range(1,10) ]# 嵌套data11 = [data,data10]# 循环取出嵌套数据for i in data11:    for j in i:        print(j)    # 如果嵌套的两个list元素个数一致，可以使用一层嵌套即可取出所有值la = [1,2,3,4]lb = [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;]lc = [la,lb]for i,j,k,l in lc:    print(i,j,k,l)# 查看list元素个数len(data)# 全部为数字时，可以取最大值，最小值max(la)min(la)# 查看某个元素存在多少个la.count(1)\n元组 tuple\n 使用()，为一个不可修改列表，大部分用法与list一致\n data = (1,2,3,4,&quot;a&quot;,&quot;b&quot;)# 创建一个只有一个元素的tuple，后面需要一个逗号data = (1,)print(type(data))# 可以不加括号data = 1,print(type(data))data = 1,2,3,4print(type(data))# 创建空的tupledata = tuple()data = ()# 通过list创建tuplemylist = [i for i in range(1,9)]data = tuple(mylist)# tuple的特殊用法，两个元素交换a = 1b = 2a,b = b,a\n集合 set\n\n数据有序，而且不可重复,具有取出重复的作用\n\n通过list和tuple来生成集合\na = [1,2,3,4,2,1,3]b = set(a)print(type(b))print(b)\n通过&#123;&#125;来定义集合\na = &#123;1,2,2,5,3,4&#125;print(type(a))\n集合没有索引，只能for循环取出元素\na = &#123;i**2 for i in range(1,10)&#125;for i in a:    print(i)\n集合运算\na = &#123;i for i in range(1,5)&#125;b = &#123;i for i in range(3,7)&#125;# 交集c = a.intersection(b)# 并集d = a.union(b)# 差集e = a.difference(b)\n让集合不可修改\na = &#123; i for i in range(1,5)&#125;b = frozenset(a)\n\n 其它 \n # 生成奇数、偶数集合a = &#123;i for i in range(1,10) if i % 2 == 0&#125;b = &#123;i for i in range(1,10) if i % 2 != 0&#125;# 删除集合中的数，如果不存在则会报错sa = &#123;i for i in range(1,10)&#125;sa.remove(1)# 删除集合中的数，如果不存在不会报错sa.discard(11)# 集合中也有pop函数，但是是随机的sa.pop()\n\n字典 dict\n 输入字典数，以及字典数据，进行去重（相同key值相加），排序\n num = int(input())lt = &#123;&#125;for i in range(num):    # map可同时设置数据类型    a,b = map(int, input().split())    if a in lt.keys():        lt[a] += b    else:        lt[a] = b# sorted可对字典进行排序，key可以使用lambda来指定使用key或者value排序lt = sorted(lt.items(), key=lambda a: a)for i in lt:    print(i[0], i[1])\n\n\n\n数据类型嵌套-对象在list，tuple，set，dict中均可以存储对象\nclass User():    name = &quot;ls&quot;    age = 21user = User()a = [user]b = (user,)c = &#123;user&#125;d = &#123;&quot;obj&quot;:user&#125;print(type(a),type(b),type(c),type(d))print(a[0].name,b[0].name,d[&quot;obj&quot;].name)for i in c:    print(i.name,i.age)\n\n\n运算符\n算数运算符\n关系运算符\n赋值运算符\n逻辑运算符\n位运算\n成员运算符\n身份运算符\n\n算数运算符\npython没有自增自减运算符\n包括：\n加 +\n减 -\n乘 *\n除\n普通除法 /\n取余 %\n取整 //\n\n\n\n\n所有运算符都可以使用运算赋值的缩写：  +=，-=，*=,/=,%=,//=  a = 1a += 1print(a)\n  已经有运算赋值这两个操作了，所以不能再赋值\n\n比较运算符比较运算的结果一定为一个布尔值：True/False\n\n等于 ==\n不等于 !=print(3!=4)\n其它\n&gt;\n&gt;=\n&lt;\n&lt;=\n\n\n\n赋值运算符使用等号来赋值=，将数据data赋值给变量\n逻辑运算符返回结果为True/False\n\nand\nor\nnot\n\na = 1if a == 3 or a == 2 :    print(&quot;true&quot;)else:    print(&quot;false&quot;)\n\n成员运算符用来检测一个值或者变量是否在一个集合中,返回结果为True/False\n\nin\nnot ina = 1b = [i for i in range(1,5)]c = a in bd = a not in bprint(c,d)\n\n身份运算符用来判断两个变量是否一致,返回结果为True/False\n\nis\nis nota = 1b = 1c = 2print(a is b)print(a is c)print(a is not c)\n\n程序结构\n顺序  程序从上到下依次执行\n循环  for  while\n分支  if\n\n分支结构这里的条件表达式只要是返回结果为True/False即可\nif 条件表达式:    语句1elif 条件表达式:    语句2else:    语句3\n\n举例1：\nuser = input(&quot;type your name: &quot;)if user == &quot;root&quot;:    print(&quot;you are the admin&quot;)elif user == &quot;narcissus&quot;:    print(&quot;you are the normal user&quot;)else:    print(&quot;you are the user not in group sudo&quot;)\n\n举例2：空字符串为假\nif &quot;&quot;:    print(&quot;true&quot;)else:    print(&quot;false&quot;)\n\n\n循环结构for循环用来遍历序列中的所有元素\nfor 变量 in 序列:    语句\n\n举例：\nfor i in range(1,10):    print(i)\n\n\n循环中的条件跳转\nbreak 终止循环\ncontinue 跳过continue后的语句\npass 没有实际作用，用来占位\n\n\n\n举例：\nfor i in range(2,20):    if i % 2 == 0:        print(str(i) + &quot;能被2整除&quot;)        continue    elif i % 3 == 0:        print(str(i) + &quot;能被3整除&quot;)        pass    else:        break\n\nwhile循环当条件成立时，一直循环。这个条件必须要有终止，否则会形成死循环。\nwhile 条件表达式:    语句\n\n举例1：求a，b的最小公约数\na = 2b = 5c = 1while c % a != 0 or c % b != 0:    c += 1    print(a,b,c)\n\n举例2：\ni = 1while i &lt; 3:    i += 1    try:        num =  int(input(&quot;num&quot;))        a = 5 / num        print(a)    except Exception as e:        print(&quot;输入非零整数&quot;)\n\n\n函数\n命名一般采用:动词_名词的形式\n\n意义复用代码\n\n定义\ndef 函数名():    语句\n调用\n函数名()\n举例：\nimport timedef get_time():    now = time.strftime(&quot;%Y%m%d-%H:%M:%S&quot;)    print(now)get_time()\n\n参数\n分类方式1：\n\n形参：在写函数时，括号中的那个参数\ndef get_name(name):    print(name)\n实参：在函数调用时括号中传入的参数\nget_name(&quot;小舞&quot;)\n\n\n分类方式2：\n\n位置参数：在传参时必须一一对应\ndef normal(name,age,like):    print(&quot;&#123;&#125; is &#123;&#125; years old and like &#123;&#125;&quot;.format(name,age,like))normal(&quot;小舞&quot;,20,&quot;star&quot;)\n关键字参数：在传参时不必一一对应，而是使用参数名来设置参数\ndef keyword(name,age,like):    print(&quot;&#123;&#125; is &#123;&#125; years old and like &#123;&#125;&quot;.format(name,age,like))keyword(age=20, name=&quot;小舞&quot;, like=&quot;star&quot;)\n默认参数: 给参数设置默认值，如果不传则使用默认值，不过默认参数后面不能写位置参数\ndef default(a,b,c=1):    print((a + b) / c)default(1,2)\n收集参数：在不确定会传入参数个数的情况下使用\n\n如果后面还有位置参数，那么位置参数会作为关键字参数，而且位置不能变\n如果有两个星号，那么表示收集所有参数包括关键字参数def collection(*count):    sum = 0    for i in count:        sum += i    return sumcollection(1,2,3,4)\n\n\n\n\n\ndef collection(*count,another=1):\nsum = 0\nfor i in count:\n    sum += i\nreturn sum + another\ncollection(1,2,3,4,another=5)\n- 分解参数：    1. 将list和元组作为参数传给函数时    ```python    def expend(*args):        sum = 0         for i in args:            sum += i        return sum    a = (i for i in range(1,10))    b = [i for i in range(1,10)]    print(expend(*a))    print(expend(*b))\n\n    2. 将字典作为参数传给函数时\n    def expend(**args):    sum = 0    for i in args:        sum += args[i]    return sumc = &#123;&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3&#125;expend(**c)\n\n返回值\n函数可以有返回值，也可以没有返回值，使用return来返回执行结果\n但是在python中还是推荐有返回值，如果没有实际值返回可以返回一个None\n函数一旦执行return之后函数就会结束，return后面的语句不会执行\n\n举例：\ndef sum(a,b):    return a + ba = sum(1,2)print(a)c = 1def plus():    global c    c += 1    return None# 函数没有返回值，每次调用函数c的值就自增1plus()print(c)\n\n计算九九乘法表：我写的挺复杂\nfor y in range(1,10):    x = 1    while x &lt;= y:        print(str(x) + &quot;*&quot; + str(y) + &quot;=&quot; + str(x*y) \\        + &quot; &quot;,end=&#x27;&#x27;)        x += 1        if x &gt; y:            print(end=&quot;\\n&quot;)\n\n简单写法\nfor y in range(1,10):    for x in range(1,y+1):        print(&#x27;&#123;&#125;*&#123;&#125;=&#123;&#125;\\t&#x27;.format(x,y,x*y),end=&quot;&quot;)    print()\n\n三角形\nfor y in range(1,10):    for x in range(1,10-y):        print(&quot;   &quot;,end=&quot;&quot;)    for x in range(1,2*y):        print(&quot; 1 &quot;,end=&quot;&quot;)    print()\n\n\n递归函数函数直接或者间接调用自己，需要有结束条件\n优缺点：\n\n优点：书写理解简单\n缺点：执行速度慢\n\n写法：\n\n结束条件\ndef plus(num):    if num == 1:        return 1# 这个函数调用时，传入1，得到plus(1) = 1# 不能这么写，这么写是错误的def plus(num):    plus(1) = 1\n返回自己\ndef plus(num):    if num == 1:        return 1    return num + plus(num-1)plus(100)\n举例：斐波拉契数列\n\n\n普通写法\n# 1, 1, 2, 3, 5, 8, 13.....def fun(num):    a = b = i = 1    sum = 1 if num == 1 else 2    while i &lt; num-1:        a,b = b,a+b        i += 1        sum = sum + b     print(&quot;第&#123;&#125;个斐波拉契数为：&#123;&#125;，总数为：&#123;&#125;&quot;.format(num,b,sum)) fun(3)\n\n使用递归写法\n# 1, 1, 2, 3, 5, 8, 13.....def fib(num):    if num == 1 or num == 2:        return 1    return fib(num-1) + fib(num-2)def fib_list(num):    for i in range(1,num+1):        print(fib(i))fib_list(10)\n\n尾递归对比普通写法和递归的写法，递归函数在调用40次时已经停止调用了，而且在求同一个斐波拉契数的时候，普通写法速度秒杀递归写法。普通写法单线程求第十万个斐波拉契数不到一秒，第一百万个斐波拉契数约六秒。所以递归函数不适合复杂计算\n递归函数为什么慢？因为递归函数运行时，每一次调用都会返回一个表达式，不能返回一个确定的值，那么原函数的参数，逻辑结构等这些都不能修改，每次计算机在调用函数时会使用堆栈，每调用一个函数会增加一层栈帧，所以当递归过程多次调用函数的时候可能会导致大小有限的堆栈溢出。优化方式之一是尾递归\n为什么尾递归可以优化？尾递归与递归都需要调用自身，看起来没多大区别（我刚开始也没看懂），但是尾递归每次都不是返回的表达式，而是返回的一个函数，至于计算结果，那是通过变量的形式进行传递的，这么做的好处就是不用开新的栈，而是刷新原函数，将参数传递进去就好了。所以做到了优化，但是python中即使是使用了尾递归，次数仍然只能达到999次。并不是真正意义上的尾递归\n在很多时候我们都是在刷新变量的值，而并不是重新用一个别的变量\nsum = 0for i in range(1,10):    sum += iprint(sum)\n\n尾递归的斐波拉契函数写法：\n# 1, 1, 2, 3, 5, 8, 13.....def fib(num, first=1, second=1, sum=2):    if num == 2 or num == 1:        return second,sum    return fib(num-1, second, first+second, sum+first+second)fib(7)\n利用三目运算简写\ndef fib(num, first=1, second=1, sum=2):    return 1 if num == 1 else(sum  if num == 2 else fib(num-1, second, first+second, sum+first+second))fib(7)\n通过上面尾递归的写法，可以看出函数调用自身的作用类似于计数，真正计算的过程在参数中。其实类似于普通函数的写法\n函数的使用在python中一切皆是对象，所以函数也是对象，函数名指向的是代码段的内存地址\n\n作为元素使用：放在list，tuple，set，dict中\ndef user():    print(&quot;hello&quot;)one = user()a = [one]\n作为参数传递给函数\n\n可以被赋值\n\n作为函数的返回值\n\n\n字符串在linux相关的运维上，有很多都是处理字符串，所以字符串有点重要的\n路径问题在很多情况下，输入路径需要各种转义才行，为了避免这种麻烦，使用r\nlocation = r&#x27;c:\\user\\kite\\desktop&#x27;print(location)\n\n变量替换（字符串拼接、格式化）\n%\nprint(&quot;i like %s and %s&quot;%(&quot;cat&quot;,&quot;dog&quot;))\nformat函数，使用&#123;&#125;\n\n直接使用\nprint(&quot;i like &#123;&#125; and &#123;&#125;&quot;.format(&quot;cat&quot;,&quot;dog&quot;))\n使用变量\na = &quot;i like &#123;&#125; and &#123;&#125;&quot;print(a.format(&quot;cat&quot;,&quot;dog&quot;))\n指定位置\na = &quot;i like &#123;0&#125; and &#123;0&#125; and &#123;1&#125;&quot;print(a.format(&quot;cat&quot;,&quot;dog&quot;))\n使用命名：\n\n我觉得这种还不错，虽然字多了一点，但是很清晰a = &quot;i like &#123;animal&#125; and &#123;animal&#125; and &#123;drink&#125;&quot;print(a.format(animal=&quot;cat&quot;,drink=&quot;juice&quot;))\n在传入的参数比较多时，使用字典是最好的,需要使用到参数分解，这个是目前我觉得最好的a = &quot;i like &#123;animal&#125; and &#123;animal&#125; and &#123;drink&#125;&quot;b = &#123;&quot;animal&quot;:&quot;cat&quot;,&quot;drink&quot;:&quot;juice&quot;&#125;print(a.format(**b))\n\n\n指定数字长度\na = &quot;pi is &#123;:.2f&#125;&quot;print(a.format(1.1314))\n\n\n\n判断类函数函数以is开头，返回值为True/False\n内置函数字符串的关键字为str，通过str来查看帮助文档\nhelp(str)\n\n举例\nurl = r&quot;https://www.baidu.com&quot;# 查找，索引，未找到返回-1url.find(&quot;http&quot;)# 从指定位置开始查找，优化查找速度url.find(&quot;d&quot;,10)# 从右边查找，查找字符在结尾时优化查找速度url.rfind(&quot;m&quot;)# 查找，索引，未找到报错url.index(&quot;h&quot;)# 开头，结尾，返回True，Falseurl.startswith(&quot;https&quot;)url.endswith(&quot;com&quot;)# 是否全大小写,返回True，Falseurl.isupper()url.islower()# 大小写转换url.upper()url.lower()# 首字母大写url.capitalize()# 不带参数代表空格，去除开头结尾空格error = r&quot;   https://www.baidu.com   &quot;a = error.strip()# 带参数去除开头结尾指定字符url.strip(&quot;https&quot;)\n\n\n类与对象类通过class来定义，对象由类实例化而来。类的作用在于为对象提供一个模板，它包含了属性和函数。最重要的是类提供了继承，封装，多态这三大特性。\n# 定义类class User():    pass# 实例化xiaolu = User()\n查看类的所有方法：__dict__\nstr.__dict__\n\n类属性和方法在类定义之后，就在内存中保存了类的属性和方法，可以直接调用\nclass User():    name = &quot;jounr&quot;    def get_name(self):        return self.nameprint(User.name)print(User.get_name(User))\n\n\n实例方法：使用最多的方法，需要将类实例化成为对象，通过对象调用方法\n\n静态方法：\n\n不需要实例化，通过类直接调用\n静态方法包装在staticmethod类的对象中，定义中没有self，可直接通过类来调用方法class MyClass():    def tellme():        print(&quot;i am a static method,without self&quot;)    tellme = staticmethod(tellme)MyClass.tellme()\n\n\n类方法：\n\n不需要实例化，通过类直接调用，如果调用需要传参的函数，则将类自己作为参数传递进去\n类方法包装在classmethod类的对象中，参数为cls，虽然可以通过对象来调用，但是实际上cls还是会关联到类的方法class MyClass():    def tellme(cls):        print(&quot;i am a class method,with args sls&quot;)    tellme = classmethod(tellme)MyClass.tellme()\n\n\n\n装饰器\n上面的类方法和静态方法，需要手动写，但是可以通过使用装饰器来自动包装\n用来替代手工包装，可用于包装任何可调用对象，还可用于方法和函数。装饰器可以有多个，指定多个时，应用的顺序与列出的顺序相反class MyClass():    @staticmethod    def tellme():        print(&quot;new decorator&quot;)MyClass.tellme()\n\nself\nself作为一个参数，常常用在类的函数中，但并不是所有类的函数都需要这个参数\nself并不是一个关键字，也可以用其它的替代\n如果这个函数需要访问类的属性，那么需要self这个参数，它用来指代实例自身\n如果这个函数不需要访问类的属性，那么不需要self这个参数\n在有self的时候，首先会看函数自己是否定义属性，如果没有，则访问类的属性class User():    age = 20    id = 1    qq = 102832343    def info():        print(&quot;hello&quot;)    def get_age(self):        return self.age    def get_qq(self):        self.qq = 2312323123        return self.qq,self.ageone = User()one.info()print(one.get_age())print(one.get_qq())\n\n继承\n继承父类的属性，函数等。避免了代码的冗余，也可重写父类的方法\n\n将父类作为参数传递给子类\n\n子类可以继承自多个类\nclass User():    name = &quot;one&quot;    age = 20    def get_name(self):        return self.nameclass Customer():    id = 1class Realone(User,Customer):    passa = Realone()a.get_name()print(a.id)\n子类扩充父类的方法：使用super()调用父类方法\nclass User():    name = &quot;journal&quot;    def get_name(self):        print(self.name)class SomeOne(User):    def get_info(self):        super().get_name()        print(&quot;attend super&quot;)a = SomeOne()a.get_info())\n检测是否为子类\nprint(issubclass(Realone,User))\n\n构造函数\n在类实例化的时候第一个自动调用的函数，作用是给对象初始化一些数据\n\n必须有参数self,函数名为__init__\nclass User():    def __init__(self):        self.name = &quot;lixingyun&quot;a = User()print(a.name)\n通过继承，扩展父类的构造函数\nclass User():    def __init__(self,name):        self.name = name        print(name)# 直接写父类的init方法，只能写一个父类，不推荐使用class One(User):    def __init__(self,name):        # 先调用父类的init函数        User.__init__(self,name)        print(&quot;initial finish&quot;)# 可以自动向上寻找父类的init方法，父类没有写死，推荐使用class Two(User):    def __init__(self,name):        super(Two,self).__init__(name)        print(&quot;initial finish&quot;)a = One(&quot;小小&quot;)b = Two(&quot;小小&quot;)\n构造函数默认被继承\n\n如果定义了自己的构造函数，那么父类的构造函数不再被继承。也叫重写父类函数\n\n\n封装封装即为对对象成员进行访问限制\n\n私有：最高级别的限制，只能在当前类或者对象中访问。通过在变量前加__实现\nclass User():    __name = &quot;喜洋洋&quot;    __age = 20one = User()# 无法直接访问print(one.name)\n其实私有也不是真的无法访问，还是可以访问的\nprint(one._User__age)\n受保护的：在外部不可访问，可以在内部和子类中访问。通过在变量前加_实现\n\n公有的：任何地方都可以使用\n\n\n多态\n同一个对象在不同情况下有不同的状态\n在python中是一种设计思想，并没有语法要求，其实我也搞不懂\n\n类的函数转属性类中的get，set，del函数可以转换为属性\nclass User():    def __init__(self,name):        self.name = name    def get_name(self):        return self.name    def set_name(self,name):        self.name = nameone = User(&quot;小小&quot;)one.get_name()one.set_name(&quot;小青&quot;)one.get_name()\n\n可以使用property(get,set,del)函数对get，set，del封装。将函数转换为一个属性值\nclass User():    def __init__(self,name):        self.name = name    def get_name(self):        return self.name    def set_name(self,name):        self.name = name    sname = property(get_name, set_name)two = User(&quot;小二&quot;)two.snametwo.sname = &quot;可可&quot;two.sname\n\n类的内置属性\n__dict__： 显示类的属性和方法\n__doc__： 类的说明文档\n__name__： 类的名称\n__bases__： 类的所有父类\n\n类的魔法函数不需要手动调用，达到触发条件，自动调用\n\n__init__： 初始化类的属性\n\n__call__： 当对象被当做函数使用的时候，调用此函数\nclass User():    def __call__(self):        print(&quot;此时对象被当做函数调用了&quot;)one = User()one()\n__str__： 当对象被当做字符串使用的时候，调用此函数\nclass User():    def __str__(self):        return &quot;此时对象被当做字符串使用了&quot;one = User()print(one)\n__getattr__： 当访问一个不存在的属性时，调用此函数\nclass User():    def __getattr__(self,method):        return &quot;此函数不存在&quot;one = User()print(one.age)\n\n抽象\n抽象方法\n\n定义了方法，但没有实现\nclass User():    def get_name(self):        pass\n\n\n抽象类\n\n必须导入模块abc\n抽象类不可以实例化，必须继承后实例化，继承的子类需要实现所有的继承来的抽象方法\n作用为设定类的标准\n\n\n\nimport abcclass User(metaclass=abc.ABCMeta):    # 定义抽象方法    @abc.abstractmethod    def get_name(self):        pass    # 定义类抽象方法    @abc.abstractclassmethod    def get_age(self):        pass    # 定义静态抽象方法    @abc.abstractstaticmethod    def get_id(self):        pass    # 定义普通方法    def set_qq(self,qq):        self.qq = qq\n\n组装类函数名可以作为变量使用\nclass User():    passdef he(self):    print(&quot;hello&quot;)User.he = heone = User()one.he()\n\n\n\nPackagepackage is a collection of modules, which must be included with a file called __init__.py\n\nhow to import a package\n\nimport all include __init__.py\nimport package_namepackage_name.function_name()package_name.class_name.function_name()\nonly import specify module,except __init__.py\nimport package_name.module_name as md1md1.function_name()md1.class_name()\nanother way import should be mentiond\nfrom package_name import *\nthe way import only import function and class which in __init__.py\n\n\n\n\nmodulea module is a file contains python code.it’s suffix with .py\n\nwhy we need module?\n\nshrink program,make it easy to maintain\nmodule can be reused\nused as a namespace,reduce name conflict\n\n\nhow to use module?\n\nimport directily\nimport module_namemodule_name.function_name()module_name.class_name()\nif the module name prefix with num such as 2.py\nimport importlibvariable = importlib.import_module(&quot;02&quot;)variable.function_name()variable.class_name()\nuse as rename module when the name of module is long\nimport module_name as somename\nimport module’s class or function,not whole module\nfrom module_name import someclass,somefunctionvariable1 = someclass()variable2 = somefunction()\nimport all class and function\n\n\n  the benifit of it is writing class or function directily without module name prefix\n  from module_name import *variable = someclass()\nwhere modules store?\n\ndefault location\nimport sysfor i in sys.path:    print(i)\nadd own module location\nimport syssys.path.append(directory)\n\n\n\nthe entrance of code\nin genreal,all entrance of code should be started with this\nit can control whether to execute some code,if used as a code which will be execute,if used as a module which will not be execute\n\nif __name__ == &quot;__main__&quot;:    print(&quot;first execute code&quot;)\n\n\n\nError catchsome days ago,i really don’t know why we need to catch error.in my mind,i think we should not write code with error.until one day,i get a problem,i need to create a temporary table first and then delete it every time the script run.and the error appeard.some times the table isn’t exist,when execute the delete code,the program broken.at last i use error catch to avoid the error\neg:get user type in\ntry:    num = int(input(&quot;num:&quot;))    result = 100 / num    print(result)except:    print(&quot;not a none zero number&quot;)\n\n\nsyntaxtry:    ...    # can raise error by hand    raise some_error_type# if it is the error below(tuple),execute this codeexcept (error_type1,error_type2...):    ...    # exit() can exit the program    exit()# we can print error infomationexcept ZeroDivisionError as e:    print(e)# Exception is the supper of all except typeexcept Exception as e:    ...# if not in the error above execute this codeelse:    ...# what ever error happend,will execute this codefinally:    ...\n\nTime muduleimport time# get time now with formatnow = time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)# another way to get the format timehour = time.localtime().tm_hour# get the timestampunique = time.time()# sleeptime.sleep(second_number)\n\nimport timeit# calcute program execute time with number times repeatt1 = timeit.timeit(stmt=&quot;[i for i in range(10)]&quot;,number=100)def number():    lt = []    for i in range(10):        lt.append(i)t2 = timeit.timeit(stmt=number,number=100)\n\nimport datetime# convert string to datea = datetime.date(2020,10,10)print(a)b= datetime.time(10,10,10)print(b)c = datetime.datetime(2020,10,10,10,10,10)print(c)# get the current datetimed = datetime.date.today()print(d)\n\n\nOS moduleassociated with operate system\nthree important modules:\n\nos\nos.path, used for path\nshutil, used for directory,file\n\nimport osdir = os.getcwd()os.chdir(&quot;../&quot;)# get file and dir of current directory with out hidden filelt = [i for i in os.listdir() if not i.startswith(&quot;.&quot;)]# execute shell commandos.system(&quot;htop&quot;)# get system environment variablesos.getenv(&quot;SHELL&quot;)\n\n\nimport os.path as opabsc = op.abspath(&quot;.&quot;)# used for different operate systemd1 = &quot;/home/narcissus&quot;d2 = &quot;1.txt&quot;os.join(d1,d2)# os.path.split return a tuple,so can be used like thisd1,d2 = op.split(&quot;/home/narcissus/1.txt&quot;)# whether a path existsop.exists(&quot;/home/narcissus/1.txt&quot;)\n\n\nimport shutilshutil.copy(&quot;1.txt&quot;,&quot;2.txt&quot;)shutil.move(&quot;1.txt&quot;,&quot;2.txt&quot;)# archive all file of Desktop into test.tarshutil.make_archive(&quot;/home/narcissus/Desktop/test&quot;,&quot;tar&quot;,&quot;/home/narcissus/Desktop/&quot;)# unarchive fileshutil.unpack_archive(&quot;/home/narcissus/Desktop/test.tar&quot;,&quot;.&quot;,&quot;tar&quot;)\n\nRandom moduleimport random# return a number in the interval [0,1)r1 = random.random()# return a number in the interval [0,100)r2 = int(random.random()*100)# random choice in the interval [1,100)l1 = [i for i in range(0,100)]random.choice(l1)# shuffle listl1 = [i for i in range(1,10)]print(l1)random.shuffle(l1)print(l1)# random integerrandom.randint(1,100)\n\n\n\nFunctional programmingfeatures:\n\nfunction can be used as a parameter \nfunction can be used as return value\n\nlambdalambda exprssion\n\nbegin with lambda\nhave zero or more parameter\nuse : split lambda with expression\nno return keyword\n\nla = lambda x: x * 100la(10)lb = lambda x,y,z: x + y*10 + z/2lb(2,4,8)\n\nhigh-level functiondef get_name():    print(&quot;小小&quot;)# function is a variablevariable = get_namevariable()\n\n# normal functiondef plus(num):    return num * 100def add(num):    return plus(num) + 100add(3)# high_level functiondef plus(num):    return num * 100def high_level(fun,num):    return fun(num) + 100high_level(plus,2)\n\nmapmap(func,*iterables)\nl1 = [i for i in range(10)]print(l1)# use lambda expression ,ten times a nummult = lambda num: num * 10# use map to generate a class mapl2 = map(mult,l1)print(l2)# class object can be iterabledl3 = [i for i in l2]print(l3)\n\nreducenotice:\n\nneed import module\nfunction need two parameters\nfunction need return value\n\nprinciple:reduce(1,2,3) = f(f(1,2),3)\nfrom functools import reducel1 = [i for i in range(10)]plus = lambda x,y: x + yl2 = reduce(plus,l1)print(l2)\n\nfilternotice:\n\nfunction need return a boolean\nfilter return a class object which can be iterabled\n\nfilter(function,*iterables)\nl1 = [i for i in range(10)]fit = lambda x: x % 2 == 0l2 = filter(fit,l1)l3 = [i for i in l2]print(l3)\n\n\nsortednumber sorted\nimport randoml1 = [i for i in range(10)]random.shuffle(l1)print(l1)l2 = sorted(l1)print(l2)l3 = sorted(l1,reverse=True)print(l3)\n\ncharactor sorted\nl1 = [&quot;sda&quot;,&quot;dev&quot;,&quot;HOME&quot;,&quot;Alian&quot;,&quot;alias&quot;]l2 = sorted(l1)print(l2)l3 = sorted(l1, key=str.lower)print(l3)l4 = sorted(l1, key=str.lower, reverse=True)print(l4)\n\n\nClosure packageB function defined inside A function,and B function as a return vlaue,all parameters of A can be used by B,it is called closure\ndef A(*args):    def B():        sum = 0        for i in args:            sum += i        return sum    return Bl1 = [i for i in range(20)]one = A(*l1)one()\n\n\nDecoratorDecorator is a high-level function,i can return a function.\nfeature:\n\nextend origion function without change its code\nuse @ to called a decorator\n\nimport timedef now(func):    def pf(*args,**kwargs):        print(&quot;Time:&quot;,time.ctime())        return func(*args,**kwargs)    return pfdef line(func):    def pf(*args,**kwargs):        print(&quot;=&quot;*50)        return func(*args,**kwargs)    return pf# use system decorator @@now@linedef he(name):    print(&quot;hello&quot;,name)he(&quot;小小&quot;)# by hand execute without system decorator @return_fun = now(he)return_fun(&quot;小小&quot;)\n\nPartial functionreturn a new function with some of its parameters fixed\nimport functools# convert 16 to 10int16 = functools.partial(int,base=16)int16(&quot;f&quot;)# we can realize this by handdef int16(num,base=16):    return int(num,base)int16(&quot;f&quot;)\n\n\nzipcombine two iterable object into several tuples\nl1 = [i for i in range(1,10)]l2 = [i for i in range(100,110)]l3 = [i for i in zip(l1,l2)]print(l3)\n\nenumerategive each iterable object a index and return several tuples,notice that the index can be customized\nl1 = [i for i in range(1,10)]l2 = [i for i in enumerate(l1,start=1)]print(l2)\n\ncollections module\nnamedtuple: it can limit the number of tuple\ndeque: it is much faster than list\ndefaultdict: no error report when query none exist key\nCounter: regard string as a iterable dict\n\nimport collectionscircle = collections.namedtuple(&quot;circle&quot;,[&quot;x&quot;,&quot;y&quot;,&quot;r&quot;])p = circle(3,4,5)if p.x**2 + p.y**2 == p.r**2:    print(&quot;it is a circle&quot;)\n\nimport collectionsql = collections.deque()ql.append(1)print(ql)\n\nimport collectionsfunc = lambda : &quot;no key exist&quot;dd = collections.defaultdict(func)dd[&quot;one&quot;] = &quot;first&quot;dd[&quot;one&quot;]dd[&quot;four&quot;]\n\nimport collectionscr = &quot;ksjflajowielzxkjowieof1242lkjlk&quot;cd = collections.Counter(cr)print(cd)print(cd[&quot;j&quot;])\n\n\nFile operateopen\nmode\nr: read only\nw: new write,will erase origional file\nx: open exist file,if not error reportd\na: append mode\nb: binary write\nt: file mode open\n+: read and write\n\n\n\nin this way, we need to close file handle by hand\ndir = r&quot;/home/narcissus/Desktop/遍历游标的三种方式.md&quot;f = open(dir,&quot;r&quot;)for i in f:    print(i)f.close()\n\nin this way, file handle will be closed automatically\ndir = r&quot;/home/narcissus/Desktop/遍历游标的三种方式.md&quot;with open(dir,&quot;r&quot;) as f:    for i in f:        print(i)\n\nread only one line,so should be carefully\ndir = r&quot;/home/narcissus/Desktop/遍历游标的三种方式.md&quot;with open(dir,&quot;r&quot;) as f:    i = f.readline()    while i:        print(i)        i = f.readline()\n\nread all lines\ndir = r&quot;/home/narcissus/Desktop/遍历游标的三种方式.md&quot;with open(dir,&quot;r&quot;) as f:    i = f.readlines()    for j in i:        print(j)# or use thiswith open(dir,&quot;r&quot;) as f:    i = list(f)    for j in i:        print(j)\n\nread each word\ndir = r&quot;/home/narcissus/Desktop/遍历游标的三种方式.md&quot;with open(dir,&quot;r&quot;) as f:    word = f.read(1)    while word:        print(word,end=&quot;&quot;)        word = f.read(1)\n\nwrite\nwrite: only support string\nwriteline: can write list directily\n\nimport osdir = r&quot;/home/narcissus/Desktop/1.txt&quot;txt = os.listdir(&quot;/home/narcissus&quot;)needed = [i for i in txt if not i.startswith(&quot;.&quot;)]with open(dir, &quot;w&quot;) as f:    # write whole list once without space    f.writelines(needed)    # can not write list directily,but can use loop to write new line per element    # for i in needed:    #     f.write(i)    #     f.write(&quot;\\n&quot;)with open(dir,&quot;r&quot;) as f:    info = f.readlines()    print(info)\n\n\npickle moduleit is used for persistence file, can save program’s information to disk while the program runing\nfeature:\n\nit can store infomation immediately\nit can store infomation with format unchanged\n\nfunction:\n\npickle.dump: write\npickle.load: read\n\nnotice:use binary mode to write or read file\nimport pickle,osdir = r&quot;/home/narcissus/Desktop/1.txt&quot;txt = os.listdir(&quot;/home/narcissus&quot;)info = [i for i in txt if not i.startswith(&quot;.&quot;)]with open(dir,&quot;wb&quot;) as f:    pickle.dump(info,f)with open(dir,&quot;rb&quot;) as f:    get = pickle.load(f)    print(get)\n\n\n\nLogwhy we need log?recording some information at important points, suitable log information can let us to know program running statiusbut that isn’t to say log is much more much better,because io operation will slow down program.\nthere are several log level:\n\ndebug\ninfo\nnotice\nwarning\nerror\ncritical\nalert\nemergency\n\nlog include:[time location level content]\ngood log module:\n\nlog4j -&gt; java\nlog4php -&gt; php\nlogging -&gt; python\n\npython logging modulelevel:\n\ndebug\ninfo\nwarning\nerror\ncritical\n\ndefault log level:\n\nspecify a log level in program\nonly log level which equal or high above than specified level will be write in log\n\nusage:specify default log levelonly logging once at first time executes\nfeature:\n\nspecify the default log level\noutput: sys.stderr\ndefault level: warning\nformat: level:log_name:content\n\nlogging.basicConfig(**kwargs)\neg:\nimport loggingdir = r&quot;/home/narcissus/Desktop/info.log&quot;log_format = &quot;%(asctime)s   %(levelname)s   %(message)s&quot;logging.basicConfig(filename=dir, level=logging.DEBUG, format=log_format)\n\nuse level functionlogging.debug(msg, *args, **kwargs)logging.info(msg, *args, **kwargs)logging.warning(msg, *args, **kwargs)logging.error(msg, *args, **kwargs)logging.critical(msg, *args, **kwargs)\neg:\nimport logginglogging.debug(&quot;this is a debug log&quot;)logging.info(&quot;this is a info log)\n\nuse log functionlogging.log(level, *args, **kwargs)\neg:\nimport logginglogging.log(logging.DEBUG,&quot;this is a debug log&quot;)logging.log(logging.INFO,&quot;this is a info log&quot;)\n\ncomplete example\nimport loggingdir = r&quot;/home/narcissus/Desktop/info.log&quot;log_format = &quot;%(asctime)s\\t%(levelname)s\\t%(lineno)d %(message)s&quot;logging.basicConfig(filename=dir, level=logging.DEBUG, format=log_format)logging.debug(&quot;this is a debug log&quot;)logging.info(&quot;this is a info log&quot;)logging.log(logging.DEBUG,&quot;this is a debug log&quot;)logging.log(logging.INFO,&quot;this is a info log&quot;)\n\n\nby hand usage\nlogger: a interface of log produces log\nhandler: decide where log stores\nfilter: what should be displayed\nformatter: format\n\nlogger:\nLogger.setLevel()Logger.addHandler()/Logge.removeHandler()Logger.addFilter()/Logger.removeFilter()Logger.debug()/info/errorLogger.exception()Logger.log()logging.getLogger()\nand so on …..\nJsonconvert:\n\njson.dumps(): python -&gt; json\njson.loads(): json -&gt; json\n\nread and write with file:\n\njson.dump(): write to file\njson.load(): read from file\n\nimport json,osdata = &#123;    &quot;user&quot;: &quot;小小&quot;,    &quot;age&quot;: 20,    &quot;like&quot;: [&quot;juice&quot;,&quot;apple&quot;,&quot;cherry&quot;],    &quot;score&quot;: &#123;        &quot;chinese&quot;: 80,        &quot;math&quot;: 90,        &quot;english&quot;: 100    &#125;&#125;jd = json.dumps(data)print(type(jd),jd)nd = json.loads(jd)print(type(nd),nd)dir = r&quot;/home/narcissus/Desktop&quot;os.chdir(dir)with open(&quot;test.js&quot;,&quot;w&quot;) as f:    json.dump(data,f)with open(&quot;test.js&quot;,&quot;r&quot;) as f:    file = json.load(f)    print(file[&quot;score&quot;][&quot;chinese&quot;])\n\n\nMulti threadsprocess vs thread:process totally different,but thread will share something.process builds with threads\nbasic usagesyntax:\nimport threading# args is tupletd = threading.thread(target=function_name,args=())# set thread name,it is optionaltd.setName(&quot;thread1&quot;)# start threadtd.start()# waiting for thread finishtd.join()   \nnotice:the type of args is tuple\ndaemon threadwhen process stops the daemon thread will stop immediately\nsyntax:\nimport threading# args is tupletd = threading.thread(target=function_name,args=())td.daemon = True # or td.setDaemon(True)td.start()# waiting for thread finishtd.join()   \n\nshared variablesit is appeard when several threads access one variable at the same time, it will lead wrong result. In order to resolve this problem, we can lock the use of variable\nsyntax:\nlock = threading.Lock()lock.acquire()lockd_variablelock.release()\n\nwithout lock\nimport threadingsum = 0num = 1000000def add(num):    global sum    for i in range(num):        sum += 1    return sumdef miu(num):    global sum    for i in range(num):        sum -= 1    return sum# normal usage will return sum = 0# miu(num)# add(num)# print(sum)# use thread access one variable at the same time will lead wrong resultdef calcu():    td1 = threading.Thread(target=add,args=(num,))    td2 = threading.Thread(target=miu,args=(num,))    td1.start()    td2.start()    td1.join()    td2.join()if __name__ == &quot;__main__&quot;:    calcu()    print(sum)\n\nuse lock\nimport threadingsum = 0num = 1000000lock = threading.Lock()# lock variable to be accessd by one at the same timedef add(num):    global sum    for i in range(num):        lock.acquire()        sum += 1        lock.release()    return sumdef miu(num):    global sum    for i in range(num):        lock.acquire()        sum -= 1        lock.release()    return sumdef lock_calcu():    ld1 = threading.Thread(target=add,args=(num,))    ld2 = threading.Thread(target=miu,args=(num,))    ld1.start()    ld2.start()    ld1.join()    ld2.join()if __name__ == &quot;__main__&quot;:    lock_calcu()    print(sum)\n\n\nthread safeif one variable to be used by multi threads at the same time without lock variable but no problem happend, it is called thread safe.\nnot thread safe: list, set, dict\nthread safe: queue\ndeadlocktwo lock both not release, lead to both waitting, deadlock appeard, leading program dead\nmuiti processeswe know multi threads will cause problem usually, but there are several method more useful than multi threads:\n\nsubprocess\nmultiprocessing\nconcurrent.futures\n\niterable/iteratordifference:iterable -&gt; directly used by for loopiterator -&gt; not only used by for loop but also can be used by next function\nhow to distinct each other:\nfrom collections import Iterable,Iteratorlt = [i for i in range(10)]print(isinstance(lt,Iterable))print(isinstance(lt,Iterator))\n\nconvert iterable to iterator:\nfrom collections import Iterable,Iteratorlt = [i for i in range(10)]print(isinstance(lt,Iterable))print(isinstance(lt,Iterator))clt = iter(lt)print(isinstance(clt,Iterable))print(isinstance(clt,Iterator))\n\n\n\ngeneratorfeature:\n\nproduct data which used by for loop\nat the end of generator raise StopIterationError\ncan be used by next() function\n\nwhy we need generator?all data are calculated step by step when in need, don’t store in memory, use cpu instead of memory. range() is a generator,so we need use it often, it is more useful than list.\nhow to make a generator\n\n()\nyield: yield can stop loop until next iterate\n\nuse ()\nlt = [i for i in range(10)]lg = (i for i in range(10))print(type(lt))# lg is a generatorprint(type(lg))\n\nuse yield\n# normal usage# 1,1,2,3,5,8,13# def fib(num):#     a,b,n = 0,1,0#     while n &lt; num:#         a,b = b,a+b#         n += 1#     return a# fib(6)# use yielddef fib(num):    a,b,n = 0,1,0    while n &lt; num:        # yield can stop loop until next iterate        yield b        a,b = b,a+b        n += 1# generator is iterablefor i in fib(7):    print(i)\n\n\n\ncoroutinescoroutines is much more useful than multi threads, it’s need less resource, we can regard it as a generator or a function which can be stopd\nhow to realize it?\n\nyield: return result\nsend: send args to generator\nyield from: as a middle hand transfer message\n\nyield x: return xx = yield: get x value from send() function\ndef test_coroutine():    print(&quot;start&quot;)    x = yield    print(&quot;get&quot;,x)    yield xco = test_coroutine()next(co)co.send(20)\n\nyield from\ndef test_coroutine(st):    for i in range(st):        yield idef get_num():    yield from &quot;1234567&quot;print(list(get_num()))\n\n\nasync/waitimport asyncioasync def get_num(num):    for i in range(num):        print(i)        await asyncio.sleep(1)loop = asyncio.get_event_loop()lt = [get_num(10),get_num(20)]loop.run_until_complete(asyncio.wait(lt))loop.close()\n\nconcurrent.futures\nuse subprocess, run several python interpreter. each subprocess can use a core of cpu, all core of cpu can be used 100%\nuse multithreads, as we know python can only use one thread at one time, so it uses the same time as one process, and each of thread can not pull use cpu\n\nThreadPoolExecutoralthough my cpu only have 4 core 8 thread, but each cpu didn’t be full used, it is because python can only run one thread at one time, threadpool is also thread.\nfrom concurrent.futures import ThreadPoolExecutordef ts(num):    sum = 0    print(threading.current_thread())    for i in range(num):        sum += 1    return sumpool = ThreadPoolExecutor(max_workers=8)t1 = pool.submit(ts, 100000000)t2 = pool.submit(ts, 100000000)t3 = pool.submit(ts, 100000000)t4 = pool.submit(ts, 100000000)t5 = pool.submit(ts, 100000000)t6 = pool.submit(ts, 100000000)t7 = pool.submit(ts, 100000000)t8 = pool.submit(ts, 100000000)print(t1.result())print(t2.result())print(t3.result())print(t4.result())print(t5.result())print(t6.result())print(t7.result())print(t8.result())\n\nuse map\nfrom concurrent.futures import ThreadPoolExecutordef ts(num):    sum = 0    print(threading.current_thread())    for i in range(num):        sum += 1    return sumpool = ThreadPoolExecutor(max_workers=8)lt = [100000000] * 8for i in pool.map(ts,lt):    print(i)\n\nProcessPoolExecutorall core of cpu can be used 100%\nfrom concurrent.futures import ProcessPoolExecutordef ts(num):    sum = 0    print(threading.current_thread())    for i in range(num):        sum += 1    return sumpool = ProcessPoolExecutor(max_workers=8)lt = [100000000] * 8for i in pool.map(ts,lt):    print(i)\n\n\n\nregular expression\nthere are two methods\n\ncompile re to a object\nimport res = &quot;Hello, Join. where did you go? 123,hk123,H89Hk&quot;p = re.compile(&quot;[0-9]&#123;1,&#125;&quot;)m = p.findall(s)print(m)\nuse re directory\nimport res = &quot;Hello, Join. where did you go? 123,hk123,H89Hk&quot;m = re.findall(&quot;[0-9]&#123;1,&#125;&quot;,s)print(m)\n\n\nignore case\n\n\nimport res = &quot;Hello, Join. where did you go? 123,hkj123,H89Hjk&quot;p = re.compile(&quot;h&quot;,re.I)m = p.findall(s)print(m)\n\n\nsubstitute\n\nimport res = &quot;Hello, Join. where did you go? 123,hkj123,H89Hjk&quot;p = re.compile(&quot;\\d+&quot;)t = p.sub(&quot;000&quot;,s)print(s)print(t)\n\n\ncatch chinese\n\nimport res = &quot;Hello, 世界. 喜欢你where did you go? 123,hkj123,H89Hjk&quot;p = re.compile(&quot;[\\u4c00-\\u9fa5]+&quot;)t = p.findall(s)print(t)\n\n\ncatch no chinese\n\nimport res = &quot;Hello, 世界. 喜欢你where did you go? 123,hkj123,H89Hjk&quot;p = re.compile(&quot;[^\\u4c00-\\u9fa5]+&quot;)t = p.findall(s)print(t)\n\n\nXpathit is used to find xml file\nsyntax:\n\n/: root node\n//: two node\n.: current node\n..: father node\n@: property\n\nnet programnetwork model:\n\n7 layers model\nLayer 7 - Application\nLayer 6 - Presentation\nLayer 5 - Session\nLayer 4 - Transport\nLayer 3 - Network\nLayer 2 - Data Link\nLayer 1 - Physical\n\n\n4 layers model\nLayer 4 - Application\nLayer 3 - Transport\nLayer 2 - Network\nLayer 1 - Link\n\n\n\nftp\nleaning website: link\n\nPython ftplibpython ftplib is a module that implements the client side of the FTP protocol. It contains an FTP client class and some helper functions. \n\nPython FTP clasThe ftplib.FTP() creates a new instance of the FTP class. When host is given, a connection to the host is made with the connect() method. \n\n\nexample:\nin my archlinux, i start vsftpd.service first\nsudo systemctl start vsftpd\n\nand then change the default config /etc/vsftpd.config to enable local user login\nat last i write a ftp python file\nimport ftplib# a anonymous function print linesline = lambda x: print(x * 80)# get ftp login user and passwduser = input(&quot;ftp login user name: &quot;)pwd = input(&quot;password: &quot;)with ftplib.FTP(&quot;localhost&quot;) as ftp:    try:        # get connection        ftp.login(user=user, passwd=pwd)        # print welcome information        info = ftp.getwelcome()        print(&quot;welcome: &quot;,info)        line(&quot;-&quot;)                # change current directory        ftp.cwd(dirname=&quot;Desktop&quot;)        # get current directory        current_dir = ftp.pwd()        print(&quot;current_dir: &quot;,current_dir)        line(&quot;*&quot;)        # get context list        files = []        ftp.dir(files.append)        for i in files:            print(i)        line(&quot;=&quot;)        # download file, by default the file will be stored at /tmp/        file_copy = &quot;test.txt&quot;        with open(file_copy, &quot;w&quot;) as f:            res = ftp.retrlines(&quot;RETR &quot;+&quot;1.py&quot;, f.write)                        if not res.startswith(&#x27;226 Transfer complete&#x27;):                print(&#x27;Download failed&#x27;)                if os.path.isfile(file_copy):                    os.remove(file_copy)              else:                print(&quot;down&quot;)            except ftplib.all_errors as e:        print(e)\n\n\n\nmailhow it works?process: user mail —-&gt; mail proxy —–&gt; mail server —–&gt; useragent: ————&gt;mua————–&gt;mta—————&gt;mdaprotocal: —————–&gt;SMTP————-&gt;POP3/IMAP\nMUA: MailUserAgent, user send mail to proxyMTA: MailTransferAgent, catch mail from proxy to mail serverMDA: MailDeliveryAgent, deliver mail from server to user\nhow to use it:there are two modules\n\nemail: used to modify mail\nsmtplib: used to send mail\n\nthe following is a simple text mail example.\nimport smtplibfrom email.mime.text import MIMEText# define some variablesfrom_addr = &quot;1025096440@qq.com&quot;# this is a code from web mailfrom_pwd = &quot;nrbnnibhjrgrbcdd&quot;to_addr = &quot;1025096440@qq.com&quot;smtp_srv = &quot;smtp.qq.com&quot;# write messagetext_msg = MIMEText(&quot;第一封邮件&quot;, &quot;plain&quot;, &quot;utf-8&quot;)# add headertext_msg[&#x27;From&#x27;] = from_addrtext_msg[&#x27;To&#x27;] = to_addrtext_msg[&#x27;Subject&#x27;] = &quot;测试&quot;try:    # server address need encode to byte,so we need encode it    # port 465 is a security port which server accept    srv = smtplib.SMTP_SSL(smtp_srv.encode(), 465)    # login    srv.login(from_addr,from_pwd)    # send text mail    srv.sendmail(from_addr, [to_addr], text_msg.as_string())    srv.quit()except Exception as e:    print(e)else:    print(&quot;done&quot;)\n\nthe following is a text format mail with additional file \nimport smtplibfrom email.mime.text import MIMETextfrom email.mime.multipart import MIMEBase,MIMEMultipart# some variablesfrom_addr = &quot;1025096440@qq.com&quot;# this is a code from web mailfrom_pwd = &quot;nrbnnibhjrgrbcdd&quot;to_addr = &quot;1025096440@qq.com&quot;smtp_srv = &quot;smtp.qq.com&quot;files = r&quot;/home/narcissus/Desktop/1.py&quot;# initial multipart objectmail_mul = MIMEMultipart()# add headermail_mul[&#x27;From&#x27;] = from_addrmail_mul[&#x27;To&#x27;] = to_addrmail_mul[&#x27;Subject&#x27;] = &quot;use python email and smtplib module send mail&quot;# write messagetext_msg = MIMEText(&quot;the email include text message and file&quot;, &quot;plain&quot;, &quot;utf-8&quot;)# add text to multipart objectmail_mul.attach(text_msg)# add filewith open(files, &quot;rb&quot;) as f:    line = f.read()    content = MIMEText(line, &quot;base64&quot;, &quot;utf-8&quot;)    content[&quot;Content-type&quot;] = &quot;application/octet-stream&quot;    content[&quot;Content-Disposition&quot;] = &quot;attachment; filename=files&quot;    mail_mul.attach(content)# send mailtry:    # server address need encode to byte,so we need encode it    # port 465 is a security port which server accept    srv = smtplib.SMTP_SSL(smtp_srv.encode(), 465)    # login    srv.login(from_addr,from_pwd)    # send text mail    srv.sendmail(from_addr, [to_addr], mail_mul.as_string())    srv.quit()except Exception as e:    print(e)else:    print(&quot;done&quot;)\n\nthe following is a html format mail example.\nimport smtplibfrom email.mime.text import MIMEText# write messagehtml_msg = &quot;&quot;&quot;    &lt;!DOCTYPE html&gt;    &lt;html lang=&quot;en&quot;&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;        &lt;title&gt;Document&lt;/title&gt;        &lt;script src=&quot;./vue.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h1 style=&quot;background: #7fedbb&quot;&gt;有情人难成属眷&lt;/h1&gt;    &lt;/body&gt;    &lt;/html&gt;    &quot;&quot;&quot;html_msg = MIMEText(html_msg, &quot;html&quot;, &quot;utf-8&quot;)# some variablesfrom_addr = &quot;1025096440@qq.com&quot;# this is a code from web mailfrom_pwd = &quot;nrbnnibhjrgrbcdd&quot;to_addr = &quot;1025096440@qq.com&quot;smtp_srv = &quot;smtp.qq.com&quot;try:    # server address need encode to byte,so we need encode it    # port 465 is a security port which server accept    srv = smtplib.SMTP_SSL(smtp_srv.encode(), 465)    # login    srv.login(from_addr,from_pwd)    # send html mail    srv.sendmail(from_addr, [to_addr], html_msg.as_string())    srv.quit()except Exception as e:    print(e)else:    print(&quot;done&quot;)\n\nalternative choose html format or text format, because some fo device can not display html format\nimport smtplibfrom email.mime.text import MIMETextfrom email.mime.multipart import MIMEMultipart# some variablesfrom_addr = &quot;1025096440@qq.com&quot;# this is a code from web mailfrom_pwd = &quot;nrbnnibhjrgrbcdd&quot;to_addr = &quot;1025096440@qq.com&quot;smtp_srv = &quot;smtp.qq.com&quot;# initial multipart objectmail_mul = MIMEMultipart(&quot;alternative&quot;)# add headermail_mul[&#x27;From&#x27;] = from_addrmail_mul[&#x27;To&#x27;] = to_addrmail_mul[&#x27;Subject&#x27;] = &quot;use python email and smtplib module send mail&quot;# write messagetext_msg = MIMEText(&quot;alternative choose text or html style&quot;, &quot;plain&quot;, &quot;utf-8&quot;)# add text to multipart objectmail_mul.attach(text_msg)# write htmlhtml_msg = &quot;&quot;&quot;    &lt;!DOCTYPE html&gt;    &lt;html lang=&quot;en&quot;&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;        &lt;title&gt;Document&lt;/title&gt;        &lt;script src=&quot;./vue.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h1 style=&quot;background: #7fedbb&quot;&gt;有情人难成属眷&lt;/h1&gt;    &lt;/body&gt;    &lt;/html&gt;    &quot;&quot;&quot;html_msg = MIMEText(html_msg, &quot;html&quot;, &quot;utf-8&quot;)mail_mul.attach(html_msg)# send mailtry:    # server address need encode to byte,so we need encode it    # port 465 is a security port which server accept    srv = smtplib.SMTP_SSL(smtp_srv.encode(), 465)    # login    srv.login(from_addr,from_pwd)    # send text mail    srv.sendmail(from_addr, [to_addr], mail_mul.as_string())    srv.quit()except Exception as e:    print(e)else:    print(&quot;done&quot;)\n\n\nthe end! I am really happy that i learn all of them. It is really awesome,nice.\n","categories":["learn"],"tags":["python"]},{"title":"rust","url":"/2022/04/23/rust/","content":"RUSTinstallby default rustup will be installed in ~/.rustup, cargo will be installed in ~/.cargo.if we want to customize install location, we need to export variables before installation.\n# export rustup and cargo locationexport RUSTUP_HOME=~/.local/apps/rust/rustup                  export CARGO_HOME=~/.local/apps/rust/cargo                    curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh\n\nafter installation finish, . /home/healer/.local/apps/rust/cargo/env command will be automaticly configured to some environment files(such as .bashrc). however it is not enough, we also need to add the variables we export before installation. without this step, there will be an error called error: no override and no default toolchain set.\nso, i write all of this to ~/.xinitrc\nexport RUSTUP_HOME=$HOME/.local/apps/rust/rustupexport CARGO_HOME=$HOME/.local/apps/rust/cargosource $HOME/.local/apps/rust/cargo/env\n\nthen check compiler and package manager version\nrustc --versioncargo --version\n\n\nvscode extensionsince i cannot download extension in vscode, so i need download rust vsix file in web site. then install it with command:\nvscodium --install-extension matklad.rust-analyzer-0.2.842.vsix\n\nthen we need to install rust language server(RSL) with command:\nrustup component add rls rust-analysis rust-src\n\nhowever i cannot download it since China cannot, so we need to config mirror with exporting this variables:\nRUSTUP_DIST_SERVER=http://mirrors.ustc.edu.cn/rust-staticRUSTUP_UPDATE_ROOT=http://mirrors.ustc.edu.cn/rust-static/rustup\n\n\ncargo mirror\nthe same problem comes with cargo, so we need to config cargo mirror, add this to $CARGO_HOME/config:\n[source.crates-io]registry = &quot;https://github.com/rust-lang/crates.io-index&quot;replace-with = &#x27;ustc&#x27;[source.ustc]registry = &quot;https://mirrors.ustc.edu.cn/crates.io-index&quot;\n","categories":["learn"],"tags":["rust"]},{"title":"rancher","url":"/2022/04/23/rancher/","content":"\nrancher + k8s\n\nubunturancherrancher是用来简化k8s集群管理的图形化web工具，它是运行在docker容器中的一个软件，所以安装rancher需要主机安装了docker，然后简单的通过一个命令将容器跑起来就可以了\n安装运行# 下面这种方式，即使添加了国内源下载速度依然很慢docker pull rancher/server# 使用下面的命令下载很快docker run -d -p 443:443 --name rancher --restart=unless-stopped \\    -e CATTLE_AGENT_IMAGE=&quot;registry.cn-hangzhou.aliyuncs.com/rancher/rancher-agent:v2.4.2&quot; \\    registry.cn-hangzhou.aliyuncs.com/rancher/rancher:v2.4.2\n\n运行上面的命令后会进行镜像下载及运行。然后查看容器的ip，即可进行rancher的网页访问\n# 查看ipaddressdocker inspect rancher\n\n访问rancher页面https://localhost:443或者https://172.17.0.2。首次运行需要设置admin用户密码，设置为admin\n\n主界面\n\n设置默认镜像源为registry.cn-hangzhou.aliyuncs.com\n\nk8sk8s是用来集群化管理docker容器的一个工具，它直接安装在物理机中，依赖docker运行，所以如果要安装k8s首先是安装并配置好docker（docker还需进行一些特殊化配置）\ndocker安装以ubuntu下的安装举例\n安装docker\napt install docker.io\n\n修改cgroups，同时添加国内源\n# k8s使用的是systemd来进行进程隔离的，但docker默认使用cgroups，所以需要修改docker的进程隔离为systemdvi /etc/docker/daemon.json&#123;  &quot;registry-mirrors&quot;: [    &quot;https://dockerhub.azk8s.cn&quot;,    &quot;https://reg-mirror.qiniu.com&quot;,    &quot;https://quay-mirror.qiniu.com&quot;  ],  &quot;exec-opts&quot;: [ &quot;native.cgroupdriver=systemd&quot; ]&#125;\n\n重启docker\nsystemctl daemon-reloadsystemctl enable dockersystemctl start docker\n\n检查是否修改成功\ndocker info | grep -i cgroups\n\n\n\n\n\nk8s安装主要组件\nkubelet 后台服务\nkubeadm 集群部署操作\nkubectl 普通用户操作\n\n安装k8s不能使用swap分区，需要提前关闭\n# 手动关闭开启的swap分区swapoff -a# 注释/etc/fstab中swap分区的信息\n\n\n\n*ubuntu的相关配置\n# 使得 apt 支持 ssl 传输apt-get update &amp;&amp; apt-get install -y apt-transport-https# 下载 gpg 密钥curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - # 添加 k8s 镜像源cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.listdeb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial mainEOFapt-get updateapt-get install -y kubelet kubeadm kubectl\n\n\n\n查看版本会报错，是因为还没有配置网络，可以忽略\nkubectl versionThe connection to the server localhost:8080 was refused - did you specify the right host or port?\n\n\n\nk8s配置master节点安装：\n\n初始化master节点\n部署flannel网络\n配置kubectl工具\n\n初始化节点使用init进行初始化，其它参数如下：\napiserver-advertise-address为apiserver的ip，填写本机ip\nimage-repository指定docker的源，初始化时需要进行在线docker镜像源的下载，如果不配置则会下载失败\npod-network-cidr指定k8s的节点网络，k8s集群之间使用此网段进行通信，默认为10.244.0.0/16\nignore-preflight-errors如果出现报错时，可以进行忽略，例如虚拟机中的cpu个数为1时会报错\nkubeadm init \\--apiserver-advertise-address=192.168.1.10 \\--image-repository registry.aliyuncs.com/google_containers \\--pod-network-cidr=10.244.0.0/16 \\--ignore-preflight-errors=CpuNum\n\n运行成功后输出，最后的join语句为其它集群加入k8smaster节点需要运行的命令，如果丢失可在master节点使用kubeadm token create --print-join-command重新生成。如果过程中断可以使用kubeadm reset重置后再次初始化\n\n配置kubectlmkdir -p $HOME/.kubesudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/configsudo chown $(id -u):$(id -g) $HOME/.kube/config\n\n然后查看是否可用kuberctl\n# 查看已加入的节点kubectl get nodes# 查看集群状态kubectl get cs\n\n\n\n配置flannel网络kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/a70459be0084506e4ec919aa1c114638878db11b/Documentation/kube-flannel.yml\n\n使用这个命令运行之后会报错Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|0.0.0.0|:443... failed: Connection refused.。百度上说是因为域名污染，在/etc/hosts文件中添加对应的ip\n199.232.28.133  raw.githubusercontent.com\n\n之后再使用，依旧会报错，错误为199.232.28.133  raw.githubusercontent.com\n使用wget下载文件报ssl错误，不过在archlinux上可以使用wget下载一个yml文件，然后将此文件通过ssh传到ubuntu上\nwget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\n\n手动加载此配置文件\nkubectl apply -f kube-flannel.yml\n\n\n然后查看集群状态就ok了\nkubectl get nodes\n\n\n\ncentoscentos下的docker安装就比较麻烦，首先是docker安装需要三个软件:docker-ce,docker-ce-cli,containerd.io，同时在centos8上的docker-ce要求container版本大于1.4，然而仓库中的版本为1.3，所以需要手动在网上下载container1.4的版本并安装，然后使用yum命令在线安装docker-ce和docker-ce-cli\ndocker更新源系统的镜像源没有提供docker的安装包，需要自己添加。命令yum-config-manager命令来进行添加源，此命令需要先安装yum-utils，device-mapper-persistent-data ，lvm2\nyum install -y  yum-utils device-mapper-persistent-data lvm2\n\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n下载container在官网链接下载container1.4版本，并进行安装\nwget https://download.docker.com/linux/centos/8/x86_64/stable/Packages/containerd.io-1.4.3-3.1.el8.x86_64.rpmyum install -y ./containerd.io-1.4.3-3.1.el8.x86_64.rpm\n\n安装dockeryum install -y docker-ce docker-cli\n\n修改cgroupvi /etc/docker/daemon.json&#123;  &quot;exec-opts&quot;: [ &quot;native.cgroupdriver=systemd&quot; ]&#125;\n\n启动dockersystemctl enable dockersystemctl start docker\n\n\n\nrancher下载rancher的docker镜像并启动\ndocker run -d -p 443:443 --name rancher --restart=unless-stopped \\    -e CATTLE_AGENT_IMAGE=&quot;registry.cn-hangzhou.aliyuncs.com/rancher/rancher-agent:v2.4.2&quot; \\    registry.cn-hangzhou.aliyuncs.com/rancher/rancher:v2.4.2\n\nrancher使用443端口，经过端口映射，可在centos上使用centos的ip进行访问。同时由于centos虚拟机与宿主机archlinux在同一网段，所以可在archlinux上使用浏览器输入centos的ip:port直接访问rancherhttps://192.168.1.111:443\nk8s需要内存大于1.7G\n关闭swap分区\nswapoff -a# 同时需要在/etc/fstab里面对swap分区进行注释\n\n\n\n镜像配置\ncat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo[kubernetes]name=Kubernetesbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/enabled=1gpgcheck=1repo_gpgcheck=1gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpgEOF\n\n禁止防火墙（docker中不需要）\n# docker中不需要setenforce 0systemctl disable firewalldsystemctl stop firewalld\n\n安装并启动kubenetes\nyum install -y kubelet kubeadm kubectl# docker中没有systemctl，直接使用命令kubelet启动即可systemctl enable kubelet &amp;&amp; systemctl start kubelet\n\n\n\n初始化节点\nkubeadm init \\--apiserver-advertise-address=192.168.1.111 \\--image-repository registry.aliyuncs.com/google_containers \\--pod-network-cidr=10.244.0.0/16 \\--ignore-preflight-errors=CpuNum \\--apiserver-cert-extra-sans=192.168.1.111kubeadm init \\--image-repository registry.aliyuncs.com/google_containers \\--pod-network-cidr=10.244.0.0/16 \\--ignore-preflight-errors=CpuNum \\--apiserver-cert-extra-sans=192.168.1.111\n\n报错：\n\ndocker版本太高，只支持到19.03\n需要修改docker的cgroup为systemd\nram需要大于1.7G\n需要enable kubelet\n\n# 下载对应版本docker wget https://download.docker.com/linux/centos/8/x86_64/edge/Packages/docker-ce-19.03.13-3.el8.x86_64.rpm  wget https://download.docker.com/linux/centos/8/x86_64/edge/Packages/docker-ce-cli-19.03.13-3.el8.x86_64.rpm\n\n卸载之前的docker\nyum remove docker-ce\n\n安装下载的docker\nyum install -y ./docker-ce-19.03.13-3.el8.x86_64.rpmyum install -y ./docker-ce-cli-19.03.13-3.el8.x86_64.rpm\n\n修改cgroup\nvim /etc/docker/daemon.json&#123;  &quot;exec-opts&quot;: [ &quot;native.cgroupdriver=systemd&quot; ]&#125;\n\n重新启动docker\nsystemctl enable dockersystemctl start docker\n\n重启机器增加内存为3G\n重新初始化节点，需要5分钟左右下载，成功输出为：\nYour Kubernetes control-plane has initialized successfully!To start using your cluster, you need to run the following as a regular user:  mkdir -p $HOME/.kube  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config  sudo chown $(id -u):$(id -g) $HOME/.kube/configAlternatively, if you are the root user, you can run:  export KUBECONFIG=/etc/kubernetes/admin.confYou should now deploy a pod network to the cluster.Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:  https://kubernetes.io/docs/concepts/cluster-administration/addons/Then you can join any number of worker nodes by running the following on each as root:kubeadm join 192.168.1.111:6443 --token hzy655.b3l3x68qsyv0np8w \\    --discovery-token-ca-cert-hash sha256:89a0c3f88db476588e90109b56468f966b88be00139062f82359ef0b63f059ee \n\n\n\n根据输出进行配置\nmkdir -p $HOME/.kubesudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/configsudo chown $(id -u):$(id -g) $HOME/.kube/configexport KUBECONFIG=/etc/kubernetes/admin.conf\n\n此时查看节点状态为notready，配置网络后就ok了\n[root@localhost ~]# kubectl get nodesNAME                    STATUS     ROLES                  AGE     VERSIONlocalhost.localdomain   NotReady   control-plane,master   2m50s   v1.20.1\n\n\n\n配置flannel网络\n# 下载配置文件wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml# 用配置文件配置网络kubectl apply -f kube-flannel.yml\n\n输出为下面即为配置成功\npodsecuritypolicy.policy/psp.flannel.unprivileged createdclusterrole.rbac.authorization.k8s.io/flannel configuredclusterrolebinding.rbac.authorization.k8s.io/flannel configuredserviceaccount/flannel unchangedconfigmap/kube-flannel-cfg configureddaemonset.apps/kube-flannel-ds created\n\n再次查看状态就为ready\n[root@localhost ~]# kubectl get nodesNAME                    STATUS   ROLES                  AGE     VERSIONlocalhost.localdomain   Ready    control-plane,master   9m46s   v1.20.1\n\n\n\n\n\nk8s加入rancher\n\n\n在centos上运行上面的命令将k8s加入rancher，其中USER_ACCOUNT通过查看配置文件获取\ncat .kube/config\n\n\n","categories":["learn"],"tags":["k8s"]},{"title":"tcp_3_handshake","url":"/2022/04/23/tcp-3-handshake/","content":"TCP 3 HandShakeas we know that TCP(transmission control protocol) is much more security than UDP(user datagram protocol). so why? and what makes it?\nthe problem of transmission\ndata sending will be split into several packets, how do i(server/client) know the sequence order of packets and how to rebuild them?\nhow can i(server/client) know that you(client/server) really received my request? no data lost or hacked?\n\nthe method to resolve problemin order to resolve the problem 1, packet use SYN synchronize sequence number to confirm data beginning number.\nin order to resolve the problem 2, server/client needs to confirm the SYC with ACK acknowledgement that it really received the SYN. (until receive ACK, server/client will resend SYN).\nthe way it worksSTEP1: client sends a syn x to server announce that client is likely start communication\nSTEP2: server received the request and then send a ack x + size of request packet(equal 1) to client confirms let’s begin with packet with number x+1. then send a syn y to client announce that the data server sends to client begins with number of y.\nSTEP3: client received the syn y of server and then announce that i will receive server’s data begins with number of y + size of request packet(equal 1).\n\n","categories":["learn"],"tags":["tcp"]},{"title":"the-reality","url":"/2022/07/04/the-reality/","content":"Reality现在是凌晨3:45，而我刚从公交车站回来，yeah，似乎现实与虚幻交织。昨天我拿主板的时候居然把食指划了一条口，当时我都有些不可置信主板也能把手划伤。而昨天的划伤似乎是今天发生的事情的预兆，yeah，我第一次打110报警。\n刚开始我却是有些激动，这都是些什么狗屁国家规定，因为出去做了一个核酸，然后不让我回家了，说72小时不能进去。我当时就火了，以前明明只要做了核酸就可以进去，如今非要24小时证明。换言之，你永远别想进去睡觉除非有那个该死的24小时证明。\n我试图闯进去，我很清楚这种做法没有任何作用，但是我还是想这么做，不仅仅是为了我自己，也是给那些乖乖的绵羊们看看如何才叫做一个有血性的人。我们不能被这种邪恶的政府随意制定的规则摆弄，我们是人，本来是你租的房子，但是你没有权利住，即便外面下着雨，他们还是不管不顾。他们唯一拥有的就是这是国家规定的这句话。他们不care你是淋雨还是躲在那个角落，我感觉一瞬间就成了一个无家可归的人，no body care where you can live, no body care whether you good, no body care whatever, it seems that i am a dog, no rights to choose, no rights to fight, the only one thing i can do is do as what they want.\n结果那个人推了我几下，我才发现嘴角已经淤青了一小块，之前还以为没什么。不过我报警了，哈哈，不得不承认这是我做的最坏的一个决定。我以为他们会讲理，以为他们会给对我动手的人一些惩罚，然而，他们是同样的思考模式，why you don’t have 72 hours proof? what a fucking word, i really hate this one. the only thing they can thought is that why you aren’t a pretty pet? but i need is where i live tonight, can you sir help me? if i know they forbid people come in without 24 hours proof, i will never ever go out. but the only thing they have is blame，it is all because your fault. you deserve it.\n到了警察局后没有座位，很多人，我们都是在门外面站着，因为不允许进去。找警察局的人真的特别多，都得排队等。其中有一个人，看着非常生气，身高1.8左右也很壮，从说话动作可以看出它是一个混混，他指着另外一个拿着文件袋的穿着制服的人大骂，说要出去之后杀了他。那个人看着好弱小，40多岁，皱巴的制服衣裳，对着另外一直狂叫的狗一样的东西有些不敢直视它的眼睛。我知道仅仅从这些外表现象就判断那个人好，那个人坏是非常不正确的，更何况我知道人是多面的。然而在他大骂的时候我却想到了我，我当时会不会也像这个狗一样的家伙那样野蛮不讲理？虽然我知道我没有骂人，也没有想害人，但是我的愤怒和他一样。而这让我感到害怕，我似乎在被邪恶吞噬，他们似乎已经存在我的灵魂。\n那一刻我突然觉得释怀了，因为我决定我一定不要成为这样的人。但是我也突然茫然了，我所坚持和争取的是对的吗？我们真的要遵守这些不讲道理的规定吗？会不会是我不遵守规则导致的呢？这会不会就仅仅是我的问题，我应该像大家一样严格遵守所谓的国家规定这才是遵纪守法吗？现实中我没有找到答案，但是我在韩剧中找到了答案。\n这一幕幕所呈现出来的不就是韩剧中那些大奸大恶之人的所作所为吗？失去良心的官员门，制定一项一项严苛的命令，每一项命令的结果从来都是以牺牲百姓为代价。是的，我突然觉得这就是电视剧啊，他们不管那么多，他们只管遵守上级的命令，至于你是死是活，是苦是乐与他们有和关系呢？然而现实如戏剧，我就生活在这样一个丑陋的社会之下，并不是我想遵守这些规矩，而是不遵守会给我带来无穷无尽的痛苦，而遵守却有可能堕落为恶魔，因为如果不时刻谨记，何为善何为恶，我就会像之前一样无法分辨是我的错还是规则的错。\n还有一个特别讽刺的事情，我们每个在局外的人都没有座位，要么站着要么做台阶上，就仅仅是这一点我就觉得我们和朝鲜没什么两样，而和那些民主国家的差距是银河之遥。但还不够，一个看门的人员给一个警察拿了一把椅子在最高的台阶坐下，过了一会有一个办完事的人连着给警察说了几声谢谢，讽刺的是，这个警察居然从嘴里蹦出了几个完全不合语境的话：为人们服务嘛，为你们服务嘛，没什么。我真的只想拍手叫绝，你这真的是在为人们服务啊，自己坐着似乎是这个世界上唯一的一把椅子，对着所有趴在地上的人说，唉，这都是为你们服务嘛！\n在局外做了4，5个小时，见识了各种纠纷的事件。让我感叹的是，这里的人为何戾气那么重，当然也包括我，还是说这就是整个社会的一个缩影呢？为什么人们都不能大度一点，从容一点，懂得互相尊重呢？\n当我觉得这个社会已经无可救药的时候，却看见了善意，我走了10，20分钟到处找公共厕所，都没找到，最后看见了一个地铁站，我想这里可能有吧。但是已经过了12点了，结束运营了，但是我还是想试一试，我问一个快50岁的人，可以去上个厕所吗？他犹豫了一会说你要快点，因为马上就要关了。我不明白他说的关是地铁口关还是什么其它的，但是因为他犹豫了，所以让我看见了善良。我知道因为犹豫就代表着有些难办，或许会给他带来什么不便，但他还是答应了。好像冬日里的一束阳光，温暖了整个山脊。\n我在局外等了4，5个小时，最后觉得待哪里没有任何意义，所以跑到公交车站等了3个半小时，等到凌晨3:30，24小时证明出来了我才回家。这一次的经历我是非常珍惜的，虽然不美好，但它又丰富了我风平浪静的人生。怎么说呢，我已经没有了那股愤怒的情绪，只是有无尽的悲凉。\n","categories":["think"],"tags":["reality is aweful"]},{"title":"to-be-gentle","url":"/2022/06/19/to-be-gentle/","content":"To Be Gentle昨晚把看似几乎没办法写出的xmond的功能，通过自己的学习和实践成功配置好了。今天早上自然醒是九点多，爬起来用昨天刚擦干净的笔记本播放音乐，几乎所有的歌曲都是温柔的。因为几个星期连着下雨，笔记本都长霉了，昨天擦干净充电，还好功能都没问题。躺在床上，听着歌，感觉好舒服，很久很久没有这种感觉了，时间就像没有流逝，所有美好都不期而遇。\n前两天是周五，很久没有那么早下班了，刚走出门就感觉到了清爽的风，抬起头天空好明亮，前面的树木全被风吹的翻起了白肚子。那一刻感觉生活在漫画的世界。\n这是一种温柔的感觉，gentle。昨天看DT的视频，他说现代的多媒体社交平台在摧毁着我们，让我们接受到太多的negative信息，浪费我们太多的时间，也在消耗这我们的能量。我觉得很对，我感觉自己就变得很negative，在网上看了太多负面的消息，当然这些都是事实，现实中也确实因为这些事实而烦恼。对这个社会了解的越多，就越让人无法开心起来，也让我变得越来越negative。\n有一个特别适合的比喻，如果把国家比作两个邻居，那么美国就是那个大大咧咧多管闲事的家伙，我们国家就是那个野心勃勃，在背地里耍小聪明且偏执的家伙。然而我不得不说我更喜欢直爽的人。而后者的这种性格，对生活实实在在的造成了很多困扰，毫无意义的核酸检测，有公路车没有道路骑，有机车卖不允许骑，然而他们自己却大摇大摆的骑着机车在道路上穿梭。太多不公平，不合理，不为百姓着想的事情了。只能说生活在这个时代这个空间的人是不幸的。因为生活几乎找不到乐趣了，all of them都被禁止，看到大街上的人群，看到我自己，有一种无法诉说的悲凉。\n没错，这些都是事实，昨天又突然把小区封闭了。虽然说着“请”大家配合，但是紧接着就说如果不配合那么解封之后可能无法出去，后果自负。一边为这奇葩的脑回路说话感到无语，一边还要为明天能否可以出去上班而担忧。我想朝鲜也就是这个鬼样子吧。如果是以前那种特别负面的心态，不知道我会不会配合做核酸。但是我的想法却变了，有人上门来做核酸多好啊，这种待遇谁享受过啊，还免得我跑几公里外去做核酸了。\n是啊，为什么我要担心考虑那么多，过好自己的生活就够了，没必要为一些不相关的事情而担忧。历史依旧会这么走，从来不会因为我的想法而改变，宇宙这么大，怎么会因为我这个尘埃的想法而改变。我真的没必要关心，而是过好自己的生活，不要让negative信息左右着我。李白，苏轼，陆游，他们都没有公路车，机车，可是他们的生活是那么丰富。作为现代人的我拥有的更多。\n真正能让一个人positive的不是外在的环境，而是自己的内心。王阳明也说心即理，内心纯粹便是天理。时光流逝的如此迅速，更应该留住美好，不去触及那些让人不开心的。成为一个温柔的人，gentle。\n","categories":["think"],"tags":["positive"]},{"title":"terminal","url":"/2022/04/23/terminal/","content":"TERMINALterminal is a topic include many many things, and i will complete it.\nSHORTCUTclean and movement\nctrl + l # clearn screen\n\nctrl + a # move cursor to the begin\n\nctrl + e # move cursor to the end\n\nalt + b # move cursor one word before\n\nalt + f # move cursor one word after\n\nctrl + u # clear to the begin and yank to clipboard\n\nctrl + k # clear to the end and yank to clipboard\n\nalt + backspace || ctrl + w # clear one word before\n\nctrl + y # paste last command&#x27;s last argument\n\n\nNote: in zsh, some of the key binding is not working by default. so we need add key binding by hand.\n\n# find all registered zle commandszle -al# bind personal key for zsh, add to .zshrcbindkey ^K kill-line   bindkey ^B backward-word bindkey ^F forward-word bindkey ^Y insert-last-word# show all binded keysbindkey\n\n\n\ndisplay and process\nctrl + c # end process\n\nctrl + z # stop current process and send to backend\n\nctrl + d # end typing\n\nctrl + s # hide character typed and output\n\nctrl + q # get out of hide mode and display\n\nGREAT WORKFLOWif you forget to type sudo at the beginning, there are two convenient ways. and i prefer the second one\n# firstctrl + asudo# second ctrl + u sudoctrl + y\n\nCOMMANDwrap terminal long lineview all message with this page\nsometimes the terminal output is too long, in default the long line will wrap in several lines, and we cannot see each line’s begin.\nthere are several methods to solve this problem:\n\nedit terminal setting\n# such as in xterm disable line wrapsetterm --linewrap off\nuse -S of less\n# such as ps -ef |grep code |less -S\n\n\n\n\nlast commandthere i will show how to modify the last command since it is really very useful in our daily typing.\n# repeat last command!!# repeat second last command!-2# get last command first argument!^# get last command last argument!$# get last command Nth argument, n is numeric, such as 1,2...11...!:n# modify last command and execute!:s/xxx/yyy\n\nmktemp在脚本中经常遇到需要创建临时文件或目录的情况，直接使用命令在/tmp目录下创建存在安全问题，所以更好的是使用mktemp命令\n# fileTEMPFILE=$(mktemp) || exit 1# dirTEMPFILE=$(mktemp -d) || exit 1\n\ntrap临时文件或目录使用完后需要清理，可以搭配trap命令。trap命令放在文件最开头，这样可以包含所有后面的信号\ntrap [command] [signal]\n\n#!/bin/bashtrap &quot;rm -rf $TEMPFILE&quot; EXITTEMPFILE=$(mktemp) || exit 1\n\n# 信号HUP：编号1，脚本与所在的终端脱离联系。INT：编号2，用户按下 Ctrl + C，意图让脚本中止运行。QUIT：编号3，用户按下 Ctrl + 斜杠，意图退出脚本。KILL：编号9，该信号用于杀死进程。TERM：编号15，这是kill命令发出的默认信号。EXIT：编号0，这不是系统信号，而是 Bash 脚本特有的信号，不管什么情况，只要退出脚本就会产生。\n\nsshfssshfs和nfs作用相同，都是挂载远程目录，但是sshfs更加简单，只需要在本地安装sshfs即可，因为连接使用的是ssh\n# installapt install sshfs# mountsshfs root@192.168.31.121:/opt /opt# umountfusermount -u /opt\n\nstty修改终端的设置\n# show all settingstty -a# disable input echostty -echo# enable input echostty echo\n\n在有些程序中（例如ftp），按下回车键不能删除字符，而是显示^H，为了解决这个问题，可以在使用ftp之前进行设置\nstty erase ^H\n\n设置之后回车即可删除，但是在shell下回车会变成^?，所以有必要改回来\nstty erase ^?\n\n同时stty还可以查看/设置屏幕高度和宽度\nstty sizestty rows 100 cols 100\n\nqmvqmv/qcp/qcmd属于renameutils软件包，可以用编辑器快速对文件重命名，默认使用nano打开文件，可以指定vim打开进行更加高效的操作\nexport EDITOR=vim# rename all jpgqmv *.jpg# only show target columnqmv *.jpg -f do\n\n\npidof查看进程的pid，效果等同于pgrep\npgrep xxxpidof xxx\n\n$!check last backend jobs’s pid\n# if we have a backend jobssleep 100 &amp;# then we can access its pid withecho $!\n\nrgrg(ripgrep), ag(the silver search) is the newest grep tool, much more faster than grep\n# almost the same useage of greprg xxx\n\nfdfd-find is the newest find tool, much more faster then find\n# different with find, but more simplefdfind md$ #\n\nexaexa is the colorful tool of ls\n# include tree displayexa -T\n\ncrontabcrontab can not only used to execute regular task, but also at a specified time, such as reboot\n# execute at reboot@reboot /location/to/script# reboot and wait for a while@reboot sleep 60 /location/to/script\n\nnot stores in historyif we put a space before command, then it will not store in history\necho &quot;cannot find this command in history&quot;\n\ndisownexit terminal but leave all processes running\ndisown -a &amp;&amp; exit\n\ntmpfscreate a super fast ram disk\nmkdir /mnt/rammount -t tmpfs tmpfs /mnt/ram -o size=8G# change mount size without rebootmount -o remount,size=4G /mnt/ram\n\nlong commnaduse shortcut opening a editor to write long command or multi commands instead of the terminal\nctrl+x+e\n\nfcopen a editor to edit the last command you run and then execute it automatically\nvim /etc/sysconig/network-scripts/ifcfe-en980fc\n\ncatch log fileif  the log file is not big enough, we can use less +F instead of tail -f, because with it we can do more control of output. such as we can see old message with ctrl + c and scroll , and than shift + f to the end with tailing\nless +F file_name# or press shift + f after opening a file when we only use less commandless file_nameshift + f# q to quitq\n\nalso we can combine this option with -S to wrap long lines, pretty much useful\nless -S +F file_name\n\nresetthere is no need to close and reopen you terminal to reset all the things such as variable setting. just typing reset , all will be done\nreset\n\ndoasI will use doas instead of sudo, because i get confused when i find /etc/sudoers file includes root settings. I wonder why it includes root settings, root has the highest privileges by default. At last i know the reason that with the settings root can use sudo command.\n# in archlinux, install opendoaspacman -S opendoas\n\n in order to make it effects, we need create a configure file and write our configuration to it\n# allow all users belong to wheel group execute super user command without passwordecho &quot;permit nopass :wheel&quot; &gt; /etc/doas.conf\n\n\nNote:\n\nnopass allow us to run command without password\nuse : before wheel means wheel is a group\n\n\nserveral days after, i find that i need reinstall sudo package, because some program need sudo, such as psd, build package with aur, without sudo there will be an error occurs.\nrsyncrsync must be installed in two machines if the two machine need to sync files\nI have ever used linux nearlly 5 years, however i know the awesome command this days. the main features:\n\nIt can implement cp scp, but more powerful\nIt can specified some file to skip\nIt can delete different files in destination\n\n\nfunny:\nI have ever wrote a shell script to backup my linux configure file. There is a satulation that the configure file in linux i have deleted but the backup directory still has the file, it is hard to check which file should be delete, so i delete whole directory and then copy directory to destination. Now, with rsync it seems that much easier.\n\n# --delete will delete destination file which not exists in source directoryrsync --include &#x27;*.txt&#x27; --exclude &#x27;*.sh&#x27; --delete -av remoteUser@ip:/remote/directory /local/directoryrsync --include &#x27;*.txt&#x27; --exclude &#x27;*.sh&#x27; --delete -av /local/directory remoteUser@ip:/remote/directory \n\nbata colorful repalcement of cat\n# show text with line number and scroll like lessbat -pn# show all text with line number at oncebat -ppn\n\ncpufetchshow detail informatioin of cpu\nxdotoolxdotool can do lots of things, such as simulate mouse action, key press, get window properity and so on.\n# key pressxdotool key &quot;l&quot; &quot;s&quot; return return# get current window class namexdotool getwindownfocus getwindowclassname# get mouse locationxdotool getmouselocation\n\nyadyad is gui dialog tool which can be used to launch a dialog for shell input. though i have ever not used xdialog, i think it is much better than xdialog.\n# setting with timeout,position,length,window title,label text,default placeholder,button position.yad --entry --timeout=5 --center --fixed --title=&#x27;change app transparence&#x27; --entry-label=&quot;App name:&quot; --entry-text=&quot;$currentApp&quot; --buttons-layout=edge# also can use text to specified window textyad --entry --timeout=5 --center --fixed --title=&#x27;change app transparence&#x27; --entry-label=&quot;App name:&quot; --entry-text=&quot;$currentApp&quot; --buttons-layout=edge --text=&quot;CHANGE APP TRANSPARENCE&quot;\n\nmount bindit is a very useful tool much better than ln -sf, ln is a tool to create a link(file) redirect to other position, and mount --bind will mount some folder/file to a specified location at boot time in kernel. so mount --bind‘s operation makes effect to origin location.\n# temporarymount --bind /mount/folder /to/mount/point# permanentvim /etc/fstab/mount/folder /to/mount/point    none    rw,bind 0 0\n\nnsenterenter new namespace with nsenter command. it is a really useful tool with container if the container don’t have  ip command.  we can use this to  easily get container ip address and route table.\n# get container&#x27;s  pidpid=`podman inspect -f &#123;&#123;.State.Pid&#125;&#125; container_name`# or use ps commandps -ef |rg $(ps -ef |rg container_name |awk &#x27;&#123;print $2&#125;&#x27; |head -1) |tail -1 |awk &#x27;&#123;print $2&#125;&#x27;# get container ip addressnsenter -t $pid -n ip -c a# get container ip route tablensenter -t $pid -n ip -c r\n\ncczewith ccze the output in terminal will be colorized.\n# usageps -ef |rg firefox |ccze -Apodman images |ccze -A\n\nSHELLsome userful, unusual, amazing usage or tips\nfind test shortcut meaningmost of time i will forget what the shortcut in shell condition meaning, but now i find a way to find all the shortcut meaning.\nman test\n\ngrant privilege to normal user with the owner’s permissionyeah, i remember to learn setuid and setgid. but still today, i really know the right usage of them, and i have to say they are very powerful for our daily use.\nas we know some command need root privilege to execute, when i meet this requirement before, i often put this command to sudoers file to make it execute without password, in a fact this method is too stupid. it is simple to resolve with setuid or setgid.\nsetuid and setgid or a command to be executed, it is a property of the command.\n# grant user privilegechmod u+s /some/command# grant group privilegechmod g+s /some/command\n\nremote X11 forward with sshwe can open remote machine’s GUI program in local  with ssh even though remote machine without a full X11 system installed. but local machine must has a full X11 system environment.\nremote machine:\n\ninstall xauth and xhost(optional)\n/etc/ssh/sshd_config allow X11Forwarding, AllowTcpForwarding, X11UseLocalhost to yes and X11DisplayOffset=10 \nrestart ssh\n\nlocal machine:\n\ninstall xauth\n\n# specify X11 forwardingssh -X remote_user@remote_ip# then open remote gui program such as xtermxterm\n\nuse Xvfb open application without GUIas we know there are so many programs load in background and they are be called daemons, however not all of the programs be designed like that, may be we have the need of opening some GUI applications in background and we don’t want to see the GUI each time the system starts.\nwith Xvfb we can do that, it opens GUI application in virtual memory without showing any screen output. in archinux, we can install it with\npacman -S xorg-server-xvfb\n\naccording to this webpage, if we want to run some GUI application in background, we can write like this\n# open a virtual frame buffer called :1Xvfb :1 &amp;# specify the application to start in virtual frame buffer :1DISPLAY=:1 /location/to/gui/application &amp;\n\nmay be we can use it in browser testing, and starting pentablet app\nthe problem of numthe way to get the hour of system will lead some problem while comparing with this nums, because all num begin with 0 is recognized as octonary\nhour=`date +%H`[[ hour -eq 8 ]] || EXIT#[[: 08: value too great for base (error token is &quot;08&quot;)\n\nthe way to fix the problem is adding 10# at the begining\nhour=10#`date +%H`[[ $hour -eq 8 ]] || EXIT\n\nthe problem of column alignmentcolumn can deal most of column’s alignment, however sometimes i don’t know why it fails, at last i find command  expand can work with column to fix the problem.\n\nfor loop in shellfor ((i=0; i&lt;5; i++))do    echo $idone\n\nvariable expansion# set default value$&#123;var:-default&#125;$&#123;var:=default&#125;$&#123;var=default&#125;# if variable not defined before then give a message$&#123;var?message&#125;# cut variable with index and length$&#123;var:index:length&#125;# cut variable with pattern$&#123;var#*pattern&#125; #cut left to the first match$&#123;var##*pattern&#125; #cut left to the last match$&#123;var%pattern*&#125; #cut right to the first match$&#123;var%%pattern*&#125; #cut right to the last match# get variable length$&#123;#var&#125;# show all variables matched with begining of &quot;pre&quot;$&#123;!pre*&#125;# variable replace$&#123;var/match/replace&#125; #replace the first one matched$&#123;var//match/replace&#125; #replace all matched$&#123;var/#match/replace&#125; #only replace the first one matched$&#123;var/%match/replace&#125; #only replace the last one matched\n\nprivilege of scriptsometimes we may meet the problem of privilege in our script as a normal user, because some commands need to be executed with root privilege.\n# one method is send root password to sudoecho &quot;password&quot; |sudo -S command# another way is giving the script privilege of without passwordecho &lt;username&gt; ALL=(ALL) NOPASSWD: &lt;/location/to/script&gt;# then execute script with sudosudo &lt;/location/to/script&gt;\n\nalias act as functionthere is a concept in perl called one liner, with zsh, we can use function to write one liner, but bash cannot. however we can use alias, is it amazing? just think of it a little more deeper, both of them are block code.\n# with zsh, function can write in one linefunction autoline()&#123;for ((i=0;i&lt;`tput cols`;i++));do echo -n &quot;=&quot;;sleep 0.001;done&#125;# unset to clear function defineunset -f autoline()# amazing alias usagealias autoline=&quot;for ((i=0;i&lt;`tput cols`;i++));do echo -n &quot;=&quot;;sleep 0.001;done&quot;# unalias to clear alias defineunalias autoline\n\nuse : to complete syntaxsometimes we don’t write code in one condition, but need to make sure syntax right, then : comes\nif [ $&#123;a&#125; == 3 ];then    :else    a=0\n\nuse local to define a local variablein shell, all variable are global by default, expect use local to define\nvar=&quot;global variables&quot;function show()&#123;    local var=&quot;local variable&quot;    echo $var&#125;showecho $var\n\nuse type to check command’s typecan check: alias, function, built-in, executable\ntype ls\n\ndisable truncate file in globalwe commanly use &gt; to truncate a file, &gt;&gt; append to a file. and there has a method to disable truncate file in global in order to less mistake happend\n# disable truncate file, now only append to file allowedset -C# enable truncate fileset +C\n\n\nNote:\nunset has totally different usage, it is used for clear variable define: var=5; unset var\n\narray in shelldifferent shell has different usage\n# in bash, it is complex with indexarray=(1 2 3 4 5)len=$&#123;#array[@]&#125;for ((i=0; i&lt;$len; i++))doecho $&#123;array[$i]&#125;done# simple usage without indexarray=(1 2 3 4 5)for i in $&#123;array[@]&#125;doecho $idone# in zsh, it is simplearray=(1 2 3 4 5)for i in $arraydoecho $idone\n\nmap in shell# create associate arraydeclare -A user user=([name]=xiaoxiao [age]=20 [score]=100) # simplifydeclare -A user=([name]=xiaoxiao [age]=20 [score]=100) # add valueuser[like]=apple# get all keysecho $&#123;!user[@]&#125;# get all valuesecho $&#123;user[@]&#125;# get specified valueecho $&#123;user[name]&#125;# get lengthecho $&#123;#user[@]&#125;\n\ncase convertwith declare, we can also convert upper case to low case, other side the same\nstring=&quot;hello world!&quot;# convert to upper casedeclare -u var=$stringecho $var# convert to lower casedeclare -l var=$stringecho $var\n\ncheck run level\n0：halt\n1：single-user text mode\n2：not used (user-definable)\n3：full multi-user text mode\n4：not used (user-definable)\n5：full multi-user graphical mode\n6：reboot\n\nwho -rsystemctl get-default\n\nget ip address# use regexip a |rg -P &#x27;(\\d+\\.)&#123;3&#125;\\d+&#x27;# use ip commandip -br -4 -c a# some debian/redhat allow thishostname -ihostname -I# use json formatip -j a |jq &#x27;.[].addr_info[0].local&#x27;\n\ncheck live environment# use systemd-detect-virt, almost make sense, owned by systemdsystemd-detect-virt# use lscpu to check Hypervisor vendorlscpu |grep &quot;Hypervisor vendor&quot;# use hostnamectl to check Virtualizationhostnamectl |grep &quot;Virtualization&quot;# even use parted to check Modelparted /dev/sda1 print |grep &quot;Model&quot;# use dmesg to check Hypervisordmesg |grep &quot;Hypervisor detected&quot;# maybe i will not use this forever, for it is so longdmidecode -s system-manufacturer\n\nshare terminal output to remote usersometime we need to share our terminal output to other people who is not in local network, and there comes this method\n# netcat is neededpacman -S gnu-netcat# for example: share our .vimrc to other peoplebat -ppn .vimrc |nc seashells.io 1337# then share the url link to other peoplehttps://seashells.io/v/Zn3SnvKX# we can change it to plain text with replacing /v to /phttps://seashells.io/p/Zn3SnvKX\n\nshare terminal to remote userbe different from above, this method allows remote user to execute command with our local machine.\n# install tmatepacman -S tmate# create ssh key if not existssh-keygen# start tmatetmate# share url link with otherstmate show-message\n\nsort ss port number via numericss -Hatln |tr -t : \\\\t |sort -k6n |tr -t \\\\t :\n\nfind process working directorypwdx `pgrep [processname]`ls -l /proc/`pgrep [processname]`/cwdlsof -p `pgrep [processname]` |rg cwdreadlink -e /proc/`pgrep [processname]`/cwd\n\nloop until succeedwhile ! ping www.bing.com; do sleep 3; doneuntil ping www.bing.com; do sleep 3; done\n\nexecute one command in remote machinesometimes, we don’t need to login to remote machine if we only want to execute one command, we can use ssh to execute that command in local machine\nssh user@ip [command]# for example:ssh root@192.168.31.100 free -m\n\nsimulate packages installationsimulation can help us to check whether there has some dependence we don’t installed in the environment before we actually install packages\n# most package managers have this functionrpm -ivh --test /location/to/rpm/package\n\nrepeat history command with tagthis feature is actually a common usage, but almost the time we don’t know it can be used  like this.\n# with `#` we can tag a commandip -br -c -4 a # ip4# repeat with tag!?#ip4\n\nCTRL CHARACTERlinux: \\n means return, and $ renders as line ending\nwindows: \\r\\n means return, and ^M$ renders as line ending\n\nNote:\nline ending character is not control character, it just renders as the ending of line.\nin coding, we may use \\n to act as a return action.\n\nthe way to show ctrl character:\ncat -A fileName# inside vim:set list# nolist to turn off:set nolist\n\nthe way we type ctrl character in vim: ctrl + v + ctrl_character. such as ctrl+v+c: ^C\n# remove all ctrl character in vim:%s/[[:cntrl:]]//g\n\nUlIMITthere are serveral ways that we can change system limits temporarily or permanently. the simplest way we can find system resource limit is typing ulimit -a.\n➜  ~  ulimit -a-t: cpu time (seconds)              unlimited-f: file size (blocks)              unlimited-d: data seg size (kbytes)          unlimited-s: stack size (kbytes)             8192-c: core file size (blocks)         unlimited-m: resident set size (kbytes)      unlimited-u: processes                       63668-n: file descriptors                1024-l: locked-in-memory size (kbytes)  64-v: address space (kbytes)          unlimited-x: file locks                      unlimited-i: pending signals                 63668-q: bytes in POSIX msg queues       819200-e: max nice                        0-r: max rt priority                 0-N 15:                              unlimited\n\nthe way to find program resource limit is cat /proc/$pid/limits\n➜  ~  cat /proc/`pgrep firefox`/limitsLimit                     Soft Limit           Hard Limit           Units     Max cpu time              unlimited            unlimited            seconds   Max file size             unlimited            unlimited            bytes     Max data size             unlimited            unlimited            bytes     Max stack size            8388608              unlimited            bytes     Max core file size        unlimited            unlimited            bytes     Max resident set          unlimited            unlimited            bytes     Max processes             63668                63668                processes Max open files            4096                 524288               files     Max locked memory         65536                65536                bytes     Max address space         unlimited            unlimited            bytes     Max file locks            unlimited            unlimited            locks     Max pending signals       63668                63668                signals   Max msgqueue size         819200               819200               bytes     Max nice priority         0                    0                    Max realtime priority     0                    0                    Max realtime timeout      50000                200000               us    \n\n\nNote:\nwe may find the difference between open files, we need to know that os resource limit only make effect when program not starts with service or systemd or no self defined, such as run program in terminal.\n\ndefine os resource limittemporary\nulimit -n 40960ulimit -u 40960\n\npermanent\n# restarting os neededvim /etc/security/limits.conf* soft nofile 40960* hard nofile 40960* soft nproc 40960* hard nproc 40960\n\nservice limitno need to reboot os, stoping program and starting program will be okay(not restart).\nvim /etc/liit/program_name.conflimit nofile 40960 40960limit nproc 40960 40960\n\nthen\nservice program_name stopservice program_name start\n\nwe can check it by\ncat /proc/`pgrep program_name`/limits\n\nsystemd limitno need to reboot os\nvim /usr/lib/systemd/system/program_name.service[Service]LimitNOFILE=40960LimitNPROC=40960\n\nthen\nsystemctl daemon-reloadsystemctl restart program_name\n\ndifferent from service we can define all systemd resource limit with\nvim /etc/systemd/system.confDefaultLimitNOFILE=40960DefaultLimitNPROC=40960\n\nmodify resource limit for running programIn the new linux kernel we have a tool called prlimit, with which we can modify program limit when it’s running.\nprlimit -n40960 -p `pgrep program_name`prlimit -u40960 -p `pgrep program_name`\n\n then check it\nprlimit\n\nUFWUncomplicated Firewall\nenable at boot, make sure iptables.service not active\nsystemctl enable ufw.service\n\ninitialize at the first time install the package\nufw enable\n\nquery rules being applied\nufw status# or much more infoufw status verbose\n\nsee default config\n[root@s1 ~]# cat /etc/default/ufw |egrep &#x27;^[^#]&#x27;IPV6=yesDEFAULT_INPUT_POLICY=&quot;DROP&quot;DEFAULT_OUTPUT_POLICY=&quot;ACCEPT&quot;DEFAULT_FORWARD_POLICY=&quot;DROP&quot;DEFAULT_APPLICATION_POLICY=&quot;SKIP&quot;MANAGE_BUILTINS=noIPT_SYSCTL=/etc/ufw/sysctl.confIPT_MODULES=&quot;nf_conntrack_ftp nf_nat_ftp nf_conntrack_netbios_ns&quot;\n\nset default policy\nufw default allow outgoingufw default deny incoming\n\nmake changes effect\nufw reload\n\nthree actions\nallow    # allow connectionlimit    # deny connections if an IP address attempts to initiate 6 or more connections within 30 secondsdeny    # deny connection\n\npolicy setting with service name\nufw limit sshufw allow ftpufw deny http\n\npolicy setting with port\nufw limit 22ufw allow 21ufw deny 80\n\npolicy setting with protocol\nufw limit 22/tcpufw allow 21/tcpufw deny 80/tcp\n\ndelete policy\nufw delete allow 21ufw delete limit sshufw delete deny 80/tcp\n\nvia sort number\n# check numberufw status numbered# delete via numberufw delete &#123;&#123;number&#125;&#125;\n\nport range\nufw allow 10000:65535/tcp\n\nspecified ip\nufw allow from 192.168.31.12\n\nip range\nufw allow from 192.168.31.0/24\n\nip and port\nufw allow from 192.168.31.12 to any port 80# add protocolufw allow proto tcp from 10.10.10.10 to 192.168.31.13 port 80 \n\nSYSTEMD最实用命令\n# 查看启动配置systemctl cat xxx.service# 查看远程服务信息systemctl status xxx.service -H root@192.168.31.110\n\n系统电源控制\nsystemctl shutdownsystemctl rebootsystemctl haltsystemctl suspendsystemctl hibernate\n\nPORT DETECT4 ways to check if a port is open on a remote linux\nnc: netcat command\nnmap: network mapper tool\ntelnet: telnet command\necho &gt; /dev/tcp/..\n\nnetcat\nnc -zvw10 192.168.0.1 22\n\nnmap\nnamp 192.168.0.1 -p 22\n\ntelnet\ntelnet 192.168.0.1 22\n\necho\nthe best way, because it is really less dependent only one  built in command echo \n# tcpecho &gt; /dev/tcp/192.168.0.1/22 &amp;&amp; echo &quot;port tcp/22 is open&quot;# udpecho &gt; /dev/udp/192.168.0.1/22 &amp;&amp; echo &quot;port udp/22 is open&quot;\n\n3 ways to check if a port is open on local machine\nnetstat\nss\nlsof\n\nnetstat and ss have the same usage\nnetstat -atulpn# ss more popular than netstatss -atulpn\n\nlsof\nsudo lsof -i:22\n\n\nNote:\nlsof need to be executed with root privilege because it need to search kernel file\n\nKILLERSif you don’t know this commands, i have not to say that you will die!\nSEDSelectionsClipboard is a buffer used for short-term data storage. It is mainly used to transfer data within and between applications, via cut, copy and paste operations. Clipboard is usually temporary and unnamed place that resides in your Computer’s RAM. \nThe clipboards are called “Selections” and there are three types of clipboards available in X11 window system in Linux. They are:\n\nPRIMARY - This is normally used when copy/paste data using Mouse middle button.\nSECONDARY - It is not used used much, but exists.\nCLIPBOARD - This is used for explicit copy/paste commands via Keyboard using ctrl+c and ctrl+v keys and via menu items.\n\nIn xterm, we can use mouse button1 to select, button3 to paste with some configuration. In firefox, we can use addon copy on select \n# ~/.Xresources&lt;Btn1Up&gt;: select-end(CLIPBOARD,PRIMARY,CUT_BUFFER0) &lt;Btn3Down&gt;: insert-selection(CLIPBOARD,PRIMARY,CUT_BUFFER0) \n\nDISCUSShow centos 6 download package with repository?centos7是可以直接使用yum下载安装包的，但是在centos6上不行，因为官方的镜像仓库已经下架。但是并不是说我们就真的无法使用了，这个网站依旧有cantos6的镜像仓库，修改之后可可以了\n# we can access that website though linux.kernel.org or# directly visit https://vault.centos.org to find the link we needrpm -ivh http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpmwget http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm\n\nhow centos download package with all of its dependences?centos上提供了一个下载插件，通过downloadonly可以下载软件及其依赖。需要注意只有在对应的系统版本上下载的依赖才不会导致其它依赖的版本冲突，所以确保下载安装包的系统和准备安装这些包的系统版本一致。\n# in centos6yum install yum-plugin-downloadonly# if our system has never install that packageyum install --downloadonly --downloaddir=&lt;directory&gt; &lt;package&gt;# if the package already exist in our systemyum reinstall --downloadonly --downloaddir=&lt;directory&gt; &lt;package&gt;\n\n还有另外一个软件也提供了相同的功能\n# yum-utils include yumdownloader packageyum install yum-utilsyumdownloader &lt;package&gt;\n\nhow WSL download python using China repo?首先需要下载gunpg，因为换源后需要key认证，默认没有这个软件，需提前下载\nsudo apt install gnupg\n\n然后添加国内源: 添加以下信息添加到/etc/apt/source.list文件中\ndeb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse\n\n更新源会报错某些key无法识别，需要进行认证\n# eg:sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 82EB5823F4FE239D\n\n重新更新源，并下载python\nsudo apt updatesudo apt install python3 python3-pip\n\n\n\nWhy was I able to delete a file owned by root in my home directory without being root?I got a situation that i cannot edit a file owned by root but can delete it in my home directory. And i was confused such a long time, finally find the answer. whether a file can be delete or not is depend on the folder where file stores in but not the permission of file, the file permission will decide whether you can modified it or not.\n","categories":["learn"],"tags":["linux"]},{"title":"todo-application","url":"/2022/11/20/todo-application/","content":"FIND A TODO APPLICATIONLast Friday, i notice how important of taking note, so i plan to find a todo application. Today, i am glade to say i get the one and make it a little clearly of how to use it.\nThe one todo application is called task. It is really small, only nearly 900 Kb downloading size. Let’s take a look of how to use it.\nSETUPFirst time we run, it will creates a .taskrc configuration file in home directory. Obviously, i will not let that happen. Fortunately, it can be set in another location with modifying its configuration.\ndata.location=~/.local/share/taskhooks.location=~/.config/task/hooks\n\nThen move ~/.taskrc to ~/.config/task/taskrc\nmv ~/.taskrc ~/.config/task/taskrc\n\n\nUSAGECreate a context and give it a project name, the project name can be used to filter.\ntask context define work project:Worktask context define life project:Life\n\nCheck in/out created context\ntask context list\n\nContext just likes workspace, so usually before we add task, we need to choose the context which a task will be wrote.\n#logintask context work#logouttask context none\n\nFilter\nIf we login one context, we can add/delete a task directly. But if we don’t login a context, we can also add/delete, only when we specify a filter.\ntask project:[projectname] ...\n\nAdd task\ntask add [&quot;the task content&quot;] due:[time]#time can be specified time: today, 2week, month, year and etc#or schedule time: daily, weekly and etc#for exampletask add &quot;watch a movie&quot; due:todaytask add &quot;do exercise&quot; due:tomorrow\n\nCompleted task\ntask [id] donetask project:[projectname] [id] done\n\nDelete task\ntask delete [id]task project:[projectname] delete [id]\n\nModify task\ntask modify /from/to/task project:[projectname] [id] modify /from/to/\n\nShow task\n\nburndown\ntask burndown weekly\ncalendar\ntask calendartask calendar 2022\nplain text\n\nshow all scheduled task task listtask project:[projectname] list\nshow all complete tasktask completed\nshow today scheduled tasktask overdue\n\n\n\n","categories":["linux"],"tags":["todo"]},{"title":"use-entr-to-sync-task","url":"/2022/11/30/use-entr-to-sync-task/","content":"USE ENTR TO SYNC TASKSince last time i heard entr command from Luke, i tried to wonder how to use this command is a proper way. And in recent, i find its purpose.\nentr — run arbitrary commands when files changels /path/to/dir/* |entr [command]\n\nentr can receive input file and monitor them, when file changes it will execute the command after entr.\n\nNotice:\nentr can only receive one command, not a pipe chain, not a function, only one command. So if we want to do some more complicated work, we need write a script and pass to it.\n\nBackground: I recently start to use a todo list command line tool called task, there is no doubt that it works perfect. But if it only works in local without multi devices, it may less of its ability. So i want to use github and git to sync in different platforms. The problem is i don’t want to do the work manually, i hope it can auto sync when i change something.\nTask stores its content in ~/.local/share/task/ directory, each time i change something, the file in it will change. So i can use entr to monitor those files. Sounds good, but i find that even a check command task overdue will leads to the file change and entr will react. So it is necessary to filter out those checking commands.\nInitialize task content directory:\ncd ~/.local/share/taskgit init git add .git commit -m &quot;init&quot;\n\nConfigure remote github info:\ngit config --local user.name ...git config --local user.email ......bla bla followed by github\n\nThe sync-task script:\n#!/bin/dash#                        _ _               _            _    #  _ __ ___   ___  _ __ (_) |_ ___  _ __  | |_ __ _ ___| | __# | &#x27;_ ` _ \\ / _ \\| &#x27;_ \\| | __/ _ \\| &#x27;__| | __/ _` / __| |/ /# | | | | | | (_) | | | | | || (_) | |    | || (_| \\__ \\   &lt; # |_| |_| |_|\\___/|_| |_|_|\\__\\___/|_|     \\__\\__,_|___/_|\\_\\                                                           TASKFILE=$HOME/.local/share/task/# monitor task file, if any changes, commit this change and sync to github repo.# auto-git-comit is a local shell script writed to commit this change.ls $TASKFILE/* |entr -p -n auto-git-commit\n\n\nNotice:\n-p allow command after entr to execute when receive modification, without -p the command will execute immediately at first time.\n-n allow us to send those command or script to background, without -n we cannot write like this sync-task &amp;, because entr will not work in background by default.\n\nThe auto-git-comit script:\n#!/bin/dash#              _                                      _ _   #   __ _ _   _| |_ ___   ___ ___  _ __ ___  _ __ ___ (_) |_ #  / _` | | | | __/ _ \\ / __/ _ \\| &#x27;_ ` _ \\| &#x27;_ ` _ \\| | __|# | (_| | |_| | || (_) | (_| (_) | | | | | | | | | | | | |_ #  \\__,_|\\__,_|\\__\\___/ \\___\\___/|_| |_| |_|_| |_| |_|_|\\__|                                                          # get last task modify infocommand=$(tail -n1 $HOME/.config/zsh/.zsh_history | awk -F&#x27;;&#x27; &#x27;&#123;print $2&#125;&#x27;)# commit this change while real change happendcd $HOME/.local/share/taskecho $command |rg -e done -e start -e delete -e add -e modify &gt;/dev/null[ $? = 0 ] &amp;&amp; \\\tgit commit -a -m &quot;$command&quot; &amp;&amp; \\\tgit push -u origin main &amp;&amp; \\\tnotify-send --expire-time=1000 &quot;task sync......&quot;\n\n\nNotice:\nI tried to use last command task use as a commit message.\n\nAt last, start this command in background with xmonad:\nspawnOnce &quot;sync-task &amp;&quot;\n\nAll done, now when we add or modify some tasks, it will auto commits those changes and syncs to github, perfect!\n","categories":["linux"],"tags":["entr"]},{"title":"vboxdiskResize","url":"/2022/04/23/vboxdiskResize/","content":"Virtualbox Disk Resizecheck virtualbox disk size\n\nnow to resize disk size, unit is Mib. --resize is the size after extend whole disk size\n\nnow to check whether make effect\n\nit seems that the partation has not added to C: drive\n\n\nwe need to manually add the partion to C: drive with Diskgenius application\n\n\nnow, it is done!\n\n\n","categories":["learn"],"tags":["vbox"]},{"title":"weakness-is-our-nature","url":"/2022/11/16/weakness-is-our-nature/","content":"WEAKNESS IS OUR NATUREFinally, i realized that i am weakness.\nSince this summer i knew about Goggins, i inspired a lot by him and decided to do exercise every day. And i truly kept that state a long time, every morning every evening, i do regular exercise. But month later, the thought i need to do this every day met challenge by myself. Sometimes i just get a thought why don’t have a break? I am tired, a little break doesn’t means a lot. And several months later, my training time shrunk to 1/4 of starting. Last two weeks, i totally did zero training.\nSometimes, my emotion went to a low level, i don’t want fight, i feel tired in my mind. The inspiration i got when i started just gone. I am missing, i am confused.\nAnd i finally have to confirm that we humans are weakness. We can’t struggle from beginning to the ending. We always get a thought which told us to break, to give up. And most of time, most of us really will give up and take a break. I don’t want to judge that, because that is some part of our nature.\nHowever, should we just obey our nature?\nYou can or you cannot, both are okay. As for me, i was can, but not the future. I know there are some parts of us in our mind are weak, and i think i know how to fight against it.\nThe method is making myself get inspired by other things or people regularly, always remind myself why i decide to start, and what am i fighting for. I am not strong enough to be a hero of myself, i need to learn from the other people that i admire how they live the regular life, what’s going on with them.\nI should feel lucky enough, all the time after work belongs to myself, i have the ability to decide the way i spend them. I have a dream in my childhood, to be a man that has strong body, hides in the hood and protects the one i love. So regular training is my basic life, i need to keep sharp every second and prepare for the coming.\nIt is my fighting time.\n","categories":["think"],"tags":["realize"]},{"title":"vim","url":"/2022/11/09/vim/","content":"VIMVIM is the most powerful text editor as far as i know, just em amazing!\n\nABOUT THIS PAGE:This time i will rewrite it, delete the one not useful.Only leaves the common usage\n\nSHOULD BE USED DAILYThis section will shows the most powerful, convenient  usage that should become a mindset.\nUSE MACROIf we don’t know macro in vim, we have no idea how powerful vim is. Macro allow us do some operations(normal or insert or ex command) then replay it. We start macro with q then press a character which stores the macro, end macro with q.\nAfter record, we can use @x (example x is the register) to replay. A number can be set before @x which means replay it several times.\nWhat if we miss something in the macro record, should we do it again? No, we can edit macro in two ways:\n\npaste macro in vim, edit and copy to register again.\n#paste macro m&quot;mp #copy to register m again&quot;myy\npaste macro in ex mode, and edit(i like this way, since some none visible characters will show in ex mode).\n#set macro m, paste macro with ctrl+r m:let @m = &#x27;&#x27;\n\nRecursive Macro\nVim supports recursive macro, that is amazing. With this feature, we don’t need to specify how many times to run macro again. Because in most of time, we don’t know exactly times we need to run it again. The trick is in the end of record pressing @x (example x is the register). Then this macro will run forever until the file ends.\nDELETE TO REGISTERInstead of deleting text to default register &quot; with d.., we can delete to a register instead. The benefit of register is we can paste those deleted text again. Just think about it, we now have 26*2 standalone clipboard.\nDelete to a register: &quot;register d.., paste with ctrl+r register in insert mode. ctrl+a will insert last inserted text.\nDefault useful register:\n\n\n\nregister\ncontent\n\n\n\n%\ncurrent file name\n\n\n/\nlast search pattern\n\n\n:\nlast command line\n\n\n-\nlast small delete\n\n\nINDENT A LINE/LINESWe can use &lt; &gt; to indent selected lines. But what if we want indent a line when we typing.\nWe can use ctrl+t to increase indent, ctrl+d to decrease indent.\nCOMPLETE WITH CTRL+X\n\n\nkey press\ncomplete\n\n\n\nctrl+x ctrl+p\ncomplete a word\n\n\nctrl+x ctrl+l\ncomplete a line\n\n\nSEARCH FOR POSITIONUsually, we use w ^ $ p ] [ 0 j k etc to specify our operation’s position. For example daw dap c2j d0. And also we use f t jump to a character in a line. It is very convenient. How the way we jump to a word? We usually use /... to search something and then use n to move around.\nWhat if we want to delete/change to a specified word or sentence? Usually i use dt to some character and use . to repeat until the position i really need, or d4j to delete several lines with count.\nBut there is really a more convenient way to do that, we can directly use search pattern to specify to position. For example:\nevery morning we wake up to the greatest gift we have, life.&quot;I want to delete the word before &quot;gift&quot; when current position is line&#x27;s beginningd/gift&quot;Done! Delete to &quot;gift&quot; and get in insert mode:s/gift\n\n\n\n\nSHOULD I INSTALL VIM?You may think that i will install vim. Sorry, the answer is No. You are wrong, i will install neovim/gvim. If you install vim and you will die!  \nWhy i use neovim/gvim instead of vim, just because vim not supports copying content to other programs. And the other supports, one thing should be clear is that vim don’t conflict with the others, they can be installed together.\n#after gvim installed, we can check clipboard supportvim --version|grep clipboard     +clipboard \n\n\nNotice that we can download source vim code and compile it with clipboard support\n\nOPEN FILEONE FILE\n\n\ndescribe\ncommand\n\n\n\nusually\nvim [file-name]\n\n\nopen to specified line\nvim +[line-number] [file-name]\n\n\nsoft mode(can force write)\nvim -R [file-name]\n\n\nreal read mode(cannot edit)\nvim -m/-M [file-name]\n\n\nMULTI FILES\n\n\ndescribe\ncommand\n\n\n\nopen files\nvim [file1] [file2]\n\n\nmove to next\n:next\n\n\nmove to previous\n:previous\n\n\nmove to first\n:first\n\n\nmove to last\n:last\n\n\njump between recent two files\nctrl+^\n\n\nMULTI WINDOW\n\n\ndescribe\ncommand\n\n\n\nhorizon\nvim -o [file1] [file2]\n\n\nvertical\nvim -O [file1] [file2]\n\n\nin vim horizon open\nsplit [file-name]\n\n\nin vim vertical open\nvsplit [file-name]\n\n\nopen with specified hight\n:[number]split/vsplit [file-name]\n\n\nin vim horizon open blank window\n:new\n\n\nin vim vertical open blank window\n:vnew\n\n\nmove to next\nctrl+w+w\n\n\nmove to direction\nctrl+w+h/j/k/l\n\n\nmove to first\nctrl+w+k\n\n\nmove to last\nctrl+w+b\n\n\nchange size\nctrl+w -/+\n\n\nSAVE &amp; QUIT\n\n\ndescribe\ncommand\n\n\n\nquit\n:q\n\n\nquit all\n:qa\n\n\nforce quit\n:q!\n\n\nsave\n:w\n\n\nsave and quit\n:wq / :x / ZZ\n\n\nEXPORT\n\n\ndescribe\ncommand\n\n\n\nsave to other file\nsaveas [file-name]\n\n\nsave to other file\nfile [file-name]\n\n\nsave specified line to other file\n[start-num],[end-num]w [file-name]\n\n\nMOTION-UNIT-POSITIONOne magic of vim operation is that we can combine motion-unit-positon to do lots of stuff.such as d stands for delete motion, but what should be deleted? Okay, we use unit and position to specify. d2j means delete next 2 line, dip means delete in a paragraph. de means delete to a word end.\nMOTION\n\n\nshortcut\nmeans\n\n\n\nx\ndelete one character\n\n\ns\ndelete one character and change to insert mode\n\n\nX\ndelete previous character\n\n\nS\ndelete one line and change to insert mode\n\n\nd\nused with other motion, such as w,e\n\n\nD\ndelete to line end\n\n\nc\nsame as d but also change to insert mode\n\n\nC\ndelete to line end and change to insert mode\n\n\ny\ncopy\n\n\nyy\ncopy one line\n\n\nr\nreplace\n\n\nR\nreplace all typed until ESC pressed\n\n\np\npaste after\n\n\nP\npaste before\n\n\nxp\nquick exchange two character\n\n\nUNITunit includes numbers and a or i.a means a/an, i means in. The magic of a or i is we can do something in a line without current cursor position exactly under the one we operate. For example we can in one line’s beginning but delete a word which is surrounded by “” in any position of the line with da&quot; or di&quot;\n\ndaw: delete a word\ndi&quot;: delete in “”\ndi&#39;: delete in ‘’\ndis: delete in sentense\nyaw: copy a word\nyas: copy a sentense\n\nPOSITON\nshortkey\nwe can use :help shortcut to find the usage.some of shortcuts can be used with num, such 3j jump to 3 lines below, this kind of  shortcut can be called motion\n\n\n\n\nrange\nshortcut\nmeans\n\n\n\nwhole page\ngg\ngoto file start\n\n\n\nG\ngoto file end\n\n\none page\nctrl+f\ngoto next screen page\n\n\n\nctrl+b\ngoto previous screen page\n\n\n\nH\ngoto screen page start\n\n\n\nM\ngoto screen page middle\n\n\n\nL\ngoto screen page end\n\n\n\nzt\ndisplay line to page first\n\n\n\nzz\ndisplay line to middle page\n\n\n\nzb\ndisplay line to page end\n\n\njumped position\nctrl+o\ngoto jumped previous\n\n\n\nctrl+i\ngoto jumped after\n\n\n\n``\njump between last jumped position\n\n\nclosed position\nctrl+o+o\ngoto last closed file’s leave position\n\n\ndefine line num\n[line-num]G\ngoto number line\n\n\nparagraph\n( or &#123;\nnext paragraph\n\n\n\n) or &#125;\nprevious paragraph\n\n\n\n[[\nprevious sentense\n\n\n\n]]\nnext sentense\n\n\nbracket\n%\njump between bracket\n\n\nline\nj\ngoto next line\n\n\n\nk\ngoto previous line\n\n\ninside line\n0\ngoto number 0 go to line start\n\n\n\n$\ngoto line end\n\n\n\nf char\nfind first character in this line\n\n\n\n;\nused with f, do the action again\n\n\n\nF char\nfind first character in this line previous\n\n\n\nw\ngoto next word start\n\n\n\ne\ngoto next word end\n\n\n\nb\ngoto previous word start\n\n\n\nge\ngoto previous word end\n\n\n\nW\nblank space as basic unit\n\n\n\nE\n\n\n\n\nB\n\n\n\n\nh\ngoto previous character\n\n\n\nl\ngoto next character\n\n\n\n*\ngoto next word position below cursor\n\n\n\n#\ngoto previous word position below cursor\n\n\nAMAZING USAGE OF G\n\n\ntopic\nshortcut\neffect\n\n\n\nopen file\ngf\nopen file upon the file location\n\n\nopen url\ngx\nopen url link in the browser\n\n\nmovement\ngv\nmove back to the last visual select postion\n\n\n\ng0\ngoto line begin while one sentense wraped in multi lines\n\n\n\ng$\ngoto line end while one sentense wraped in multi lines\n\n\n\ngj\ngoto next line while one sentense wraped in multi lines\n\n\n\ngk\ngoto before line while one sentense wraped in multi lines\n\n\n\nJ\njoin lines with one blank space\n\n\n\ngJ\njoin lines without blank space\n\n\nredo\ng&amp;\ndo previous line replacement over the whole file\n\n\nredo\ncgn\ntype cgn then modify something then press . to next same one\n\n\ncapital\nguu\nlower case one line\n\n\n\ngUU\nupper case one line\n\n\n\n~\nreverse character case\n\n\n\ng~~\nreverse line case\n\n\nglobal search\n:g//\nsearch something in global and do action. eg: :g/^$/d delete all blank line\n\n\nCTRL’S MAGICctrl+a: number increase 1\nctrl+o i think this is the most useful shortcut in my usages.  it allow us temporary run some commands or press some shortcuts just like what we do in normal mode while we are in insert mode. \nfor example: i want to add some word in sevaral lines, i don’t need edit each line in insert line and then press ESC to normal mode and then back to insert mode. what i do is edit line and then press ctrl+o and then press j, continue editing lines. amazing\nUNDO/REDOu: undo\nctrl+r: redo\n:e!: undo to last saved\nSEARCH/: fuzzy search char/word between now to file end\n?: fuzzy search char/word between now to file begin \n\\&lt; \\&gt;: exact search char/word\nn: goto next matched search char/word\nN: goto previous matched search char/word\nMARK POSITIONMarker is a powerful tool if we use it properly. There are 2*26 characters can be used as marker. [a-z],[A-Z]. And there are some difference between capital and lower case:\n\n\n\ndescribe\ncommand\n\n\n\nm [a-z]\nmark works in local file\n\n\nm [A-Z]\nmark works in multi open files\n\n\n`[a-zA-Z]\njump to mark\n\n\nmarks\nshow all marks\n\n\nmarks [a-zA-Z]\nshow mark info\n\n\ndelmarks\ndelete all marks\n\n\nMark not only can be used to navigate, but also a position. Such as:\n#delete to marker `a`d`a#copy to marker `a`y`a\n\n\nSPELL CHECKEnable/Disable spell check\n:set spell/nospell  # in terminalset spell           # in .vimrc file\n\nThere are 3 state of a word:\n\nGood: real good word\nMisspell: not sure\nBad: read wrong spell word\n\nWe can mark word good or bad, and also can save it to file or as tmp.\n\n\n\ncommand\ndescription\n\n\n\n]s\nmove to next misspelled word\n\n\n[s\nmove to previous misspelled word\n\n\n]S\nmove to next bad word\n\n\n[S\nmove to previous bad word\n\n\nzg\nmark current word as good and add to good file\n\n\nzug\nmove current word from good file\n\n\nzG\nmark current word as good and add to tmp good file\n\n\nzuG\nmove current word from tmp good file\n\n\nzw\nmark current word as bad and add to bad file\n\n\nzuw\nmove current word from bad file\n\n\nzW\nmark current word as bad and add to tmp bad file\n\n\nzuW\nmove current word from bad tmp file\n\n\nz=\ncorrect word\n\n\nctrl+x+s\nchoose from already exist word in insert mode\n\n\nFOLDthere are 6 ways to define fold lines:\n\n\n\nmethod\ndescribe\n\n\n\nmanual\nmanually define fold\n\n\nindent\nuse indent to fold\n\n\nexpr\nuse expression to fold\n\n\nsyntax\nuse syntax to fold\n\n\ndiff\nfold no changes\n\n\nmarker\nfold with marked\n\n\nset fold method:\n#exmaple::set foldmethod=marker\n\nFOLD MOTIONIn this chapter i want to mark some useful fold operation, such as move, open, close.\n\n\n\ndescribe\ncommand\n\n\n\nclose all recursively\nzM\n\n\nopen all recursively\nzR\n\n\nclose step by step(global)\nzm\n\n\nopen step by step(global)\nzr\n\n\nopen under cursor\nzo\n\n\nopen under cursor recursively\nzO\n\n\nclose under cursor\nzc\n\n\nclose under cursor recursively\nzC\n\n\njump to next fold\nzj\n\n\njump to previous fold\nzk\n\n\njump to fold begin\n[z\n\n\njump to fold end\n]z\n\n\nmarker fold\nif we use marker fold method, we have other shortcut:\n\n\n\ncommand\ndescribe\n\n\n\nzf\ncreate fold\n\n\nzd\ndelete fold\n\n\nzD\ndelete multi step fold\n\n\nzE\ndelete all fold\n\n\nFOLD WITH MARKDOWNI have to say that i tried to install a markdown plugin, but its code block sucks, or may be i don’t know how to use it. So i uninstalled it and search whether vim itself can fold markdown, finally, i find it. Yes, vim itself can fold markdown as well.\nthe only thing we need to do is putting this line in ~/.vimrc\nlet g:markdown_folding = 1\n\nfor better view, we can open a fold column in lefe side with:\nset foldcolumn=6\n\n\n\nSETTING\n\n\ncommand\ndescribe\n\n\n\n:set cmdheight=num\nset bottom pannel height\n\n\n:set background=dark\nset background color\n\n\n:syntax reset\nsyntax reset\n\n\n:set spell\nenable spell check\n\n\n:! shell_command\ntemporary change to terminal and execute command\n\n\n:r !shell_command\nwrite shell command stdout to file\n\n\n:%TOhtml\nconvert file to html format\n\n\n:jumps\nshow jumped list, last jumped position marked with &gt;\n\n\nCOLOR\n\n\nwhich\ndescribe\n\n\n\nterm\nblack terminal display properity\n\n\ncterm\ncolorized terminal display properity\n\n\nctermfg\ncolorized foreground color\n\n\nctermbg\ncolorized background color\n\n\ngui\ngui properity\n\n\nguifg\ngui foreground color\n\n\nguibg\ngui background color\n\n\nsuch as:\n#change comment color to green:highlight Comment ctermfg=green guifg=green\n\n\n\nMAPin vim, we can map command to a shortcut, and it is very useful.\nas we know, vim has serveral mode, and map also has 3 kinds:\n\nmap/nomap: which bind key in normal mode\nvnoremap: which bind key in visual mode\ninoremap: which bind key in insert mode\n\n&quot;&lt;CR&gt;:return &lt;C-CR&gt;:ctrl+enter&quot;\\r -&gt; save and run shell scriptnoremap \\r :w&lt;Return&gt;:!./%&lt;CR&gt;&quot;\\# -&gt; comment \\3 -&gt; uncommentnoremap \\# :&#x27;&lt;,&#x27;&gt;norm I#&lt;ESC&gt;noremap \\3 :&#x27;&lt;,&#x27;&gt;norm x#&lt;Return&gt;&quot;/+enter -&gt; close search resultnoremap /&lt;CR&gt; :nohlsearch&lt;CR&gt;&quot;ctrl+n -&gt; open/close left file manager pannelnoremap &lt;C-n&gt; :NERDTreeToggle&lt;CR&gt;&quot;visual_choose+&gt; -&gt; increace indent(TAB)vnoremap &gt; &gt;gv&quot;visual_choose+&lt; -&gt; decreace indent(TAB)vnoremap &lt; &lt;gv&quot;ctrl+enter+esc -&gt; save and run pythoninoremap &lt;C-CR&gt; &lt;ESC&gt;:w&lt;CR&gt;,r     \n\n\n\n\n\nVIMDIFFvimdiff(or neovim’s nvim -d) is a colorful compare tool, much better than diff or colordiff\n\n\n\ncommand\ndescribe\n\n\n\nvimdiff file1 file2\ncompare two file\n\n\n:vertical diffsplit file2\nor compare another file when edit\n\n\n]c\njump to next difference\n\n\n[c\njump to previous difference\n\n\n:diffupdate\nrefresh screen\n\n\nTHE MOST IMPORTANT THEMEBefore use vim, the first thing is making it more beautiful.\none thing we need to notice vim’s theme include there part: \n\ncolor theme : code render color\nstatus line theme : bottom bar color\ncustom theme: include status line, line number etc\n\nCOLOR THEMEthe easiest way is use vim-plug to auto install theme, one thing we need to do is writing it to .vimrc\n#such as install onedark themePlug &#x27;joshdick/onedark.vim&#x27;\n\nand then type\n:PlugInstall\n\nthen call it in .vimrc\ncolorscheme onedark\n\noptional setting\n#the setting is optional, should write previous define colorschemelet g:onedark_hide_endofbuffer = 1let g:onedark_termcolors = 256let g:onedark_terminal_italics = 1\n\nmanually install need we download theme package and put theme in a specified location ~/.vim/colors\nSTATUS LINEStatus line choose lightline, it includes several different theme for us. \n#put in .vimrcPlug &#x27;itchyny/lightline.vim&#x27;let g:lightline = &#123;\\ &#x27;colorscheme&#x27;: &#x27;molokai&#x27;,\\ &#x27;component&#x27;: &#123;\\   &#x27;readonly&#x27;: &#x27;%&#123;&amp;readonly?&quot;&quot;:&quot;&quot;&#125;&#x27;,\\ &#125;,\\ &#x27;separator&#x27;: &#123; &#x27;left&#x27;: &#x27;&#x27;, &#x27;right&#x27;: &#x27;&#x27; &#125;,\\ &#x27;subseparator&#x27;: &#123; &#x27;left&#x27;: &#x27;&#x27;, &#x27;right&#x27;: &#x27;&#x27; &#125;\\ &#125;\n\n\n\nCUSTOM THEMEuser defined theme, adjust theme manually\n\nNote:\n​    without clear item we custom the setting will make no effect!\n\n&quot;clear linenr clear exist theme setting and make it the same as the terminal&quot;highlight clear LineNr&quot;clear signcolumn clear the left line setting make it the same as the terminal&quot;highlight clear SignColumn&quot;then set ourselves theme color&quot;highlight LineNr term=underline ctermfg=gray ctermbg=234highlight SignColumn term=underline ctermfg=gray ctermbg=232highlight cursorLineNr term=underline ctermbg=26 ctermfg=grayhighlight CursorLine cterm=NONE ctermbg=234 ctermfg=NONE guibg=NONE guifg=NONE\n\n\n\nlast effect: screen shot\n\nTIPSMULTI INSERTshift+v :norm I char: add some char in multi lines’head\n\nctrl+v :I char ESC: add some char in multi lines’specified position\n\nNUMBER SEQUENCEshift+v g ctrl+a: number sequence, line head\n\nctrl+v g ctrl+a:  number sequence, specified position\n\nREVERSE LINE SEQUENCE:g/^/,m0: reverse line sequence, move matched line to zero line\n\nJOIN MULTI LINEJ: join two lines, with one blank space\ngJ: join two lines, without blank space\n\nEDIT REMOTE FILEthis method is very very useful, because some remote machines have no vim or no vim configure. with this, we can use our favorate configuration to edit remote file\nvim scp://user@ip//location/to/file\n\n\nNote:\nnot only we can specified a file, we can also specified a directory\n\n","categories":["linux"],"tags":["vim"]},{"title":"vscode","url":"/2022/04/23/vscode/","content":"VSCODEvscode is a code editor with lots of extension. now i will show u how to install and configure it.\nsoftware install# pacman -S visual-studio-code-bin\n\n\nNote: now it is not recommended to install this package. because it cannot download any extensions,  for some reasons that vscode the open project cannot use any extensions from microsoft’s virsul studio market. So, there comes vscodium-bin which can use the open market  the Open VSX registry while vscodium-bin-marketplace installed instead of microsoft one. However in our country we cannot visit github and some other websites, so we cannot download the open VSX market’s extension in code editor. The resolution is downloading extension from [market website](Extensions for Visual Studio family of products | Visual Studio Marketplace) manually and then run vscodium --install-extension the-name-of-extension.vsix to install it\n\nparu -S vscodium-binparu -S vscodium-bin-marketplace# install some downloaded extensionvscodium --install-extension xxx.vsix# if there comes an error while installing extensions, we need to check whether we are in the correct markplace in website(visual studio code instead of visual studio)\n\n\n\nNote: the good news is that old vscode extensions can be used again once we copy it to new vscodium’s extension location.\n\ncp ~/.vscode/extensions ~/.vscode-oss/extensions\n\nsync with accounti use microsoft account to sync my settings for vscode is developed by microsoft.\n\nthe benefit of login with account is that when we install a new vscode, the only thing that we need to do is login our account, then all extension and user specified setting will download and correctly configure.\nextension\nBracket Pair Colorizer 2: colorize parentheses\nCode Runner: run code with shortcut\nPython: python syntax highlight and autocomplete\ngo: golang syntax highlight and autocomplete\n\ncommon settingsfont size\neditor font size\n\n\ndebug fontsize\n\n\nintegrated fontsize\n\n\n\nsmooth scroll\nrun in terminalconfigured only when code runner installed before\n\nrun before clearconfigured only when code runner installed before\n\nsave file before runconfigured only when code runner installed before\n\nshortcutconfigured only when code runner installed before. use ctrl+enter to run code\n\ndisable auto check update\n\npretty font settingwe know that we can use setting’s UI page to set this configuration. but edit file can reduce the time we search correct setting position.\npress ctrl+p then type settings.json open the file to edit.\nnote that the font name can be find with fc-list in linux. only copy the font name, remember no any style or it makes no sense.\nfont weight is also important, without it, the font may look thin.\nthe font is introduced by this video on Youtube, follow this web page, we can find Fira Code font, it looks really beautiful while rendering math symbol.\nin archlinux, we can download it use pacman\npacman -S nerd-fonts-fira-code\n\n\ncondai wanna to configure vscode debug with conda environment.\npress ctrl+p and type setting.json then enter\n\nand add &quot;python.pythonPath&quot;: &quot;/home/blueocean/.local/apps/minicanda/envs/new/bin/python&quot; the path of my conda python\n\nat last, activate conda env by hand in integrate terminal\n\namazing Zen modeThat’s the feature i love vscode most,  pure clean.  press ctrl+k then release, after that press z to  switch Zen mode.\ntroubleshootwhen i use microsoft account to login vscode to sync settings, i get the error below. and find a solution in this website\n\n# with archlinux, install the two packagesyay -S qtkeychain gnome-keyring\n\n\n\n","categories":["learn"],"tags":["vscode"]},{"title":"why-must-be-gained","url":"/2022/10/31/why-must-be-gained/","content":"WHY MUST BE GAINEDRecently, i knew a youtuber named luke, and i have to say it is really too late to know the guy, since lots of his mind thought, his life style, the way he use linux inspires me a lot.\nIt is been a long time that i have nearly zero skill updated. The most important reason is my work nowadays has no needs of IT technology. Another reason yet still important is i realize that’s really a huge of work. I can’t find the way to start. I leak of the courage of learning.\nLucky as me, watched a video from him in last Sunday. He lays in a soft chair with keyboard above this legs, just like a ease friend, talking with you, teaching you some skill of linux, vim. This sight really inspires me, cause i find his peace, patient, focus of learning or teaching something. \nLearning something doesn’t means we must be gained from it. Most of the time, it is just for fun. There is no need to hurry about something that has a lot of to learn. Step by step, even no gain, the time we spent yet still worthy.\nHis love to vim makes me think i should love the thing i love, don’t leave it just because people don’t like it, just because it’s out of date. VIM, the little thing, the best editor. I miss it a long time and i should get it back.\n","categories":["think"],"tags":["patient"]},{"title":"xmonad","url":"/2022/06/19/xmonad-0.17/","content":"XMONAD上大学的时候就开始用xmonad了，过段时间可能就要重新配置一下xmonad，这也成为了一种乐趣。曾经尝试过很多的WE，DE，最终还是最喜欢xmonad。xmonad的版本也从0.15变成了现在的0.17，logo也换了，everything is changed。有一种沧桑的感觉\n最近又在配置xmonad，想要实现用快捷键切换窗口的布局。然后发现了一些其它比较好的功能，但是我的archlinux上的版本不支持，所以考虑下载最新的版本使用。\n跟着教程一步一步配置，这种方式就不是用pacman上的安装包，而是从github克隆源码下来，用stack来编译安装。\n而且使用这种方式安装有一个附加的好处是系统升级不需要重新编译它，因为它不是用pacman来安装的，非常好。以前更新之后必须要编译不然重启后就会报错。\n以前一直以为配置文件只能放家目录下，现在发现可以放~/.config/xmonad下了，又是一个惊喜。\ninstall new 0.17\n进入配置目录\n\nmkdir ~/.config/xmonadcd ~/.config/xmonad\n\n\n复制之前的配置文件\n\ncp ~/.xmonad/xmonad.hs ~/.config/xmonad/\n\n\n\n\n克隆源码\n\ngit clone https://github.com/xmonad/xmonadgit clone https://github.com/xmonad/xmonad-contrib\n\n\n下载编译工具\n\npacman -S stack\n\n\n创建stack project\n\nstack init\n\n从这一步开始就报错了，还是老问题，国内访问不到，只能开vpn下载了\n\n安装编译\n\nstack install\n\n这一步会下载ghc，并且自动编译stack build，然后自动把xmonad命令移动到~/.local/bin下。\n现在准备工作已经完毕，只需要编译配置文件就行。因为用pacman安装的有xmonad，所以现在运行xmonad --recompile还是用的之前的版本，所以我们必须指定路径来编译配置。\n~/.local/bin/xmonad --recompile\n\n\nNote: 为什么不先卸载系统的xmonad呢？因为我们不能确定编译没有问题，所以需要先保证编译没问题后再卸载。\n\n编译过程自然是会报错，问题就是0.15版本的一些语法在0.17不兼容了。包括两个地方：\n1. XMonad.Hooks.StatusBar.PP 取代 XMonad.Hooks.DynamicLog2. XMonad.Actions.CycleWS 用emptyWS取代EmptyWS\n\n\n编译没问题之后卸载系统xmonad\n\npacman -Rns xmonad xmonad-contrib\n\n\n\n\n\nnew featurekeybinding to toggle layout这个功能在0.15版本就是可以实现的，只不过之前不知道怎么配置，因为自带的配置没有对应的layout调用，需要自己写数据结构\n-- self define toggle layout transformerdata ACCORDION = ACCORDION deriving (Read, Show, Eq)instance Transformer ACCORDION Window where    transform _ x k = k Accordion (const x)data CROSS = CROSS deriving (Read, Show, Eq)instance Transformer CROSS Window where    transform _ x k = k simpleCross (const x)data PST = PST deriving (Read, Show, Eq)instance Transformer PST Window where    transform _ x k = k positionStoreFloat (const x)data THREE = THREE deriving (Read, Show, Eq)instance Transformer THREE Window where    transform _ x k = k (ThreeColMid 1 (3/100) (1/2)) (const x)\n\n然后调用\n$  mkToggle (single MIRROR)$  mkToggle (single ACCORDION)$  mkToggle (single CROSS)$  mkToggle (single PST)$  mkToggle (single THREE)\n\n设置快捷键\n, ((_M , xK_apostrophe), submap . M.fromList $   [ ((0 , xK_m), sendMessage $ Toggle MIRROR)   , ((0 , xK_a), sendMessage $ Toggle ACCORDION)   , ((0 , xK_c), sendMessage $ Toggle CROSS)   , ((0 , xK_p), sendMessage $ Toggle PST)   , ((0 , xK_t), sendMessage $ Toggle THREE)   ])\n\n\n\nswallow parent while child GUI open这个功能只有0.17才支持，非常适合在terminal中打开图形程序。设置之后，如果在terminal中打开GUI程序，那么terminal会被隐藏直到GUI被关闭。例如用feh打开图片后就不会开一个新的窗口，而是隐藏终端，非常nice\n导入模块\nimport XMonad.Hooks.WindowSwallowing\n\n配置\n, handleEventHook       = swallowEventHook (className =? &quot;XTerm&quot;) (return True) \n\n\n\n\n\n\n\n","categories":["linux"],"tags":["xmonad"]},{"title":"xmonad","url":"/2022/06/19/xmonad/","content":"XMONADWhat is xmonad? It is a window manager which i used for years and it is also my favorite one among tens of WM. Although i have used it so many years, i can not really understand it’s configure language haskell, so do some of features that i like. Recently, when i see a installation guide in official web site, i find something new i have never know and also a solution for every time upgrade system will broken xmonad in archlinux.\nMain point:\n\nwe can put xmonad configure file under ~/.config/xmonad instead of ~/.xmonad.\nwe should not install xmonad and xmonad-contrib via system package manager(pacman).\nwe need download origion file of xmonad and xmonad-contrib from github.\nwe need a tool called stack to manage our xmonad.\n\n\nNote: \n\nwhen we use our system package manager pacman to download xmonad, it will also download many dependences, once some of them upgrade, our xmonad should be recompiled, if not it will broken once restart computer since it builds xmonad with dependences though system dynamic link.\n\nwhen compile xmonad, it needs a tool called ghc. once we use stack, we need create a project, and then it can automatically download ghc, auto download project dependences, auto compile. very useful.\n\n\n\nInstall StackOpen up official website, we can find the full introduction. what i recommend is to download the binary file of stack(manual style).\nuncompress to local path\ntar -xzf stack-2.7.5-linux-x86_64.tar.gz -C ~/.local/share/bin\n\nmake sure the path already added to system path\nChina-based users\nbecause we live in China, we cannot download need file with stack until we do some configuration.\nappend this in ~/.stack/config.yaml\n###ADD THIS IF YOU LIVE IN CHINAsetup-info-locations: - &quot;http://mirrors.tuna.tsinghua.edu.cn/stackage/stack-setup.yaml&quot;urls:  latest-snapshot: http://mirrors.tuna.tsinghua.edu.cn/stackage/snapshots.jsonpackage-indices:  - download-prefix: http://mirrors.tuna.tsinghua.edu.cn/hackage/    hackage-security:        keyids:        - 0a5c7ea47cd1b15f01f5f51a33adda7e655bc0f0b0615baa8e271f4c3351e21d        - 1ea9ba32c526d1cc91ab5e5bd364ec5e9e8cb67179a471872f6e26f0ae773d42        - 280b10153a522681163658cb49f632cde3f38d768b736ddbc901d99a1a772833        - 2a96b1889dc221c17296fcc2bb34b908ca9734376f0f361660200935916ef201        - 2c6c3627bd6c982990239487f1abd02e08a02e6cf16edb105a8012d444d870c3        - 51f0161b906011b52c6613376b1ae937670da69322113a246a09f807c62f6921        - 772e9f4c7db33d251d5c6e357199c819e569d130857dc225549b40845ff0890d        - aa315286e6ad281ad61182235533c41e806e5a787e0b6d1e7eef3f09d137d2e9        - fe331502606802feac15e514d9b9ea83fee8b6ffef71335479a2e68d84adc6b0        key-threshold: 3        ignore-expiry: no\n\nand that is all we need do for installation\nInstall Needed Dependencesin archlinux, we need download below dependences:\nsudo pacman -S \\&gt; git \\&gt; xorg-server xorg-apps xorg-xinit xorg-xmessage \\&gt; libx11 libxft libxinerama libxrandr libxss \\&gt; pkgconf\n\n\n\nInstall Xmonad\ncreate xmonad configure directory and change to it.\n\nmkdir ~/.config/xmonadcd ~/.config/xmonad\n\n\ncopy our configure file to new directory\n\ncp ~/.xmonad/xmonad.hs ~/.config/xmonad\n\n\nfollow this page, download xmonad via git\n\ngit clone https://github.com/xmonad/xmonadgit clone https://github.com/xmonad/xmonad-contrib\n\n\ncreate stack project\n\nstack init\n\nwith this command, stack will create a yaml file to record our xmonad project\n\ninstall everything\n\nstack install\n\nit will auto download ghc, build all required package, copy xmonad executable file to ~/.local/bin\n\nconfigure xmonad to be our window manager\n\n# add this to the end of ~/.xinitrc# exec xmonadexec ~/.cache/xmonad/xmonad-x86_64-linux\n\n\nTips: it is better to exec the cached binary of xmonad (~/.cache/xmonad/xmonad-x86_64-linux) than xmonad itself. because sometimes exec xmonad will lead to recompile xmonad.\n\nStack simple usageghci command\nstack ghci --no-build --no-load\n\nrunhaskell command which used in vscodium\nstack runhaskell\n\nwe can add the two with alias\nnvim ~/.config/zsh/.zshrcalias ghci=&quot;stack ghci --no-build --no-load&quot;alias runhaskell=&quot;stack runhaskell&quot;\n\n\n\nUninstall system xmonadif we use xmonad by pacman in the past, now we can uninstall it.\nuninstall xmonad which is installed by system package manger pacman\nsudo pacman -Rns xmonad xmonad-contrib\n\nuninstall all other haskell package which is installed by system package manager pacman\npacman -Qq |rg haskell |xargs -I &#123;&#125; sudo pacman -Rnsc --noconfirm &#123;&#125;\n\n\n\nAlso change xmobarso it’s recommend to install xmobar with stack.\nfrom this page download xmobar then uncompress to ~/.config/xmobar\n# it already has a yaml file, so just installcd ~/.config/xmobar/xmobar-0.43stack install\n\nmove xmobar executable file to ~/.local/bin\ncp ~/.config/xmobar/xmobar-0.43/.stack-work/install/x86_64-linux-tinfo6/d660e667db171d47e4c3dc93f070ddacfc49d82c6286abced097cd895b8e9705/8.10.7/bin/xmobar ~/.local/bin\n\n\nNote: because xmobar’s yaml file has another version of ghc, so need download ghc8.10, and it compiles much longer than xmonad, also larger size dependences.\n\nUpgrade xmonad &amp; xmonad-contribone more thing is to upgrade xmonad and xmonad-contrib when new version is available.\nthere are two steps:\n\npull the latest version from github\nuse stack to rebuild the new package pulled from github (this step includes recompile xmonad)\n\n\nchange directory to local xmonad git folder and pull new update\ncd ~/.config/xmonad/xmonadgit pullcd ~/.config/xmonad/xmonad-contribgit pull\nbuild new added xmonad &amp; xmonad-contrib libraries (and rebuild xmonad binary)\ncd ~/.config/xmonadstack install\n\nAt lastand now we have an inpendent, clean xmonad.\n","categories":["linux"],"tags":["xmonad"]},{"title":"xp-pentablet","url":"/2022/06/24/xp-pentablet/","content":"XP-PentabletI brought a xp-pentablet almost one year, and i like it very much for daily use instead of mouse. I remember the first time i install it’s driver, i got a problem every time i restart the computer, all of my configuration was gone. I request for Sells client, but they also don’t know how, at last i know it’s just because the default xp-driver not starts in background which they should be in DE, but in my WM, it’s just not working.\nBut if i run the driver program it will turn up a gui app every time i restart computer, i finally find a solution with xvfb by sending it to virtual display. And it goes so far so good.\nHowever today when i try to search how to use pen pressure in normal usage, i find an open source driver which suits for tens of pentablets, and i wanna to have a try.\nopentabletdriverthe main reason i wanna to use this is because it has a system service run in backend, so there is no need for me to send a gui app to virtual display. That sounds better.\nfollow this guide i can install it from AUR.\n# installparu -S opentabletdriver-git# Reload the systemd user unit daemonsystemctl --user daemon-reload# Enable and start the user servicesystemctl --user enable opentabletdriver --now\n\n\nNote: it is a user service\n\nthen in rofi typing opentabletdriver to open it’s gui configure some key bindings\nat last stop using old xp-pentable\n# comment this in xmonad.hs--spawnOnce &quot;startPentablet&quot;\n\n\n\n\nPS: opentabletdriver has lots of drivers, but i find it cannot installed successfully, which makes me a little disappointed.\n\n","categories":["linux"],"tags":["pentablet"]},{"title":"zabbix","url":"/2022/04/23/zabbix/","content":"♥ ZABBIXarchitecture\n server: central component\n database storage: data gathered and configuration stores\n web interface: web UI support\n proxy: optional, load balance support\n agent: install on target machine to gather needed information\n\n\ninstallzabbix can only be installed on specified OS, and the way to install is :\n\nusing commands which can be find in online official website\n\nusing ovf template directly without step to step to configure\n\n\nthe version of 5.4 with centos7 has no server, so we cannot use it. then i choose centos7-5.0LTS-mysql-nginx \ndetail steps:\nNote: \nit is very important to disable selinux and firewalld, or it may meet this error message: “PID file /run/zabbix/zabbix_server.pid not readable (yet?) after start”. and zabbix-server cannot start successfully\n\n\nsecurity setting\n## selinux# temporarysetenforce 0# forevervi /etc/selinux/config SELINUX=disabled## firewalld# disablesystemctl stop firewalldsystemctl disable firewalld# or open some portsudo firewall-cmd --add-port=&#123;10051/tcp,10050/tcp,80/tcp&#125; --permanentsudo firewall-cmd --reload\ninstall repository\n rpm -Uvh https://repo.zabbix.com/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpmyum clean all \ninstall zabbix server and agent\n yum install zabbix-server-mysql zabbix-agent  -y\ninstall zabbix frontend\nyum install centos-release-scl -y\n\nedit /etc/yum.repos.d/zabbix.repo file, change enabled from 0 to 1\nvi /etc/yum.repos.d/zabbix.repo[zabbix-frontend]enabled=1\n\nyum install zabbix-web-mysql-scl zabbix-nginx-conf-scl -y\ninstall mariadb\nyum install mariadb-server -y\n\nsystemctl enable mariadbsystemctl start mariadb\nconfigure mariadb\n-- default no passwordmysql -uroot -p create database zabbix character set utf8 collate utf8_bin;-- specified your own passwdcreate user zabbix@localhost identified by &#x27;123456&#x27;; grant all privileges on zabbix.* to zabbix@localhost;quit;\n\nif we wanna to change zabbix user’s password, follow this steps:\nset password for zabbix@localhost = password(&#x27;123456&#x27;)\n\nimport data to zabbix database， enter the password of zabbix created before\nzcat /usr/share/doc/zabbix-server-mysql*/create.sql.gz | mysql -uzabbix -p zabbix \nconfigure zabbix with the ability of accessing DataBase\nvi /etc/zabbix/zabbix_server.confDBPassWord=123456\nconfigure PHP for zabbix frontend\nvi \t/etc/opt/rh/rh-nginx116/nginx/conf.d/zabbix.conflisten 80;server_name 192.168.31.114vi /etc/opt/rh/rh-php72/php-fpm.d/zabbix.conflisten.acl_users = apache,nginxphp_value[date.timezone] = Asia/Shanghai \nstart zabbix server and agent process\nsystemctl enable zabbix-server zabbix-agent rh-nginx116-nginx rh-php72-php-fpm systemctl restart zabbix-server zabbix-agent rh-nginx116-nginx rh-php72-php-fpm\naccess webpage with database password\nhttp://192.168.31.114# default user name and passwordAdmin/zabbix\n\n\n\n\n\n","categories":["learn"],"tags":["zabbix"]},{"title":"zookeeper","url":"/2022/04/23/zookeeper/","content":"\nzk单机以及集群搭建（基于docker）\n\n单机创建并进入docker创建docker，并将有安装包的主机挂载到docker中\nsystemctl start docker\n\ndocker run -d -it --name zk -v /home/qiyue/Downloads:/home centosdocker exec -it zk /bin/bash\n\n\n\n配置并启动zk在容器中将安装包复制到/opt目录下\ncp /home/jdk-15.0.1 /opt -rcp /home/apache-zookeeper-3.6.2-bin /opt -r\n\n在/etc/profile中添加环境变量\nexport JAVA_HOME=/opt/jdk-15.0.1export ZK_HOME=/opt/apache-zookeeper-3.6.2-binexport CLASSPATH=.:$JAVA_HOME/libexport PATH=$PATH:$JAVA_HOME/bin:$ZK_HOME/bin\n\n使环境变量生效\nsource /etc/profile\n\n创建data和logs文件夹\ncd /opt/apache-zookeeper-3.6.2-bintouch data logs\n\n修改配置文件conf/zoo.cfg\n# 新建zoo.cfgcd confcp zoo_sample.cfg zoo.cfg\n\n# 添加dataDir=/opt/apache-zookeeper-3.6.2-bin/datadataLog=/opt/apache-zookeeper-3.6.2-bin/logsserver.1=172.17.0.2:2888:3888server.2=172.17.0.3:2888:3888server.3=172.17.0.4:2888:3888\n\n# 添加dataDir=/opt/apache-zookeeper-3.6.2-bin/data\n\n启动/查看/停止运行状态\nzkServer.sh startzkServer.sh statuszkServer.sh stop\n\n\n\n\n\n集群创建并进入docker创建docker，并将有安装包的主机挂载到docker中\nsystemctl start docker\n\ndocker run -d -it --name zk1 -v /home/qiyue/Downloads:/home centosdocker run -d -it --name zk2 -v /home/qiyue/Downloads:/home centosdocker run -d -it --name zk3 -v /home/qiyue/Downloads:/home centosdocker exec -it zk1 /bin/bashdocker exec -it zk1 /bin/bashdocker exec -it zk1 /bin/bash\n\n\n\n配置并启动zk在容器中将安装包复制到/opt目录下\ncp /home/jdk-15.0.1 /opt -rcp /home/apache-zookeeper-3.6.2-bin /opt -r\n\n在/etc/profile中添加环境变量\nexport JAVA_HOME=/opt/jdk-15.0.1export ZK_HOME=/opt/apache-zookeeper-3.6.2-binexport CLASSPATH=.:$JAVA_HOME/libexport PATH=$PATH:$JAVA_HOME/bin:$ZK_HOME/bin\n\n使环境变量生效\nsource /etc/profile\n\n创建data和logs文件夹\ncd /opt/apache-zookeeper-3.6.2-bintouch data logs\n\n创建myid文件(不同的容器中写入对应的id)\n# 第一个容器echo 1 &gt; data/myid# 第二个容器echo 2 &gt; data/myid# 第三个容器echo 3 &gt; data/myid\n\n修改配置文件conf/zoo.cfg\n# 新建zoo.cfgcd confcp zoo_sample.cfg zoo.cfg\n\n# 添加dataDir=/opt/apache-zookeeper-3.6.2-bin/datadataLog=/opt/apache-zookeeper-3.6.2-bin/logsserver.1=172.17.0.2:2888:3888server.2=172.17.0.3:2888:3888server.3=172.17.0.4:2888:3888\n\n启动/查看/停止运行状态\nzkServer.sh startzkServer.sh statuszkServer.sh stop\n\n\n\n选举机制与myid的大小和投票数有关：\n\n第一次都只会给自己投票，无法选出leader\n第二次投票myid大的获胜，选出leader\n第三次票数多的获胜，leader依然为leader，后启动的都是follower\n\n错误\nClient port found: 2181. Client address: localhost. Client SSL: false.\n因为myid中写了id和ip，正确的应该只写id\n\n\n使用节点查看节点目录\nls patheg:\tls /# 递归ls -R /\n\n新增节点和数据\n# 新增节点并进行数据关联create /node1 &quot;the fist node&quot;\n\n查看节点数据\nget /node1\n\n修改节点数据\nset /node1 &quot;the master node&quot;\n\n删除节点和数据\ndelete /node1# 如果当前节点下还有子节点deleteall /node1\n\n\n\n\n\n\n\n\n\n\n\n\n\n","categories":["learn"],"tags":["zk"]},{"title":"zsh","url":"/2022/04/23/zsh/","content":"ZSHchange default location.zshrc and .zcompdump location in $HOME directory.  and we can change it to another folder\n# add this to ~/.zprofileexport ZDOTDIR=$HOME/.config/zsh\n\n\nNote:\n.zcompdump file used to speed up the zsh completion\n\nchange oh-my-zsh default locationexport ZSH=$HOME/.config/zsh/.oh-my-zsh\n\n\n\n\n\nauto correctIn archlinux installer, i have ever saw auto correct effect while error typing and it is very helpful, however i cannot find the plugin which has the same effect. Today, i searched and found it finally, you know what? It is even not a plugin but a configuration in .zshrc.\n# uncomment to enable itENABLE_CORRECTION=&quot;true&quot;\n\n\n\nn which means no, don’t correct my command and execute it as it is\ny which means yes, correct my command\na which means abort, don’t execute the command and give me an empty prompt\ne which means edit, don’t execute the command and let me edit it again\n\nauto suggestionoh-my-zsh includes this function. Add zsh-autosuggestions to plugin&#123;&#125; will okay. However, it is much more customizable, we can even define its color.\nplugins=(git    zsh-autosuggestions    )ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE=&quot;fg=#7e749d,bg=#42414d,bold,underline&quot;\n\n\n","categories":["learn"],"tags":["zsh"]},{"title":"人生几多愁","url":"/2022/05/26/%E4%BA%BA%E7%94%9F%E5%87%A0%E5%A4%9A%E6%84%81/","content":"虽然标题看起来很宏伟，但是人生是我无法看破的存在。所以本文就是泛泛而谈，想到什么写什么。\n前一段时间，或者说今年，我都没怎么学习linux相关的东西，最心爱的arch也成为了看电影的工具。我想很大部分原因是这个工作不涉及这些导致的吧。很长一段时间，我都无法开心，因为核酸隔离限制了我的行动自由，我想这是我上学时候绝对想象不到的。那个时候就希望早点毕业，渴求自由，希望没人约束，但是到了社会才发现这是另外一个囚笼，几乎没人可以逃脱，所以我感觉人生被束缚住了，无论多么用力挣扎，和一个国家比起来，微不足道。我也深深体会到了先辈们在历史中的那份迫不得已，谁人不想像李白一样仰天大笑出门去呢？然而如果皇权下令不许，那么这就是一个梦。\n因为这一切，有那么一段时间我特别厌恶这个专制体系，希望可以逃离它。然而许久过去，我发现已经渐渐的少了些许怨愤，添了一份平和。当然这一切只是我的心境变化，环境嘛可以说更糟吧。\n为什么会有这些变化？我想很大一个原因是我一直记得shield中的那句话：真正重要的不是邪恶对我们做了什么，而是我们面对这些事的反馈。人或者社会无论多么邪恶，那是他们的态度，而真正决定我们的是什么呢？如果因为他们的邪恶，我们也同样没有原则的用同样的手段对付他们，那么我们与他们有和差别呢？\n所以我想这就是一段时间心境的一个缩影吧。小时候无忧无虑，十几岁为成绩发愁，大学追求一个女生，进入社会面对另外的困境。每个阶段都有应该要完成的事，并不是每一段时光都那么美好，都值得留恋，然而正是这些经历塑造了不同的我们。所以如果现在的环境特别差，我想说这是一个去磨练我们的机会。当然并不是说我们一定要做出什么对的选择，当然可以选择错误的做法，可以成就一段后悔的记忆。然而我们不要否定它，不要掩盖它，正是它成就了我们。\n今天打算买一本书《月亮与六便士》，看了百科的介绍，突然就特别想买了看，因为它讲述了一个古老的故事，让我有一种看了就会很治愈的感觉。我想生活真的需要这些讲故事的人，体验他们所描绘的人生。如果一个人的生活仅仅是可见的世界，我想那一定很无聊吧，所以为了不无聊，我想看一看。\n当然也是因为买这本书看到了京东上的第一个评论，他说他很爱看书，也拍照显示了他买了很多书，看过很多书。哈哈，我就看了他写的一段评论：”人需要多看书，书中自有黄金屋，书中自有颜如玉……“。然后我就突然了解到了这是一个怎样的人，我很想说他的书真的是白看了。就随随便便的几句话就可以看出一个人的庸俗，如果看书是为了这些的话，我觉得还是别看了，简直是浪费钱。读历史是读人心，读小说是体验人生。他们从来都不是为了给你带来可以炫耀的知识和可以变现的财富。深深体会到王阳明先生所主张的心既是天理，内心纯粹没有一毫私欲才是我们该有的态度。多谢王阳明先生的书，让我可以很轻易的分辨一个人的内心。\n我想起去年的一个老板，他说自己一年要读接近100本书。当时的我从来没有看书的兴趣，觉得太不可思议了。但是如今我却觉得真的没必要读那么多书，读的多有什么用呢，能真正体会到的其实是很少的。就像王阳明的四本书，潦草读一遍能算了解阳明吗？那可是他一生的结晶，我觉得每一个故事，每一段对话都值得好好领悟。同样的爱因斯坦的相对论，薄薄的一本书，但是就是它开启了新的物理时代，多么伟大，潦草读一遍能收获什么呢？我想书中随便一个公式都推导不出来吧。\n人生啊，喜怒哀乐皆具本是正常不过，不必苛责。然而我们时常会走偏，时而会无故低沉，那么这个时候就需要主动给自己添加一些目标指引。\n生活的绚烂不在于多么惊天动地，而在于欣赏和享受每一刻小确信。这顿饭有肉，柴米有盐，下雨有伞，烈日有云，早春有花，盛夏有风，生活有乐，有恼，有悟。都值得被珍视和留恋\n","categories":["think"],"tags":["思绪"]},{"title":"为什么我们都患上了愤怒调节障碍","url":"/2022/05/15/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E9%83%BD%E6%82%A3%E4%B8%8A%E4%BA%86%E6%84%A4%E6%80%92%E8%B0%83%E8%8A%82%E9%9A%9C%E7%A2%8D/","content":"刚毕业那年，武汉发生封城，我当然就是被封的那个，小区设置了门禁，需要检查核酸。被关了半年，头发都可以扎起来了，深刻的感受到了孤独和被抛弃的感觉，然而对待每次的检查，我都是没有任何怨言的，我觉得应该如此，没有太多的想法。\n然而今年的核酸检查，每次都让我感到愤怒、可笑、可悲。\n有一次去小区做核酸，哪里人太多，就打算回家玩会再去，可结果是看大门的一个人拦住了我，不让我过去，然后就是直接暴力的把我往那边推，我说明了原因，但是他说他说了算，他说不让我过我就别想过。顿时我就怒了，因为这种做法直接挑战了我对现在是文明社会的认知，也挑战了我对自由的看法。我真的很想跟他打一架，但是没打起来。哈哈，我记得当时腿就不由自主的抖，我知道那不是害怕，但是我就是控制不住。后来发现仅仅是因为紧张，因为在公开场合我几乎话都没说过，就好像大一参加社团时在台上发言一样，我几乎说不出一句完整的话。尽管我已经告诉自己大丈夫屹立于天地直接，有何可俱。\n还有一次是因为我出去骑公路车回来，也是小区的一个看门的，拦住不让我进去。非要我给什么网格员打电话，我不知道这是什么外星术语，让他给我号码或者什么联系方式，但是他也不给。反正就是不让你过，道理什么的嘛他也不懂。这次真的真的对我影响很大，因为他让我放弃了骑行的梦想和乐趣，前几天把车也卖了。除了愤怒之外，我也深深的感到悲哀，就这样一个素质的社会，还想企及环法，环意自行车赛的边？一个把人最后梦想都扼杀的社会？痴人说梦，即便是道路状况极差，只能在颠簸的人行道上骑，我们仍在继续，仅仅是因为那一份热情。而这也被无情的抹杀，你说现在的年轻人都躺平是为什么呢？因为我们的热情，追求都被抹去，只剩下孤独的灵魂。\n然后就是这怪诞的核酸检测了，之前是一天一次，现在改成三天一次了。我发现渐渐的人们都已经忘记为什么要做核酸检测了，只知道不做你就上不了班，坐不了车，没有行动的自由。如果说这是一个文明社会、尊重科学的社会，会发生这种事情吗？我们都已经麻木不仁了，检测已经成为了呼吸的一部分，尽管我们知道这都是毫无意义的，这不是保护人该做的事，这已经成为一门生意，堂而皇之以一个国家的背书，靠着武力野蛮来施加无可抗拒的压力。这让我可笑，因为国家把科学常常挂在嘴边，而做出的事，毫无科学。\n对于这所有种种事情，我不想全部怪罪于一个国家。因为细数历史，你会发现每个朝代都是这样，由兴盛转向衰亡。个人同样是无法抗拒的，每一个人都属于时代的微不足道的一部分。然而我想说的是，正是王阳明先生提到的，从尧舜到当今，社会是每况愈下。千年前有孔孟，500年前有阳明，而当今谁也没有了。那些被先贤们珍视的文明礼仪、社会良知几乎散尽，作为人被判定为一个人该有的依据已模糊，斯人逐渐沦为禽兽而不自省。即便朝代再次更迭，我想情况并不会改善，因为人心已不在。而决定一个社会前进最为重要的是什么呢？是良知。没有了良知，俄罗斯这样拥有先进核武的国家，也只会沦为屠杀人类的机器。没有了良知，那些管理人员才会显得那么野蛮。\n经常看科幻片的我认为如果人类真的发明了星际穿越的方法，我也觉得目前的人类配不上，因为他们自私没有良知，所过之处只是无尽的灾难罢了。阳明说人心就是良知，需要内心纯粹无一毫私欲。试问有几人做得到呢？如今这可悲的时代。\n除了从本质来解读之外，还想从另一个现实解释这种现象出现的原因：1. 人们之间几乎无交集，属于陌生人范畴。2. 因为戴了口罩，遮住了它的社交信息，真实显露出它的邪恶。想象一下，如果是发生在一个乡村里面，你做出这等散尽天良的事，只怕会被所有人孤立，甚至是报复。\n唉，除了一声长叹，也只剩一句唏嘘。虽然整体社会的良知散失，但是并不代表我也没有，我有王阳明作为导师，足以澄其心。再者说了，不管邪恶做出什么，那是他们做的事，对于我们来说如何回应邪恶才是关键。如果用暴力来还击，那证明我们也只是他们的一部分罢了。\n","categories":["think"],"tags":["良知"]},{"title":"从容","url":"/2022/06/25/%E4%BB%8E%E5%AE%B9/","content":"从容if you wanna smile, just smile. if you wanna cry, just cry. if you wanna run, just run, if you wanna take a break, just break. if we feel bad, just let it go.\n在youtube上看到一个视频，一个约40岁的男人，潦草的头发，一张塑料凳子，一把吉他，坐在泥土地面的道路旁进行弹唱。时而有健身跑步的美女，时而有路过的行人，时而有驶过的马车拖着的自来水瓶。没有人停留，时间在流逝，歌声在蔓延。而这真的让我感到特别舒适，这就是真正的生活。\n今天看另外一个chipmunk视频，是我熟悉的chuncky。女士打开在门外等待的chipmunk，它熟悉的跑到装满食物的bowl，享用这为它准备的美食。这个little girl是有多么开心，作为一个谨慎的动物，它可以拥有这么善良的善待它的人类。我在想，为什么我无法开心，我在追求什么呢？人真的必须要有追求吗？我们真正能追求到的又是什么呢？\n翻看历史，有无数无数被记录的人物，他们能够追求的最多也只是那个时代所能享受到的，无论有多少权利金钱，也无法获得现代的任何高科技产品。所追求权利和金钱，拥有了他们可以享受更多的物质，但也仅此而已。我们和所有其它的生物享受一样的空气，阳光，大地。\n一个chipmunk来到这个世界，它要实现什么人生目标吗？那么人为什么就必须要有呢？我们如此渺小，无法穿越时空，无法进入高维世界，我们和chipmunk一样。所以为什么要让自己的生活存在那么多的不开心呢？\n如果问一个进入社会的人，你追求什么，大多数人会说钱吧。如果你问一个小孩子，那么很难和钱有关。为什么我们的生活单调到只有钱这么一个目标？过去的三年里，我学了无数计算机的东西，可是如今我如果有一丝念头在想学学rust吧，居然有点搞笑，心里会想，what the hell, are you crazy? \nyes，我的生活也很枯燥，上班下班睡觉吃饭+最近热爱的健身。偶尔还会有念头不想锻炼，感觉就是一团糟。为什么无法悠闲的躺着看一下午的天空，为什么没有想法在街头溜达溜达感受这番水土的气息，为什么无法静静的看一会书。为什么总感觉很忙，但是其实发现啥也没做，反而无法从容淡定。\n听着视频的歌声，我想生活本来就没有欢声，没有听众，而是需要我们自己给它谱曲，让它婉转绚烂。而这需要我们的耐心，坚持，从容。\nso，just get a little plan, and try to make our life more regular. let’s dive in.\n","categories":["think"],"tags":["life"]},{"title":"weechat","url":"/2023/02/06/weechat/","content":"WEECHATWeechat is a text-mode IRC client, we can talk to people through channel and people where they come from the whole world, it is amazing!\nA few years ago, i have used weechat, and now i want to use it again. But i almost forget how to use it, so this article is mainly focus on how to get things done.\ninstall weechat in gentoo   user$ doas emerge --ask net-irc/weechat \n\nbasic configure weechatWith the following steps, we can simply configure weechat, and join some channels.\n\nstart weechat\nuser$ weechat\nadd irc server \n/server add libera irc.libera.chat/6697 -ssl\nset nickname\n/set irc.server.libera.nicks &quot;shutterbug&quot;\n\n\nNote: \nAfter this step, we can connect to libera server and join free channel.\nNext time we start weechat, we only need to follow steps showing below.\n\n\nconnect to server\n/connect libera\njoin channel\n/join #gentoo\n\nregistering account on the Libera.Chat IRC networkIf we only do the configuration above, we may failed to join some channel such as #archlinux-aur, cause it needs a registered NickServ account logged in.\n\nSo we need to register an account on Libra.Chat, it can be done through command(make sure we connect to libera server and then type the command).\n/msg nickserv register [password] [email]\n\n\nNote:\npassword is the one we need to remember for the next time to login account\nemail should be a in use email account, cause we will receive an email include the information about how to finish the register process.\n\nNow we need to open our email web or app to open the new email which is sent from Libera.Chat Network Services, find the command which tell us how to run this in weechat, we need to copy this command and run in weechat to finish register.\n\nRun this in weechat, this command is random, so don’t use this one next time.\n/msg NickServ VERIFY REGISTER shutterbug 3kKcJyDVgG5aCdna\n\n\nNow we get a registered NickServ account, we can join #archlinux-aur channel, before join, we need to vertify.\n/msg nickserv identify [password]\n\nAnd we are allowed to join.\n/join #archlinux-aur\n\n\nenable auto connectAlthough we can connect to libera server by hand, there is a convenient way to auto connect.\n/set irc.server.libera.autoconnect on\n\nYeah, there is also a way to auto join channels, but so far, i don’t like to auto join channel, may be in the future i will use this.\n/set irc.server.libera.autojoin &quot;#gentoo,#gentoo-chat&quot;\n\nTips:\nWe can type command in every channel, the weechat will recognize it as command but not sending message. So no need to worry about where to type command.\n\n","categories":["linux"],"tags":["weechat"]}]