<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="shutterbug">
    
    <title>
        
            go |
        
        Sweet Diary
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"raw.githubusercontent.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/4.jpg","description":"the world you see is not about how they act but how we respond."},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":false,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Sweet Diary
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">go</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">shutterbug</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        .article-meta-info {
  font-size: 0.8rem;
  color: var(--third-text-color);

  .article-meta-item {
    margin-right: 10px;

    &:last-child {
      margin-right: 0;
    }
  }

  .article-date {

    .mobile {
      display: none;
    }

    +keep-tablet() {
      .pc {
        display: none;
      }

      .mobile {
        display: inline;
      }
    }

  }


  .article-tags, .article-categories {
    display: inline;

    ul, li {
      display: inline;
    }

    a {
      color: var(--third-text-color);

      &:hover {
        color: var(--primary-color);
      }
    }
  }

  .article-tags {
    +keep-tablet() {
      display: none;
    }
  }

  .article-min2read, .article-wordcount {
    +keep-mobile() {
      display: none;
    }
  }
}

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="GO"><a href="#GO" class="headerlink" title="GO"></a>GO</h1><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><p>follow <a target="_blank" rel="noopener" href="https://golang.org/doc/install">this document</a>, download compressed file and extract to the place where application stores.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">i install go <span class="keyword">in</span> .<span class="built_in">local</span>/apps.</span></span><br><span class="line">tar -xzf Downloads/go1.16.3.linux-amd64.tar.gz -C .local/apps</span><br></pre></td></tr></table></figure>

<p>configure go env</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">add to /etc/profile or ~/.zshrc. i put it <span class="keyword">in</span> .xinitrc</span></span><br><span class="line">export PATH=$PATH:/home/blueocean/.local/apps/go/bin</span><br></pre></td></tr></table></figure>

<p>after source configure file we can check whether it makes effect</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go env</span><br></pre></td></tr></table></figure>

<h2 id="config-workspace"><a href="#config-workspace" class="headerlink" title="config workspace"></a>config workspace</h2><p><code>GOPATH</code> is the place of our workspace which can be find by running <code>go env</code>, we can change it by running</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go env -w GOPATH=&quot;$HOME/Public/code/go&quot;</span><br></pre></td></tr></table></figure>

<p>the command will write go environment variable to <code>~/.config/go/env</code> file.</p>
<p>below is the standard workspace structure</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Public/code/go</span><br><span class="line">├── bin</span><br><span class="line">├── pkg</span><br><span class="line">└── src</span><br><span class="line">    └── github.com</span><br><span class="line">        └── blueocean</span><br><span class="line">            └── go_project_1</span><br><span class="line">                └── helloworld</span><br><span class="line">                    └── main.go</span><br></pre></td></tr></table></figure>

<ul>
<li>bin: compiled file stores, when we run <code>go install xx.go</code> will create binary file to the folder</li>
<li>pkg: other people package, the package/module we download will store in the folder</li>
<li>src: source code file, the place we write go code</li>
</ul>
<p>why there are github.com/username? it is useful when we work in a team. the folder name is the same as github.</p>
<h2 id="vscode-go-plugin"><a href="#vscode-go-plugin" class="headerlink" title="vscode go plugin"></a>vscode go plugin</h2><p>i will write code with vscode editor, first install <code>go</code> extension. then when we write go code, there will be a prompt suggests us to install other extensions. and just click install all. however it may failed because we can not access github file in our country.</p>
<p>but there comes a method can resolve this problem with proxy. <code>goproxy.io</code> is a proxy of go</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go env -w GO111MODULE=on</span><br><span class="line">go env -w GOPROXY=https://goproxy.io,direct</span><br></pre></td></tr></table></figure>

<p>then reinstall all will be fine</p>
<blockquote>
<p>Note:</p>
<p>while install go plugin, there comes a error message: <strong>Writing login information to the keychain failed with error ‘The name org.freedesktop.secrets was not provided by any .service files’.</strong></p>
<p><a target="_blank" rel="noopener" href="https://github.com/MicrosoftDocs/live-share/issues/224">resolve method:</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S gnome-keyring libsecret</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="run-or-compile-file"><a href="#run-or-compile-file" class="headerlink" title="run or compile file"></a>run or compile file</h2><p>though go is a compile language, go tools allow us to run code without compile. we can just type</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run go_file.go</span><br></pre></td></tr></table></figure>

<p>if we wanna to compile it to binary file</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">this will product a binary file <span class="keyword">in</span> current location</span></span><br><span class="line">go build go_file.go</span><br></pre></td></tr></table></figure>

<p>we can also compile file with <code>go install</code>, and it will put binary file to bin directory</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go install go_file.go</span><br></pre></td></tr></table></figure>

<h2 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;hello world!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>we need to know that in an application there are many go files and each of them need to belong to a package. the name of package can be customized, however there must to be a package name main for progarm will start running with this file. and there must be a function named main for program will start running with main function.</p>
<p>we can import other packages by keyword <code>import</code>. neither build in packages or download from internet with <code>go get</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;math&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// or use parenthense</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;math&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="naming-rule"><a href="#naming-rule" class="headerlink" title="naming rule"></a>naming rule</h2><p><strong>in Go, a name is exported if it begins with a capital letter.</strong></p>
<ul>
<li>function name and variable always begins with lowercase。</li>
<li>except the package need to be imported by other packages as a module, then function name begin with capital letter</li>
</ul>
<h2 id="constan"><a href="#constan" class="headerlink" title="constan"></a>constan</h2><p>the value that can not be changed is called constan. we can define it by <code>const</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;john&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="variables"><a href="#variables" class="headerlink" title="variables"></a>variables</h2><p>as we know go is a compile language, we need to define a variable before we use it.</p>
<p>there are two principles we need follow:</p>
<ol>
<li>define a variable before we use it.</li>
<li>every defined variable need to be used</li>
</ol>
<p>there are three ways to define a variable:</p>
<ol>
<li><p>use var keyword</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> variable_name <span class="keyword">type</span></span><br></pre></td></tr></table></figure>

<p>eg:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name <span class="type">string</span></span><br><span class="line"><span class="keyword">var</span> age <span class="type">int</span></span><br><span class="line"><span class="keyword">var</span> high <span class="type">float32</span></span><br><span class="line"><span class="keyword">var</span> ptr *<span class="type">int</span></span><br></pre></td></tr></table></figure></li>
<li><p>initialize without type</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> variable_name = value</span><br></pre></td></tr></table></figure>

<p>eg:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&quot;Azon&quot;</span></span><br><span class="line"><span class="keyword">var</span> age = <span class="number">12</span></span><br><span class="line"><span class="keyword">var</span> ptr = &amp;age</span><br></pre></td></tr></table></figure></li>
<li><p>inside function use short sign</p>
<blockquote>
<p>Note:</p>
<p>this method can only used inside function</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variable_name := value</span><br></pre></td></tr></table></figure>

<p>eg:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name := <span class="string">&quot;Azon&quot;</span></span><br><span class="line">age := <span class="number">12</span></span><br><span class="line">ptr = &amp;age</span><br></pre></td></tr></table></figure></li>
</ol>
<p>define same type variables in one line</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name, age <span class="type">int</span></span><br></pre></td></tr></table></figure>

<p>define serveral variables with parentheses</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    name <span class="type">string</span></span><br><span class="line">    age <span class="type">int</span></span><br><span class="line">    ptr *<span class="type">int</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">// or sign value</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    name = <span class="string">&quot;Azon&quot;</span></span><br><span class="line">    age = <span class="number">12</span></span><br><span class="line">    ptr = &amp;age</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>note:</p>
<p>​    second and third used often. and third can only be used in function</p>
</blockquote>
<h2 id="basic-type"><a href="#basic-type" class="headerlink" title="basic type"></a>basic type</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span></span><br><span class="line"></span><br><span class="line"><span class="type">string</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span>  <span class="type">int8</span>  <span class="type">int16</span>  <span class="type">int32</span>  <span class="type">int64</span></span><br><span class="line"><span class="type">uint</span> <span class="type">uint8</span> <span class="type">uint16</span> <span class="type">uint32</span> <span class="type">uint64</span> <span class="type">uintptr</span></span><br><span class="line"></span><br><span class="line"><span class="type">byte</span> <span class="comment">// alias for uint8</span></span><br><span class="line"></span><br><span class="line"><span class="type">rune</span> <span class="comment">// alias for int32</span></span><br><span class="line">     <span class="comment">// represents a Unicode code point</span></span><br><span class="line"></span><br><span class="line"><span class="type">float32</span> <span class="type">float64</span></span><br><span class="line"></span><br><span class="line"><span class="type">complex64</span> <span class="type">complex128</span></span><br></pre></td></tr></table></figure>

<h2 id="array"><a href="#array" class="headerlink" title="array"></a>array</h2><p>the length of array is part of array’s type. and the size can not be changed</p>
<p><strong>define array with fixed size</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> array_name [length]<span class="keyword">type</span></span><br></pre></td></tr></table></figure>

<p><strong>define array with values</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> array_name = [length]<span class="keyword">type</span> &#123;value1, value2...&#125;</span><br><span class="line"><span class="comment">// or use `...`, in this way the length of array is the initial length of value elements. it may common to use</span></span><br><span class="line"><span class="keyword">var</span> array_name = [...]<span class="keyword">type</span>&#123;v1,v2,v3,v4&#125;</span><br></pre></td></tr></table></figure>

<p><strong>use short syntax</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_name := [length]<span class="keyword">type</span> &#123;value1, value2...&#125;</span><br></pre></td></tr></table></figure>

<p><strong>change array value</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nums := [<span class="number">2</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">nums[<span class="number">0</span>] = <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><strong>array index</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr[<span class="number">0</span>] <span class="comment">//first</span></span><br><span class="line">arr[<span class="built_in">len</span>(arr)<span class="number">-1</span>] <span class="comment">//last</span></span><br></pre></td></tr></table></figure>

<p><strong>two ways to loop array value</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    dataJson := [...]<span class="type">string</span>&#123;<span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>&#125;</span><br><span class="line">    <span class="comment">// range</span></span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> dataJson &#123;</span><br><span class="line">        fmt.Println(v)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// index</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(dataJson); i++ &#123;</span><br><span class="line">        fmt.Println(dataJson[i])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>compare two arrays</strong></p>
<p>if the element type of the array is comparable, then the array type is also compartable</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    arr1 := [...]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">    arr2 := [<span class="number">3</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">    fmt.Println(arr1 == arr2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h2><p>slice is the reference of array, it doesn’t store any data but the describe of data. </p>
<ul>
<li>no specified size</li>
<li>change slice will change array which slice describes</li>
</ul>
<p><strong>define array with changeable length</strong></p>
<p>slice <code>[]type&#123;v1,v2,v3&#125;</code> truely creates an array <code>[3]type&#123;v1,v2,v3&#125;</code> and then builds a slice that references it</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> slice_name = []<span class="keyword">type</span>&#123;value1, value2...&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">slice_name := []<span class="keyword">type</span>&#123;value1, value2...&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// use pointer</span></span><br><span class="line">slice_name := &amp;[]<span class="keyword">type</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// specified with exist array</span></span><br><span class="line"><span class="keyword">var</span> array_name = [<span class="number">3</span>]<span class="type">int</span>&#123;v1,v2,v3&#125;</span><br><span class="line">slice_name1 := array_name[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">slice_name2 := array_name[:]</span><br><span class="line">slice_name3 := array_name[<span class="number">0</span>:]</span><br><span class="line">slice_name4 := array_name[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// use make to create slice</span></span><br><span class="line">slice_name := <span class="built_in">make</span>([]<span class="keyword">type</span>, len_of_array, cap_of_array)</span><br><span class="line"><span class="comment">// eg:</span></span><br><span class="line">num := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">0</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> num = [<span class="number">4</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line">    a := num[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">    a[<span class="number">0</span>] = <span class="number">8</span></span><br><span class="line">    fmt.Println(num)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//[8 2 3 4]</span></span><br></pre></td></tr></table></figure>

<p><strong>add value to changeable length array</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nums := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">nums = <span class="built_in">append</span>(nums, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p><strong>slice has length and capacity</strong></p>
<ul>
<li><p>The length of a slice is the number of elements it contains.  </p>
</li>
<li><p>The capacity of a slice is the number of elements in the underlying array,     counting from the first element in the slice.  </p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">num := sum[:<span class="number">0</span>]</span><br><span class="line">fmt.Println(<span class="built_in">len</span>(num), <span class="built_in">cap</span>(num))</span><br></pre></td></tr></table></figure>

<p><strong>slice of slice</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    nums := [][]<span class="type">int</span>&#123;</span><br><span class="line">        []<span class="type">int</span>&#123;&#125;,</span><br><span class="line">        []<span class="type">int</span>&#123;&#125;,</span><br><span class="line">        []<span class="type">int</span>&#123;&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(nums)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [[] [] []]</span></span><br></pre></td></tr></table></figure>

<h2 id="nil"><a href="#nil" class="headerlink" title="nil"></a>nil</h2><p>The <strong>zero value</strong> of a slice is <code>nil</code>.  </p>
<p>A nil slice has a <strong>length</strong> and <strong>capacity</strong> of <strong>0</strong>  and has <strong>no underlying array.</strong>  </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> num []<span class="type">int</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(num, <span class="built_in">len</span>(num), <span class="built_in">cap</span>(num))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="range"><a href="#range" class="headerlink" title="range"></a>range</h2><p><code>_</code> used to ignore some value</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    nums := [][]<span class="type">int</span>&#123;</span><br><span class="line">        []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;,</span><br><span class="line">        []<span class="type">int</span>&#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;,</span><br><span class="line">        []<span class="type">int</span>&#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(nums)</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> nums &#123;</span><br><span class="line">        fmt.Println(v)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define syntax</span></span><br><span class="line"><span class="keyword">var</span> map_name = <span class="built_in">make</span>(<span class="keyword">map</span>[key_type]value_type)</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> student = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>)</span><br><span class="line">student[<span class="string">&quot;xiaozhan&quot;</span>] = <span class="number">23</span></span><br><span class="line">student[<span class="string">&quot;xiaoli&quot;</span>] = <span class="number">22</span></span><br><span class="line">fmt.Println(student, student[<span class="string">&quot;xiaozhan&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// without define</span></span><br><span class="line"><span class="keyword">var</span> student = <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>&#123;</span><br><span class="line">    <span class="string">&quot;xiaozhan&quot;</span>: <span class="number">23</span>,</span><br><span class="line">    <span class="string">&quot;xiaoli&quot;</span>:   <span class="number">22</span>,</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(student, student[<span class="string">&quot;xiaozhan&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>however the way map most useful is combining with struct</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> People <span class="keyword">struct</span> &#123;</span><br><span class="line">    name      <span class="type">string</span></span><br><span class="line">    age       <span class="type">int</span></span><br><span class="line">    graduate  <span class="type">bool</span></span><br><span class="line">    email     <span class="type">string</span></span><br><span class="line">    address   <span class="type">string</span></span><br><span class="line">    telephone <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> student = <span class="keyword">map</span>[<span class="type">int</span>]People&#123;</span><br><span class="line">        <span class="number">1</span>: &#123;<span class="string">&quot;xiaozhan&quot;</span>, <span class="number">12</span>, <span class="literal">true</span>, <span class="string">&quot;129381@qq.com&quot;</span>, <span class="string">&quot;China&quot;</span>, <span class="string">&quot;1337649393&quot;</span>&#125;,</span><br><span class="line">        <span class="number">2</span>: &#123;<span class="string">&quot;johnsemi&quot;</span>, <span class="number">23</span>, <span class="literal">false</span>, <span class="string">&quot;johnsemi@gmail.com&quot;</span>, <span class="string">&quot;American&quot;</span>, <span class="string">&quot;98234222&quot;</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// update value</span></span><br><span class="line">    student[<span class="number">1</span>] = People&#123;<span class="string">&quot;xiaozhan&quot;</span>, <span class="number">18</span>, <span class="literal">true</span>, <span class="string">&quot;129381@qq.com&quot;</span>, <span class="string">&quot;China&quot;</span>, <span class="string">&quot;1337649393&quot;</span>&#125;</span><br><span class="line">    fmt.Println(student[<span class="number">1</span>].age)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// delete element</span></span><br><span class="line">    <span class="built_in">delete</span>(student,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check whether key exist</span></span><br><span class="line">    _, exist := student[<span class="number">2</span>]</span><br><span class="line">    fmt.Println(exist)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note: </p>
<p>can’t change values associated with keys in a map, only if we use pointer</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> People <span class="keyword">struct</span> &#123;</span><br><span class="line">    name      <span class="type">string</span></span><br><span class="line">    age       <span class="type">int</span></span><br><span class="line">    graduate  <span class="type">bool</span></span><br><span class="line">    email     <span class="type">string</span></span><br><span class="line">    address   <span class="type">string</span></span><br><span class="line">    telephone <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> student = <span class="keyword">map</span>[<span class="type">int</span>]*People&#123;</span><br><span class="line">        <span class="number">1</span>: &#123;<span class="string">&quot;xiaozhan&quot;</span>, <span class="number">12</span>, <span class="literal">true</span>, <span class="string">&quot;129381@qq.com&quot;</span>, <span class="string">&quot;China&quot;</span>, <span class="string">&quot;1337649393&quot;</span>&#125;,</span><br><span class="line">        <span class="number">2</span>: &#123;<span class="string">&quot;johnsemi&quot;</span>, <span class="number">23</span>, <span class="literal">false</span>, <span class="string">&quot;johnsemi@gmail.com&quot;</span>, <span class="string">&quot;American&quot;</span>, <span class="string">&quot;98234222&quot;</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    student[<span class="number">1</span>] = &amp;People&#123;<span class="string">&quot;xiaozhan&quot;</span>, <span class="number">18</span>, <span class="literal">true</span>, <span class="string">&quot;129381@qq.com&quot;</span>, <span class="string">&quot;China&quot;</span>, <span class="string">&quot;1337649393&quot;</span>&#125;</span><br><span class="line">    student[<span class="number">1</span>].age = <span class="number">22</span></span><br><span class="line">    fmt.Println(student[<span class="number">1</span>].age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="struct"><a href="#struct" class="headerlink" title="struct"></a>struct</h2><p>A <code>struct</code> is a collection of fields.  </p>
<ul>
<li>Struct fields are accessed using a dot.</li>
<li>Struct fields can be accessed through a struct pointer.  and has a short write <code>(*p).x</code> with <code>p.x</code></li>
<li>Struct literal  used to make new data field</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> People <span class="keyword">struct</span> &#123;</span><br><span class="line">    name  <span class="type">string</span></span><br><span class="line">    age   <span class="type">int</span></span><br><span class="line">    email <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    no1 := People&#123;<span class="string">&quot;xiaoming&quot;</span>, <span class="number">12</span>, <span class="string">&quot;823739@qq.com&quot;</span>&#125;</span><br><span class="line">    no2 := People&#123;name: <span class="string">&quot;xiaozhan&quot;</span>, age: <span class="number">13</span>&#125;</span><br><span class="line">    no3 := &amp;People&#123;age: <span class="number">12</span>&#125;</span><br><span class="line">    fmt.Println(no1, no1.age+no2.age, no3.age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="for-loop"><a href="#for-loop" class="headerlink" title="for loop"></a>for loop</h2><p>in golang, there is no while loop, however for loop can do the same thing as while.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// infinite loop</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for each</span></span><br><span class="line"><span class="keyword">for</span> i,v := <span class="keyword">range</span> xxx &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// break or continue</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ...... &#123;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="basic-function"><a href="#basic-function" class="headerlink" title="basic function"></a>basic function</h2><p>the way to define function with keyword <code>func</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">func_name</span><span class="params">(arg <span class="keyword">type</span>)</span></span> return_type &#123;</span><br><span class="line">    <span class="comment">//function content</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// more than one return value use `()`</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">func_name</span><span class="params">(arg1 <span class="keyword">type</span>, arg2 <span class="keyword">type</span>)</span></span> (return_type, return_type) &#123;</span><br><span class="line">    <span class="comment">//function content</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// named return</span></span><br><span class="line"><span class="comment">// combine same type</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">func_name</span><span class="params">(arg1, arg2 <span class="keyword">type</span>)</span></span> (x,y return_type) &#123;</span><br><span class="line">    x = xxx</span><br><span class="line">    y = xxx</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>eg:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reverse</span><span class="params">(a, b <span class="type">string</span>)</span></span> (<span class="type">string</span>, <span class="type">string</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> b, a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">minormax</span><span class="params">(a, b <span class="type">int</span>)</span></span> (max1, min1 <span class="type">int</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> max, min <span class="type">int</span></span><br><span class="line">    <span class="keyword">if</span> a &gt; <span class="number">0</span> &amp;&amp; b &gt; <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> a &gt; b &#123;</span><br><span class="line">            max = a</span><br><span class="line">            min = b</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            max = b</span><br><span class="line">            min = a</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> i := min; i &gt; <span class="number">1</span>; i-- &#123;</span><br><span class="line">            <span class="keyword">if</span> max%i == <span class="number">0</span> &amp;&amp; min%i == <span class="number">0</span> &#123;</span><br><span class="line">                max1 = i</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> i := max; i &gt; <span class="number">0</span>; i++ &#123;</span><br><span class="line">            <span class="keyword">if</span> i%max == <span class="number">0</span> &amp;&amp; i%min == <span class="number">0</span> &#123;</span><br><span class="line">                min1 = i</span><br><span class="line">                <span class="comment">// add break here or it cannot stop</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a := sum(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">    b, c := reverse(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>)</span><br><span class="line">    d, e := minormax(<span class="number">8</span>, <span class="number">10</span>)</span><br><span class="line">    fmt.Println(a, <span class="string">&quot;\t&quot;</span>, b, c, <span class="string">&quot;\t&quot;</span>, d, e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="usage"><a href="#usage" class="headerlink" title="... usage"></a><code>...</code> usage</h2><p>two ways:</p>
<ul>
<li>pass <code>...</code> before function input type: this way can let function accept values which the number we are not sure</li>
<li>pass <code>...</code> after array/slice: this way can parse them out of array/slice without <code>for</code> loop</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pass ... to function type</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sum</span><span class="params">(a ...<span class="type">float32</span>)</span></span> <span class="type">float32</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> sum <span class="type">float32</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> a &#123;</span><br><span class="line">        sum = sum + v</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(Sum(<span class="number">56</span>, <span class="number">78</span>, <span class="number">60.5</span>, <span class="number">89.5</span>, <span class="number">93</span>, <span class="number">76</span>))</span><br><span class="line">    <span class="comment">// or </span></span><br><span class="line">    <span class="comment">// fmt.Println(Sum(score...))</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pass ... to array/slice</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    score := []<span class="type">float32</span>&#123;<span class="number">56</span>, <span class="number">78</span>, <span class="number">60.5</span>, <span class="number">89.5</span>, <span class="number">93</span>, <span class="number">76</span>&#125;</span><br><span class="line">    <span class="keyword">var</span> array = []<span class="type">float32</span>&#123;&#125;</span><br><span class="line">    array = <span class="built_in">append</span>(array, score...)</span><br><span class="line">    fmt.Println(array)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="function-value"><a href="#function-value" class="headerlink" title="function value"></a>function value</h2><ul>
<li>Functions are values too. They can be passed around just like other values.  </li>
<li>Function values may be used as function arguments and return values.  </li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">plu</span><span class="params">(fn1 <span class="keyword">func</span>(<span class="type">float32</span>, <span class="type">float32</span>)</span></span> <span class="type">float32</span>, fn2 <span class="function"><span class="keyword">func</span><span class="params">(<span class="type">float32</span>, <span class="type">float32</span>)</span></span> <span class="type">float32</span>) <span class="type">float32</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fn1(<span class="number">2</span>, <span class="number">3</span>) * fn2(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a := <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">float32</span>)</span></span> <span class="type">float32</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x + y</span><br><span class="line">    &#125;</span><br><span class="line">    b := <span class="function"><span class="keyword">func</span><span class="params">(x, y <span class="type">float32</span>)</span></span> <span class="type">float32</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x - y</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    c := plu(a, b)</span><br><span class="line">    fmt.Println(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="example"><a href="#example" class="headerlink" title="example"></a>example</h2><h5 id="initialize-struct-data-with-functions-and-return-a-struct-data-type"><a href="#initialize-struct-data-with-functions-and-return-a-struct-data-type" class="headerlink" title="initialize struct data with functions and return a struct data type."></a>initialize struct data with functions and return a struct data type.</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// define a struct type</span></span><br><span class="line"><span class="keyword">type</span> people <span class="keyword">struct</span> &#123;</span><br><span class="line">    name <span class="type">string</span></span><br><span class="line">    age  <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// initialize struct with function and return a struct</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">who</span><span class="params">(name <span class="type">string</span>, age <span class="type">int</span>)</span></span> *people &#123;</span><br><span class="line">    people := &amp;people&#123;</span><br><span class="line">        name: name,</span><br><span class="line">        age:  age,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> people</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// function to get struct data</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p people)</span></span> getName() <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> p.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// used like this: method().method()</span></span><br><span class="line">    res := who(<span class="string">&quot;libai&quot;</span>, <span class="number">12</span>).getName()</span><br><span class="line">    fmt.Println(res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="read-from-file-and-write-file"><a href="#read-from-file-and-write-file" class="headerlink" title="read from file and write file"></a>read from file and write file</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;log&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// read content form ori and write to filePath file</span></span><br><span class="line">    <span class="keyword">var</span> filePath <span class="type">string</span> = <span class="string">&quot;/mnt/c/Users/qiyue/Desktop/test.txt&quot;</span></span><br><span class="line">    <span class="keyword">var</span> ori <span class="type">string</span> = <span class="string">&quot;/mnt/c/Users/qiyue/Desktop/go.md&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// open write file</span></span><br><span class="line">    new_file, err := os.OpenFile(filePath, os.O_WRONLY|os.O_TRUNC, <span class="number">0777</span>)</span><br><span class="line">    <span class="keyword">defer</span> new_file.Close()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatal(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// open content file</span></span><br><span class="line">    ori_file, err := os.ReadFile(ori)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatal(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// write content</span></span><br><span class="line">    <span class="keyword">if</span> _, err := new_file.Write(ori_file); err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatal(err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="methods"><a href="#methods" class="headerlink" title="methods"></a>methods</h2><p>Go does not have classes. However, you can define methods on types.  </p>
<ul>
<li>A method is a function with a special <em>receiver</em> argument.  </li>
<li>The receiver appears in its own argument list between the <code>func</code> keyword and  the method name.</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// method with struct</span></span><br><span class="line"><span class="keyword">type</span> type_name <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v type_name)</span></span> func_name() return_type &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// use method</span></span><br><span class="line">v := type_name&#123;&#125;</span><br><span class="line">v.func_name()</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// method with none-struct type</span></span><br><span class="line"><span class="keyword">type</span> type_name value_type</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v type_name)</span></span> func_name() return_type&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// use method</span></span><br><span class="line">v := type_name()</span><br><span class="line">v.func_name()</span><br></pre></td></tr></table></figure>

<p><strong>pointer receiver</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// with pointer receiver, we can change struct data self</span></span><br><span class="line"><span class="keyword">type</span> type_name <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v *type_name)</span></span> func_name() return_type&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// change struct data with function</span></span><br><span class="line">v := type_name&#123;&#125;</span><br><span class="line">v.func_name()</span><br></pre></td></tr></table></figure>

<p>method with pointer receiver can be called either a value or a pointer</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// method with pointer receiver</span></span><br><span class="line"><span class="keyword">type</span> type_name <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v *type_name)</span></span> func_name() return_type&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// called by value</span></span><br><span class="line">v := type_name&#123;&#125;</span><br><span class="line">v.func_name()</span><br><span class="line"><span class="comment">// callled by pointer</span></span><br><span class="line">v := &amp;type_name&#123;&#125;</span><br><span class="line">v.func_name()</span><br></pre></td></tr></table></figure>

<p>method with value receiver can be called either a value or a pointer</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// normal value receiver</span></span><br><span class="line"><span class="keyword">type</span> type_name <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v type_name)</span></span> func_name() return_type &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// can be call with value or pointer</span></span><br><span class="line">v1 := type_name&#123;&#125;</span><br><span class="line">v1.func_name()</span><br><span class="line"></span><br><span class="line">v2 := &amp;type_name&#123;&#125;</span><br><span class="line">v2.func_name()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<pre><code>1. even though both can work fine, however only pointer receiver has the capacity to change struct data itself
2. pointer receiver don&#39;t copy data struct, which can minimize memory usage
</code></pre>
</blockquote>
<h2 id="interfaces"><a href="#interfaces" class="headerlink" title="interfaces"></a>interfaces</h2><p><strong>An <em>interface type</em> is defined as a set of method signatures.</strong>  </p>
<ul>
<li>A value of interface type can hold any value that implements those methods.  </li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Cal <span class="keyword">interface</span> &#123;</span><br><span class="line">    Abs() <span class="type">float32</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Sum <span class="keyword">struct</span> &#123;</span><br><span class="line">    a, b <span class="type">float32</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// function of sum implement Cal interface</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Sum)</span></span> Abs() <span class="type">float32</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">float32</span>(s.a + s.b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Div <span class="keyword">struct</span> &#123;</span><br><span class="line">    a, b <span class="type">float32</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// function of div implement Cal interface</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *Div)</span></span> Abs() <span class="type">float32</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">float32</span>(d.a / d.b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// apply any value to interface variable which has implemented interface methods</span></span><br><span class="line">    <span class="keyword">var</span> a Cal</span><br><span class="line">    a = &amp;Sum&#123;<span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">    fmt.Println(a.Abs())</span><br><span class="line">    a = &amp;Div&#123;<span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">    fmt.Println(a.Abs())</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//5</span></span><br><span class="line"><span class="comment">//0.6666667</span></span><br></pre></td></tr></table></figure>

<p><strong>The interface type that specifies zero methods is known as the <em>empty interface</em></strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>An empty interface may hold values of any type.     (Every type implements at least zero methods.)  </p>
</li>
<li><p>Empty interfaces are used by code that handles values of unknown type.     For example, <code>fmt.Print</code> takes any number of arguments of type <code>interface&#123;&#125;</code>.  </p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// empty interface `interface&#123;&#125;` as a value type</span></span><br><span class="line">    <span class="keyword">var</span> num <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">    num = <span class="number">5</span></span><br><span class="line">    fmt.Println(num)</span><br><span class="line">    num = <span class="string">&quot;justin&quot;</span></span><br><span class="line">    fmt.Println(num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>type assertions</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define a variable of empty interface</span></span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">i = <span class="string">&quot;hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use i.(type) to check the type of i is true. ok&#x27;s value is true || false</span></span><br><span class="line">_,ok := i.(<span class="keyword">type</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// eg :</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> i <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">    i = <span class="string">&quot;hello&quot;</span></span><br><span class="line">    _, ok := i.(<span class="type">int</span>)</span><br><span class="line">    fmt.Println(ok)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//false</span></span><br></pre></td></tr></table></figure>

<p><strong>type switch</strong></p>
<p>use type assertions with <code>switch case</code> to ignore value’s type or deal value with different types.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">do</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> t := i.(<span class="keyword">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">int</span>:</span><br><span class="line">        fmt.Println(t * <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">string</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;words:&quot;</span>, t)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;noknown type !&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    do(<span class="number">20</span>)</span><br><span class="line">    do(<span class="string">&quot;hello world&quot;</span>)</span><br><span class="line">    do(<span class="number">12.232</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Stringer <span class="keyword">interface</span> &#123;</span><br><span class="line">    String() <span class="type">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>fmt</code> package will look for Stringer interface to print values by default. it is be defined in <code>fmt</code> package</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Exercise: Stringer</span></span><br><span class="line"><span class="comment">// Make the IPAddr type implement fmt.Stringer to print the address as a dotted quad.</span></span><br><span class="line"><span class="comment">// For instance, IPAddr&#123;1, 2, 3, 4&#125; should print as &quot;1.2.3.4&quot;. </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> IPAddr [<span class="number">4</span>]<span class="type">byte</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hosts = <span class="keyword">map</span>[<span class="type">string</span>]IPAddr&#123;</span><br><span class="line">    <span class="string">&quot;loopback&quot;</span>:  &#123;<span class="number">127</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">    <span class="string">&quot;googledns&quot;</span>: &#123;<span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ip IPAddr)</span></span> String() <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%v.%v.%v.%v&quot;</span>, ip[<span class="number">0</span>], ip[<span class="number">1</span>], ip[<span class="number">2</span>], ip[<span class="number">3</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> name, ip := <span class="keyword">range</span> hosts &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;%v:\t%v\n&quot;</span>, name, ip)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="goroutines"><a href="#goroutines" class="headerlink" title="goroutines"></a>goroutines</h2><p>A <em>goroutine</em> is a lightweight thread managed by the Go runtime.  </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> num = [<span class="number">10</span>]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, j := <span class="keyword">range</span> num &#123;</span><br><span class="line">        <span class="keyword">go</span> fmt.Println(j)</span><br><span class="line">        fmt.Println(j)</span><br><span class="line">        fmt.Println(<span class="string">&quot;ordered&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="channel"><a href="#channel" class="headerlink" title="channel"></a>channel</h2><p>Channels are a typed conduit through which you can send and receive values with the channel operator, <code>&lt;-</code>.  </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create channel</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// send v to channel ch</span></span><br><span class="line">ch &lt;- v</span><br><span class="line"><span class="comment">// receive from ch, and assign value to v</span></span><br><span class="line">v := &lt;- ch</span><br></pre></td></tr></table></figure>

<p><strong>buffered channels</strong></p>
<p>Channels can be <em>buffered</em>.  Provide the buffer length as the second argument to <code>make</code> to initialize a buffered channel:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ch := make(chan int, 100)</span><br></pre></td></tr></table></figure>

<p>Sends to a buffered channel block only when the buffer is full. Receives block when the buffer is empty.  </p>
<h2 id="execute-shell-command"><a href="#execute-shell-command" class="headerlink" title="execute shell command"></a>execute shell command</h2><p>go has a built in module <code>os/exec</code>, which can execute shell command in the system.</p>
<ul>
<li><code>Output()</code>: run command and show stdout, exit code</li>
<li><code>Run()</code>: run command and wait it to finish, only show stderr</li>
<li><code>Start()</code>: run command in background, only show stderr</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. use log.Printf() to pretty output with date showing</span></span><br><span class="line"><span class="comment">// 2. check command exists in system first</span></span><br><span class="line"><span class="comment">// 3. output isn&#x27;t string, use string() converts</span></span><br><span class="line"><span class="comment">// 4. exec.Command() can not use `|` and multi commands, so </span></span><br><span class="line"><span class="comment">// we need use `bash -c` to wrap multi commands and pipeline</span></span><br><span class="line"><span class="comment">// 5. use `return` to exit program while error appears</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;log&quot;</span> <span class="comment">// output with date</span></span><br><span class="line">    <span class="string">&quot;os/exec&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> commands = [<span class="number">3</span>]<span class="type">string</span>&#123;<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;ps&quot;</span>, <span class="string">&quot;wc&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// LookPath to check whether the system contains this commands</span></span><br><span class="line">    <span class="keyword">for</span> _, c := <span class="keyword">range</span> commands &#123;</span><br><span class="line">        _, err := exec.LookPath(c)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            log.Printf(<span class="string">&quot;%v: not find in path&quot;</span>, c)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Command execute, output is stream</span></span><br><span class="line">    cmd := exec.Command(<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;ps -ef |wc -l&quot;</span>)</span><br><span class="line">    stream, err := cmd.Output()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// convert to character with string function</span></span><br><span class="line">    fmt.Println(<span class="type">string</span>(stream))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Run() don&#x27;t show a stdout value</span></span><br><span class="line">    <span class="type">error</span> := exec.Command(<span class="string">&quot;ls&quot;</span>, <span class="string">&quot;-l&quot;</span>).Run()</span><br><span class="line">    <span class="keyword">if</span> <span class="type">error</span> != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Println(<span class="type">error</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="find-the-type-of-variable"><a href="#find-the-type-of-variable" class="headerlink" title="find the type of variable"></a>find the type of variable</h2><p><strong>3 ways to check</strong></p>
<ul>
<li><code>Using reflect.TypeOf Function</code></li>
<li><code>Using reflect.ValueOf.Kind() Function</code></li>
<li><code>Using %T with Printf</code></li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;log&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">    <span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    file, err := os.Open(<span class="string">&quot;./test/examples/README.md&quot;</span>)</span><br><span class="line">    <span class="keyword">defer</span> file.Close()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// first</span></span><br><span class="line">    fmt.Printf(<span class="string">&quot;%T\n&quot;</span>, file)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// second</span></span><br><span class="line">    tp := reflect.TypeOf(file)</span><br><span class="line">    fmt.Println(tp)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// third</span></span><br><span class="line">    tp = reflect.ValueOf(file).Type()</span><br><span class="line">    fmt.Println(tp)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="deal-with-file"><a href="#deal-with-file" class="headerlink" title="deal with file"></a>deal with file</h2><h3 id="read-file"><a href="#read-file" class="headerlink" title="read file"></a>read file</h3><p>read file include two parts:</p>
<ol>
<li>open a file handler</li>
<li>get the content with handler</li>
</ol>
<p>however some function combine the two parts into one, and that’s fine</p>
<blockquote>
<p>Note:</p>
<p>while opening a file, need to colse it</p>
</blockquote>
<p><strong>simple open a file, leave a file handler, without dealing with it.</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;log&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    file, err := os.Open(<span class="string">&quot;./test/examples/README.md&quot;</span>)</span><br><span class="line">    <span class="keyword">defer</span> file.Close()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// show file state</span></span><br><span class="line">    fmt.Println(file.Stat())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>read whole file content with one function at once, don’t use it with large file</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// don&#x27;t need to colse file manually</span></span><br><span class="line">    content, err := os.ReadFile(<span class="string">&quot;./test/examples/README.md&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(<span class="type">string</span>(content))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>read file by chunks</strong></p>
<p>we don’t take it all completely in memory but instead we load it by  chunking. It’s very important to read large files in chunk to avoid out  of memory errors.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;io&quot;</span></span><br><span class="line">    <span class="string">&quot;log&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    file, err := os.Open(<span class="string">&quot;./test/examples/README.md&quot;</span>)</span><br><span class="line">    <span class="keyword">defer</span> file.Close()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Print(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create slice</span></span><br><span class="line">    chunk := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// for loop</span></span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="comment">// read content to chunk and return a chunk size</span></span><br><span class="line">        size, err := file.Read(chunk)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> err != io.EOF &#123;</span><br><span class="line">                log.Print(err)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Printf(<span class="type">string</span>(chunk[:size]))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>use bufio</strong></p>
<p>line by line</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;log&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    file, err := os.Open(<span class="string">&quot;./test/examples/README.md&quot;</span>)</span><br><span class="line">    <span class="keyword">defer</span> file.Close()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Print(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    scanner := bufio.NewScanner(file)</span><br><span class="line">    <span class="keyword">for</span> scanner.Scan() &#123;</span><br><span class="line">        fmt.Println(scanner.Text())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>read file word by word</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;log&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    file, err := os.Open(<span class="string">&quot;./test/examples/README.md&quot;</span>)</span><br><span class="line">    <span class="keyword">defer</span> file.Close()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Print(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    scanner := bufio.NewScanner(file)</span><br><span class="line">    scanner.Split(bufio.ScanWords) <span class="comment">// add one line to split line into word</span></span><br><span class="line">    <span class="keyword">for</span> scanner.Scan() &#123;</span><br><span class="line">        fmt.Println(scanner.Text())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="write-file"><a href="#write-file" class="headerlink" title="write file"></a>write file</h3><p>simplest way, easy for writing small size file</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    loc := <span class="string">&quot;./data.txt&quot;</span></span><br><span class="line">    file, err := os.OpenFile(loc, os.O_CREATE|os.O_APPEND|os.O_RDWR, <span class="number">0755</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// write to file directorily</span></span><br><span class="line">    file.WriteString(<span class="string">&quot;hello world!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// read file</span></span><br><span class="line">    content, err := os.ReadFile(loc)</span><br><span class="line">    fmt.Println(<span class="type">string</span>(content))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>we can use bufio to write content to file, more useful for large file to write</p>
<ul>
<li>use <code>os.OpenFile()</code> for more control</li>
<li>it does a write when <code>writer.Fulsh()</code> is called</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// create file if none with permistion of 0755, or append to a exist file </span></span><br><span class="line">    loc := <span class="string">&quot;./data.txt&quot;</span></span><br><span class="line">    file, err := os.OpenFile(loc, os.O_CREATE|os.O_APPEND|os.O_RDWR, <span class="number">0755</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// store string to buffer</span></span><br><span class="line">    writer := bufio.NewWriter(file)</span><br><span class="line">    writer.WriteString(<span class="string">&quot;hello world!&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// write buffer all at once to file when we use flush function</span></span><br><span class="line">    writer.Flush()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// reopen file to show content</span></span><br><span class="line">    file, _ = os.Open(loc)</span><br><span class="line">    scanner := bufio.NewScanner(file)</span><br><span class="line">    <span class="keyword">for</span> scanner.Scan() &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;text:&quot;</span>, scanner.Text())</span><br><span class="line">    &#125;</span><br><span class="line">    file.Close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="get-request-and-json-convert"><a href="#get-request-and-json-convert" class="headerlink" title="get request and json convert"></a>get request and json convert</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;crypto/tls&quot;</span></span><br><span class="line">    <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> URL <span class="type">string</span> = <span class="string">&quot;https://192.168.31.214:8080&quot;</span></span><br><span class="line"><span class="keyword">var</span> USER <span class="type">string</span> = <span class="string">&quot;admin&quot;</span></span><br><span class="line"><span class="keyword">var</span> PASSWD <span class="type">string</span> = <span class="string">&quot;xFkwBNzwtA6ufGGLwSXzCwU8k9VGX4hcbhxemEUhBxyUkesSupynBBemEX8CK3Do&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// join string</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">url</span><span class="params">(api <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> URL + api</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">get</span><span class="params">(url <span class="type">string</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">    http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config&#123;InsecureSkipVerify: <span class="literal">true</span>&#125;</span><br><span class="line"></span><br><span class="line">    r, err := http.NewRequest(<span class="string">&quot;GET&quot;</span>, url, <span class="literal">nil</span>)</span><br><span class="line">    r.SetBasicAuth(USER, PASSWD)</span><br><span class="line"></span><br><span class="line">    c := &amp;http.Client&#123;&#125;</span><br><span class="line">    resp, err := c.Do(r)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return resp.Body, remove `[]`</span></span><br><span class="line">    content, _ := ioutil.ReadAll(resp.Body)</span><br><span class="line">    <span class="keyword">return</span> content[<span class="number">1</span> : <span class="built_in">len</span>(content)<span class="number">-2</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create struct to parse json, notice captial case</span></span><br><span class="line"><span class="keyword">type</span> Data <span class="keyword">struct</span> &#123;</span><br><span class="line">    Code             <span class="type">string</span> <span class="string">`json:&quot;code&quot;`</span></span><br><span class="line">    virtual          <span class="type">string</span></span><br><span class="line">    state            <span class="type">string</span></span><br><span class="line">    agentsetgroup    <span class="type">string</span></span><br><span class="line">    labelgroup       <span class="type">string</span></span><br><span class="line">    agentsetrole     <span class="type">string</span></span><br><span class="line">    agentsetfwstate  <span class="type">string</span></span><br><span class="line">    microfwstate     <span class="type">string</span></span><br><span class="line">    usernumber       <span class="type">int</span></span><br><span class="line">    expiredtimestamp <span class="type">int</span></span><br><span class="line">    blocklog         <span class="type">string</span></span><br><span class="line">    updateduser      <span class="type">string</span></span><br><span class="line">    updatedtimestamp <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    content := get(url(<span class="string">&quot;/default/activationcode&quot;</span>))</span><br><span class="line">    fmt.Println(<span class="type">string</span>(content))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> md Data</span><br><span class="line">    <span class="comment">// convert to json</span></span><br><span class="line">    json.Unmarshal(content, &amp;md)</span><br><span class="line">    fmt.Println(md.Code)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="practice"><a href="#practice" class="headerlink" title="practice"></a>practice</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;crypto/tls&quot;</span></span><br><span class="line">    <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">    <span class="string">&quot;flag&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;io&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// define some variables</span></span><br><span class="line"><span class="keyword">var</span> NEW Data</span><br><span class="line"><span class="keyword">var</span> OLD Data</span><br><span class="line"></span><br><span class="line"><span class="comment">// create data struct of service request [&#123;k:v,k:[&#123;k:v&#125;,&#123;k:v&#125;...]&#125;,k:v]</span></span><br><span class="line"><span class="keyword">type</span> Data []<span class="keyword">struct</span> &#123;</span><br><span class="line">    Uuid             <span class="type">string</span>  <span class="string">`json:&quot;uuid&quot;`</span></span><br><span class="line">    Service          Service <span class="string">`json:&quot;service&quot;`</span></span><br><span class="line">    Updatedtimestamp <span class="type">int</span>     <span class="string">`json:&quot;updatedtimestamp&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Service []<span class="keyword">struct</span> &#123;</span><br><span class="line">    Protocol <span class="type">string</span> <span class="string">`json:&quot;protocol&quot;`</span></span><br><span class="line">    Port     <span class="type">string</span> <span class="string">`json:&quot;port&quot;`</span></span><br><span class="line">    Listen   <span class="type">string</span> <span class="string">`json:&quot;listen&quot;`</span></span><br><span class="line">    Name     <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">    Exe      <span class="type">string</span> <span class="string">`json:&quot;exe&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// commind line parse</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">parseCmd</span><span class="params">()</span></span> (<span class="type">string</span>, <span class="type">uint</span>, <span class="type">string</span>, <span class="type">string</span>) &#123;</span><br><span class="line">    url := flag.String(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;192.168.31.53&quot;</span>, <span class="string">&quot;QCC url&quot;</span>)</span><br><span class="line">    interval := flag.Uint(<span class="string">&quot;time&quot;</span>, <span class="number">300</span>, <span class="string">&quot;interval time(seconds)&quot;</span>)</span><br><span class="line">    api := flag.String(<span class="string">&quot;api&quot;</span>, <span class="string">&quot;rh8FeGiGZhGBFWawrCvFYLaMHHQBVr9ZEmKmLAJAiCfqkB5kRkGs4cwgToELFV5L&quot;</span>, <span class="string">&quot;qcc api&quot;</span>)</span><br><span class="line">    user := flag.String(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;api user name&quot;</span>)</span><br><span class="line">    flag.Parse()</span><br><span class="line">    <span class="keyword">return</span> *url, *interval, *api, *user</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// function of api url</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">apiUrl</span><span class="params">(url, api <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;https://&quot;</span> + url + <span class="string">&quot;:8080&quot;</span> + api</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// get http request raw data</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rawData</span><span class="params">(url, user, api <span class="type">string</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">    http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config&#123;InsecureSkipVerify: <span class="literal">true</span>&#125;</span><br><span class="line"></span><br><span class="line">    r, err := http.NewRequest(<span class="string">&quot;GET&quot;</span>, url, <span class="literal">nil</span>)</span><br><span class="line">    r.SetBasicAuth(user, api)</span><br><span class="line"></span><br><span class="line">    c := &amp;http.Client&#123;&#125;</span><br><span class="line">    resp, err := c.Do(r)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">defer</span> resp.Body.Close()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// return resp.Body</span></span><br><span class="line">    content, _ := io.ReadAll(resp.Body)</span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compare data with x minutes interval</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">compareData</span><span class="params">(data Data, tsleep <span class="type">uint</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    NEW = data</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> OLD == <span class="literal">nil</span> &#123;</span><br><span class="line">            OLD = NEW</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// condition</span></span><br><span class="line">        time.Sleep(time.Duration(tsleep) * time.Second)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;one&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main function</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    url, interval, api, user := parseCmd()</span><br><span class="line">    fmt.Println(url, interval, api, user, apiUrl(url, <span class="string">&quot;/default/workloadservice&quot;</span>))</span><br><span class="line">    content := rawData(apiUrl(url, <span class="string">&quot;/default/workloadservice&quot;</span>), user, api)</span><br><span class="line">    <span class="comment">// fmt.Println(apiUrl(&quot;/default/workloadservice&quot;))</span></span><br><span class="line">    <span class="comment">// fmt.Printf(&quot;%T\n&quot;,content)</span></span><br><span class="line">    <span class="comment">// fmt.Printf(&quot;%s\n&quot;,content)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> data Data</span><br><span class="line">    err := json.Unmarshal(content, &amp;data)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    result := compareData(data, interval)</span><br><span class="line">    fmt.Println(result)</span><br><span class="line">    <span class="comment">// fmt.Printf(&quot;%T\n&quot;,data)</span></span><br><span class="line">    <span class="comment">// fmt.Println(data[0].Service)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>

        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/go/">#go</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/04/23/haskell/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">haskell</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/04/23/git/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">git</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">shutterbug</a>
        </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#GO"><span class="nav-number">1.</span> <span class="nav-text">GO</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#install"><span class="nav-number">1.1.</span> <span class="nav-text">install</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#config-workspace"><span class="nav-number">1.2.</span> <span class="nav-text">config workspace</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vscode-go-plugin"><span class="nav-number">1.3.</span> <span class="nav-text">vscode go plugin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#run-or-compile-file"><span class="nav-number">1.4.</span> <span class="nav-text">run or compile file</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hello-world"><span class="nav-number">1.5.</span> <span class="nav-text">hello world</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#naming-rule"><span class="nav-number">1.6.</span> <span class="nav-text">naming rule</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#constan"><span class="nav-number">1.7.</span> <span class="nav-text">constan</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#variables"><span class="nav-number">1.8.</span> <span class="nav-text">variables</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#basic-type"><span class="nav-number">1.9.</span> <span class="nav-text">basic type</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#array"><span class="nav-number">1.10.</span> <span class="nav-text">array</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#slice"><span class="nav-number">1.11.</span> <span class="nav-text">slice</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nil"><span class="nav-number">1.12.</span> <span class="nav-text">nil</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#range"><span class="nav-number">1.13.</span> <span class="nav-text">range</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map"><span class="nav-number">1.14.</span> <span class="nav-text">map</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#struct"><span class="nav-number">1.15.</span> <span class="nav-text">struct</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#for-loop"><span class="nav-number">1.16.</span> <span class="nav-text">for loop</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#basic-function"><span class="nav-number">1.17.</span> <span class="nav-text">basic function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#usage"><span class="nav-number">1.18.</span> <span class="nav-text">... usage</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#function-value"><span class="nav-number">1.19.</span> <span class="nav-text">function value</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#example"><span class="nav-number">1.20.</span> <span class="nav-text">example</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#initialize-struct-data-with-functions-and-return-a-struct-data-type"><span class="nav-number">1.20.0.0.1.</span> <span class="nav-text">initialize struct data with functions and return a struct data type.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#read-from-file-and-write-file"><span class="nav-number">1.20.0.0.2.</span> <span class="nav-text">read from file and write file</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#methods"><span class="nav-number">1.21.</span> <span class="nav-text">methods</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#interfaces"><span class="nav-number">1.22.</span> <span class="nav-text">interfaces</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#goroutines"><span class="nav-number">1.23.</span> <span class="nav-text">goroutines</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#channel"><span class="nav-number">1.24.</span> <span class="nav-text">channel</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#execute-shell-command"><span class="nav-number">1.25.</span> <span class="nav-text">execute shell command</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#find-the-type-of-variable"><span class="nav-number">1.26.</span> <span class="nav-text">find the type of variable</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#deal-with-file"><span class="nav-number">1.27.</span> <span class="nav-text">deal with file</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#read-file"><span class="nav-number">1.27.1.</span> <span class="nav-text">read file</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#write-file"><span class="nav-number">1.27.2.</span> <span class="nav-text">write file</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#get-request-and-json-convert"><span class="nav-number">1.28.</span> <span class="nav-text">get request and json convert</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#practice"><span class="nav-number">1.29.</span> <span class="nav-text">practice</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>






<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
