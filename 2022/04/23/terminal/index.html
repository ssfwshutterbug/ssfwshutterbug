<!DOCTYPE html>
<html>
	<head>
		
<title>terminal-Quiet</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/favicon.ico">

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="linux,">
<meta name="description" content="">


<script src="/js/jquery.min.js"></script>


<script src="/js/index.js"></script>


<script src="/js/fancybox.umd.js"></script>


<script src="/js/fancybox-images.js"></script>


<script src="/js/gitalk.min.js"></script>


<script src="/js/hljs.min.js"></script>
 
<script>hljs.highlightAll();</script>

	<meta name="generator" content="Hexo 5.4.2"></head>

	<body>
		
	<div class="header">
		<div class="header-top" id="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/logo.png" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										HOME
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										ARCHIVE
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/categories">
										CATEGORIES
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/tags">
										TAGS
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>Joey</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">HOME</a>
        </li>
        
        <li>
            <a href="/archives">ARCHIVE</a>
        </li>
        
        <li>
            <a href="/categories">CATEGORIES</a>
        </li>
        
        <li>
            <a href="/tags">TAGS</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quiet主题">
        </a>
        
    </div>
</div>
<div class='shelter'>
</div>
<style>
    .shelter{
        background-color: #333;
        opacity:0.5;
        cursor: pointer;
        display: none; 
        position: fixed;
        left: 0;
        top: 0; 
        right: 0;
        bottom: 0;
        z-index: 1998;
    }
    .sidebar {
        width: 66%;
        height: 100%;
        position: fixed;
        top: 0;
        right: -100%;
        bottom: 0;
        background: #fff;
        z-index: 1999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815);
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $( function () {
	$( '.h-right-close>svg' )
		.click( function () {
			$( '.sidebar' )
				.animate( {
					right: "0"
				}, 500 );
			$( '.shelter' )
				.fadeIn( "slow" )
		} );
	$( '.shelter' )
		.click( function ( e ) {
			$( '.sidebar' )
				.animate( {
					right: "-100%"
				}, 500 );
			$( '.shelter' )
				.fadeOut( "slow" )
		} )
} )

</script>

<div class="post">
    <div class="post-header-background post-header-img"
    style="background: url('https://api.ixiaowai.cn/gqapi/gqapi.php')" 
>
    <div class="post-header-background-content">
        <ul class="post-header-tag">
            
            
            <li><a href="/tags/linux">linux</a></li>
            
            
        </ul>
        
        <h1>terminal</h1>
        <div class="post-header-info">
            <div class="post-header-info-author">
                
                    <svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
                        <path
                            d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
                            p-id="2902" fill="#ffffff"></path>
                    </svg>
                    
                <span class="post-header-info-author-text"> <a href="../../about">Joey</a></span>
                <div class="post-header-info-author-categories">
                    
                         <a href="../../categories/learn/" target="_blank" >learn</a>
                    
                </div>
                <p>2022-04-23 23:12:34</p>
            </div>
        </div>
    </div>
</div>
    <div class="post-content" id="content">
  
  <div id="article" class="post-content-info">
    

    <h1 id="TERMINAL"><a href="#TERMINAL" class="headerlink" title="TERMINAL"></a>TERMINAL</h1><p>terminal is a topic include many many things, and i will complete it.</p>
<h2 id="SHORTCUT"><a href="#SHORTCUT" class="headerlink" title="SHORTCUT"></a>SHORTCUT</h2><p><strong>clean and movement</strong></p>
<pre><code class="shell">ctrl + l # clearn screen
</code></pre>
<pre><code class="shell">ctrl + a # move cursor to the begin
</code></pre>
<pre><code class="shell">ctrl + e # move cursor to the end
</code></pre>
<pre><code class="shell">alt + b # move cursor one word before
</code></pre>
<pre><code class="shell">alt + f # move cursor one word after
</code></pre>
<pre><code class="shell">ctrl + u # clear to the begin and yank to clipboard
</code></pre>
<pre><code class="shell">ctrl + k # clear to the end and yank to clipboard
</code></pre>
<pre><code class="shell">alt + backspace || ctrl + w # clear one word before
</code></pre>
<pre><code class="shell">ctrl + y # paste last command&#39;s last argument
</code></pre>
<blockquote>
<p>Note: in zsh, some of the key binding is not working by default. so we need <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/18042685/list-of-zsh-bindkey-commands">add key binding by hand</a>.</p>
</blockquote>
<pre><code class="shell"># find all registered zle commands
zle -al

# bind personal key for zsh, add to .zshrc
bindkey ^K kill-line   
bindkey ^B backward-word 
bindkey ^F forward-word 
bindkey ^Y insert-last-word

# show all binded keys
bindkey
</code></pre>
<p><strong>display and process</strong></p>
<pre><code class="shell">ctrl + c # end process
</code></pre>
<pre><code class="shell">ctrl + z # stop current process and send to backend
</code></pre>
<pre><code class="shell">ctrl + d # end typing
</code></pre>
<pre><code class="shell">ctrl + s # hide character typed and output
</code></pre>
<pre><code class="shell">ctrl + q # get out of hide mode and display
</code></pre>
<h2 id="GREAT-WORKFLOW"><a href="#GREAT-WORKFLOW" class="headerlink" title="GREAT WORKFLOW"></a>GREAT WORKFLOW</h2><p>if you forget to type <code>sudo</code> at the beginning, there are two convenient ways. and i prefer the second one</p>
<pre><code class="shell"># first
ctrl + a
sudo

# second 
ctrl + u 
sudo
ctrl + y
</code></pre>
<h2 id="COMMAND"><a href="#COMMAND" class="headerlink" title="COMMAND"></a>COMMAND</h2><h3 id="wrap-terminal-long-line"><a href="#wrap-terminal-long-line" class="headerlink" title="wrap terminal long line"></a>wrap terminal long line</h3><p><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/20493/how-to-disable-line-wrap-in-a-terminal">view all message with this page</a></p>
<p>sometimes the terminal output is too long, in default the long line will wrap in several lines, and we cannot see each line’s begin.</p>
<p>there are several methods to solve this problem:</p>
<ol>
<li><p>edit terminal setting</p>
<pre><code class="shell"># such as in xterm disable line wrap
setterm --linewrap off
</code></pre>
</li>
<li><p>use <code>-S</code> of <code>less</code></p>
<pre><code class="shell"># such as 
ps -ef |grep code |less -S
</code></pre>
<p><img src=".images/image-20210520225316462.png" alt="image alt &lt;"></p>
</li>
</ol>
<h3 id="last-command"><a href="#last-command" class="headerlink" title="last command"></a>last command</h3><p>there i will show how to modify the last command since it is really very useful in our daily typing.</p>
<pre><code class="shell"># repeat last command
!!

# repeat second last command
!-2

# get last command first argument
!^

# get last command last argument
!$

# get last command Nth argument, n is numeric, such as 1,2...11...
!:n

# modify last command and execute
!:s/xxx/yyy
</code></pre>
<h3 id="mktemp"><a href="#mktemp" class="headerlink" title="mktemp"></a>mktemp</h3><p>在脚本中经常遇到需要创建临时文件或目录的情况，直接使用命令在<code>/tmp</code>目录下创建存在安全问题，所以更好的是使用<code>mktemp</code>命令</p>
<pre><code class="shell"># file
TEMPFILE=$(mktemp) || exit 1

# dir
TEMPFILE=$(mktemp -d) || exit 1
</code></pre>
<h3 id="trap"><a href="#trap" class="headerlink" title="trap"></a>trap</h3><p>临时文件或目录使用完后需要清理，可以搭配<code>trap</code>命令。trap命令放在文件最开头，这样可以包含所有后面的信号</p>
<pre><code class="shell">trap [command] [signal]
</code></pre>
<pre><code class="shell">#!/bin/bash

trap &quot;rm -rf $TEMPFILE&quot; EXIT
TEMPFILE=$(mktemp) || exit 1
</code></pre>
<pre><code class="shell"># 信号
HUP：编号1，脚本与所在的终端脱离联系。
INT：编号2，用户按下 Ctrl + C，意图让脚本中止运行。
QUIT：编号3，用户按下 Ctrl + 斜杠，意图退出脚本。
KILL：编号9，该信号用于杀死进程。
TERM：编号15，这是kill命令发出的默认信号。
EXIT：编号0，这不是系统信号，而是 Bash 脚本特有的信号，不管什么情况，只要退出脚本就会产生。
</code></pre>
<h3 id="sshfs"><a href="#sshfs" class="headerlink" title="sshfs"></a>sshfs</h3><p><code>sshfs</code>和<code>nfs</code>作用相同，都是挂载远程目录，但是sshfs更加简单，只需要在本地安装sshfs即可，因为连接使用的是ssh</p>
<pre><code class="shell"># install
apt install sshfs

# mount
sshfs root@192.168.31.121:/opt /opt

# umount
fusermount -u /opt
</code></pre>
<h3 id="stty"><a href="#stty" class="headerlink" title="stty"></a>stty</h3><p>修改终端的设置</p>
<pre><code class="shell"># show all setting
stty -a

# disable input echo
stty -echo

# enable input echo
stty echo
</code></pre>
<p>在有些程序中（例如ftp），按下回车键不能删除字符，而是显示<code>^H</code>，为了解决这个问题，可以在使用ftp之前进行设置</p>
<pre><code class="shell">stty erase ^H
</code></pre>
<p>设置之后回车即可删除，但是在shell下回车会变成<code>^?</code>，所以有必要改回来</p>
<pre><code class="shell">stty erase ^?
</code></pre>
<p>同时stty还可以查看/设置屏幕高度和宽度</p>
<pre><code class="shell">stty size
stty rows 100 cols 100
</code></pre>
<h3 id="qmv"><a href="#qmv" class="headerlink" title="qmv"></a>qmv</h3><p><code>qmv/qcp/qcmd</code>属于<code>renameutils</code>软件包，可以用编辑器快速对文件重命名，默认使用nano打开文件，可以指定vim打开进行更加高效的操作</p>
<pre><code class="shell">export EDITOR=vim

# rename all jpg
qmv *.jpg

# only show target column
qmv *.jpg -f do
</code></pre>
<p><img src=".images/qmv.gif" alt="qmv"></p>
<h3 id="pidof"><a href="#pidof" class="headerlink" title="pidof"></a>pidof</h3><p>查看进程的pid，效果等同于<code>pgrep</code></p>
<pre><code class="shell">pgrep xxx
pidof xxx
</code></pre>
<h3 id=""><a href="#" class="headerlink" title="$!"></a>$!</h3><p>check last backend jobs’s pid</p>
<pre><code class="shell"># if we have a backend jobs
sleep 100 &amp;

# then we can access its pid with
echo $!
</code></pre>
<h3 id="rg"><a href="#rg" class="headerlink" title="rg"></a>rg</h3><p><code>rg</code>(ripgrep), <code>ag</code>(the silver search) is the newest grep tool, much more faster than grep</p>
<pre><code class="shell"># almost the same useage of grep
rg xxx
</code></pre>
<h3 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h3><p><code>fd-find</code> is the newest find tool, much more faster then find</p>
<pre><code class="shell"># different with find, but more simple
fdfind md$ #
</code></pre>
<h3 id="exa"><a href="#exa" class="headerlink" title="exa"></a>exa</h3><p><code>exa</code> is the colorful tool of <code>ls</code></p>
<pre><code class="shell"># include tree display
exa -T
</code></pre>
<h3 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h3><p>crontab can not only used to execute regular task, but also at a specified time, such as reboot</p>
<pre><code class="shell"># execute at reboot
@reboot /location/to/script

# reboot and wait for a while
@reboot sleep 60 /location/to/script
</code></pre>
<h3 id="not-stores-in-history"><a href="#not-stores-in-history" class="headerlink" title="not stores in history"></a>not stores in history</h3><p>if we put a space before command, then it will not store in history</p>
<pre><code class="shell"> echo &quot;cannot find this command in history&quot;
</code></pre>
<h3 id="disown"><a href="#disown" class="headerlink" title="disown"></a>disown</h3><p>exit terminal but leave all processes running</p>
<pre><code class="shell">disown -a &amp;&amp; exit
</code></pre>
<h3 id="tmpfs"><a href="#tmpfs" class="headerlink" title="tmpfs"></a>tmpfs</h3><p>create a super fast ram disk</p>
<pre><code class="shell">mkdir /mnt/ram
mount -t tmpfs tmpfs /mnt/ram -o size=8G

# change mount size without reboot
mount -o remount,size=4G /mnt/ram
</code></pre>
<h3 id="long-commnad"><a href="#long-commnad" class="headerlink" title="long commnad"></a>long commnad</h3><p>use shortcut opening a editor to write long command or multi commands instead of the terminal</p>
<pre><code class="shell">ctrl+x+e
</code></pre>
<h3 id="fc"><a href="#fc" class="headerlink" title="fc"></a>fc</h3><p>open a editor to edit the last command you run and then execute it automatically</p>
<pre><code class="shell">vim /etc/sysconig/network-scripts/ifcfe-en980
fc
</code></pre>
<h3 id="catch-log-file"><a href="#catch-log-file" class="headerlink" title="catch log file"></a>catch log file</h3><p>if  the log file is not big enough, we can use <code>less +F</code> instead of <code>tail -f</code>, because with it we can do more control of output. such as we can see old message with <code>ctrl + c</code> and scroll , and than <code>shift + f</code> to the end with tailing</p>
<pre><code class="shell">less +F file_name

# or press shift + f after opening a file when we only use less command
less file_name
shift + f

# q to quit
q
</code></pre>
<p>also we can combine this option with <code>-S</code> to wrap long lines, pretty much useful</p>
<pre><code class="shell">less -S +F file_name
</code></pre>
<h3 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h3><p>there is no need to close and reopen you terminal to reset all the things such as variable setting. just typing <code>reset</code> , all will be done</p>
<pre><code class="shell">reset
</code></pre>
<h3 id="doas"><a href="#doas" class="headerlink" title="doas"></a>doas</h3><p>I will use <code>doas</code> instead of <code>sudo</code>, because i get confused when i find <code>/etc/sudoers</code> file includes <code>root</code> settings. I wonder why it includes root settings, root has the highest privileges by default. At last i know the reason that with the settings root can use <code>sudo</code> command.</p>
<pre><code class="shell"># in archlinux, install opendoas
pacman -S opendoas
</code></pre>
<p> in order to make it effects, we need create a configure file and write our configuration to it</p>
<pre><code class="shell"># allow all users belong to wheel group execute super user command without password
echo &quot;permit nopass :wheel&quot; &gt; /etc/doas.conf
</code></pre>
<blockquote>
<p>Note:</p>
<ol>
<li><code>nopass</code> allow us to run command without password</li>
<li>use <code>:</code> before <code>wheel</code> means wheel is a group</li>
</ol>
</blockquote>
<p>serveral days after, i find that i need reinstall <code>sudo</code> package, because some program need sudo, such as <code>psd</code>, build package with <code>aur</code>, without sudo there will be an error occurs.</p>
<h3 id="rsync"><a href="#rsync" class="headerlink" title="rsync"></a>rsync</h3><p><strong>rsync must be installed in two machines if the two machine need to sync files</strong></p>
<p>I have ever used linux nearlly 5 years, however i know the awesome command this days. the main features:</p>
<ol>
<li>It can implement <code>cp</code> <code>scp</code>, but more powerful</li>
<li>It can specified some file to skip</li>
<li>It can delete different files in destination</li>
</ol>
<blockquote>
<p>funny:</p>
<p>I have ever wrote a shell script to backup my linux configure file. There is a satulation that the configure file in linux i have deleted but the backup directory still has the file, it is hard to check which file should be delete, so i delete whole directory and then copy directory to destination. Now, with rsync it seems that much easier.</p>
</blockquote>
<pre><code class="shell"># --delete will delete destination file which not exists in source directory
rsync --include &#39;*.txt&#39; --exclude &#39;*.sh&#39; --delete -av remoteUser@ip:/remote/directory /local/directory
rsync --include &#39;*.txt&#39; --exclude &#39;*.sh&#39; --delete -av /local/directory remoteUser@ip:/remote/directory 
</code></pre>
<h3 id="bat"><a href="#bat" class="headerlink" title="bat"></a>bat</h3><p>a colorful repalcement of <code>cat</code></p>
<pre><code class="shell"># show text with line number and scroll like less
bat -pn

# show all text with line number at once
bat -ppn
</code></pre>
<h3 id="cpufetch"><a href="#cpufetch" class="headerlink" title="cpufetch"></a>cpufetch</h3><p>show detail informatioin of cpu</p>
<h3 id="xdotool"><a href="#xdotool" class="headerlink" title="xdotool"></a>xdotool</h3><p>xdotool can do lots of things, such as simulate mouse action, key press, get window properity and so on.</p>
<pre><code class="shell"># key press
xdotool key &quot;l&quot; &quot;s&quot; return return

# get current window class name
xdotool getwindownfocus getwindowclassname

# get mouse location
xdotool getmouselocation
</code></pre>
<h3 id="yad"><a href="#yad" class="headerlink" title="yad"></a>yad</h3><p>yad is gui dialog tool which can be used to launch a dialog for shell input. though i have ever not used xdialog, i think it is much better than xdialog.</p>
<pre><code class="shell"># setting with timeout,position,length,window title,label text,default placeholder,button position.
yad --entry --timeout=5 --center --fixed --title=&#39;change app transparence&#39; --entry-label=&quot;App name:&quot; --entry-text=&quot;$currentApp&quot; --buttons-layout=edge

# also can use text to specified window text
yad --entry --timeout=5 --center --fixed --title=&#39;change app transparence&#39; --entry-label=&quot;App name:&quot; --entry-text=&quot;$currentApp&quot; --buttons-layout=edge --text=&quot;CHANGE APP TRANSPARENCE&quot;
</code></pre>
<h3 id="mount-bind"><a href="#mount-bind" class="headerlink" title="mount bind"></a>mount bind</h3><p>it is a very useful tool much better than <code>ln -sf</code>, <code>ln</code> is a tool to create a link(file) redirect to other position, and <code>mount --bind</code> will mount some folder/file to a specified location at boot time in kernel. so <code>mount --bind</code>‘s operation makes effect to origin location.</p>
<pre><code class="shell"># temporary
mount --bind /mount/folder /to/mount/point

# permanent
vim /etc/fstab
/mount/folder /to/mount/point    none    rw,bind 0 0
</code></pre>
<h3 id="nsenter"><a href="#nsenter" class="headerlink" title="nsenter"></a>nsenter</h3><p>enter new namespace with <code>nsenter</code> command. it is a really useful tool with container if the container don’t have  <code>ip</code> command.  we can use this to  easily get container ip address and route table.</p>
<pre><code class="shell"># get container&#39;s  pid
pid=`podman inspect -f &#123;&#123;.State.Pid&#125;&#125; container_name`

# or use ps command
ps -ef |rg $(ps -ef |rg container_name |awk &#39;&#123;print $2&#125;&#39; |head -1) |tail -1 |awk &#39;&#123;print $2&#125;&#39;

# get container ip address
nsenter -t $pid -n ip -c a

# get container ip route table
nsenter -t $pid -n ip -c r
</code></pre>
<h3 id="ccze"><a href="#ccze" class="headerlink" title="ccze"></a>ccze</h3><p>with <code>ccze</code> the output in terminal will be colorized.</p>
<pre><code class="shell"># usage
ps -ef |rg firefox |ccze -A

podman images |ccze -A
</code></pre>
<h2 id="SHELL"><a href="#SHELL" class="headerlink" title="SHELL"></a>SHELL</h2><p>some userful, unusual, amazing usage or tips</p>
<h3 id="find-test-shortcut-meaning"><a href="#find-test-shortcut-meaning" class="headerlink" title="find test shortcut meaning"></a>find test shortcut meaning</h3><p>most of time i will forget what the shortcut in shell condition meaning, but now i find a way to find all the shortcut meaning.</p>
<pre><code class="shell">man test
</code></pre>
<h3 id="grant-privilege-to-normal-user-with-the-owner’s-permission"><a href="#grant-privilege-to-normal-user-with-the-owner’s-permission" class="headerlink" title="grant privilege to normal user with the owner’s permission"></a>grant privilege to normal user with the owner’s permission</h3><p>yeah, i remember to learn <code>setuid</code> and <code>setgid</code>. but still today, i really know <a target="_blank" rel="noopener" href="https://www.liquidweb.com/kb/how-do-i-set-up-setuid-setgid-and-sticky-bits-on-linux/">the right usage of them</a>, and i have to say they are very powerful for our daily use.</p>
<p>as we know some command need root privilege to execute, when i meet this requirement before, i often put this command to <code>sudoers</code> file to make it execute without password, in a fact this method is too stupid. it is simple to resolve with <code>setuid or setgid</code>.</p>
<p><code>setuid and setgid</code> or a command to be executed, it is a property of the command.</p>
<pre><code class="shell"># grant user privilege
chmod u+s /some/command

# grant group privilege
chmod g+s /some/command
</code></pre>
<h3 id="remote-X11-forward-with-ssh"><a href="#remote-X11-forward-with-ssh" class="headerlink" title="remote X11 forward with ssh"></a>remote X11 forward with ssh</h3><p>we can open remote machine’s GUI program in local  with ssh even though remote machine without a full X11 system installed. but local machine must has a full X11 system environment.</p>
<p><strong>remote machine:</strong></p>
<ul>
<li>install xauth and xhost(optional)</li>
<li><code>/etc/ssh/sshd_config</code> allow <code>X11Forwarding, AllowTcpForwarding, X11UseLocalhost</code> to <code>yes</code> and <code>X11DisplayOffset=10</code> </li>
<li>restart ssh</li>
</ul>
<p><strong>local machine:</strong></p>
<ul>
<li>install xauth</li>
</ul>
<pre><code class="shell"># specify X11 forwarding
ssh -X remote_user@remote_ip
# then open remote gui program such as xterm
xterm
</code></pre>
<h3 id="use-Xvfb-open-application-without-GUI"><a href="#use-Xvfb-open-application-without-GUI" class="headerlink" title="use Xvfb open application without GUI"></a>use Xvfb open application without GUI</h3><p>as we know there are so many programs load in background and they are be called daemons, however not all of the programs be designed like that, may be we have the need of opening some GUI applications in background and we don’t want to see the GUI each time the system starts.</p>
<p>with <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Xvfb">Xvfb</a> we can do that, it opens GUI application in virtual memory without showing any screen output. in archinux, we can install it with</p>
<pre><code class="shell">pacman -S xorg-server-xvfb
</code></pre>
<p>according to this <a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/512356/is-there-any-way-to-launch-gui-application-without-gui">webpage</a>, if we want to run some GUI application in background, we can write like this</p>
<pre><code class="shell"># open a virtual frame buffer called :1
Xvfb :1 &amp;
# specify the application to start in virtual frame buffer :1
DISPLAY=:1 /location/to/gui/application &amp;
</code></pre>
<p>may be we can use it in browser testing, and starting pentablet app</p>
<h3 id="the-problem-of-num"><a href="#the-problem-of-num" class="headerlink" title="the problem of num"></a>the problem of num</h3><p>the way to get the hour of system will lead some problem while comparing with this nums, because all num begin with <code>0</code> is recognized as octonary</p>
<pre><code class="shell">hour=`date +%H`

[[ hour -eq 8 ]] || EXIT
#[[: 08: value too great for base (error token is &quot;08&quot;)
</code></pre>
<p>the way to fix the problem is adding <code>10#</code> at the begining</p>
<pre><code class="shell">hour=10#`date +%H`
[[ $hour -eq 8 ]] || EXIT
</code></pre>
<h3 id="the-problem-of-column-alignment"><a href="#the-problem-of-column-alignment" class="headerlink" title="the problem of column alignment"></a>the problem of column alignment</h3><p><code>column</code> can deal most of column’s alignment, however sometimes i don’t know why it fails, at last i find command  <code>expand</code> can work with <code>column</code> to <a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/396223/bash-shell-script-output-alignment">fix the problem</a>.</p>
<p><img src=".images/image-20210809233020904.png" alt="image-20210809233020904"></p>
<h3 id="for-loop-in-shell"><a href="#for-loop-in-shell" class="headerlink" title="for loop in shell"></a>for loop in shell</h3><pre><code class="shell">for ((i=0; i&lt;5; i++))
do
    echo $i
done
</code></pre>
<h3 id="variable-expansion"><a href="#variable-expansion" class="headerlink" title="variable expansion"></a>variable expansion</h3><pre><code class="shell"># set default value
$&#123;var:-default&#125;
$&#123;var:=default&#125;
$&#123;var=default&#125;

# if variable not defined before then give a message
$&#123;var?message&#125;

# cut variable with index and length
$&#123;var:index:length&#125;

# cut variable with pattern
$&#123;var#*pattern&#125; #cut left to the first match
$&#123;var##*pattern&#125; #cut left to the last match
$&#123;var%pattern*&#125; #cut right to the first match
$&#123;var%%pattern*&#125; #cut right to the last match

# get variable length
$&#123;#var&#125;

# show all variables matched with begining of "pre"
$&#123;!pre*&#125;

# variable replace
$&#123;var/match/replace&#125; #replace the first one matched
$&#123;var//match/replace&#125; #replace all matched
$&#123;var/#match/replace&#125; #only replace the first one matched
$&#123;var/%match/replace&#125; #only replace the last one matched
```

### privilege of script

sometimes we may meet the problem of privilege in our script as a normal user, because some commands need to be executed with root privilege.

```shell
# one method is send root password to sudo
echo "password" |sudo -S command

# another way is giving the script privilege of without password
echo <username> ALL=(ALL) NOPASSWD: </location/to/script>
# then execute script with sudo
sudo </location/to/script>
```

### alias act as function

there is a concept in perl called one liner, with zsh, we can use function to write one liner, but bash cannot. however we can use alias, is it amazing? just think of it a little more deeper, both of them are block code.

```shell
# with zsh, function can write in one line
function autoline()&#123;for ((i=0;i<`tput cols`;i++));do echo -n "=";sleep 0.001;done&#125;

# unset to clear function define
unset -f autoline()

# amazing alias usage
alias autoline="for ((i=0;i<`tput cols`;i++));do echo -n "=";sleep 0.001;done"

# unalias to clear alias define
unalias autoline
```

### use : to complete syntax

sometimes we don't write code in one condition, but need to make sure syntax right, then `:` comes

```shell
if [ $&#123;a&#125; == 3 ];then
    :
else
    a=0
```

### use local to define a local variable

in shell, all variable are global by default, expect use `local` to define

```shell
var="global variables"
function show()&#123;
    local var="local variable"
    echo $var
&#125;
show
echo $var
```

### use type to check command's type

can check: alias, function, built-in, executable

```shell
type ls
```

### disable truncate file in global

we commanly use `>` to truncate a file, `>>` append to a file. and there has a method to disable truncate file in global in order to less mistake happend

```shell
# disable truncate file, now only append to file allowed
set -C

# enable truncate file
set +C
```

> Note:
> 
> unset has totally different usage, it is used for clear variable define: `var=5; unset var`

### array in shell

different shell has different usage

```shell
# in bash, it is complex with index
array=(1 2 3 4 5)
len=$&#123;#array[@]&#125;
for ((i=0; i<$len; i++))
do
echo $&#123;array[$i]&#125;
done

# simple usage without index
array=(1 2 3 4 5)
for i in $&#123;array[@]&#125;
do
echo $i
done

# in zsh, it is simple
array=(1 2 3 4 5)
for i in $array
do
echo $i
done
```

### map in shell

```shell
# create associate array
declare -A user 
user=([name]=xiaoxiao [age]=20 [score]=100) 
# simplify
declare -A user=([name]=xiaoxiao [age]=20 [score]=100) 

# add value
user[like]=apple

# get all keys
echo $&#123;!user[@]&#125;

# get all values
echo $&#123;user[@]&#125;

# get specified value
echo $&#123;user[name]&#125;

# get length
echo $&#123;#user[@]&#125;
```

### case convert

with `declare`, we can also convert upper case to low case, other side the same

```shell
string="hello world!"

# convert to upper case
declare -u var=$string
echo $var

# convert to lower case
declare -l var=$string
echo $var
```

### check run level

- 0：halt
- 1：single-user text mode
- 2：not used (user-definable)
- 3：full multi-user text mode
- 4：not used (user-definable)
- 5：full multi-user graphical mode
- 6：reboot

```shell
who -r
systemctl get-default
```

### get ip address

```shell
# use regex
ip a |rg -P '(\d+\.)&#123;3&#125;\d+'

# use ip command
ip -br -4 -c a

# some debian/redhat allow this
hostname -i
hostname -I

# use json format
ip -j a |jq '.[].addr_info[0].local'
```

### check live environment

```shell
# use systemd-detect-virt, almost make sense, owned by systemd
systemd-detect-virt

# use lscpu to check Hypervisor vendor
lscpu |grep "Hypervisor vendor"

# use hostnamectl to check Virtualization
hostnamectl |grep "Virtualization"

# even use parted to check Model
parted /dev/sda1 print |grep "Model"

# use dmesg to check Hypervisor
dmesg |grep "Hypervisor detected"

# maybe i will not use this forever, for it is so long
dmidecode -s system-manufacturer
```

### share terminal output to remote user

sometime we need to share our terminal output to other people who is not in local network, and there comes this method

```shell
# netcat is needed
pacman -S gnu-netcat

# for example: share our .vimrc to other people
bat -ppn .vimrc |nc seashells.io 1337

# then share the url link to other people
https://seashells.io/v/Zn3SnvKX

# we can change it to plain text with replacing /v to /p
https://seashells.io/p/Zn3SnvKX
```

### share terminal to remote user

be different from above, this method allows remote user to execute command with our local machine.

```shell
# install tmate
pacman -S tmate

# create ssh key if not exist
ssh-keygen

# start tmate
tmate

# share url link with others
tmate show-message
```

### sort ss port number via numeric

```shell
ss -Hatln |tr -t : \\t |sort -k6n |tr -t \\t :
```

### find process working directory

```shell
pwdx `pgrep [processname]`
ls -l /proc/`pgrep [processname]`/cwd
lsof -p `pgrep [processname]` |rg cwd
readlink -e /proc/`pgrep [processname]`/cwd
```

### loop until succeed

```shell
while ! ping www.bing.com; do sleep 3; done

until ping www.bing.com; do sleep 3; done
```

### execute one command in remote machine

sometimes, we don't need to login to remote machine if we only want to execute one command, we can use ssh to execute that command in local machine

```shell
ssh user@ip [command]

# for example:
ssh root@192.168.31.100 free -m
```

### simulate packages installation

simulation can help us to check whether there has some dependence we don't installed in the environment before we actually install packages

```shell
# most package managers have this function
rpm -ivh --test /location/to/rpm/package
```

### repeat history command with tag

this feature is actually a common usage, but almost the time we don't know it can be used  like this.

```shell
# with `#` we can tag a command
ip -br -c -4 a # ip4

# repeat with tag
!?#ip4
```

## [CTRL CHARACTER](https://stackoverflow.com/questions/3844311/how-do-i-replace-or-find-non-printable-characters-in-vim-regex/9277984)

linux: `\n` means return, and `$` renders as line ending

windows: `\r\n` means return, and `^M$` renders as line ending

> Note:
> 
> line ending character is not control character, it just renders as the ending of line.
> 
> in coding, we may use `\n` to act as a return action.

the way to show ctrl character:

```shell
cat -A fileName

# inside vim
:set list
# nolist to turn off
:set nolist
```

the way we type ctrl character in vim: `ctrl` + `v` + `ctrl_character`. such as `ctrl+v+c`: `^C`

```shell
# remove all ctrl character in vim
:%s/[[:cntrl:]]//g
```

## UlIMIT

there are serveral ways that we can change system limits temporarily or permanently. the simplest way we can find system resource limit is typing `ulimit -a`.

```shell
➜  ~  ulimit -a
-t: cpu time (seconds)              unlimited
-f: file size (blocks)              unlimited
-d: data seg size (kbytes)          unlimited
-s: stack size (kbytes)             8192
-c: core file size (blocks)         unlimited
-m: resident set size (kbytes)      unlimited
-u: processes                       63668
-n: file descriptors                1024
-l: locked-in-memory size (kbytes)  64
-v: address space (kbytes)          unlimited
-x: file locks                      unlimited
-i: pending signals                 63668
-q: bytes in POSIX msg queues       819200
-e: max nice                        0
-r: max rt priority                 0
-N 15:                              unlimited
```

the way to find program resource limit is `cat /proc/$pid/limits`

```shell
➜  ~  cat /proc/`pgrep firefox`/limits
Limit                     Soft Limit           Hard Limit           Units     
Max cpu time              unlimited            unlimited            seconds   
Max file size             unlimited            unlimited            bytes     
Max data size             unlimited            unlimited            bytes     
Max stack size            8388608              unlimited            bytes     
Max core file size        unlimited            unlimited            bytes     
Max resident set          unlimited            unlimited            bytes     
Max processes             63668                63668                processes 
Max open files            4096                 524288               files     
Max locked memory         65536                65536                bytes     
Max address space         unlimited            unlimited            bytes     
Max file locks            unlimited            unlimited            locks     
Max pending signals       63668                63668                signals   
Max msgqueue size         819200               819200               bytes     
Max nice priority         0                    0                    
Max realtime priority     0                    0                    
Max realtime timeout      50000                200000               us    
```

> Note:
> 
> we may find the difference between open files, we need to know that os resource limit only make effect when program not starts with service or systemd or no self defined, such as run program in terminal.

#### define os resource limit

**temporary**

```shell
ulimit -n 40960
ulimit -u 40960
```

**permanent**

```shell
# restarting os needed
vim /etc/security/limits.conf

* soft nofile 40960
* hard nofile 40960
* soft nproc 40960
* hard nproc 40960
```

#### service limit

no need to reboot os, stoping program and starting program will be okay(not restart).

```shell
vim /etc/liit/program_name.conf

limit nofile 40960 40960
limit nproc 40960 40960
```

then

```shell
service program_name stop
service program_name start
```

we can check it by

```shell
cat /proc/`pgrep program_name`/limits
```

#### systemd limit

no need to reboot os

```shell
vim /usr/lib/systemd/system/program_name.service

[Service]
LimitNOFILE=40960
LimitNPROC=40960
```

then

```shell
systemctl daemon-reload
systemctl restart program_name
```

different from service we can define all systemd resource limit with

```shell
vim /etc/systemd/system.conf

DefaultLimitNOFILE=40960
DefaultLimitNPROC=40960
```

#### modify resource limit for running program

In the new linux kernel we have a tool called `prlimit`, with which we can modify program limit when it's running.

```shell
prlimit -n40960 -p `pgrep program_name`
prlimit -u40960 -p `pgrep program_name`
```

 then check it

```shell
prlimit
```

## UFW

Uncomplicated Firewall

enable at **boot**, make sure `iptables.service` not active

```shell
systemctl enable ufw.service
```

**initialize** at the first time install the package

```shell
ufw enable
```

**query** rules being applied

```shell
ufw status
# or much more info
ufw status verbose
```

see **default** config

```shell
[root@s1 ~]# cat /etc/default/ufw |egrep '^[^#]'
IPV6=yes
DEFAULT_INPUT_POLICY="DROP"
DEFAULT_OUTPUT_POLICY="ACCEPT"
DEFAULT_FORWARD_POLICY="DROP"
DEFAULT_APPLICATION_POLICY="SKIP"
MANAGE_BUILTINS=no
IPT_SYSCTL=/etc/ufw/sysctl.conf
IPT_MODULES="nf_conntrack_ftp nf_nat_ftp nf_conntrack_netbios_ns"
```

**set** default policy

```shell
ufw default allow outgoing
ufw default deny incoming
```

make changes **effect**

```shell
ufw reload
```

three **actions**

```shell
allow    # allow connection
limit    # deny connections if an IP address attempts to initiate 6 or more connections within 30 seconds
deny    # deny connection
```

policy setting with **service name**

```shell
ufw limit ssh
ufw allow ftp
ufw deny http
```

policy setting with **port**

```shell
ufw limit 22
ufw allow 21
ufw deny 80
```

policy setting with **protocol**

```shell
ufw limit 22/tcp
ufw allow 21/tcp
ufw deny 80/tcp
```

**delete** policy

```shell
ufw delete allow 21ufw delete limit sshufw delete deny 80/tcp
```

via sort number

```shell
# check number
ufw status numbered

# delete via number
ufw delete &#123;&#123;number&#125;&#125;
</code></pre>
<p><strong>port range</strong></p>
<pre><code class="shell">ufw allow 10000:65535/tcp
</code></pre>
<p><strong>specified ip</strong></p>
<pre><code class="shell">ufw allow from 192.168.31.12
</code></pre>
<p><strong>ip range</strong></p>
<pre><code class="shell">ufw allow from 192.168.31.0/24
</code></pre>
<p><strong>ip and port</strong></p>
<pre><code class="shell">ufw allow from 192.168.31.12 to any port 80

# add protocol
ufw allow proto tcp from 10.10.10.10 to 192.168.31.13 port 80 
</code></pre>
<h2 id="SYSTEMD"><a href="#SYSTEMD" class="headerlink" title="SYSTEMD"></a>SYSTEMD</h2><p><strong>最实用命令</strong></p>
<pre><code class="shell"># 查看启动配置
systemctl cat xxx.service

# 查看远程服务信息
systemctl status xxx.service -H root@192.168.31.110
</code></pre>
<p><strong>系统电源控制</strong></p>
<pre><code class="shell">systemctl shutdown
systemctl reboot
systemctl halt
systemctl suspend
systemctl hibernate
</code></pre>
<h2 id="PORT-DETECT"><a href="#PORT-DETECT" class="headerlink" title="PORT DETECT"></a>PORT DETECT</h2><h3 id="4-ways-to-check-if-a-port-is-open-on-a-remote-linux"><a href="#4-ways-to-check-if-a-port-is-open-on-a-remote-linux" class="headerlink" title="4 ways to check if a port is open on a remote linux"></a>4 ways to check if a port is open on a remote linux</h3><ul>
<li>nc: netcat command</li>
<li>nmap: network mapper tool</li>
<li>telnet: telnet command</li>
<li>echo &gt; /dev/tcp/..</li>
</ul>
<p><strong>netcat</strong></p>
<pre><code class="shell">nc -zvw10 192.168.0.1 22
</code></pre>
<p><strong>nmap</strong></p>
<pre><code class="shell">namp 192.168.0.1 -p 22
</code></pre>
<p><strong>telnet</strong></p>
<pre><code class="shell">telnet 192.168.0.1 22
</code></pre>
<p><strong>echo</strong></p>
<p>the best way, because it is really less dependent only one  built in command <code>echo</code> </p>
<pre><code class="shell"># tcp
echo &gt; /dev/tcp/192.168.0.1/22 &amp;&amp; echo &quot;port tcp/22 is open&quot;

# udp
echo &gt; /dev/udp/192.168.0.1/22 &amp;&amp; echo &quot;port udp/22 is open&quot;
</code></pre>
<h3 id="3-ways-to-check-if-a-port-is-open-on-local-machine"><a href="#3-ways-to-check-if-a-port-is-open-on-local-machine" class="headerlink" title="3 ways to check if a port is open on local machine"></a>3 ways to check if a port is open on local machine</h3><ul>
<li>netstat</li>
<li>ss</li>
<li>lsof</li>
</ul>
<p><strong>netstat and ss have the same usage</strong></p>
<pre><code class="shell">netstat -atulpn

# ss more popular than netstat
ss -atulpn
</code></pre>
<p><strong>lsof</strong></p>
<pre><code class="shell">sudo lsof -i:22
</code></pre>
<blockquote>
<p>Note:</p>
<p>lsof need to be executed with <strong>root privilege</strong> because it need to search kernel file</p>
</blockquote>
<h2 id="KILLERS"><a href="#KILLERS" class="headerlink" title="KILLERS"></a>KILLERS</h2><p>if you don’t know this commands, i have not to say that you will die!</p>
<h3 id="SED"><a href="#SED" class="headerlink" title="SED"></a>SED</h3><h2 id="Selections"><a href="#Selections" class="headerlink" title="Selections"></a>Selections</h2><p>Clipboard is a buffer used for short-term data storage. It is mainly used to transfer data within and between applications, via <strong>cut</strong>, <strong>copy</strong> and <strong>paste</strong> operations. Clipboard is usually temporary and unnamed place that resides in your Computer’s <strong>RAM</strong>. </p>
<p>The clipboards are called <strong>“Selections”</strong> and there are three types of clipboards available in <strong>X11</strong> window system in Linux. They are:</p>
<ul>
<li><strong>PRIMARY</strong> - This is normally used when copy/paste data using Mouse middle button.</li>
<li><strong>SECONDARY</strong> - It is not used used much, but exists.</li>
<li><strong>CLIPBOARD</strong> - This is used for explicit copy/paste commands via Keyboard using <code>ctrl+c</code> and <code>ctrl+v</code> keys and via menu items.</li>
</ul>
<p>In xterm, we can use mouse button1 to select, button3 to paste with some configuration. In firefox, we can use addon <code>copy on select</code> </p>
<pre><code class="shell"># ~/.Xresources
&lt;Btn1Up&gt;: select-end(CLIPBOARD,PRIMARY,CUT_BUFFER0) 
&lt;Btn3Down&gt;: insert-selection(CLIPBOARD,PRIMARY,CUT_BUFFER0) 
</code></pre>
<h2 id="DISCUSS"><a href="#DISCUSS" class="headerlink" title="DISCUSS"></a>DISCUSS</h2><h4 id="how-centos-6-download-package-with-repository"><a href="#how-centos-6-download-package-with-repository" class="headerlink" title="how centos 6 download package with repository?"></a>how centos 6 download package with repository?</h4><p>centos7是可以直接使用yum下载安装包的，但是在centos6上不行，因为官方的镜像仓库已经下架。但是并不是说我们就真的无法使用了，<a target="_blank" rel="noopener" href="https://vault.centos.org/">这个网站</a>依旧有cantos6的镜像仓库，修改之后可可以了</p>
<pre><code class="shell"># we can access that website though linux.kernel.org or
# directly visit https://vault.centos.org to find the link we need
rpm -ivh http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm
wget http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm
</code></pre>
<h4 id="how-centos-download-package-with-all-of-its-dependences"><a href="#how-centos-download-package-with-all-of-its-dependences" class="headerlink" title="how centos download package with all of its dependences?"></a>how centos download package with all of its dependences?</h4><p>centos上提供了一个下载插件，通过<code>downloadonly</code>可以下载软件及其依赖。需要注意只有在对应的系统版本上下载的依赖才不会导致其它依赖的版本冲突，所以确保下载安装包的系统和准备安装这些包的系统版本一致。</p>
<pre><code class="shell"># in centos6
yum install yum-plugin-downloadonly

# if our system has never install that package
yum install --downloadonly --downloaddir=&lt;directory&gt; &lt;package&gt;

# if the package already exist in our system
yum reinstall --downloadonly --downloaddir=&lt;directory&gt; &lt;package&gt;
</code></pre>
<p>还有另外一个软件也提供了相同的功能</p>
<pre><code class="shell"># yum-utils include yumdownloader package
yum install yum-utils
yumdownloader &lt;package&gt;
</code></pre>
<h4 id="how-WSL-download-python-using-China-repo"><a href="#how-WSL-download-python-using-China-repo" class="headerlink" title="how WSL download python using China repo?"></a>how WSL download python using China repo?</h4><p>首先需要下载gunpg，因为换源后需要key认证，默认没有这个软件，需提前下载</p>
<pre><code class="shell">sudo apt install gnupg
</code></pre>
<p>然后添加国内源: 添加以下信息添加到<code>/etc/apt/source.list</code>文件中</p>
<pre><code class="shell">deb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse
</code></pre>
<p>更新源会报错某些key无法识别，需要进行认证</p>
<pre><code class="shell"># eg:
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 82EB5823F4FE239D
</code></pre>
<p>重新更新源，并下载python</p>
<pre><code class="shell">sudo apt update
sudo apt install python3 python3-pip
</code></pre>
<h4 id="Why-was-I-able-to-delete-a-file-owned-by-root-in-my-home-directory-without-being-root"><a href="#Why-was-I-able-to-delete-a-file-owned-by-root-in-my-home-directory-without-being-root" class="headerlink" title="Why was I able to delete a file owned by root in my home directory without being root?"></a><a target="_blank" rel="noopener" href="https://serverfault.com/questions/726907/why-was-i-able-to-delete-a-file-owned-by-root-in-my-home-directory-without-being">Why was I able to delete a file owned by root in my home directory without being root?</a></h4><p>I got a situation that i cannot edit a file owned by root but can delete it in my home directory. And i was confused such a long time, finally find the answer. whether a file can be delete or not is depend on the folder where file stores in but not the permission of file, the file permission will decide whether you can modified it or not.</p>

  </div>
  <div id="gitalk-container"></div>
</div>

<script>
  
Fancybox.bind('[data-fancybox="fancybox-gallery-img"]', {
  dragToClose: true,
  Toolbar: true,
  closeButton: "top",
  Image: {
    zoom: true,
  },
  on: {
    initCarousel: (fancybox) => {
      const slide = fancybox.Carousel.slides[fancybox.Carousel.page];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
    "Carousel.change": (fancybox, carousel, to, from) => {
      const slide = carousel.slides[to];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
  },
});
</script>

<style>
    #noneimg img {
        display: none;
        z-index: 9999;
        /* width: 600px !important; */
        min-width: 0%;
        max-width: 90%;
        max-height: 80%;
        border-radius: 0px;
        position: fixed;
        box-shadow: 0 0 0px #c3c3c300 !important;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto !important;
    }

    @media screen and (max-width:600px) {
        #noneimg img {
            max-width: 88%
        }
    }
</style>

    <div class="post-paging">
    
    <a href="/2022/04/23/vboxdiskResize/">
        <div class="post-paging-last">
            <span>上一篇</span>
            <p>vboxdiskResize</p>
        </div>
    </a>
    

    
    <a href="/2022/04/23/tcp-3-handshake/">
        <div class="post-paging-next">
            <span>下一篇</span>
            <p>tcp_3_handshake</p>
        </div>
    </a>
    
</div>
</div>
		
<div class="footer">
	<div class="Copyright">
		©2022 By Joey. 主题：<a
			style="text-decoration: none;display: contents; color: #898F9F;"
			target="_blank" rel="noopener" href="https://github.com/79e/hexo-theme-quiet">Quiet</a>
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quiet主题">
		</a>
		
	</div>
</div>

<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            transition: border .5s;
            border: 1px solid rgba(18, 24, 58, 0.06);

            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari 和 Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $( '#js-go_top' )
	.gotoTop( {
		offset: 500,
		speed: 300,
		animationShow: {
			'transform': 'translate(0,0)',
			'transition': 'transform .5s ease-in-out'
		},
		animationHide: {
			'transform': 'translate(100px,0)',
			'transition': 'transform .5s ease-in-out'
		}
	} );
</script>


    <!-- Gitalk -->
    <script>
        const data = '{"clientID":"02b3c","clientSecret":"adfc7b4","repo":"gimment","owner":"duneng","admin":"duneng"}'
        const gitalk = new Gitalk({
            ...JSON.parse( data),
            id:location.pathname,
            distractionFreeMode:false
        })
        
        if(Boolean('true')){
            gitalk.render('gitalk-container')
        }
    </script>

<script>
	console.log('\n %c Hexo-Quiet 主题 %c https://github.com/79e/hexo-theme-quiet \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
</script>
	</body>
</html>

