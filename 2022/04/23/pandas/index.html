<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>pandas | shutterbug sweet diary</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="pandaspandas是python中一个数据处理和科学分析的工具，最为强大的就是数据处理。由于它可以很轻松的处理excel数据，所以也是自动化办公的一个神器。 install使用pip来安装pandas，pip需要先配置国内源，不然下载速度很慢 pip install pandas  处理excel数据，还需要一个插件（openpyxl）来读取&#x2F;写入excel # openpyxl (3.0.">
<meta property="og:type" content="article">
<meta property="og:title" content="pandas">
<meta property="og:url" content="https://raw.githubusercontent.com/ssfwshutterbug/ssfwshutterbug.github.io/main/2022/04/23/pandas/index.html">
<meta property="og:site_name" content="shutterbug sweet diary">
<meta property="og:description" content="pandaspandas是python中一个数据处理和科学分析的工具，最为强大的就是数据处理。由于它可以很轻松的处理excel数据，所以也是自动化办公的一个神器。 install使用pip来安装pandas，pip需要先配置国内源，不然下载速度很慢 pip install pandas  处理excel数据，还需要一个插件（openpyxl）来读取&#x2F;写入excel # openpyxl (3.0.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200418202939418.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200418204331053.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200418204439512.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200417203430726.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200417192602580.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/Desktop/Figure_1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200417202420437.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200417202957849.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200417220253777.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200417220601412.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200417223035065.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200417223407312.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200418095053048.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200418103216628.png">
<meta property="og:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200418104716779.png">
<meta property="article:published_time" content="2022-04-23T15:08:20.000Z">
<meta property="article:modified_time" content="2022-04-23T15:08:49.640Z">
<meta property="article:author" content="shutterbug">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/home/narcissus/.config/Typora/typora-user-images/image-20200418202939418.png">
  
    <link rel="alternate" href="/atom.xml" title="shutterbug sweet diary" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">shutterbug sweet diary</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://raw.githubusercontent.com/ssfwshutterbug/ssfwshutterbug.github.io/main"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-pandas" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/04/23/pandas/" class="article-date">
  <time datetime="2022-04-23T15:08:20.000Z" itemprop="datePublished">2022-04-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/learn/">learn</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      pandas
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h1><p>pandas是python中一个数据处理和科学分析的工具，最为强大的就是数据处理。由于它可以很轻松的处理excel数据，所以也是自动化办公的一个神器。</p>
<h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><p>使用pip来安装pandas，pip需要先配置国内源，不然下载速度很慢</p>
<pre><code class="shell">pip install pandas
</code></pre>
<p>处理excel数据，还需要一个插件（openpyxl）来读取/写入excel</p>
<pre><code class="shell"># openpyxl (3.0.3)    - A Python library to read/write Excel 2010 xlsx/xlsm files
pip install openpyxl
</code></pre>
<h2 id="three-data-type"><a href="#three-data-type" class="headerlink" title="three data type"></a>three data type</h2><table>
<thead>
<tr>
<th>数据结构</th>
<th>维度</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>Series</td>
<td>一维</td>
<td>同构（数据类型相同），表示一列column</td>
</tr>
<tr>
<td>DataFrame</td>
<td>二维</td>
<td>异构，表示一个表格table</td>
</tr>
<tr>
<td>Panel</td>
<td>三维</td>
<td>异构，使用的少</td>
</tr>
</tbody></table>
<p>由于具有DataFrame这种二维数据结构，所以可以处理很多类似数据结构的文件，比如：excel，sql，json等</p>
<h2 id="simple-read-write"><a href="#simple-read-write" class="headerlink" title="simple read write"></a>simple read write</h2><p><strong>读取数据的时候可以直接指定index列<code>index_col=</code></strong></p>
<p><strong>数据如果太长显示不了，可以设置显示宽度<code>pandas.options.display.max_columns=num</code></strong></p>
<h3 id="excel"><a href="#excel" class="headerlink" title="excel"></a>excel</h3><pre><code class="python">import pandas as pd

# 写入数据到excel
data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,22,24], &quot;score&quot;:[80,90,100]&#125;
df = pd.DataFrame(data)
df.to_excel(&#39;/home/narcissus/Desktop/1.xlsx&#39;)

# 从excel读取数据
pe = pd.read_excel(&quot;/home/narcissus/Desktop/1.xlsx&quot;, index_col=&#39;name&#39;)
print(pe)
</code></pre>
<h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><p>需要安装数据库连接驱动</p>
<pre><code class="shell">pip install pymysql
</code></pre>
<pre><code class="python">import pandas
import pymysql

host = &#39;192.168.0.105&#39;
user = &#39;pi&#39;
password = input(&quot;password for mysql connection: &quot;)
database = &#39;mytestdb&#39;
con = pymysql.connect(host,user,password,database)

# 读取数据
df = pd.read_sql_query(&#39;select * from ssacount limit 0,10&#39;,con)
print(df)

# 可以将数据库中读取到的数据直接写入excel中
df.to_excel(&#39;~/Desktop/1.xlsx&#39;)
</code></pre>
<h3 id="sqlite"><a href="#sqlite" class="headerlink" title="sqlite"></a>sqlite</h3><pre><code class="python">import sqlite3

con = sqlite3.connect(&quot;testdatabase.db&quot;)
df = pd.read_sql_query(&quot;SELECT * FROM ssacount&quot;, con)
print(df)
</code></pre>
<h3 id="json"><a href="#json" class="headerlink" title="json"></a>json</h3><pre><code class="python">df = pd.read_json(&#39;test.json&#39;)
</code></pre>
<h3 id="csv-tsv-txt"><a href="#csv-tsv-txt" class="headerlink" title="csv/tsv/txt"></a>csv/tsv/txt</h3><p>pandas只有一个<code>read_csv()</code>函数，但是却可以读取这三种文件（文本文件都可以），默认读取csv文件，其分隔符为逗号，所以在读取tsv和txt的时候，要手动设置分隔符<code>sep=&#39;&#39;</code></p>
<pre><code class="python">df = pd.read_csv(&#39;1.csv&#39;)
df = pd.read_csv(&#39;1.tsv&#39;, sep=&#39;\t&#39;)
df = pd.read_csv(&#39;1.txt&#39;, sep=&#39;文件中的特殊分隔符号&#39;)
</code></pre>
<h3 id="写入"><a href="#写入" class="headerlink" title="写入"></a>写入</h3><p>值得注意的是在写入文件之前要确保去掉默认的index，需要设置成自己指定的index，否则再读取文件时，会有一个unamed的列（之前的index列）。其实可以用后面学习的<code>skiprows</code>在读取时指定跳过多少行，以及<code>usecols</code>来跳过指定列</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,None,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,None,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
# 写入文件之前需要去掉默认的index
df.set_index(&#39;name&#39;, inplace=True)
df.to_excel(&#39;~/Desktop/1.xlsx&#39;)
# 读取数据时指定index
df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, index_col=&#39;name&#39;)
print(df)
</code></pre>
<pre><code class="python">df.to_excel(&#39;~/Desktop/1.xlsx&#39;)

df.to_json(&#39;~/Desktop/test.json&#39;)

df.to_sql(&#39;ssacount&#39;, con)
</code></pre>
<p><strong>PS:</strong> 按照目前我的理解，pandas可以完美的完成这些数据文件之间的转换。可以将json，数据库中的数据导入到excel中进行可视化操作。</p>
<h1 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h1><p>作为最重要的一个部分，DataFrame包含了几百种方法和操作，可以对数据进行任何的分析与处理。</p>
<h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><p>创建的方式比较多，但通常都是使用<code>dict</code>来创建。</p>
<pre><code class="python">import pandas as pd

data = &#123;
        &quot;name&quot;:[&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], 
        &quot;age&quot;:[21,22,24], 
        &quot;score&quot;:[80,90,100]
       &#125;
df = pd.DataFrame(data)
print(df)
</code></pre>
<p>每一对key-value作为一个Series(column)，key作为表头，value作为数据</p>
<h2 id="自己指定index"><a href="#自己指定index" class="headerlink" title="自己指定index"></a>自己指定index</h2><p>默认会自动创建一个index列，为从0开始的连续数据。可以自己指定某列为索引列</p>
<pre><code class="python"># 使用set_index()方法
df = df.set_index(&quot;name&quot;)

# 或者在DataFrame中指定index
df = pd.DataFrame(data, index=[&#39;一班&#39;,&#39;二班&#39;,&#39;二班&#39;])
</code></pre>
<p>需要注意的是这个index的数据是可以重复的，并不需要唯一性</p>
<h2 id="通过index找出对应数据"><a href="#通过index找出对应数据" class="headerlink" title="通过index找出对应数据"></a>通过index找出对应数据</h2><p>可以通过<code>loc</code>找出来的条件是设置了index，否则无法找到</p>
<pre><code class="python">sear = df.loc[&#39;一班&#39;]
print(sear)

name     韩信
age      21
score    80
Name: 一班, dtype: object
</code></pre>
<p>可以看出index与其对应数据也是一个<code>dict</code>数据类型</p>
<p>即使设置了index，也可以通过默认的index来查找<code>iloc</code></p>
<pre><code class="python">sear = df.iloc[1]
</code></pre>
<h2 id="指定header"><a href="#指定header" class="headerlink" title="指定header"></a>指定header</h2><p>默认header=0,会使用第0行（index为空）/excel中的第一行作为header，即columns</p>
<pre><code class="python">df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, header=1)
</code></pre>
<p>重新自定义header，能够自定义成功的前提是这个文件本身就没有header，否则原来的header会作为一个数据行成为index=0的那一行</p>
<pre><code class="python">df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, header=None)
# 取指定列
df = df[[1,3]]
# 设置header
df.columns = [1,2]
</code></pre>
<h2 id="查看开头和结尾"><a href="#查看开头和结尾" class="headerlink" title="查看开头和结尾"></a>查看开头和结尾</h2><pre><code class="python"># 默认为5行
df.head()
df.tail()

# 可以自己指定显示多少行
df.head(20)
df.tail(20)
</code></pre>
<h2 id="查看数据信息"><a href="#查看数据信息" class="headerlink" title="查看数据信息"></a>查看数据信息</h2><p><code>.info()</code>提供了很重要的一些信息，包括行，列，数据是否为空，数据类型，内存占用等</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,22,24], &quot;score&quot;:[80,80,100]&#125;
df = pd.DataFrame(data)
info = df.info()
print(info)

&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 3 entries, 0 to 2
Data columns (total 3 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   name    3 non-null      object
 1   age     3 non-null      int64 
 2   score   3 non-null      int64 
dtypes: int64(2), object(1)
memory usage: 200.0+ bytes
None
</code></pre>
<h2 id="查看行列数"><a href="#查看行列数" class="headerlink" title="查看行列数"></a>查看行列数</h2><p><code>.shape</code>提供了一个简单快速查看总行数，列数的信息(rows,columns)</p>
<pre><code class="python">info = df.shape
print(info)

(3,3)
</code></pre>
<h2 id="添加与去重"><a href="#添加与去重" class="headerlink" title="添加与去重"></a>添加与去重</h2><h3 id="添加DataFrame"><a href="#添加DataFrame" class="headerlink" title="添加DataFrame"></a>添加DataFrame</h3><ul>
<li>df.append()</li>
<li>pandas.concat([])</li>
</ul>
<p><code>.append()</code>可以将已有的DataFrame追加。但是index不会自动变化，要是index自动变化，需要调用<code>reset_index(drop=True)</code></p>
<p>append如果需要将Series追加到行后面，必须加一个参数<code>ignore_index=True</code></p>
<pre><code class="python">import pandas as pd
import pymysql

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
tmp_df = df.append(df)
print(tmp_df)

    name  age  score
0   韩信   21     80
1   韩信   21     80
2   李白   22     80
3   杜甫   24    100
0   韩信   21     80
1   韩信   21     80
2   李白   22     80
3   杜甫   24    100
</code></pre>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
tmp_df = df.append(df).reset_index(drop=True)
print(tmp_df)

    name  age  score
0   韩信   21     80
1   韩信   21     80
2   李白   22     80
3   杜甫   24    100
4   韩信   21     80
5   韩信   21     80
6   李白   22     80
7   杜甫   24    100
</code></pre>
<p>使用concat默认y轴添加，使用axis=1则x轴添加</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
tmp_df = pd.concat([df,df], axis=0).reset_index(drop=True)
print(tmp_df)
</code></pre>
<h3 id="添加Series"><a href="#添加Series" class="headerlink" title="添加Series"></a>添加Series</h3><pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
add = pd.Series(&#123;&#39;name&#39;:&#39;筱倩&#39;, &#39;age&#39;:30, &#39;score&#39;:88&#125;)
df = df.append(add, ignore_index=True)
print(df)

    name  age  score
0   韩信   21     80
1   韩信   21     80
2   李白   22     80
3   杜甫   24    100
4   筱倩   30     88
</code></pre>
<h3 id="添加列"><a href="#添加列" class="headerlink" title="添加列"></a>添加列</h3><pre><code class="python">df[&#39;column_name&#39;] = []
tmp_df[&#39;add&#39;] = [i for i in range(max(tmp_df.index)+1)]
</code></pre>
<h3 id="找到重复数据"><a href="#找到重复数据" class="headerlink" title="找到重复数据"></a>找到重复数据</h3><p><code>df.dumpllicateed(subset=&#39;column_name&#39;)</code>可以找出指定列的重复index，和True/False的Series。那么如何通过index来找到真正的重复数据？可以通过循环，其实更加简单的方式是使用<code>df.iloc[index]</code>定位</p>
<pre><code class="python">import pandas as pd
import pymysql

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
dum = df.duplicated(subset=&#39;name&#39;)
# 查看是否存在重复数据
print(dum.any())
dum = dum[dum == True] #可以简化为dum = dum[dum]
info = df.iloc[dum.index]
print(info)

True
    name  age  score
1   韩信   21     80
</code></pre>
<h3 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h3><p><code>.drop_duplicates()</code>可以将追加的重复数据清除，需要加上<code>inplace=True</code>这个参数，否则不会生效。</p>
<ul>
<li>默认会对整个表的数据进行去重，如果需要对指定列，那么添加参数<code>subset=&#39;column_name&#39;</code></li>
</ul>
<pre><code class="python">tmp_df.drop_duplicates(subset=&#39;score&#39;, inplace=True)

    name  age  score
0   韩信   21     80
2   李白   22     80
3   杜甫   24    100
</code></pre>
<p><code>.drop_duplicates()</code>的<code>keep</code>参数：</p>
<ul>
<li>first，保留第一次出现的，默认</li>
<li>last，保留最后一次出现的</li>
<li>False，去除所有重复数据</li>
</ul>
<pre><code class="python">tmp_df.drop_duplicates(inplace=True, keep=&#39;first&#39;)

    name  age  score
0   韩信   21     80
2   李白   22     80
3   杜甫   24    100
</code></pre>
<pre><code class="python">tmp_df.drop_duplicates(inplace=True, keep=&#39;last&#39;)

    name  age  score
1   韩信   21     80
2   李白   22     80
3   杜甫   24    100
</code></pre>
<pre><code class="python">tmp_df.drop_duplicates(inplace=True, keep=False)

Empty DataFrame
Columns: [name, age, score]
Index: []
</code></pre>
<h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><p>通过df[‘column_name’]/df.column_name可以获取Series，通过Series[index]可以获取到指定的值</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
df.name[1] = &#39;筱倩&#39;
df.age[1] = 99
print(df)

    name  age  score
0   韩信   21     80
1   筱倩   99     80
2   李白   22     80
3   杜甫   24    100
</code></pre>
<h2 id="替换"><a href="#替换" class="headerlink" title="替换"></a>替换</h2><p>使用到了<code>df.iloc[index]</code>定位，并用Series进行替换</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
alert = pd.Series(&#123;&#39;name&#39;:&#39;筱倩&#39;, &#39;age&#39;:30, &#39;score&#39;:88&#125;)
df.iloc[1] = alert
print(df)
</code></pre>
<h2 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h2><h3 id="行"><a href="#行" class="headerlink" title="行"></a>行</h3><p>使用到了df[]切片以及追加操作。值得注意的是：在python中可以对list进行切片，但是在pandas中还可以对DataFrame这种二维数据进行切片</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
insert = pd.Series(&#123;&#39;name&#39;:&#39;筱倩&#39;, &#39;age&#39;:30, &#39;score&#39;:88&#125;)
part1 = df[:2]
part2 = df[2:]
df = part1.append(insert, ignore_index=True).append(part2).reset_index(drop=True)
print(df)

    name  age  score
0   韩信   21     80
1   韩信   21     80
2   筱倩   30     88
3   李白   22     80
4   杜甫   24    100
</code></pre>
<h3 id="列"><a href="#列" class="headerlink" title="列"></a>列</h3><pre><code class="python"># num为想插入到第几列前面
df.insert(num, column=&#39;column_name&#39;, value=[])
</code></pre>
<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><h3 id="行-1"><a href="#行-1" class="headerlink" title="行"></a>行</h3><p>两种方法：</p>
<ul>
<li>使用到了<code>df.drop(index=[], inplace=True)</code></li>
<li>可以使用切片，将需要的数据切出来然后append组合</li>
</ul>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;韩信&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)
insert = pd.Series(&#123;&#39;name&#39;:&#39;筱倩&#39;, &#39;age&#39;:30, &#39;score&#39;:88&#125;)
part1 = df[:1]
part2 = df[2:]
# index后面可以跟一个list集合，也可以是一个range()函数
df.drop(index=2, inplace=True)
# 使用切片然后组合
# df = part1.append(part2).reset_index(drop=True)
print(df)
</code></pre>
<h3 id="列-1"><a href="#列-1" class="headerlink" title="列"></a>列</h3><pre><code class="python">df.drop(columns=[],inplace=True)
</code></pre>
<h2 id="columns"><a href="#columns" class="headerlink" title="columns"></a>columns</h2><p><code>.columns</code>可获取所有列名，返回的是一个列表</p>
<pre><code class="python">print(df.columns)

Index([&#39;name&#39;, &#39;age&#39;, &#39;score&#39;], dtype=&#39;object&#39;)
</code></pre>
<p><code>.rename()</code>可修改列名</p>
<pre><code class="python">df.rename(columns=&#123;&#39;name&#39;:&#39;Name&#39;, &#39;age&#39;:&#39;AGE&#39;&#125;, inplace=True)
</code></pre>
<p><code>col.lower()</code>搭配列表生成式可以转换小写</p>
<pre><code class="python">df.columns = [col.lower() for col in df.columns]
</code></pre>
<h2 id="Null数据行清除"><a href="#Null数据行清除" class="headerlink" title="Null数据行清除"></a>Null数据行清除</h2><p><code>.isnull()</code>找出null数据，null数据显示True，非空数据显示False</p>
<pre><code class="python">print(df.isnull())
</code></pre>
<p><code>.sum()</code>计算总的null数据</p>
<pre><code class="python">print(df.isnull().sum())
</code></pre>
<p><code>.dropna()</code>删除有null数据的行，只要有一个null数据就会清除</p>
<pre><code class="python">df.dropna(inplace=True)
</code></pre>
<p>可以看到这种清除数据的缺点，无法对指定列的Null数据进行清除，所以需要使用到过滤</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,None,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,21,None,24], &quot;score&quot;:[80,80,80,100]&#125;
# 为了能够找到手动输入的None数据列，对其进行了转换
df = pd.DataFrame(data).fillna(0)

miss = df.loc[df.name == 0 ].index
df.drop(index=miss, inplace=True)
print(df)

    name   age  score
0   韩信  21.0     80
2   李白   0.0     80
3   杜甫  24.0    100
</code></pre>
<h2 id="Null数据列的清除"><a href="#Null数据列的清除" class="headerlink" title="Null数据列的清除"></a>Null数据列的清除</h2><p><code>.dropna(axis=1)</code>使用了一个参数axis</p>
<pre><code class="python">df.dropna(inplace=True, axis=1)
</code></pre>
<p>为什么是1？在我们使用df.shape的时候返回一个tuple，(rows,columns)，可以看出columns的索引为1</p>
<h2 id="使用mean来填充null数据列"><a href="#使用mean来填充null数据列" class="headerlink" title="使用mean来填充null数据列"></a>使用mean来填充null数据列</h2><p><code>.fillna(column_name, inplace=True)</code>如果将有null的数据列都删除的话， 那么数据的缺失会比较大，可以用平均值来填充</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,None,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,None,22,24], &quot;score&quot;:[80,80,80,100]&#125;
df = pd.DataFrame(data)

# 取出age列
age = df[&#39;age&#39;]
# 取平均值
age_mean = age.mean()
# 将age列中的null用平均值填充
age.fillna(age_mean, inplace=True)
print(df)
</code></pre>
<h2 id="获取数据描述"><a href="#获取数据描述" class="headerlink" title="获取数据描述"></a>获取数据描述</h2><p>前面用<code>.info()</code>获取了对DataFrame的描述，但是<code>.describe()</code>可以获取关于数据的描述：包括最大值，最小值，平均值，列数，行数等。既可以是整个DataFrame，也可以是某一列。</p>
<pre><code class="python"># 整个表
print(df.describe())
# age列
print(df[&#39;age&#39;].describe())
</code></pre>
<h2 id="查看某列数据相同数据的个数"><a href="#查看某列数据相同数据的个数" class="headerlink" title="查看某列数据相同数据的个数"></a>查看某列数据相同数据的个数</h2><p><code>.value_counts()</code>指定列的数据出现个数</p>
<pre><code class="python">print(df[&#39;score&#39;].value_counts())
</code></pre>
<h2 id="重组DataFrame"><a href="#重组DataFrame" class="headerlink" title="重组DataFrame"></a>重组DataFrame</h2><p><code>type(df[&#39;age&#39;])</code>的类型是一个serise，而<code>type(df[[&#39;age&#39;]])</code>的类型是一个DataFrame，所以可以使用这种方式来重新选取需要的列构成新的DataFrame</p>
<pre><code class="python">new_df = df[[&#39;name&#39;, &#39;age&#39;]]
print(new_df)
</code></pre>
<h2 id="数据的过滤"><a href="#数据的过滤" class="headerlink" title="数据的过滤"></a>数据的过滤</h2><h3 id="在Series的基础上过滤"><a href="#在Series的基础上过滤" class="headerlink" title="在Series的基础上过滤"></a>在Series的基础上过滤</h3><p>用条件判断来过滤数据：<code>&gt; &lt; == !=</code>等</p>
<pre><code class="python">info = (df[&#39;score&#39;] == 80)
print(info)

# 可以得到true of false的返回值
0     True
1     True
2     True
3    False
</code></pre>
<p>如果想要直接得到过滤后的数据</p>
<pre><code class="python">info = df[df[&#39;score&#39;] == 80]
print(info)

   name   age  score
0    韩信  21.0     80
1   None   NaN     80
2    李白  22.0     80
</code></pre>
<p>还可以使用逻辑判断</p>
<pre><code class="python">info = df[(df[&#39;score&#39;] &gt; 80) | (df[&#39;age&#39;] == 22)]
</code></pre>
<p>使用<code>isin()</code>更加简洁</p>
<pre><code class="python">info = df[df[&#39;age&#39;].isin([21,22])]
</code></pre>
<p><em><strong>上面的所有方法都很简洁，但是数据量比较大的时候，效率就比较低</strong></em></p>
<p>所以我们需要使用函数来进行过滤，使用<code>.apply()</code>将column传递给函数</p>
<pre><code class="python">def filter_score(x):
    if x == 100:
        return True
    else:
        return False
info = df.loc[df[&#39;score&#39;].apply(filter_score)]
# 简化
info = df[df[&#39;score&#39;].apply(filter_score)]
# 简化，其实我不理解为什么可以这么写
info = df[df.score.apply(filter_score)]
</code></pre>
<p>可以使用匿名函数简化</p>
<pre><code class="python">info = df[df[&#39;score&#39;].apply(lambda x : x == 100)]
# 再简化
info = df[df.score.apply(lambda x : x == 100)]
</code></pre>
<h3 id="在DataFrame基础上过滤"><a href="#在DataFrame基础上过滤" class="headerlink" title="在DataFrame基础上过滤"></a>在DataFrame基础上过滤</h3><p><code>axis=1</code>表示每一行（x轴），<code>axis=0</code>表示每一列（y轴）</p>
<pre><code class="python">def filter_score(x):
    if x.score == 100:
        return True
    else:
        return False

info = df.apply(filter_score， axis=1)
print(info)
</code></pre>
<h2 id="从指定行或列开始读取"><a href="#从指定行或列开始读取" class="headerlink" title="从指定行或列开始读取"></a>从指定行或列开始读取</h2><p>可能表格并不是从第一行第一列开始写的，所以需要指定从哪里开始读取，否则会出现许多的unamed row和Nan值</p>
<pre><code class="python">import pandas as pd 

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;)
print(df)

# 这里包含了一个空行，和一个index列，读取的时候会出现这些问题
Unnamed: 0 Unnamed: 1 Unnamed: 2 Unnamed: 3
0         NaN       name        age      score
1         0.0         韩信         21         80
2         1.0         韩信         22         80
3         2.0         李白         22         80
4         3.0         杜甫         24        100
</code></pre>
<p>使用<code>skiprows(num)</code>和<code>usecols=[]</code>来选取需要的数据</p>
<pre><code class="python">import pandas as pd 

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, skiprows=1, usecols=[1,2,3])
# 或者使用列名指定
df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, skiprows=1, usecols=[&#39;name&#39;,&#39;age&#39;,&#39;score&#39;])
print(df)

# 这样就能读取需要的数据了
    name  age  score
0   韩信   21     80
1   韩信   22     80
2   李白   22     80
3   杜甫   24    100
</code></pre>
<h2 id="自动填充功能"><a href="#自动填充功能" class="headerlink" title="自动填充功能"></a>自动填充功能</h2><p>用python来实现excel中拖拽自动填充的功能，生成序列数据进行填充，比较复杂的是日期的处理</p>
<ul>
<li>连续数据：list赋值</li>
<li>交叉数据：三目运算</li>
<li>日期数据：自定义函数</li>
</ul>
<pre><code class="python">import pandas as pd
from datetime import date,timedelta

data = &#123;&#39;name&#39;:[&#39;李白&#39;,&#39;杜甫&#39;,&#39;白居易&#39;,&#39;王维&#39;], &#39;age&#39;:[None,None,None,None], &#39;birthday&#39;:[None,None,None,None], &#39;drink&#39;:[None,None,None,None]&#125;
df = pd.DataFrame(data)
print(df)

=======================================================================================
    name   age birthday drink
0   李白  None     None  None
1   杜甫  None     None  None
2  白居易  None     None  None
3   王维  None     None  None
=======================================================================================

# 初始化日期
start = date(1600,1,31)
# 定义日期处理函数，传一个开始日期以及添加的月份
def add_month(start_date, add_month):
    tmonth = start_date.month + add_month
    cyear = start_date.year + tmonth // 12 
    cmonth = 12 if tmonth % 12  == 0 else tmonth % 12
    cday = start_date.day
    # 由于不同月份的天数不同，所以需要考虑
    if cday &gt; 28:
        if cmonth == 2:
            cday = 29 if cyear % 4 == 0 and cyear % 100 != 0 or cyear % 400 == 0 else 28
        elif cday == 31 and cmonth in [1,3,5,7,8,10,12]:
            cday = 31
        elif cday == 31 and cmonth in [2,4,6,9,11]:
            cday = 30
    return date(cyear,cmonth,cday)

# 对age进行填充，使用到了list的赋值
df[&#39;age&#39;] = [i+20 for i in range(df.shape[1])]
# 使用循环index，来对每一项进行赋值
for i in df.index:
    # 用到了三目运算，实现交叉数据填充
    df[&#39;drink&#39;][i] = &#39;like&#39; if i % 2 == 0 else &#39;hate&#39;
    
    # day递增的情况：day的相加有对应的函数
    df[&#39;birthday&#39;][i] = start + timedelta(days=i)
    # year递增的情况：year的相加可以在year上直接添加
    df[&#39;birthday&#39;][i] = date(start.year+i, start.month, start.day)
    # month递增的情况：比较复杂，涉及到year与month进位的问题，调用自定义函数实现
    df[&#39;birthday&#39;][i] = add_month(start,i+10)

print(df)

=======================================================================================
    name  age    birthday drink
0   李白   20  1600-11-30  like
1   杜甫   21  1601-12-31  hate
2  白居易   22  1601-01-31  like
3   王维   23  1601-02-28  hate
=======================================================================================
</code></pre>
<h2 id="计算功能"><a href="#计算功能" class="headerlink" title="计算功能"></a>计算功能</h2><h3 id="x轴向乘法"><a href="#x轴向乘法" class="headerlink" title="x轴向乘法"></a>x轴向乘法</h3><p>使用到了pandas特有的list相乘，以及list展开相乘（这在python语法中是没有的，乘也是list的复制）</p>
<pre><code class="python">sr1 = pd.Series([21,18,22,24])
sr2 = pd.Series([80,80,80,100])
df = pd.DataFrame(&#123;&#39;A&#39;:sr1, &#39;B&#39;:sr2&#125;)
print(df)

# pandas的list乘
df[&#39;C&#39;] = df[&#39;A&#39;] * df[&#39;B&#39;]
df[&#39;D&#39;] = df[&#39;C&#39;] * 100
# 可以使用apply()
df[&#39;E&#39;] = df[&#39;B&#39;].apply(lambda x:x+2)

print(df)

A    B
0  21   80
1  18   80
2  22   80
3  24  100
    A    B     C       D    E
0  21   80  1680  168000   82
1  18   80  1440  144000   82
2  22   80  1760  176000   82
3  24  100  2400  240000  102
</code></pre>
<h3 id="x轴向求和-平均"><a href="#x轴向求和-平均" class="headerlink" title="x轴向求和/平均"></a>x轴向求和/平均</h3><p>前面都是使用的Series来进行计算的，如果需要的不止一列的数据呢？比如说需要每一行的和和平均值，当然也可以将所有列写出来计算，但是有点麻烦，其实可以指定轴。它会自动过滤掉文字列，只计算数字列。(索引不会计算)</p>
<p><code>axis=1</code>指定x轴，按行计算，从上到下</p>
<pre><code class="python">import pandas as pd
df1 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
df2 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet2&#39;)

table = df1.join(df2, how=&#39;left&#39;).fillna(0)
table[&#39;qq&#39;] = table[&#39;qq&#39;].astype(int)

table[&#39;sum&#39;] = table.sum(axis=1)
table[&#39;mean&#39;] = table.mean(axis=1).astype(int)
print(table)

    name  age  score student          qq         sum        mean
0   韩信   21     80      韩信   124242423   124242524    62121262
1   赵云   22     10      赵云    12342356    12342388     6171194
2   李白   22     30      李白   574534563   574534615   287267307
3   杜甫   24    100      杜甫     6785842     6785966     3392983
4   曹操   18     75      曹操    34563342    34563435    17281717
5   姜尚   45     75      姜尚    57845262    57845382    28922691
6   阿狗   23     11      阿狗    45645834    45645868    22822934
7   筱倩    3     99      筱倩    58364743    58364845    29182422
8   夫子  123    107      夫子  4824854834  4824855064  2412427532
9   葛聂   33     90       0           0         123          61
</code></pre>
<h3 id="y轴向求和-平均并添加到DataFrame"><a href="#y轴向求和-平均并添加到DataFrame" class="headerlink" title="y轴向求和/平均并添加到DataFrame"></a>y轴向求和/平均并添加到DataFrame</h3><ul>
<li>必须设置<code>ignore_index=True</code>，否则无法添加</li>
</ul>
<pre><code class="python">import pandas as pd
df1 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
df2 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet2&#39;)

table = df1.join(df2, how=&#39;left&#39;).fillna(0)
table[&#39;qq&#39;] = table[&#39;qq&#39;].astype(int)

# 这里省略了axis=0,因为这是默认值
total = table.mean()
sum = table.sum()
# total为一个Series，可以设置name值
total[&#39;name&#39;] = &#39;平均值&#39;
sum[&#39;name&#39;] = &#39;总和&#39;
# 将Nan转为空
table = table.append([total,sum], ignore_index=True).fillna(&#39;&#39;)
print(table)

name    age  score student            qq
0    韩信   21.0   80.0      韩信  1.242424e+08
1    赵云   22.0   10.0      赵云  1.234236e+07
2    李白   22.0   30.0      李白  5.745346e+08
3    杜甫   24.0  100.0      杜甫  6.785842e+06
4    曹操   18.0   75.0      曹操  3.456334e+07
5    姜尚   45.0   75.0      姜尚  5.784526e+07
6    阿狗   23.0   11.0      阿狗  4.564583e+07
7    筱倩    3.0   99.0      筱倩  5.836474e+07
8    夫子  123.0  107.0      夫子  4.824855e+09
9    葛聂   33.0   90.0       0  0.000000e+00
10  平均值   33.4   67.7          5.739179e+08
11   总和  334.0  677.0          5.739179e+09
</code></pre>
<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><p><code>.sort_values(by=[],inplace=True,ascending=[False])</code></p>
<p>默认生成一个新的DataFrame，使用inplace=True在原DataFrame上修改</p>
<p>默认使用升序排列，用ascending=False来降序排列</p>
<ol>
<li>对一列数据进行排序</li>
</ol>
<pre><code class="python">import pandas as pd

sr2 = pd.Series([21,18,22,22,24])
sr3 = pd.Series([80,80,60,80,100])
df = pd.DataFrame(&#123;&#39;A&#39;:sr2, &#39;B&#39;:sr3&#125;)
df.set_index(&#39;A&#39;, inplace=True)
df.sort_values(by=&#39;A&#39;, inplace=True, ascending=False)
print(df)
</code></pre>
<ol start="2">
<li>对多列数据进行排序，而且第一列倒序，第二列升序</li>
</ol>
<pre><code class="python">import pandas as pd

sr2 = pd.Series([21,18,22,22,24])
sr3 = pd.Series([80,80,60,80,100])
df = pd.DataFrame(&#123;&#39;A&#39;:sr2, &#39;B&#39;:sr3&#125;)
df.set_index(&#39;A&#39;, inplace=True)
df.sort_values(by=[&#39;A&#39;,&#39;B&#39;], inplace=True, ascending=[False,True])
print(df)
</code></pre>
<h2 id="数据相关性"><a href="#数据相关性" class="headerlink" title="数据相关性"></a>数据相关性</h2><p>之前在一篇文章中看到<code>df.corr()</code>时，没看懂它到底什么意思，有什么作用。今天看了老师讲的视频，才发现这个东西超级无敌厉害。它就是分析一个表中每两列数据之间的相关性的。</p>
<ul>
<li>1.0代表完全相关</li>
<li>比例越大，相关性越大</li>
</ul>
<pre><code class="python">import pandas as pd

sr2 = pd.Series([21,18,22,22,24])
sr3 = pd.Series([80,80,60,80,100])
df = pd.DataFrame(&#123;&#39;age&#39;:sr2, &#39;score&#39;:sr3&#125;)
df.corr()


# 可以看出score与age之间的相关性比较小，仅有0.3
            age    score
age        1.000000    0.322749
score    0.322749    1.000000
</code></pre>
<h2 id="从不同sheet页读取"><a href="#从不同sheet页读取" class="headerlink" title="从不同sheet页读取"></a>从不同sheet页读取</h2><pre><code class="python">import pandas as pd
df1 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
df2 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet2&#39;)

print(df1)
print(df2)
# table = df1.merge(df2, on=&#39;name&#39;)
# print(table)
    name  age  score
0   韩信   21     80
1   赵云   22     10
2   李白   22     30
3   杜甫   24    100
4   曹操   18     75
5   姜尚   45     75
6   阿狗   23     11
7   筱倩    3     99
8   夫子  123    107
9   葛聂   33     90
  name          qq
0   韩信   124242423
1   赵云    12342356
2   李白   574534563
3   杜甫     6785842
4   曹操    34563342
5   姜尚    57845262
6   阿狗    45645834
7   筱倩    58364743
8   夫子  4824854834
</code></pre>
<h2 id="多表联合查询"><a href="#多表联合查询" class="headerlink" title="多表联合查询"></a>多表联合查询</h2><p>用到了与数据库类似的操作，merge两个DataFrame，默认为inner join,可以设置left/right join</p>
<ul>
<li><code>df.merge()</code>需要指定关联的列，具有内连接，左/右连接</li>
<li><code>df.join()</code>默认使用index作为关联的列，不具有内连接，左/右连接</li>
<li><code>pandas.concat([],axis=num)</code></li>
</ul>
<pre><code class="python">import pandas as pd
df1 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
df2 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet2&#39;)

table = df1.merge(df2, on=&#39;name&#39;)
print(table)

    name  age  score          qq
0   韩信   21     80   124242423
1   赵云   22     10    12342356
2   李白   22     30   574534563
3   杜甫   24    100     6785842
4   曹操   18     75    34563342
5   姜尚   45     75    57845262
6   阿狗   23     11    45645834
7   筱倩    3     99    58364743
8   夫子  123    107  4824854834
</code></pre>
<p>可以发现默认是使用的inner join，要df1的数据全部显示出来，使用left join方式</p>
<pre><code class="python">table = df1.merge(df2, how=&#39;left&#39;, on=&#39;name&#39;)
</code></pre>
<p>如果要关联的两张表的columns名字不同，那么不能使用<code>on</code>，而需要使用<code>left_on=&#39;&#39;,right_on=&#39;&#39;</code>来连接</p>
<pre><code class="python">    name  age  score
0   韩信   21     80
1   赵云   22     10
2   李白   22     30
3   杜甫   24    100
4   曹操   18     75
5   姜尚   45     75
6   阿狗   23     11
7   筱倩    3     99
8   夫子  123    107
9   葛聂   33     90

  student          qq
0      韩信   124242423
1      赵云    12342356
2      李白   574534563
3      杜甫     6785842
4      曹操    34563342
5      姜尚    57845262
6      阿狗    45645834
7      筱倩    58364743
8      夫子  4824854834
</code></pre>
<p>关联之后数据会出现Nan值，使用<code>fillna()</code>函数来填充null</p>
<p>如果显示的是小数或者科学计数，可以使用<code>astype()</code>设置为数据类型</p>
<pre><code class="python">import pandas as pd

df1 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
df2 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet2&#39;)

table = df1.merge(df2, how=&#39;left&#39;, left_on=&#39;name&#39;, right_on=&#39;student&#39;).fillna(0)
table[&#39;qq&#39;] = table[&#39;qq&#39;].astype(int)
print(table)

    name  age  score student          qq
0   韩信   21     80      韩信   124242423
1   赵云   22     10      赵云    12342356
2   李白   22     30      李白   574534563
3   杜甫   24    100      杜甫     6785842
4   曹操   18     75      曹操    34563342
5   姜尚   45     75      姜尚    57845262
6   阿狗   23     11      阿狗    45645834
7   筱倩    3     99      筱倩    58364743
8   夫子  123    107      夫子  4824854834
9   葛聂   33     90       0           0
</code></pre>
<p>使用<code>join()</code>函数</p>
<pre><code class="python">import pandas as pd
df1 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
df2 = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, sheet_name=&#39;Sheet2&#39;)

table = df1.join(df2, how=&#39;left&#39;).fillna(0)
table[&#39;qq&#39;] = table[&#39;qq&#39;].astype(int)
print(table)

    name  age  score student          qq
0   韩信   21     80      韩信   124242423
1   赵云   22     10      赵云    12342356
2   李白   22     30      李白   574534563
3   杜甫   24    100      杜甫     6785842
4   曹操   18     75      曹操    34563342
5   姜尚   45     75      姜尚    57845262
6   阿狗   23     11      阿狗    45645834
7   筱倩    3     99      筱倩    58364743
8   夫子  123    107      夫子  4824854834
9   葛聂   33     90       0           0
</code></pre>
<h2 id="数据列分割"><a href="#数据列分割" class="headerlink" title="数据列分割"></a>数据列分割</h2><p>使用到了<code>Series.str.split()</code>方法，另外<code>Series.str</code>有很多方法可以用，可以对字符串进行各种操作。</p>
<pre><code class="python">import pandas as pd 

data = &#123;&#39;A&#39;:[&quot;hello joyce&quot; for i in range(1,8)]&#125;
df = pd.DataFrame(data)
# 不使用expand，那么数据会作为一个list
info = df.A.str.split(expand=True)
df[&#39;first&#39;] = info[0]
df[&#39;last&#39;] = info[1]
print(df)
</code></pre>
<h2 id="行列转换"><a href="#行列转换" class="headerlink" title="行列转换"></a>行列转换</h2><p><code>df.transpose()</code>即可，为了避免旋转后第一行为index，所以在读取的时候需要指定index</p>
<pre><code class="python">import pandas as pd

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, index_col=&#39;name&#39;)
df = df.transpose()
print(df)
</code></pre>
<h2 id="提取日期"><a href="#提取日期" class="headerlink" title="提取日期"></a>提取日期</h2><pre><code class="python">pandas.DatetimeIndex(df[&#39;column_name&#39;]).year
pandas.DatetimeIndex(df[&#39;column_name&#39;]).month
pandas.DatetimeIndex(df[&#39;column_name&#39;]).day
</code></pre>
<h2 id="分组，聚合"><a href="#分组，聚合" class="headerlink" title="分组，聚合"></a>分组，聚合</h2><p>模拟透视表功能</p>
<pre><code class="python">import pandas as pd
import numpy as np

df.pivot_table(index=&#39;column_name&#39;, columns=&#39;column_name&#39;, value=&#39;column_name&#39;, aggfunc=np.sum)
</code></pre>
<p>分组</p>
<pre><code class="python">groups = df.groupby(&#39;column_name&#39;)
</code></pre>
<p>聚合</p>
<pre><code class="python">S = groups[&#39;column_name&#39;].sum()
</code></pre>
<h2 id="条件颜色"><a href="#条件颜色" class="headerlink" title="条件颜色"></a>条件颜色</h2><pre><code class="python">import pandas as pd 

def colorlize(x):
    colors = &#39;orange&#39; if x &lt; 60 else &#39;lime&#39;
    # 这里返回的格式必须要是这样
    return f&#39;color:&#123;colors&#125;&#39;

def another(x):
    # 这里需要返回一个list
    return [&#39;color:red&#39; if v &gt; 90 else &#39;background-color:black&#39; for v in x] 
    
df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;)

# 可直接添加在后面
# df.style.apply(another, subset=[&#39;age&#39;,&#39;score&#39;])
df.style.applymap(colorlize, subset=[&#39;age&#39;,&#39;score&#39;]).apply(another, subset=[&#39;age&#39;,&#39;score&#39;])
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418202939418.png" alt="image-20200418202939418"></p>
<p>需要注意的：</p>
<ul>
<li><code>df.style.applymap()</code>获取到的是每一个值</li>
<li><code>df.style.apply()</code>获取到的是一个Series，但是需要用for循环读取每一个值，这和之前用的<code>df.apply()</code>自动循环每一个值不同</li>
</ul>
<h2 id="颜色条"><a href="#颜色条" class="headerlink" title="颜色条"></a>颜色条</h2><pre><code class="python">import pandas as pd 

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;)
df.style.bar(color=&#39;pink&#39;, subset=[&#39;age&#39;,&#39;score&#39;])
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418204331053.png" alt="image-20200418204331053"></p>
<h2 id="渐变颜色"><a href="#渐变颜色" class="headerlink" title="渐变颜色"></a>渐变颜色</h2><p>需要下载seaborn模块</p>
<pre><code class="python">pip install seaborn
</code></pre>
<pre><code class="python">import pandas as pd 
import seaborn as sn

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;)
color_map = sn.light_palette(&#39;pink&#39;, as_cmap=True)

df.style.background_gradient(color_map, subset=[&#39;age&#39;, &#39;score&#39;])
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418204439512.png" alt="image-20200418204439512"></p>
<hr>
<h1 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h1><h2 id="Series序列"><a href="#Series序列" class="headerlink" title="Series序列"></a>Series序列</h2><p>用来生成一维数据。类似list数据类型</p>
<pre><code class="python">import pandas as pd

data = &#123;&quot;name&quot;:[&quot;韩信&quot;,&quot;貂蝉&quot;,&quot;李白&quot;,&quot;杜甫&quot;], &quot;age&quot;:[21,18,22,24], &quot;score&quot;:[80,80,80,100]&#125;
sr = pd.Series(data)
print(sr)

name      [韩信, 貂蝉, 李白, 杜甫]
age       [21, 18, 22, 24]
score    [80, 80, 80, 100]
</code></pre>
<h2 id="Series组装DataFrame"><a href="#Series组装DataFrame" class="headerlink" title="Series组装DataFrame"></a>Series组装DataFrame</h2><ol>
<li>使用<code>dict</code>组装。不指定index时，使用默认的index</li>
</ol>
<pre><code class="python">import pandas as pd

sr1 = pd.Series([&quot;韩信&quot;,&quot;貂蝉&quot;,&quot;李白&quot;,&quot;杜甫&quot;])
sr2 = pd.Series([21,18,22,24])
sr3 = pd.Series([80,80,80,100])
df = pd.DataFrame(&#123;&#39;name&#39;:sr1, &#39;age&#39;:sr2, &#39;score&#39;:sr3&#125;)
print(df)

  name  age  score
0   韩信   21     80
1   貂蝉   18     80
2   李白   22     80
3   杜甫   24    100
</code></pre>
<ol start="2">
<li>还可以手动指定index</li>
</ol>
<pre><code class="python">import pandas as pd

sr1 = pd.Series([&quot;韩信&quot;,&quot;貂蝉&quot;,&quot;李白&quot;,&quot;杜甫&quot;], index=(1,2,3,4), name=&#39;name&#39;)
sr2 = pd.Series([21,18,22,24], index=(1,2,3,4), name=&#39;age&#39;)
sr3 = pd.Series([80,80,80,100], index=(1,2,3,4))
df = pd.DataFrame(&#123;sr1.name:sr1, sr2.name:sr2, sr3.name:sr3&#125;)
print(df)

  name  age  NaN
1   韩信   21   80
2   貂蝉   18   80
3   李白   22   80
4   杜甫   24  100
</code></pre>
<ol start="3">
<li>使用<code>list</code>组装。如果不指定index和name，那么会用默认的index来填充columns和index</li>
</ol>
<pre><code class="python">import pandas as pd

sr1 = pd.Series([&quot;韩信&quot;,&quot;貂蝉&quot;,&quot;李白&quot;,&quot;杜甫&quot;],  index=(1,2,3,4), name=&#39;name&#39;)
sr2 = pd.Series([21,18,22,24], index=(1,2,3,4), name=&#39;age&#39;)
sr3 = pd.Series([80,80,80,100], index=(1,2,3,4), name=&#39;score&#39;)
df = pd.DataFrame([sr1, sr2, sr3])
print(df)

        1   2   3    4
name   韩信  貂蝉  李白   杜甫
age    21  18  22   24
score  80  80  80  100
</code></pre>
<p><em>可以发现，使用list来组装DataFrame时，会将Series以行的形式展示。如果用dict来组装，那么会将Series以列的形式组装。</em></p>
<h2 id="DataFrame取出Series"><a href="#DataFrame取出Series" class="headerlink" title="DataFrame取出Series"></a>DataFrame取出Series</h2><p>两种方式：</p>
<ul>
<li>这种就是python自身的语法，DataFrame由字典组成，所以使用<code>df[&#39;column_name&#39;]</code>即可</li>
<li>使用pandas DataFrame数据结构的语法，<code>df.column_name</code>也可以</li>
</ul>
<hr>
<h1 id="制图"><a href="#制图" class="headerlink" title="制图"></a>制图</h1><p>pandas是构建于matplotlib之上，所以需要先下载</p>
<pre><code class="python"># matplotlib (3.2.1)                 - Python plotting package
pip install matplotlib
</code></pre>
<p>使用到的数据：</p>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417203430726.png" alt="1.xlsx"></p>
<h2 id="柱状图"><a href="#柱状图" class="headerlink" title="柱状图"></a>柱状图</h2><p>第一个例子：</p>
<pre><code class="python">import pandas as pd 
import matplotlib.pyplot as plt


df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, skiprows=1, usecols=[1,2,3,4])
# 先排score，再排age，从大到小
df.sort_values(by=[&#39;score&#39;,&#39;age&#39;], inplace=True, ascending=False)
# pandas支持制图
df.plot.bar(x=&#39;name&#39;, y=[&#39;score&#39;,&#39;age&#39;], color=[&#39;lightblue&#39;,&#39;orange&#39;])
# 紧凑显示
plt.tight_layout()
# 使用matplotlib来渲染
plt.show()
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417192602580.png" alt="image-20200417192602580"></p>
<h2 id="中文支持"><a href="#中文支持" class="headerlink" title="中文支持"></a>中文支持</h2><p>默认matplotlib无法显示中文，需要从matplotlib导入font_manager</p>
<pre><code class="python">from matplotlib import font_manager
</code></pre>
<p>查看有那些中文字体</p>
<pre><code class="shell">fc-list :lang=zh

/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc: WenQuanYi Micro Hei,文泉驛微米黑,文泉驿微米黑:style=Regular
/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc: WenQuanYi Micro Hei Mono,文泉驛等寬微米黑,文泉驿等宽微米黑:style=Regular
</code></pre>
<p>设置font变量</p>
<pre><code class="python">font = font_manager.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)
</code></pre>
<p>在需要显示中文的地方加上fontproperties属性。需要注意只有matplotlib才能加这个属性，所以在需要加这个属性的时候，要用matplotlib来设置</p>
<pre><code class="python">plt.xticks(rotation=40, fontproperties=font)
</code></pre>
<h2 id="使用matplotlib修饰"><a href="#使用matplotlib修饰" class="headerlink" title="使用matplotlib修饰"></a>使用matplotlib修饰</h2><p>matpllotlib比pandas自带的制图功能要多，可定制性更强。导入matplotlib的作用呢就是来补充pandas自身制图功能的一些不足，以及渲染图片。</p>
<p>由于pandas基于matplotlib，所以这两个可完美的搭配使用。在pandas搞不定的地方就用matplotlib来补充</p>
<h2 id="分组柱状图"><a href="#分组柱状图" class="headerlink" title="分组柱状图"></a>分组柱状图</h2><pre><code class="python">import pandas as pd 
import matplotlib.pyplot as plt
from matplotlib import font_manager

font = font_manager.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)

# 读取
df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, skiprows=1, usecols=[1,2,3,4])
# 排序
df.sort_values(by=[&#39;score&#39;,&#39;age&#39;], inplace=True, ascending=False)
# 用pandas自身绘制分组柱状图
df.plot.bar(x=&#39;name&#39;, y=[&#39;score&#39;,&#39;age&#39;], color=[&#39;lightblue&#39;,&#39;orange&#39;])
# pandas自身绘图的标签不支持中文，那么用matplotlib来让标签显示中文，以及设置一定旋转角度
# plt.xticks(rotation=20, fontproperties=font, fontsize=14)
# 上面这个无法设置旋转中心，所以使用下面的
# gca获取x轴，ha=&#39;right&#39;设置右端对齐
px = plt.gca()
px.set_xticklabels(df[&#39;name&#39;], rotation=20, ha=&#39;right&#39;, fontproperties=font, fontsize=14)
# gcf获取图形的布局
pf = plt.gcf()
pf.subplots_adjust(left=0.1)
# 用matplotlib来设置x轴名称
plt.xlabel(&#39;name&#39;, fontsize=20)
# 用matplotlib来设置y轴名称
plt.ylabel(&#39;score&#39;, fontsize=20)
# 用matplotlib来设置title
plt.title(&#39;学习情况统计表&#39;, fontproperties=font, fontsize=24, color=&#39;lightpink&#39;)
plt.tight_layout()
plt.show()
</code></pre>
<p><img src="/home/narcissus/Desktop/Figure_1.png"></p>
<h2 id="叠加柱状图"><a href="#叠加柱状图" class="headerlink" title="叠加柱状图"></a>叠加柱状图</h2><ul>
<li>需要自己新计算一个新的列，这个列的值为需要叠加的数据之和</li>
<li>使用这个新的列作为排序的标准</li>
<li>y轴仍然为之前的列</li>
<li>只不过在df.plot.bar显示的时候加了一个参数<code>stacked=True</code>，声明使用叠加的方式</li>
</ul>
<pre><code class="python">import pandas as pd 
import matplotlib.pyplot  as plt 
from matplotlib import font_manager

font = font_manager.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, usecols=[1,2,3,4,5], skiprows=1)
df[&#39;total&#39;] = df[&#39;age&#39;] + df[&#39;score&#39;]
df.sort_values(by=&#39;total&#39;, inplace=True, ascending=False)
df.plot.bar(x=&#39;name&#39;, y=[&#39;score&#39;, &#39;age&#39;], color=[&#39;brown&#39;,&#39;pink&#39;], stacked=True)
px = plt.gca()
px.set_xticklabels(df[&#39;name&#39;], rotation=10, ha=&#39;right&#39;, fontproperties=font)
plt.xlabel(&#39;name&#39;)
plt.ylabel(&#39;count&#39;)
plt.title(&#39;学习情况统计&#39;, fontproperties=font, fontsize=22, fontweight=&#39;bold&#39;)
plt.show()
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417202420437.png" alt="image-20200417202420437"></p>
<h2 id="水平叠加柱状图"><a href="#水平叠加柱状图" class="headerlink" title="水平叠加柱状图"></a>水平叠加柱状图</h2><p>其实只需要改一个参数就可以了，将<code>df.plot.bar</code>改为<code>df.plot.barh</code>就代表水平展示了。</p>
<ul>
<li>这个时候的排序可能需要调整一下</li>
<li>如果自定义了x轴，y轴的话，需要交换一下</li>
</ul>
<pre><code class="python">import pandas as pd 
import matplotlib.pyplot  as plt 
from matplotlib import font_manager

font = font_manager.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, usecols=[1,2,3,4,5], skiprows=1)
df[&#39;total&#39;] = df[&#39;age&#39;] + df[&#39;score&#39;]
df.sort_values(by=&#39;total&#39;, inplace=True)
df.plot.barh(x=&#39;name&#39;, y=[&#39;score&#39;, &#39;age&#39;], color=[&#39;brown&#39;,&#39;pink&#39;], stacked=True)
px = plt.gca()
px.set_yticklabels(df[&#39;name&#39;], rotation=10, ha=&#39;right&#39;, fontproperties=font)
plt.xlabel(&#39;count&#39;)
plt.ylabel(&#39;name&#39;)
plt.title(&#39;学习情况统计&#39;, fontproperties=font, fontsize=22, fontweight=&#39;bold&#39;)
plt.show()
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417202957849.png" alt="image-20200417202957849"></p>
<h2 id="饼图"><a href="#饼图" class="headerlink" title="饼图"></a>饼图</h2><p>绘制饼图的优点是可以清晰的看出各部分所占的比例</p>
<p>与柱状图不同，饼图需要的数据为一个Series，同时在读取数据的时候指定的index会成为饼图显示的信息</p>
<ul>
<li>饼图注意点还挺多的，最为重要的就是使用pandas来绘制，无法显示中文，所以采用了plt来绘制</li>
<li>采用matplotlib时，也无法直接设置字体，需要用循环给具体的对象赋值</li>
<li>对序列排序，并通过绘制时的顺时针来设置旋转方向</li>
<li>通过startangle来设置最大值从12点方向开始</li>
</ul>
<pre><code class="python">import pandas as pd 
from matplotlib import font_manager as fm 
from matplotlib import pyplot as plt 

font = fm.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)
df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, skiprows=1, usecols=[1,2,3,4])
# 为了顺序显示，进行排序。这里没有从大到小排是因为后面绘制的时候可以使用counterclock来设置顺时针排序
df.sort_values(by=&#39;score&#39;, inplace=True)
# 使用pandas自身的绘图，无法显示中文，所以不采用
# df[&#39;score&#39;].plot.pie(labels=df[&#39;name&#39;])
# 使用matplotlib来绘制图形，label为标签名
paint = plt.pie(df[&#39;score&#39;], labels=df[&#39;name&#39;], counterclock=True, startangle=-270)
# 即便是通过matplotlib来绘制，中文也不好显示，只能通过返回值来找到text所在位置，并循环设置中文字体
for i in df.index:
    paint[1][i].set_fontproperties(font)
plt.title(&#39;学习情况统计&#39;, fontproperties=font, fontsize=22, fontweight=&#39;bold&#39;)
# ylabel来设置左边显示文字
plt.ylabel(&#39;score&#39;, fontsize=16)
plt.show()
</code></pre>
<p>对数据进行排序之后会出现，比例较小的部分字重叠，这也是一个问题。</p>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417220253777.png" alt="排序"></p>
<p>所以不对其进行排序显示的效果可能会更好。</p>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417220601412.png" alt="未排序"></p>
<h2 id="折线图"><a href="#折线图" class="headerlink" title="折线图"></a>折线图</h2><ul>
<li>折线图在绘制的时候，只要直接使用<code>.plot</code>就可以了。需要指定y轴的数据</li>
<li>x轴的数据可以通过指定index来设置</li>
</ul>
<pre><code class="python">import pandas as pd 
from matplotlib import pyplot as plt 
from matplotlib import font_manager as fm 

font = fm.FontProperties(fname=&#39;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&#39;)
data = &#123;&#39;score&#39;:[45,76,56,100,93], &#39;age&#39;:[16,18,24,29,35]&#125;
df = pd.DataFrame(data)
df.plot(y=[&#39;score&#39;,&#39;age&#39;])

plt.title(&#39;年龄与分数走势图&#39;,fontproperties=font, fontsize=22)
plt.xlabel(&#39;time&#39;)
plt.xticks(df.index)
plt.ylabel(&#39;count&#39;)
plt.show()
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417223035065.png" alt="image-20200417223035065"></p>
<h2 id="叠加区域图"><a href="#叠加区域图" class="headerlink" title="叠加区域图"></a>叠加区域图</h2><p>只需要在折线图的基础上将<code>.plot</code>改为<code>.plot.area</code>即可</p>
<pre><code class="python">df.plot.area(y=[&#39;score&#39;,&#39;age&#39;])
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417223407312.png" alt="image-20200417223407312"></p>
<h2 id="散点图"><a href="#散点图" class="headerlink" title="散点图"></a>散点图</h2><p>散点图就可以看出pandas的处理速度完胜excel，同时交换x，y轴数据，pandas可以轻松搞定，而excel在数据量多的时候无法操作。</p>
<ul>
<li>使用到了<code>df.plot.scatter()</code>来画散点图</li>
</ul>
<pre><code class="python">import pandas as pd
from matplotlib import pyplot as plt
from matplotlib import font_manager as fm 

font = fm.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, skiprows=1, usecols=[1,2,3,4])
df.plot.scatter(x=&#39;score&#39;, y=&#39;age&#39;, color=&#39;brown&#39;)
plt.title(&#39;学习与年龄散点图&#39;, fontproperties=font, fontsize=22)
plt.show()
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418095053048.png" alt="image-20200418095053048"></p>
<h2 id="分布图"><a href="#分布图" class="headerlink" title="分布图"></a>分布图</h2><p>可以清晰的看出指定数据的分布情况。分布图只需要Series就可以</p>
<ul>
<li>使用了<code>Series.plot.hist(bins=num)</code></li>
<li>参数bins设置划分区间，越多图越精细</li>
<li><code>plt.xticks()</code>设置x轴的分段，默认Series分段少，使用range()函数，来设置步长</li>
</ul>
<pre><code class="python">import pandas as pd
from matplotlib import pyplot as plt
from matplotlib import font_manager as fm 

font = fm.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, skiprows=1, usecols=[1,2,3,4])
df[&#39;score&#39;].plot.hist(bins=10)
plt.xticks(range(0,max(df[&#39;score&#39;]),4), rotation=90)
plt.xlabel(&#39;score&#39;)
plt.title(&#39;分数分布图&#39;, fontproperties=font, fontsize=20)
plt.show()
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418103216628.png" alt="image-20200418103216628"></p>
<h2 id="密度图"><a href="#密度图" class="headerlink" title="密度图"></a>密度图</h2><p>直接使用会报错，提示缺少一个scipy的科学库</p>
<pre><code class="python"># scipy (1.4.1)                   - SciPy: Scientific Library for Python
pip install scipy
</code></pre>
<p>密度图同样使用Series</p>
<ul>
<li>使用<code>Series.plot.kde()</code>,其它与分布图类似</li>
</ul>
<pre><code class="python">import pandas as pd
from matplotlib import pyplot as plt
from matplotlib import font_manager as fm 

font = fm.FontProperties(fname=&quot;/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc&quot;)

df = pd.read_excel(&#39;~/Desktop/1.xlsx&#39;, skiprows=1, usecols=[1,2,3,4])
df[&#39;score&#39;].plot.kde()
plt.xlabel(&#39;score&#39;)
plt.title(&#39;密度分布图&#39;, fontproperties=font, fontsize=20)
plt.show()
</code></pre>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418104716779.png" alt="image-20200418104716779"></p>
<hr>
<p>终于一口气学完了这个模块，感觉功能确实很多，而且没学到的功能还有很多。但是就目前掌握的这些来说，写个自动化办公的脚本来说已经够了。数据的读取，增删查改，制图等等功能都很好用。虽然是一边看视频，一边敲代码，但是熟悉程度还不够，还的在日常的生活中多用才会熟练。学完一个东西觉得很开心，但是又觉得有点失落，因为我接下来要学什么呢？是个很大的问题。要不学学powershell吧！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://raw.githubusercontent.com/ssfwshutterbug/ssfwshutterbug.github.io/main/2022/04/23/pandas/" data-id="cl9ktb7vc001wdta8aod0c6ee" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/04/23/podman/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          podman
        
      </div>
    </a>
  
  
    <a href="/2022/04/23/openssh/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">openssh</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/learn/">learn</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/think/">think</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/thinking/">thinking</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%BB%E5%8E%86%E5%8F%B2/">读历史</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/anaconda/" rel="tag">anaconda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/anbox/" rel="tag">anbox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/" rel="tag">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/archlinux/" rel="tag">archlinux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/boring/" rel="tag">boring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/container/" rel="tag">container</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cursor-theme/" rel="tag">cursor theme</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ed/" rel="tag">ed</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grub/" rel="tag">grub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/haskell/" rel="tag">haskell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/inject-js-css/" rel="tag">inject js/css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/" rel="tag">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mind/" rel="tag">mind</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/optimized/" rel="tag">optimized</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pentablet/" rel="tag">pentablet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/positive/" rel="tag">positive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reality-is-aweful/" rel="tag">reality is aweful</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/route/" rel="tag">route</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rust/" rel="tag">rust</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shield/" rel="tag">shield</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/" rel="tag">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tcp/" rel="tag">tcp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vbox/" rel="tag">vbox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xmonad/" rel="tag">xmonad</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zabbix/" rel="tag">zabbix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zk/" rel="tag">zk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zsh/" rel="tag">zsh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%9D%E7%BB%AA/" rel="tag">思绪</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A5%9E%E8%AF%9D/" rel="tag">神话</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%89%AF%E7%9F%A5/" rel="tag">良知</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/anaconda/" style="font-size: 10px;">anaconda</a> <a href="/tags/anbox/" style="font-size: 10px;">anbox</a> <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/archlinux/" style="font-size: 10px;">archlinux</a> <a href="/tags/boring/" style="font-size: 10px;">boring</a> <a href="/tags/container/" style="font-size: 10px;">container</a> <a href="/tags/cursor-theme/" style="font-size: 10px;">cursor theme</a> <a href="/tags/ed/" style="font-size: 10px;">ed</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/go/" style="font-size: 10px;">go</a> <a href="/tags/grub/" style="font-size: 10px;">grub</a> <a href="/tags/haskell/" style="font-size: 10px;">haskell</a> <a href="/tags/inject-js-css/" style="font-size: 10px;">inject js/css</a> <a href="/tags/iptables/" style="font-size: 10px;">iptables</a> <a href="/tags/k8s/" style="font-size: 20px;">k8s</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/mind/" style="font-size: 10px;">mind</a> <a href="/tags/optimized/" style="font-size: 10px;">optimized</a> <a href="/tags/pentablet/" style="font-size: 10px;">pentablet</a> <a href="/tags/positive/" style="font-size: 10px;">positive</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/reality-is-aweful/" style="font-size: 10px;">reality is aweful</a> <a href="/tags/route/" style="font-size: 10px;">route</a> <a href="/tags/rust/" style="font-size: 10px;">rust</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/shield/" style="font-size: 10px;">shield</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/tcp/" style="font-size: 10px;">tcp</a> <a href="/tags/vbox/" style="font-size: 10px;">vbox</a> <a href="/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/tags/xmonad/" style="font-size: 20px;">xmonad</a> <a href="/tags/zabbix/" style="font-size: 10px;">zabbix</a> <a href="/tags/zk/" style="font-size: 10px;">zk</a> <a href="/tags/zsh/" style="font-size: 10px;">zsh</a> <a href="/tags/%E6%80%9D%E7%BB%AA/" style="font-size: 15px;">思绪</a> <a href="/tags/%E7%A5%9E%E8%AF%9D/" style="font-size: 10px;">神话</a> <a href="/tags/%E8%89%AF%E7%9F%A5/" style="font-size: 10px;">良知</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/10/23/our-body-may-cheat-ourselves-md/">our-body-may-cheat-ourselves.md</a>
          </li>
        
          <li>
            <a href="/2022/07/04/the-reality/">the-reality</a>
          </li>
        
          <li>
            <a href="/2022/06/25/%E4%BB%8E%E5%AE%B9/">从容</a>
          </li>
        
          <li>
            <a href="/2022/06/25/magic-of-xmonad/">magic-of-xmonad</a>
          </li>
        
          <li>
            <a href="/2022/06/24/xp-pentablet/">xp-pentablet</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 shutterbug<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>