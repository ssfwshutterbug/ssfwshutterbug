<!DOCTYPE html>
<html>
	<head>
		
<title>firefox-extension-Quiet</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" type="image/x-icon" href="/image/favicon.ico">

<link rel="stylesheet" href="/css/index.css">



<meta name="keywords" content="inject js/css,">
<meta name="description" content="">


<script src="/js/jquery.min.js"></script>


<script src="/js/index.js"></script>


<script src="/js/fancybox.umd.js"></script>


<script src="/js/fancybox-images.js"></script>


<script src="/js/gitalk.min.js"></script>


<script src="/js/hljs.min.js"></script>
 
<script>hljs.highlightAll();</script>

	<meta name="generator" content="Hexo 5.4.2"></head>

	<body>
		
	<div class="header">
		<div class="header-top" id="header-top">
			<div class="h-left">
				<a href="/">
					<img src="/image/logo.png" alt="Quiet">
				</a>
			</div>
			<div class="h-right">
				<ul>
					
						
								<li>
									<a href="/">
										HOME
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/archives">
										ARCHIVE
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/categories">
										CATEGORIES
									</a>
									<span class="dot"></span>
								</li>
								
									
						
								<li>
									<a href="/tags">
										TAGS
									</a>
									<span class="dot"></span>
								</li>
								
									
				</ul>
			</div>
			<div class="h-right-close">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
					<path fill="none" d="M0 0h24v24H0z" />
					<path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" fill="rgba(68,68,68,1)" />
				</svg>
			</div>
		</div>
	</div>
	<div class="sidebar">
    <div class="topo">
        <h2>Joey</h2>
    </div>
    <ul>
        
        <li>
            <a href="/">HOME</a>
        </li>
        
        <li>
            <a href="/archives">ARCHIVE</a>
        </li>
        
        <li>
            <a href="/categories">CATEGORIES</a>
        </li>
        
        <li>
            <a href="/tags">TAGS</a>
        </li>
        
    </ul>
    <div class="my_foot">
        
        <a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
            <img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quiet主题">
        </a>
        
    </div>
</div>
<div class='shelter'>
</div>
<style>
    .shelter{
        background-color: #333;
        opacity:0.5;
        cursor: pointer;
        display: none; 
        position: fixed;
        left: 0;
        top: 0; 
        right: 0;
        bottom: 0;
        z-index: 1998;
    }
    .sidebar {
        width: 66%;
        height: 100%;
        position: fixed;
        top: 0;
        right: -100%;
        bottom: 0;
        background: #fff;
        z-index: 1999;
        text-align: center;
        box-shadow: -6px 0 20px rgba(98, 94, 94, .815);
    }

    .topo {
        width: 100%;
        height: 200px;
        background: url(https://api.ixiaowai.cn/gqapi/gqapi.php) no-repeat;
        background-size: 100% 100%;
        position: relative;
        display: flex;
        align-items: flex-end
    }

    .topo h2 {
        color: #fff;
        z-index: 1;
        position: relative;
        margin: 0 0 10px 10px;
        font-size: 1.2em;
        box-sizing: border-box
    }

    .topo:before {
        content: '';
        background-image: url(/image/pattern.png);
        background-repeat: repeat;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: 1
    }

    .sidebar ul {
        width: 100%;
        margin-top: 50px
    }

    .sidebar ul li {
        height: 50px;
        list-style: none;
        font-size: 1.2em;
        text-align: right;
        margin-right: 10px
    }

    .sidebar ul li a {
        display: grid;
        color: #5d606a;
        text-overflow: ellipsis;
        width: 100%;
        text-decoration: none
    }

    .my_foot {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        position: absolute;
        bottom: 0
    }

    .my_foot a {
        text-decoration: none;
        margin-right: 10px;
        display: inline-block
    }

    .my_foot a img {
        width: 30px;
        height: 30px
    }
</style>

<script>
    $( function () {
	$( '.h-right-close>svg' )
		.click( function () {
			$( '.sidebar' )
				.animate( {
					right: "0"
				}, 500 );
			$( '.shelter' )
				.fadeIn( "slow" )
		} );
	$( '.shelter' )
		.click( function ( e ) {
			$( '.sidebar' )
				.animate( {
					right: "-100%"
				}, 500 );
			$( '.shelter' )
				.fadeOut( "slow" )
		} )
} )

</script>

<div class="post">
    <div class="post-header-background post-header-img"
    style="background: url('https://api.ixiaowai.cn/gqapi/gqapi.php')" 
>
    <div class="post-header-background-content">
        <ul class="post-header-tag">
            
            
            <li><a href="/tags/inject js/css">inject js/css</a></li>
            
            
        </ul>
        
        <h1>firefox-extension</h1>
        <div class="post-header-info">
            <div class="post-header-info-author">
                
                    <svg t="1604839279282" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="2901" width="20" height="20">
                        <path
                            d="M513 956.3c-247.7 0-448-200.3-448-448S265.3 66.2 513 66.2s448 200.3 448 448-200.3 442.1-448 442.1z m0-830.9c-212.2 0-388.8 170.7-388.8 388.8C124.2 726.3 294.9 903 513 903c212.2 0 388.8-170.7 388.8-388.8S725.2 125.4 513 125.4z m0 430.2c-94.2 0-170.7-76.5-170.7-170.7S418.8 207.8 513 207.8s170.7 76.5 170.7 170.7S607.2 555.6 513 555.6z m0-289.1c-64.6 0-112 52.8-112 112s47.4 117.9 112 117.9 112-52.8 112-112-47.4-117.9-112-117.9z m0 689.8c-135.7 0-259-58.7-341.9-158.9l-11.8-17.8 11.8-17.8c76.5-117.9 206.2-188.5 347.8-188.5 135.7 0 265 64.6 341.9 182.6l11.8 17.8-11.8 17.8C778 897.1 648.7 956.3 513 956.3zM230.3 773.2C300.9 849.7 406.9 897 513 897c112 0 218.1-47.4 288.6-129.8-70.5-88.2-170.7-135.6-282.7-135.6s-218.1 53.3-288.6 141.6z"
                            p-id="2902" fill="#ffffff"></path>
                    </svg>
                    
                <span class="post-header-info-author-text"> <a href="../../about">Joey</a></span>
                <div class="post-header-info-author-categories">
                    
                         <a href="../../categories/learn/" target="_blank" >learn</a>
                    
                </div>
                <p>2022-05-24 22:29:02</p>
            </div>
        </div>
    </div>
</div>
    <div class="post-content" id="content">
  
  <div id="article" class="post-content-info">
    

    <h1 id="firefox-extension"><a href="#firefox-extension" class="headerlink" title="firefox extension"></a>firefox extension</h1><blockquote>
<p>I may never wondering there comes a day that i will learn to write a firefox extension, because all most the time i need is to download some one for adds on. But when i get a job, and need to view one web page ten to hundred times, then i really want to do some optimize with the page just wish to improve the usability. And when i write this note, i only learned a little, however i think it is better to do rather than not.</p>
</blockquote>
<p>The main goals that i want to achieve are:</p>
<ol>
<li>edit the color style of a page</li>
<li>automatically choose/click button</li>
<li>intelligent filling/adjust what i typed in</li>
</ol>
<h2 id="the-way-to-realize"><a href="#the-way-to-realize" class="headerlink" title="the way to realize"></a>the way to realize</h2><ul>
<li>inject css file to web page when we open one url, to customize page style </li>
<li>inject js file to web page(we all know how powerful the js is) to do everything else</li>
</ul>
<h2 id="my-first-extension-with-temporary-loading"><a href="#my-first-extension-with-temporary-loading" class="headerlink" title="my first extension with temporary loading"></a><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension">my first extension</a> with temporary loading</h2><p>at first we need a folder to store all files</p>
<pre><code class="shell">touch chcolor
</code></pre>
<p>then create folder and file like this</p>
<pre><code class="shell">── chcolor
   ├── icons
   │  ├── 32.png
   │  ├── 48.png
   ├── manifest.json
   └── scripts
      ├── modify.js
      └── theme.css
</code></pre>
<ul>
<li><code>manifest.json</code> is the main file to describe everything else</li>
<li><code>icons</code> folder includes all the icons used in adds on</li>
<li><code>scripts</code> folder store our main js and css file</li>
</ul>
<h3 id="mainfest-json"><a href="#mainfest-json" class="headerlink" title="mainfest.json"></a>mainfest.json</h3><p>describe which icon the extension use and which url will be match, which js and css file we use.</p>
<pre><code class="json">&#123;
    &quot;manifest_version&quot;: 2,
    &quot;name&quot;: &quot;chcolor&quot;,
    &quot;version&quot;: &quot;1.0&quot;,

    &quot;description&quot;: &quot;testing and learning&quot;,

    &quot;icons&quot;: &#123;
        &quot;48&quot;: &quot;icons/48.png&quot;
    &#125;,

    &quot;content_scripts&quot;:[
        &#123;
            &quot;matches&quot;:[&quot;*://*.baidu.com/*&quot;],
            &quot;js&quot;:[&quot;scripts/modify.js&quot;],
            &quot;css&quot;:[&quot;scripts/theme.css&quot;]
        &#125;
    ]
&#125;
</code></pre>
<h3 id="inject-css-file-to-web-page"><a href="#inject-css-file-to-web-page" class="headerlink" title="inject css file to web page"></a>inject css file to web page</h3><p>if we want to customized the style of web page, at first we need to find the css in web page and then change to what we want in our local css file. note that we only need copy the one we need, not all of them.</p>
<p><img src=".images/get-css.gif"></p>
<p><code>theme.css</code></p>
<pre><code class="css">.s-top-left-new &#123;
    display: none;
&#125; 

.s-hotsearch-wrapper &#123;
    display: none;
&#125;

#head_wrapper #kw &#123;
    border: 2px solid #a65d31;
    background: #c0b29c52;
&#125;

#head_wrapper .s_btn &#123;
    background-color: #a65d31;
    border-radius: 0 20px 20px 0;
&#125;
</code></pre>
<h3 id="inject-js-to-web-page"><a href="#inject-js-to-web-page" class="headerlink" title="inject js to web page"></a>inject js to web page</h3><p>another way hiding some elements of page is to use js’s  function <code>removeChild()</code></p>
<p><em><strong>note that</strong></em> the parent element must be the direct father element of child, otherwise it will make no sense.</p>
<p><code>modify.js</code></p>
<pre><code class="js">// change whole webpage background color
document.body.style.backgroundColor = &quot;#eef2e8&quot;;

// use console.log to debug
console.log(&quot;start&quot;);

menu_father = document.getElementById(&quot;head&quot;);
menu = document.getElementById(&quot;s-top-left&quot;);
menu_father.removeChild(menu);

hot_search = document.getElementById(&quot;s-hotsearch-wrapper&quot;);

hot_search_father = document.getElementsByClassName(&quot;s_form_wrapper soutu-env-nomac soutu-env-index&quot;)[0];
hot_father.removeChild(hot_search);

console.log(&quot;done&quot;);
</code></pre>
<p><em>if we cannot find an element by id, we can find it by classname, and remember that we need to use index figuring out it.</em></p>
<p>in console, we can find whether it is done.</p>
<p><img src=".images/image-20220521180238741.png" alt="image-20220521180238741"></p>
<h3 id="temporary-load-our-extension-to-firefox"><a href="#temporary-load-our-extension-to-firefox" class="headerlink" title="temporary load our extension to firefox"></a>temporary load our extension to firefox</h3><p>in <code>about:debugging</code> of firefox, click <strong>This Firefox</strong> to load our extension, then reload the web page, we will find it makes effect.</p>
<p>now it will look like this:</p>
<p><img src=".images/image-20220521175751914.png" alt="image-20220521175751914"></p>
<h2 id="pack-file-to-an-shared-extension"><a href="#pack-file-to-an-shared-extension" class="headerlink" title="pack file to an shared extension"></a>pack file to an shared extension</h2><p>with the above method, we can only make it effect when the browser opens, once it reopens then it will not work until we add it by hand.</p>
<p>so we need to pack it up to an <code>.xpi</code> file, one important thing is <strong>we need compress our file to a zip file first and then send it to AMO to sign</strong>. Once it be signed, we can install it like other online adds on.</p>
<p>before compress file, we need add some info to <code>manifest.json</code></p>
<pre><code class="json">&quot;browser_specific_settings&quot;: &#123;
  &quot;gecko&quot;: &#123;
    &quot;id&quot;: &quot;ssfwshutterbug@gmail.com&quot;
  &#125;
&#125;
</code></pre>
<p>compress file</p>
<pre><code class="shell"># compress file without unnecessary file such as .git folder
zip -r -FS ../my-extension.zip * --exclude &#39;*.git*&#39;
</code></pre>
<p>open <a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-US/firefox/">AMO</a> web page, login our account, then click <a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-US/developers/">developer hub</a>, upload our zip file. once it done, we can download it from this page.</p>

  </div>
  <div id="gitalk-container"></div>
</div>

<script>
  
Fancybox.bind('[data-fancybox="fancybox-gallery-img"]', {
  dragToClose: true,
  Toolbar: true,
  closeButton: "top",
  Image: {
    zoom: true,
  },
  on: {
    initCarousel: (fancybox) => {
      const slide = fancybox.Carousel.slides[fancybox.Carousel.page];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
    "Carousel.change": (fancybox, carousel, to, from) => {
      const slide = carousel.slides[to];
      fancybox.$container.style.setProperty(
        "--bg-image",
        `url("${slide.$thumb.src}")`
      );
    },
  },
});
</script>

<style>
    #noneimg img {
        display: none;
        z-index: 9999;
        /* width: 600px !important; */
        min-width: 0%;
        max-width: 90%;
        max-height: 80%;
        border-radius: 0px;
        position: fixed;
        box-shadow: 0 0 0px #c3c3c300 !important;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto !important;
    }

    @media screen and (max-width:600px) {
        #noneimg img {
            max-width: 88%
        }
    }
</style>

    <div class="post-paging">
    
    <a href="/2022/05/26/%E4%BA%BA%E7%94%9F%E5%87%A0%E5%A4%9A%E6%84%81/">
        <div class="post-paging-last">
            <span>上一篇</span>
            <p>人生几多愁</p>
        </div>
    </a>
    

    
    <a href="/2022/05/15/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E9%83%BD%E6%82%A3%E4%B8%8A%E4%BA%86%E6%84%A4%E6%80%92%E8%B0%83%E8%8A%82%E9%9A%9C%E7%A2%8D/">
        <div class="post-paging-next">
            <span>下一篇</span>
            <p>为什么我们都患上了愤怒调节障碍</p>
        </div>
    </a>
    
</div>
</div>
		
<div class="footer">
	<div class="Copyright">
		©2022 By Joey. 主题：<a
			style="text-decoration: none;display: contents; color: #898F9F;"
			target="_blank" rel="noopener" href="https://github.com/79e/hexo-theme-quiet">Quiet</a>
	</div>
	<div class="contact">
		
		<a target="_blank" rel="noopener" href="https://github.com/79E/hexo-theme-quiet">
			<img src="https://cdn.jsdelivr.net/gh/duogongneng/MyBlogImg/imggithub.png" alt="Quiet主题">
		</a>
		
	</div>
</div>

<script src="/js/gotop.js"></script>


<style type="text/css">
    @media screen and (min-width: 600px) {
        .goTop>span {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            opacity: 0.8;
            background: rgba(18, 24, 58, 0.06);
            text-align: center;
            transition: border .5s;
            border: 1px solid rgba(18, 24, 58, 0.06);

            -moz-transition: border .5s;
            /* Firefox 4 */
            -webkit-transition: border .5s;
            /* Safari 和 Chrome */
            -o-transition: border .5s;
            /* Opera */
        }

        .goTop>span:hover {
            border: 1px solid #6680B3;
        }


        .goTop {
            position: fixed;
            right: 30px;
            bottom: 80px;
        }

        .goTop>span>svg {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

    }

    @media screen and (max-width: 600px) {
        .goTop {
            display: none;
        }
    }
</style>
<div class="goTop" id="js-go_top">
    <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g>
                <path d="M13 12v8h-2v-8H4l8-8 8 8z"></path>
            </g>
        </svg>
    </span>
</div>
<script>
    $( '#js-go_top' )
	.gotoTop( {
		offset: 500,
		speed: 300,
		animationShow: {
			'transform': 'translate(0,0)',
			'transition': 'transform .5s ease-in-out'
		},
		animationHide: {
			'transform': 'translate(100px,0)',
			'transition': 'transform .5s ease-in-out'
		}
	} );
</script>


    <!-- Gitalk -->
    <script>
        const data = '{"clientID":"02b3c","clientSecret":"adfc7b4","repo":"gimment","owner":"duneng","admin":"duneng"}'
        const gitalk = new Gitalk({
            ...JSON.parse( data),
            id:location.pathname,
            distractionFreeMode:false
        })
        
        if(Boolean('true')){
            gitalk.render('gitalk-container')
        }
    </script>

<script>
	console.log('\n %c Hexo-Quiet 主题 %c https://github.com/79e/hexo-theme-quiet \n', 'color: #fadfa3; background: #030307; padding:5px 0;', 'background: #fadfa3; padding:5px 0;')
</script>
	</body>
</html>

